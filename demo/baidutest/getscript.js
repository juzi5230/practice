window.TILE_VERSION={"ditu":{"normal":{"version":"088","updateDate":"20220211"},"satellite":{"version":"009","updateDate":"20220211"},"normalTraffic":{"version":"081","updateDate":"20220211"},"satelliteTraffic":{"version":"083","updateDate":"20220211"},"mapJS":{"version":"104","updateDate":"20220211"},"satelliteStreet":{"version":"083","updateDate":"20220211"},"earthVector":{"version":"001","updateDate":"20220211"}},"webapp":{"high_normal":{"version":"001","updateDate":"20220211"},"lower_normal":{"version":"002","updateDate":"20220211"}},"api_for_mobile":{"vector":{"version":"002","updateDate":"20220211"},"vectorIcon":{"version":"002","updateDate":"20220211"}}};window.MSV={"mapstyle":{"updateDate":"20220128","version":"001"}};window.BMAP_AUTHENTIC_KEY="E4805d16520de693a3fe707cdc962045";window.BMapGL=window.BMapGL||{};(function(bo,eF){var C=C||{version:"20150702",emptyFn:function(){}};(function(){C._log=[];var i=0;var T={};C.BaseClass=function(hY){T[(this.hashCode=(hY||C.BaseClass.guid()))]=this};C.BaseClass.guid=function(){return"mz_"+(i++).toString(36)};C.BaseClass.create=function(){var hY=new C.BaseClass();hY.decontrol();return hY};var e=C.instance=C.I=function(hY){return T[hY]};C.BaseClass.prototype.dispose=function(){if(this.hashCode){delete T[this.hashCode]}for(var hY in this){if(typeof this[hY]!="function"){delete this[hY]}}};C.BaseClass.prototype.getHashCode=function(){if(!this.hashCode){T[(this.hashCode=C.BaseClass.guid())]=this}return this.hashCode};C.BaseClass.prototype.decontrol=function(){delete T[this.hashCode]};C.BaseClass.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};C.BaseClass.prototype._wlog=function(hZ,h0){var hY=C._log;if(hY.length>100){hY.reverse().length=50;hY.reverse()}hY[hY.length]="["+hZ+"]["+(this._className||"Object")+" "+this.hashCode+"] "+h0}})();Function.prototype.inherits=function(hY,T){var e,hZ,h1=this.prototype,h0=function(){};h0.prototype=hY.prototype;hZ=this.prototype=new h0();if(typeof(T)=="string"){hZ._className=T}for(e in h1){hZ[e]=h1[e]}this.prototype.constructor=h1.constructor;h1=h0=null;return hZ};C.BaseEvent=function(e,i){this.type=e;this.returnValue=true;this.target=i||null;this.currentTarget=this.srcElement=null;this.cancelBubble=false;this.domEvent=null};C.BaseClass.prototype.on=C.BaseClass.prototype.addEventListener=function(T,i){if(typeof i!=="function"){return this._wlog("error","addEventListener:"+i+" is not a function")}if(!this._listeners){this._listeners={}}var e=this._listeners;if(T.indexOf("on")!==0){T="on"+T}if(typeof e[T]!=="object"){e[T]={}}var hY=i.hashCode||C.BaseClass.guid();i.hashCode=hY;if(e[T][hY]){this._wlog("warning","repeat key:"+hY)}e[T][hY]=i};C.BaseClass.prototype.off=C.BaseClass.prototype.removeEventListener=function(T,i){if(typeof i=="function"){i=i.hashCode}else{if(typeof i!=="string"&&typeof i!=="undefined"){return}}if(!this._listeners){this._listeners={}}if(T.indexOf("on")!=0){T="on"+T}var e=this._listeners;if(!e[T]){return}if(i===undefined){e[T]={};return}if(e[T][i]){delete e[T][i]}};C.BaseClass.prototype.fire=C.BaseClass.prototype.dispatchEvent=function(hY){if(!this._listeners){this._listeners={}}var T,e=this._listeners,hZ=hY.type;hY.target=hY.srcElement=hY.target||hY.srcElement||this;hY.currentTarget=this;if(typeof this[hZ]=="function"){this[hZ](hY)}if(typeof e[hZ]=="object"){for(T in e[hZ]){if(typeof e[hZ][T]=="function"){e[hZ][T].call(this,hY)}}}return hY.returnValue};C.BaseEvent.prototype.inherit=function(T){var i=this;this.domEvent=T=window.event||T;i.clientX=T.clientX||T.pageX;i.clientY=T.clientY||T.pageY;i.offsetX=T.offsetX||T.layerX;i.offsetY=T.offsetY||T.layerY;i.screenX=T.screenX;i.screenY=T.screenY;i.ctrlKey=T.ctrlKey||T.metaKey;i.shiftKey=T.shiftKey;i.altKey=T.altKey;return i};C.Browser=(function(){var T=navigator.userAgent;var hZ=0;var e=0;var h0=0;var i=0;var h4=0;var h2=0;var h3=0;var h1=0;var hY=0;var h5=0;if(typeof window.opera==="object"&&/Opera(\s|\/)(\d+(\.\d+)?)/.test(T)){h0=parseFloat(RegExp.$2)}else{if(/OPR(\/(\d+)(\..?)?)/.test(T)){h0=parseInt(RegExp.$2,10)}else{if(/Edge\/((\d+)\.\d+)/.test(T)){hZ=parseInt(RegExp.$2,10)}else{if(/MSIE (\d+(\.\d+)?)/.test(T)){e=parseFloat(RegExp.$1)}else{if(T.indexOf("Trident")>-1&&/rv:(\d+(\.\d+)?)/.test(T)){e=parseInt(RegExp.$1,10)}else{if(/Firefox(\s|\/)(\d+(\.\d+)?)/.test(T)){h4=parseFloat(RegExp.$2)}else{if(navigator.vendor==="Netscape"&&/Netscape(\s|\/)(\d+(\.\d+)?)/.test(T)){h3=parseFloat(RegExp.$2)}else{if(T.indexOf("Safari")>-1&&/Version\/(\d+(\.\d+)?)/.test(T)){i=parseFloat(RegExp.$1)}}}}}}}}if(T.indexOf("Trident")>-1&&/Trident\/(\d+(\.\d+)?)/.test(T)){h1=parseInt(RegExp.$1,10)}else{if(!e&&!hZ&&T.indexOf("Gecko")>-1&&T.indexOf("KHTML")===-1&&/rv\:(\d+(\.\d+)?)/.test(T)){hY=parseFloat(RegExp.$1)}else{if(!hZ&&/chrome\/(\d+(\.\d+)?)/i.test(T)){h2=parseFloat(RegExp.$1)}else{if(!hZ&&/AppleWebKit\/(\d+(\.\d+)?)/.test(T)){h5=parseInt(RegExp.$1,10)}}}}var h6={edge:hZ,ie:e,firefox:h4,netscape:h3,opera:h0,safari:i,chrome:h2,gecko:hY,trident:h1,webkit:h5};return h6})();window.FeBrowser=C.Browser;C.Dom={};C.Dom.createDom=function(i,e){if(C.isIE&&e&&e.name){i="<"+i+' name="'+C.String.escapeHTML(e.name)+'">'}var T=document.createElement(i);if(e){C.Dom.setProperties(T,e)}return T};C.Dom.getOffset=function(hY){var h1=C.Dom.getOwnerDocument(hY);var h0=C.isGecko>0&&h1.getBoxObjectFor&&C.Dom.getStyle(hY,"position")=="absolute"&&(hY.style.top===""||hY.style.left==="");var h2={left:0,top:0};var i=(C.isIE&&!C.isStrict)?h1.body:h1.documentElement;if(hY==i){return h2}var T=null;var hZ;if(hY.getBoundingClientRect){hZ=hY.getBoundingClientRect();h2.left=hZ.left+Math.max(h1.documentElement.scrollLeft,h1.body.scrollLeft);h2.top=hZ.top+Math.max(h1.documentElement.scrollTop,h1.body.scrollTop);h2.left-=h1.documentElement.clientLeft;h2.top-=h1.documentElement.clientTop;if(C.isIE&&!C.isStrict){h2.left-=2;h2.top-=2}}else{if(h1.getBoxObjectFor&&!h0){hZ=h1.getBoxObjectFor(hY);var e=h1.getBoxObjectFor(i);h2.left=hZ.screenX-e.screenX;h2.top=hZ.screenY-e.screenY}else{T=hY;do{h2.left+=T.offsetLeft;h2.top+=T.offsetTop;if(C.isWebkit>0&&C.Dom.getStyle(T,"position")=="fixed"){h2.left+=h1.body.scrollLeft;h2.top+=h1.body.scrollTop;break}T=T.offsetParent}while(T&&T!=hY);if(C.isOpera>0||(C.isWebkit>0&&C.Dom.getStyle(hY,"position")=="absolute")){h2.top-=h1.body.offsetTop}T=hY.offsetParent;while(T&&T!=h1.body){h2.left-=T.scrollLeft;if(!C.isOpera||T.tagName!="TR"){h2.top-=T.scrollTop}T=T.offsetParent}}}return h2};C.Dom.getOwnerDocument=function(e){return e.nodeType==9?e:e.ownerDocument||e.document};C.Dom.setProperties=function(i,e){C.each(e,function(hY,T){C.Dom._setProperty(i,T,hY)})};C.Dom._setProperty=function(i,e,T){if(e=="style"){i.style.cssText=T}else{if(e=="class"){i.className=T}else{if(e=="for"){i.htmlFor=T}else{if(e in C.Dom._DIRECT_ATTRIBUTE_MAP){i.setAttribute(C.Dom._DIRECT_ATTRIBUTE_MAP[e],T)}else{i[e]=T}}}}};C.Dom._DIRECT_ATTRIBUTE_MAP={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder"};C.G=function(){for(var T=[],hY=arguments.length-1;hY>-1;hY--){var hZ=arguments[hY];T[hY]=null;if(typeof hZ=="object"&&hZ&&hZ.dom){T[hY]=hZ.dom}else{if((typeof hZ=="object"&&hZ&&hZ.tagName)||hZ==window||hZ==document){T[hY]=hZ}else{if(typeof hZ=="string"&&(hZ=document.getElementById(hZ))){T[hY]=hZ}}}}return T.length<2?T[0]:T};C.ac=function(e,i){if(!(e=this.G(e))){return}i=this.trim(i);if(!new RegExp("(^| )"+i.replace(/(\W)/g,"\\$1")+"( |$)").test(e.className)){e.className=e.className.split(/\s+/).concat(i).join(" ")}};C.addClassName=C.ac;C.each=function(h0,e){if(typeof e!="function"){return h0}if(h0){if(h0.length===undefined){for(var T in h0){e.call(h0[T],h0[T],T)}}else{for(var hY=0,hZ=h0.length;hY<hZ;hY++){e.call(h0[hY],h0[hY],hY)}}}return h0};C.extend=function(h0,hY){if(h0&&hY&&typeof(hY)=="object"){for(var hZ in hY){h0[hZ]=hY[hZ]}var T=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];for(var e=0,i;e<T.length;e++){i=T[e];if(Object.prototype.hasOwnProperty.call(hY,i)){h0[i]=hY[i]}}}return h0};C.hide=function(){C.each(arguments,function(e){if(e=C.G(e)){e.style.display="none"}})};C.inherit=function(h2,hY,T){var h1=h2.prototype;var h0=function(){};h0.prototype=hY.prototype;var hZ=h2.prototype=new h0();if(typeof T=="string"){hZ._className=T}for(var e in h1){hZ[e]=h1[e]}h2.prototype.constructor=h1.constructor;h1=null;return hZ};C.isIE=0;(function(){if(navigator.userAgent.indexOf("MSIE")>0&&!window.opera){/MSIE (\d+(\.\d+)?)/.test(navigator.userAgent);C.isIE=parseFloat(RegExp.$1)}})();C.rc=function(e,i){if(!(e=this.G(e))){return}i=this.trim(i);var T=e.className.replace(new RegExp("(^| +)"+i.replace(/(\W)/g,"\\$1")+"( +|$)","g"),"$2");if(e.className!=T){e.className=T}};C.removeClassName=C.rc;C.show=function(){this.each(arguments,function(e){if(e=C.G(e)){e.style.display=""}})};C.trim=function(e){return e.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g,"")};C.getElementsByClassName=function(e,i){if(e.getElementsByClassName){return e.getElementsByClassName(i)}else{return(function T(h5,h3){if(h3==null){h3=document}var h2=[],h1=h3.getElementsByTagName("*"),hY=h1.length,h4=new RegExp("(^|\\s)"+h5+"(\\s|$)"),h0,hZ;for(h0=0,hZ=0;h0<hY;h0++){if(h4.test(h1[h0].className)){h2[hZ]=h1[h0];hZ++}}return h2})(i,e)}};C.toggleClass=function(e,i){if(C.hasClass(e,i)){C.removeClassName(e,i)}else{C.addClassName(e,i)}};C.hasClass=function(hY,T){if(!hY||!hY.className||typeof hY.className!="string"){return false}var i=-1;try{i=hY.className==T||hY.className.search(new RegExp("(\\s|^)"+T+"(\\s|$)"))}catch(hZ){return false}return i>-1};C.insertHTML=function(hY,e,T){hY=C.G(hY);if(hY===null){return hY}var i,hZ;if(hY.insertAdjacentHTML){hY.insertAdjacentHTML(e,T)}else{i=hY.ownerDocument.createRange();e=e.toUpperCase();if(e=="AFTERBEGIN"||e=="BEFOREEND"){i.selectNodeContents(hY);i.collapse(e=="AFTERBEGIN")}else{hZ=e=="BEFOREBEGIN";i[hZ?"setStartBefore":"setEndAfter"](hY);i.collapse(hZ)}i.insertNode(i.createContextualFragment(T))}return hY};if(typeof HTMLElement!="undefined"&&HTMLElement.prototype.__lookupGetter__&&!HTMLElement.prototype.__lookupGetter__("children")&&!window.opera){try{HTMLElement.prototype.__defineGetter__("children",function(){for(var T=[],hY=0,h0,hZ=0,e=this.childNodes.length;hZ<e;hZ++){h0=this.childNodes[hZ];if(h0.nodeType==1){T[hY++]=h0;if(h0.name){if(!T[h0.name]){T[h0.name]=[]}T[h0.name][T[h0.name].length]=h0}if(h0.id){T[h0.id]=h0}}}return T})}catch(gC){}}if(typeof(HTMLElement)!="undefined"&&!window.opera&&HTMLElement.prototype&&!HTMLElement.prototype.insertAdjacentHTML){HTMLElement.prototype.insertAdjacentHTML=function(i,T){var hY=this.ownerDocument.createRange();hY.setStartBefore(this);hY=hY.createContextualFragment(T);switch(i){case"beforeBegin":this.parentNode.insertBefore(hY,this);break;case"afterBegin":this.insertBefore(hY,this.firstChild);break;case"beforeEnd":this.appendChild(hY);break;case"afterEnd":if(!this.nextSibling){this.parentNode.appendChild(hY)}else{this.parentNode.insertBefore(hY,this.nextSibling)}break}}}if(typeof HTMLElement!="undefined"&&!window.opera){HTMLElement.prototype.contains=function(e){if(e==this){return true}while(e=e.parentNode){if(e==this){return true}}return false}}if(!C.Browser.ie&&typeof Event!="undefined"&&!window.opera){Event.prototype.__defineSetter__("returnValue",function(e){if(!e){this.preventDefault()}return e});Event.prototype.__defineSetter__("cancelBubble",function(e){if(e){this.stopPropagation()}return e})}C.each=function(hZ,hY){if(bV(hY)){for(var T=0,e=hZ.length;T<e;T++){if(hY.call(hZ,hZ[T],T)===false){break}}}return hZ};C.Platform={x11:0,macintosh:0,windows:0,android:0,iphone:0,ipad:0};for(var gy in C.Platform){if(C.Platform.hasOwnProperty(gy)){C.Platform[gy]=new RegExp(gy,"i").test(window.navigator.userAgent)?1:0}}if(typeof(C.Dom)==="undefined"){C.Dom={}}C.Dom.getComputedStyle=function(i,e){var hY=i.nodeType==9?i:i.ownerDocument||i.document,T;if(hY.defaultView&&hY.defaultView.getComputedStyle){T=hY.defaultView.getComputedStyle(i,null);if(T){return T[e]||T.getPropertyValue(e)}}else{if(i.currentStyle){return i.currentStyle[e]||""}}return""};var bb=C.BaseEvent;var eg=C.BaseClass;eg.prototype.toString=function(){return this._className||""};C.on=function(T,i,e){if(!(T=C.G(T))){return T}i=i.replace(/^on/,"");if(T.addEventListener){T.addEventListener(i,e,false)}else{if(T.attachEvent){T.attachEvent("on"+i,e)}}return T};C.un=function(T,i,e){if(!(T=C.G(T))){return T}i=i.replace(/^on/,"");if(T.removeEventListener){T.removeEventListener(i,e,false)}else{if(T.detachEvent){T.detachEvent("on"+i,e)}}return T};C.hc=function(hY,T){if(!hY||!hY.className||typeof hY.className!="string"){return false}var i=-1;try{i=hY.className==T||hY.className.search(new RegExp("(\\s|^)"+T+"(\\s|$)"))}catch(hZ){return false}return i>-1};C.isEmptyObject=function(T){if(Object.prototype.toString.call(T)==="[object Object]"){for(var e in T){return false}return true}else{return false}};var f9=window.location.protocol==="http:"?"http:":"https:";var e0={fontFamily:'Arial,Helvetica,"PingFang SC","Hiragino Sans GB",STHeiti,sans-serif',mapStyleNameIdPair:{"default":0,"grayed-out":1},mapHost:f9+"//map.baidu.com",apiHost:f9+"//api.map.baidu.com",apiIMG:f9+"//api.map.baidu.com/images",staticHost:f9+"//webmap0.bdimg.com",imgPath:f9+"//webmap0.bdimg.com/image/api/",tileDomain:[f9+"//maponline0.bdimg.com",f9+"//maponline1.bdimg.com",f9+"//maponline2.bdimg.com",f9+"//maponline3.bdimg.com"],optDomain:"http://10.120.25.45:8017",rasterTilePath:"/tile/",vectorTilePath:"/pvd/",originTilePath:[f9+"//pcor.baidu.com"],getIconSetPath:function(e){var i="map_icons2x/";if(typeof e==="string"&&this.mapStyleNameIdPair[e]>0){i="map_icons2x_"+(this.mapStyleNameIdPair[e]-1)+"/"}return f9+"//maponline0.bdimg.com/sty/"+i},getMapStyleFiles:function(T){var hZ=true;if(typeof T==="string"&&T!=="default"){hZ=false}var h0=hZ?"":"_"+(this.mapStyleNameIdPair[T]-1);var i=fF();var hY="udt="+i.udt+"&v="+i.ver;var e=f9+"//maponline0.bdimg.com/sty/";return[e+"icons_2x"+h0+".js?"+hY,e+"fs"+h0+".js?"+hY,e+"indoor_fs.js?"+hY]},tvc:{ditu:{normal:{version:"088",updateDate:"20210726"},satellite:{version:"009",updateDate:"20210726"},normalTraffic:{version:"081",updateDate:"20210726"},satelliteTraffic:{version:"083",updateDate:"20210726"},mapJS:{version:"104",updateDate:"20210726"},satelliteStreet:{version:"083",updateDate:"20210726"},panoClick:{version:"1033",updateDate:"20180108"},panoUdt:{version:"20180108",updateDate:"20180108"},panoSwfAPI:{version:"20150123",updateDate:"20150123"},panoSwfPlace:{version:"20141112",updateDate:"20141112"},earthVector:{version:"001",updateDate:"20210726"}}},msv:{mapstyle:{updateDate:"20210726",version:"001"}}};e0.imgResources={blankGIF:e0.staticHost+"/res/litemapapi/v1d1/images/blank.gif?20170501",markerPng:e0.staticHost+"/res/litemapapi/v1d1/images/marker.png?20170501",locPng:e0.staticHost+"/res/litemapapi/v1d1/images/loc.png?20180918",locNewPng:e0.staticHost+"/res/litemapapi/v1d1/images/loc_new.png?20190314",zoomPng:e0.staticHost+"/res/litemapapi/v1d1/images/zoombtn.png?20180918",mapLogoPng:e0.staticHost+"/res/litemapapi/v1d1/images/logo-2x.png?20190226"};var e8=e0;var a3="ruler.cur";if(C.Browser.ie||C.Browser.edge){C.extend(e8,{distCursor:"url("+e8.imgPath+a3+"),crosshair",defaultCursor:"url("+e8.imgPath+"openhand.cur),default",draggingCursor:"url("+e8.imgPath+"closedhand.cur),move"})}else{if(C.Browser.firefox){C.extend(e8,{distCursor:"url("+e8.imgPath+a3+"),crosshair",defaultCursor:"-moz-grab",draggingCursor:"-moz-grabbing"})}else{if(C.Browser.chrome||C.Browser.safari){C.extend(e8,{distCursor:"url("+e8.imgPath+a3+") 2 6,crosshair",defaultCursor:"url("+e8.imgPath+"openhand.cur) 8 8,default",draggingCursor:"url("+e8.imgPath+"closedhand.cur) 8 8,move"});if(C.Platform.macintosh){e8.defaultCursor="-webkit-grab";e8.draggingCursor="-webkit-grabbing"}}else{C.extend(e8,{distCursor:"url("+e8.imgPath+a3+"),crosshair",defaultCursor:"url("+e8.imgPath+"openhand.cur),default",draggingCursor:"url("+e8.imgPath+"closedhand.cur),move"})}}}bo=bo||{};bo.version="gl";bo._register=[];bo.register=function(e){this._register[this._register.length]=e};bo.guid=1;bo.getGUID=function(e){return(e||"")+bo.guid++};var gk=window.BMAP_AUTHENTIC_KEY||"";function dS(e,i,hY){var T=new Date();T.setTime(T.getTime()+hY*24*60*60*1000);document.cookie=e+"="+escape(i)+";expires="+T.toGMTString()}function d6(e,i){if(navigator.cookieEnabled){return dS(e,i,30)}if(localStorage){return localStorage.setItem(e,i)}if(sessionStorage){return sessionStorage.setItem(e,i)}}bo.getSeckeyCid=function(){var i=+new Date();var e=f9+"//dlswbr.baidu.com/heicha/mw/abclite-2063-s.js?_t="+i;ht.load(e,ew)};function ew(){if(window.___abvk){d6("SECKEY_ABVK",window.___abvk)}}window.__abbaidu_2063_cb=function(i){var e=JSON.parse(i);d6("BMAP_SECKEY",e.data)};bo.bmapVerifyCbk=function(e){if(e&&e.error!==0){if(typeof map!=="undefined"){map.getContainer().innerHTML="";map.__listeners={}}bo=null;var i="百度未授权使用地图API，可能是因为您提供的密钥不是有效的百度地图开放平台密钥，或此密钥未对本应用的百度地图JavaScriptAPI授权。您可以访问如下网址了解如何获取有效的密钥：https://lbs.baidu.com/apiconsole/key#。";switch(e.error){case 101:i="您所使用的密钥ak有问题，不支持jsapi服务，可以访问该网址了解如何获取有效密钥：http://lbsyun.baidu.com/apiconsole/key#。";break;case 102:i="MCODE参数不存在，mobile类型MCODE参数必需，详情查看：http://lbsyun.baidu.com/apiconsole/key#。";break;case 200:i="APP不存在，AK有误请检查再重试，详情查看：http://lbsyun.baidu.com/apiconsole/key#。";break;case 201:i="APP被您禁用啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 202:i="APP被管理员删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 203:i="APP类型错误，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 210:i="APP IP校验失败，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 220:i="APP Referer校验失败。请检查该ak设置的白名单与访问所有的域名是否一致。详情查看：http://lbsyun.baidu.com/apiconsole/key#";break;case 230:i="APP Mcode码校验失败，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 240:i="APP服务被禁用了，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情，或联系我们了解详情。";break;case 250:i="该用户不存在... 请登录 https://lbs.baidu.com 的控制台，注册成为开发者申请ak吧。";break;case 251:i="该用户被自己删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看自己的应用具体详情。";break;case 252:i="该用户被管理员删除啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 了解如何获取有效密钥，或请联系我们了解详情。";break;case 260:i="您所使用的密钥AK不包含该服务呢，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看服务选择情况，或请联系我们了解详情。";break;case 261:i="您所使用的密钥AK的该服务被禁用啦，可以访问 http://lbsyun.baidu.com/apiconsole/key# 查看服务选择情况，或请联系我们了解详情。";break;case 401:i="您所使用的AK并发超限了，请登录 http://lbsyun.baidu.com/cashier/quota#/home 了解详情。";break;case 302:i="您所使用的AK天配额超限了，请登录 http://lbsyun.baidu.com/cashier/quota#/home 了解详情。";break}alert(i)}};bo.frequencyCbk=function(e){if(e){window.QTFrequency=e}};bo.verify=function(){var e=e8.apiHost+"/?qt=verify&v=gl&type=webgl&ak="+gk+"&callback="+eF+".bmapVerifyCbk";ht.load(e)};bo.frequency=function(){};bo.apiLoad=bo.apiLoad||function(){};function fQ(i,e){this._size=i;this._cache=[];this._totalGetTimes=0;this._totalHitTimes=0;this._options={clearCallback:null,removeOldCallback:null};e=e||{};for(var T in e){if(e.hasOwnProperty(T)){this._options[T]=e[T]}}}fQ.prototype.setData=function(T,hY){var e=this._cache;var i=this._size;if(i===0){return}if(e.length>i){this._removeOld()}if(!e[T]){e.push(hY)}e[T]=hY;hY._key_=T};fQ.prototype.getHitRate=function(){return Math.round(this._totalHitTimes/this._totalGetTimes*1000)/1000};fQ.prototype.getData=function(i){var e=this._cache[i];if(e){this._totalHitTimes++}this._totalGetTimes++;return e};fQ.prototype.removeData=function(hZ){if(this._options.clearCallback){this._options.clearCallback(this._cache[hZ])}var T=this._cache;var h0=T[hZ];for(var hY=0,e=T.length;hY<e;hY++){if(T[hY]===h0){T.splice(hY,1);break}}delete T[hZ]};fQ.prototype._removeOld=function(){var e=this._cache;var hZ=Math.round(this._size*0.6);for(var hY=0;hY<hZ;hY++){var T=e[hY]._key_;if(this._options.clearCallback){this._options.clearCallback(e[T])}delete e[T]}e.splice(0,hZ);if(this._options.removeOldCallback){this._options.removeOldCallback()}};fQ.prototype.clear=function(){var T=this._cache;for(var hZ=0,e=T.length;hZ<e;hZ++){var hY=T[hZ]._key_;if(this._options.clearCallback){this._options.clearCallback(T[hY])}delete T[hY]}this._cache=T=[]};fQ.prototype.forEach=function(hY){var T=this._cache;for(var h0=0,e=T.length;h0<e;h0++){var hZ=T[h0]._key_;hY(T[hZ])}};fQ.prototype.getBatch=function(hZ){var e=[];for(var hY=0,T=hZ.length;hY<T;hY++){if(this.getData(hZ[hY])){e[e.length]=this.getData(hZ[hY])}}return e};fQ.prototype.clearExcept=function(h0){var T=this._cache;for(var e=T.length,hZ=e-1;hZ>=0;hZ--){var hY=this._cache[hZ]._key_;if(!h0[hY]){T.splice(hZ,1);if(this._options.clearCallback){this._options.clearCallback(T[hY])}delete T[hY]}}};fQ.prototype.getDataCount=function(){return this._cache.length};function am(){}C.extend(am.prototype,{centerAndZoomIn:function(h3,T,h4){var h1=this;if(!h3&&!T){return}h3=h3||this.centerPoint;T=T||this.zoomLevel;T=this._getProperZoom(T).zoom;if(this.mapType===BMAP_EARTH_MAP){if(!this._earth){this.mapType=BMAPGL_NORMAL_MAP;this.temp.originMapType=BMAP_EARTH_MAP;function h2(){h1._earth=new bo.Earth(h1,{showRealSunlight:h1.config.showRealSunlight,showMilkyway:h1.config.showMilkyway,earthBackground:h1.config.earthBackground});h1._proxyEarthEvents();h1._changeEarthMapType(BMAP_EARTH_MAP);C.extend(h1,bo.EarthView.prototype);if(!h1._navigationCtrl&&h1.config.showControls){h1._navigationCtrl=new bo.NavigationControl3D(h1)}delete h1.temp.originMapType}ed.load("earth",function(){if(bo["FeatureStyle"+h1.config.style]){h2()}else{h1.loadMapStyleFiles(function(){h2()})}})}}this.lastLevel=this.zoomLevel||T;this.zoomLevel=T;var hZ=new bb("onload");hZ.point=h3;hZ.zoom=T;this.centerPoint=this.restrictCenter(new hz(h3.lng,h3.lat));if(this.centerPoint.zoom){this.zoomLevel=this.centerPoint.zoom}this.defaultZoomLevel=this.defaultZoomLevel||this.zoomLevel;this.defaultCenter=this.defaultCenter||this.centerPoint;if(!this.loaded&&!(this.temp.originMapType===BMAP_EARTH_MAP)){var i=this.config.defaultMaxBounds;var h0=new c5(i,"baidu",this.mapType);var hY=new cR({mapType:this.mapType,copyright:h0,customLayer:false,baseLayer:true,tileTypeName:"web"});hY._isInnerLayer=true;this.addTileLayer(hY);if(this.mapType===BMAP_SATELLITE_MAP&&this._isHybridShow===true){this._addHybirdMap()}}this.dispatchEvent(hZ);this.loaded=true;h4=h4||{};h4.callback&&h4.callback()},_setPlatformPosition:function(h4,h3,h7){h7=h7||{};if(h4===0&&h3===0&&!h7.point){return}if(isNaN(h7.initMapOffsetX)){h7.initMapOffsetX=this.offsetX}if(isNaN(h7.initMapOffsetY)){h7.initMapOffsetY=this.offsetY}var h5=h4+h7.initMapOffsetX;var h2=h3+h7.initMapOffsetY;if(h7.point){var i=this.restrictCenter(h7.point);if(!i.equals(this.centerPoint)){this.centerPoint=i.clone();this.fire(new bb("oncenter_changed"))}}else{var hY=this.offsetX-h5;var e=this.offsetY-h2;var T=this.getZoomUnits();var h1=this.centerPoint.lng;var h0=this.centerPoint.lat;var hZ=new hz(h1,h0);this.centerPoint=this.restrictCenter(new hz(hZ.lng+hY*T,hZ.lat-e*T),T);this.fire(new bb("oncenter_changed"));if(this.zoomLevel<10){h5=this.offsetX-(this.centerPoint.lng-hZ.lng)/T;h2=this.offsetY+(this.centerPoint.lat-hZ.lat)/T}}this.offsetX=h5;this.offsetY=h2;var h6=this.platform.style;h6.left=h5+"px";h6.top=h2+"px";this.maskLayer.style.left=-h5+"px";this.maskLayer.style.top=-h2+"px";if(h7.dispatchEvent!==false){this.dispatchEvent(new bb("onmoving"))}},zoomTo:function(e,h1,h5){h5=h5||{};h5.zoomCenter=h1;if(h5.noAnimation!==true){this.deepZoomTo(e,h5);return}if(typeof e!=="number"){return}var hZ=b6[this.mapType];if(!hZ){return}var T=e;e=this._getProperZoom(e).zoom;if(e===this.zoomLevel){var h2=new bb("onzoomexceeded");h2.targetZoom=T;this.dispatchEvent(h2);h5.callback&&h5.callback();return}this.lastLevel=this.zoomLevel;if(h1){this.temp._cPoint=h1;this.temp._cPixel=this.pointToPixelIn(h1)}else{if(this.getInfoWindow()){var h4=this.getInfoWindow().getPoint();this.temp._cPixel=this.pointToPixelIn(h4);this.temp._cPoint=h4}}if(this.config.zoomCenter){h1=this.config.zoomCenter;this.temp._cPoint=h1;this.temp._cPixel=this.pointToPixelIn(h1)}if(h1||this.temp.infoWin&&this.temp.infoWin.isOpen()){var i=this.temp._cPoint;var h3=this.temp._cPixel;var hY=this.getZoomUnits(e);var h0=new hz(i.lng+hY*(this.width/2-h3.x),i.lat-hY*(this.height/2-h3.y));this.centerPoint=this.restrictCenter(h0,hY,e);if(this.centerPoint.zoom){e=this.centerPoint.zoom}}if(h5.fireEvent!==false){this.dispatchEvent(new bb("onzoomstart"))}if(e!==this.zoomLevel){this.zoomLevel=e;this.dispatchEvent(new bb("onzooming"));this.dispatchEvent(new bb("onzoomstartcode"))}if(h5.fireEvent!==false){this.dispatchEvent(new bb("onzoomend"))}if(h5.callback){h5.callback()}},deepZoomMedia:function(e){var i=this;if(!i.temp.isStdCtrlBusy){i.temp.isStdCtrlBusy=true;i.deepZoomTo(i.zoomLevel+e);setTimeout(function(){i.temp.isStdCtrlBusy=false},400)}},deepZoomTo:function(h2,hY){hY=hY||{};var h0=h2-this.zoomLevel;var hZ=this._getProperZoom(h2);if(hZ.exceeded){var e=new bb("onzoomexceeded");e.targetZoom=h2;this.dispatchEvent(e);return}var i;if(hY.zoomCenter){i=this.pointToPixelIn(hY.zoomCenter)}else{if(this.getInfoWindow()){i=this.pointToPixelIn(this.getInfoWindow().getPoint(),{zoom:this.lastLevel})}else{var i=new em(this.width/2,this.height/2)}}this.lastLevel=this.zoomLevel;var h1=this.deepZoom||new bE(this);var T=h0>0?1:-1;h1.zoomMap(i,h0,T,null,hY)},flyToIn:function(h3,e){if(e===this.zoomLevel){this.panToIn(h3);return}var h0=this._getProperZoom(e);if(h0.exceeded){var h4=new bb("onzoomexceeded");h4.targetZoom=e;this.dispatchEvent(h4);return}var h2=e-this.zoomLevel;var T=new em(this.width/2,this.height/2);var i=this.pointToPixelIn(h3);var h1=new ec(i.x-T.x,i.y-T.y);this.lastLevel=this.zoomLevel;if(Math.abs(h2)>=4||Math.abs(h1.width)>this.width||Math.abs(h1.height)>this.height){this.centerAndZoomIn(h3,e);return}var hZ=this.deepZoom||new bE(this);var hY=h2>0?1:-1;hZ.zoomMap(i,h2,hY,h1)},panToIn:function(i,T){T=T||{};if(!i||i.equals(this.centerPoint)){T.callback&&T.callback();return}var hY=this.pointToPixelIn(i);var e=Math.round(this.width/2);var hZ=Math.round(this.height/2);if(Math.abs(e-hY.x)>this.width||Math.abs(hZ-hY.y)>this.height||T.noAnimation===true){this._panToIn(e-hY.x,hZ-hY.y,i);T.callback&&T.callback()}else{this._panBy(e-hY.x,hZ-hY.y,T)}},_panToIn:function(i,e,hY){var T=this.temp;if(T.operating===true){return}if(T.dragAni){T.dragAni.stop();T.dragAni=null;this.dispatchEvent(new bb("onmoveend"))}this.dispatchEvent(new bb("onmovestart"));this._setPlatformPosition(i,e,{point:hY});this.dispatchEvent(new bb("onmoveend"))},panBy:function(i,e,T){T=T||{};i=Math.round(i)||0;e=Math.round(e)||0;if(Math.abs(i)<=this.width&&Math.abs(e)<=this.height&&T.noAnimation!==true){this._panBy(i,e,T)}else{this._panToIn(i,e);T.callback&&T.callback()}},_panBy:function(i,e,hZ){if(this.temp.operating===true){return}hZ=hZ||{};this.dispatchEvent(new bb("onmovestart"));var hY=this;var T=hY.temp;T.pl=hY.offsetX;T.pt=hY.offsetY;if(T.tlPan){T.tlPan.cancel()}if(T.dragAni){T.dragAni.stop();T.dragAni=null;this.dispatchEvent(new bb("onmoveend"))}T.tlPan=new o({fps:hZ.fps||hY.config.fps,duration:hZ.duration||hY.config.actionDuration,transition:hZ.transition||cn.easeInOutQuad,render:function(h0){this.terminative=hY.temp.operating;if(hY.temp.operating){return}hY._setPlatformPosition(Math.ceil(i*h0),Math.ceil(e*h0),{initMapOffsetX:T.pl,initMapOffsetY:T.pt})},finish:function(h0){hY.dispatchEvent(new bb("onmoveend"));hY.temp.tlPan=false;if(hY.temp.stopArrow===true){hY.temp.stopArrow=false;if(hY.temp.arrow!==0){hY._arrow()}}hZ.callback&&hZ.callback()}})},getCenterIn:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},setTilt:function(){},getTilt:function(){return this._tilt},setHeading:function(){},getHeading:function(){return this._heading},restrictCenter:function(h6,i,e){this.isRestrict=false;i=i||this.getZoomUnits();e=e||this.zoomLevel;var h4=this.pixelToPointIn(new em(this.width,0),{center:h6,zoom:e});var h2=this.pixelToPointIn(new em(0,this.height),{center:h6,zoom:e});var h7=h6.lng;var ic=h6.lat;if(this.config.restrictBounds!==null&&!this.config.restrictBounds.isEmpty()){var ib=this.config.restrictBounds;var hY=ib.getSouthWest();var h9=ib.getNorthEast();var h5=eq.convertLL2MC(hY);var h0=eq.convertLL2MC(h9);h6.lng=this.calcNewLngByBounds(h7,h2,h4,h5.lng,h0.lng,i);h6.lat=this.calcNewLatByBounds(ic,h2,h4,h5.lat,h0.lat,i);return h6}var h3=this.pixelToPointIn(new em(0,0),{center:h6,zoom:e});var hZ=this.pixelToPointIn(new em(0,this.height),{center:h6,zoom:e});if(this.zoomLevel<5){if(h3.lat>c8.MAX_LAT&&hZ.lat<c8.MIN_LAT){this.isRestrict=true;var T=c8.MAX_LAT-h6.lat;var h1=h6.lat-c8.MIN_LAT;var ia;if(T<h1){ia=T/(this.height/2)}else{ia=h1/(this.height/2)}var h8=18-eH(ia);this.zoomLevel=Math.ceil(h8);h6.zoom=Math.ceil(h8);return h6}}if(h3.lat>c8.MAX_LAT){this.isRestrict=true;h6.lat=c8.MAX_LAT-this.height/2*i}else{if(hZ.lat<c8.MIN_LAT){this.isRestrict=true;h6.lat=c8.MIN_LAT+this.height/2*i}}return h6}});function c8(e,T){if(typeof e==="string"){e=document.getElementById(e)}eg.call(this);this.container=e;this.width=e.clientWidth;this.height=e.clientHeight;this.offsetX=0;this.offsetY=0;this._setStyle(e);e.unselectable="on";e.innerHTML="";C.ac(e,"bmap-container");e.appendChild(this.render());this._initDate=new Date();this.platform=e.children[0];this.maskLayer=this.platform.children[0];this._panes={};this.centerPoint=new hz(0,0);this.zoomLevel=0;this._heading=0;this._tilt=0;this._bounds=new dT();this.lastLevel=0;this._lock=false;this._enableTiltZoom=7;this._enableHeadingZoom=7;this.defaultZoomLevel=null;this.defaultCenter=null;this.zoomEventStatus="idle";this.currentOperation=dV.idle;this._setConfig(T);this._initMapRenderType();this._animationInfo={};this._animationInfoUnstopable={};this.suspendLoad=false;this._customTileLabels=[];if(this._renderType==="webgl"){this._workerMgr=new gf(this);this._featureMgr=new dc();C.extend(this,c7.prototype);this.jobScheduler=new fU(this);this.benchmark=new ac();this._setupWebGLMap();this.deviceInfo={hardwareInfo:{renderer:"",vendor:""}};if(a8.ifSupportWebGL._renderer){this.deviceInfo.hardwareInfo.renderer=a8.ifSupportWebGL._renderer;this.deviceInfo.hardwareInfo.vendor=a8.ifSupportWebGL._vendor}}else{C.extend(this,am.prototype)}if(!b6[this.config.mapType]){this.config.mapType=BMAPGL_NORMAL_MAP}if(this.config.mapType===BMAP_EARTH_MAP&&!this.config.enableEarth){if(this.forceEnableEarth()===false){this.config.mapType=BMAPGL_NORMAL_MAP}}this.mapType=this.config.mapType;this.preMapType=null;if(this.config.enableEarth){var h0=this.maskLayer.style;h0.opacity=0;h0.background="#000";if(this.config.mapType===BMAP_EARTH_MAP){h0.opacity=1}setTimeout(function(){h0.WebkitTransition=h0.transition="opacity .4s"},100)}this._isHybridShow=this.config.showStreetLayer;this.temp={operating:false,arrow:0,lastDomMoveTime:0,lastLoadTileTime:0,lastMovingTime:0,canKeyboard:false,I:function(i){return C.I(i)},curSpots:[],curSpotsArray:[],curAreaSpot:null,spotsGuid:1,registerIndex:-1,hoverOnSpot:null,isStdCtrlBusy:false};window.InstanceCore=this.temp.I;this.platform.style.cursor=this.config.defaultCursor;this._bind();for(var hY=0;hY<bo._register.length;hY++){bo._register[hY](this)}this.temp.registerIndex=hY;var hZ=this;if(this._renderType==="webgl"){ed.load("oppcgl",function(){hZ._asyncRegister()})}else{ed.load("oppc",function(){hZ._asyncRegister()})}if(this.config.mapType==="B_EARTH_MAP"){if(!bo.Earth){ed.load("earth",function(){})}else{hZ._syncAndChangeMapType("B_EARTH_MAP")}}}c8.MAX_TILT=87;c8.MAX_DRAG_TILT=73;c8.MAX_DRAG_TILT_L2=50;c8.MIN_TILT=0;c8.MAX_LAT=19431424;c8.MIN_LAT=-16023552;c8.WORLD_SIZE_MC_HALF=20037726.372307256;c8.WORLD_SIZE_MC=c8.WORLD_SIZE_MC_HALF*2;c8.RIGHT_EDGE_POINT=new hz(c8.WORLD_SIZE_MC_HALF,0);c8.LEFT_EDGE_POINT=new hz(-c8.WORLD_SIZE_MC_HALF,0);c8.HIGH_RES_MIN_RATIO=1.2;c8.inherits(eg,"Map");var da={NORMAL:"B_NORMAL_MAP",EARTH:"B_EARTH_MAP",SATELLITE:"B_STREET_MAP"};bo.MapTypeId=da;C.extend(c8.prototype,{render:function(){var e=S("div",{id:"platform"});var hY=e.style;hY.overflow="visible";hY.position="absolute";hY.zIndex=5;hY.top=hY.left="0px";var i=S("div",{id:"mask","class":"BMap_mask"});var T=i.style;T.position="absolute";T.top=T.left="0px";T.zIndex="9";T.overflow="hidden";T.WebkitUserSelect="none";T.width=this.width+"px";T.height=this.height+"px";e.appendChild(i);return e},_initMapRenderType:function(){var e=this.config.forceRenderType;if(e==="dom"){this._renderType="dom";return}else{if(e==="canvas"){if(a8.isModernBrowser&&!a8.ifCanvas2dInBlackList()){this._renderType="canvas";return}else{this._renderType="dom";return}}else{if(e==="webgl"){if(a8.ifSupportWebGL()){this._renderType="webgl";return}}}}if(a8.ifSupportWebGL()&&a8.ifEnableWebGLMap()){this._renderType="webgl";return}if(a8.isModernBrowser&&a8.ifEnableCanvas2dMap()){this._renderType="canvas";return}this._renderType="dom"},_setConfig:function(i){i=i||{};this.config={bottomOffset:0,clickInterval:200,enableDragging:true,enableRotate:true,enableTilt:true,enableKeyboard:false,enableDblclickZoom:true,enableContinuousZoom:true,enableWheelZoom:false,enableRotateGestures:true,enableTiltGestures:true,enablePinchZoom:true,fixCenterWhenPinch:false,enableAutoResize:true,zoomCenter:null,fps:C.Browser.ie?30:60,zoomerDuration:240,actionDuration:450,defaultCursor:e8.defaultCursor,draggingCursor:e8.draggingCursor,coordType:BMAP_COORD_MERCATOR,mapType:BMAPGL_NORMAL_MAP,drawer:BMAP_SYS_DRAWER,enableInertialDragging:true,drawMargin:500,drawMarginGL:500,enableFulltimeSpotClick:false,enableResizeOnCenter:false,isModernBrowser:a8.isModernBrowser,forceRenderType:"",textRenderType:null,ratio:a6()>=c8.HIGH_RES_MIN_RATIO?2:1,enableEarth:a8.ifEnableEarth(),defaultMaxBounds:new dT(new hz(-21364736,-10616832),new hz(23855104,15859712)),showControls:false,showRealSunlight:true,showMilkyway:true,earthBackground:null,showStreetLayer:true,minZoom:null,maxZoom:null,style:"default",backgroundColor:null,enableIconClick:false,autoSafeArea:false,ak:null,webgl2:false,restrictCenter:true,restrictBounds:null,smaa:true,preserveDrawingBuffer:false};for(var T in i){if(i.hasOwnProperty(T)){this.config[T]=i[T];if(T==="fixCenterWhenResize"){this.config.enableResizeOnCenter=i[T]}}}if(i.style){if(i.style["styleId"]&&i.style["styleId"].length<32){this.config.style=i.style["styleId"]}else{this.config.style=i.style}}this._setTextRenderType();this._displayOptions={poi:true,poiText:true,poiIcon:true,overlay:true,layer:true,building:true,indoor:true,street:true,skyColors:["rgba(226, 237, 248, 0)","rgba(186, 211, 252, 1)"],isFlat:false,labelMargin:0};if(i.displayOptions){for(var e in i.displayOptions){if(i.displayOptions.hasOwnProperty(e)){this._displayOptions[e]=i.displayOptions[e]}}}if(this.config.restrictCenter===false){this._enableTiltZoom=0;this._enableHeadingZoom=0}},getMinZoom:function(){var T;if(b6[this.mapType][this._renderType]){T=b6[this.mapType][this._renderType].minZoom}else{T=b6[this.mapType].minZoom}if(this.config.minZoom!==null&&this.config.minZoom>=T){T=this.config.minZoom}if(this.mapType==="B_EARTH_MAP"){return T}var i=this.getSize();var e=this.worldSize(T);while(e<i.width){T++;e=this.worldSize(T)}return T},getMaxZoom:function(){var e;if(b6[this.mapType][this._renderType]){e=b6[this.mapType][this._renderType].maxZoom}else{e=b6[this.mapType].maxZoom}if(this.config.maxZoom!==null&&this.config.maxZoom<=e){e=this.config.maxZoom}else{if(this._renderType==="webgl"){e=21}}return e},_drawFrame:function(){this._webglMapScene._painter.draw()},_setupWebGLMap:function(){var e=this;ed.load("mapgl",function(){e._asyncRegister()})},_setStyle:function(i){var e=i.style;e.overflow="hidden";if(f4(i).position!=="absolute"){e.position="relative"}e.backgroundImage="url("+e8.imgPath+"bg.png)";e.textAlign="left";e.touchAction=e.MSTouchAction="none"},_bind:function(){var e=this;if(e._renderType!=="webgl"){e._watchSize=function(){var T=e.getContainerSize();if(e.width!==T.width||e.height!==T.height){var h1=(T.width-e.width)/2;var h3=(T.height-e.height)/2;var hY=e.getZoomUnits();var h0=e.centerPoint;if(h0&&!e.config.enableResizeOnCenter){e.centerPoint=new hz(h0.lng+h1*hY,h0.lat-h3*hY)}e.maskLayer.style.width=(e.width=T.width)+"px";e.maskLayer.style.height=(e.height=T.height)+"px";var hZ=new bb("onresize");hZ.size=T;e.dispatchEvent(hZ);e.fire(new bb("onsize_changed"));var i=parseInt(e.platform.style.left,10)||0;var h2=parseInt(e.platform.style.top,10)||0;if(e.currentOperation!=="undefined"&&e.currentOperation!==dV.idle&&(e.offsetX!==i||e.offsetY!==h2)){e._setPlatformPosition(i,h2)}}}}else{e._watchSize=function(){var i=e.getContainerSize();if(e.width!==i.width||e.height!==i.height){var hY=e.getSize();e.maskLayer.style.width=(e.width=i.width)+"px";e.maskLayer.style.height=(e.height=i.height)+"px";if(a6()!==e.config.ratio){e.config.ratio=a6()}var hZ=new bb("onresize");hZ.size=i;e.dispatchEvent(hZ);var T=new bb("onsize_changed");T.size=i;T.oldSize=hY;e.fire(T)}}}if(e.config.enableAutoResize){e.temp.autoResizeTimer=setInterval(e._watchSize,16)}this.on("size_changed",function(){var i=e.getMinZoom();if(e.zoomLevel<i){e.setZoomIn(i,{noAnimation:true})}});this.on("zoom_changed",function(){this.dispatchEvent(new bb("onzooming"))})},addControl:function(e){if(e&&bV(e._i)){e._i(this);this.dispatchEvent(new bb("onaddcontrol",e))}},removeControl:function(e){if(e&&bV(e.remove)){e.remove();this.dispatchEvent(new bb("onremovecontrol",e))}},addContextMenu:function(e){if(e){e.initialize(this);this.dispatchEvent(new bb("onaddcontextmenu",e))}},removeContextMenu:function(e){if(e){this.dispatchEvent(new bb("onremovecontextmenu",e));e.remove()}},addDistrictLayer:function(e){if(e){e.initialize(this)}},removeDistrictLayer:function(e){if(e){e.removeDistrict(this,e)}},addOverlay:function(i){if(i&&bV(i._i)){var T=new bb("onbeforeaddoverlay",i);T.overlay=i;this.dispatchEvent(T);i._i(this);T=new bb("onaddoverlay",i);T.overlay=i;this.dispatchEvent(T)}},removeOverlay:function(i){if(i&&bV(i.remove)){var T=new bb("onremoveoverlay",i);T.overlay=i;i.remove();this.dispatchEvent(T)}},clearOverlays:function(){this.dispatchEvent(new bb("onclearoverlays"))},addTileLayer:function(hZ){if(!hZ){return}for(var hY=0,e=this.tileMgr.tileLayers.length;hY<e;hY++){var T=this.tileMgr.tileLayers[hY];if(T===hZ||T.getMapType()===hZ.getMapType()){return}}hZ.initialize(this);this.dispatchEvent(new bb("onaddtilelayer",hZ))},removeTileLayer:function(e){if(e){e.remove();this.dispatchEvent(new bb("onremovetilelayer",e))}},getTileLayer:function(e){if(this.tileMgr){return this.tileMgr.getTileLayer(e)}return null},setMapType:function(e){var i=this;if(this.mapType===e||this._mapTypeChanging){return}if(e===BMAP_EARTH_MAP&&!this.config.enableEarth){return}if(this._earth&&this._earth.getLock()){return}this._mapTypeChanging=true;this.preMapType=this.mapType;this._boundsInPreMapType=this.getBoundsIn();if(this.preMapType===BMAP_SATELLITE_MAP){this._preStreetLayerShow=this._isHybridShow}if(e===BMAP_EARTH_MAP){if(!bo.Earth){ed.load("earth",function(){i._syncAndChangeMapType(e)});return}i._syncAndChangeMapType(e)}else{if(this.preMapType!==BMAP_EARTH_MAP){this._changeFlatMapType(e);this._mapTypeChanging=false}else{this._setMapTypeStatus(e,function(T,hY){var hZ=i._earth.getEarthCanvas();i._changeFlatMapType(e,this.preMapType);if(i._mapTypeChangAni){i._mapTypeChangAni.stop()}i._mapTypeChangAni=fq.start({el:hZ,style:"opacity",startValue:1,endValue:0,duration:200,callback:function(){i._mapTypeChangAni=null;i._mapTypeChanging=false}});T=eq.convertLL2MC(T);if(i._renderType==="webgl"){C.extend(i,c7.prototype);i.setCenterIn(T,{noAnimation:true});i.setZoomIn(hY,{noAnimation:true})}else{C.extend(i,am.prototype);i.centerAndZoomIn(T,hY)}})}}},_changeFlatMapType:function(h1){if(!h1||!b6[h1]){return}var h9=this.preMapType;this.mapType=h1;var hY=this.getTileLayer(h9);if(hY){this.removeTileLayer(hY)}else{if(this.tileMgr.tileLayers.length){var h8=this.getTileLayer("B_NORMAL_MAP");if(h8){this.removeTileLayer(h8)}else{h8=this.getTileLayer("B_SATELLITE_MAP");h8&&this.removeTileLayer(h8)}}}this._preStreetLayerShow=this.config.showStreetLayer;if(h9===BMAP_SATELLITE_MAP&&this._preStreetLayerShow){this._removeHybirdMap()}if(this.mapType!==BMAP_EARTH_MAP||this._renderType!=="webgl"||this.baseLayerAdded!==true){var T=new dT(new hz(-21364736,-10616832),new hz(23855104,15859712));var h6=new c5(T,"baidu",h1);var hZ=new cR({mapType:this.mapType,copyright:h6,dataType:this.mapType===BMAP_SATELLITE_MAP?eM:gz,customLayer:this.mapType===BMAP_SATELLITE_MAP,baseLayer:true,transparentPng:true,tileTypeName:this.mapType===BMAP_SATELLITE_MAP?"web":"na"});hZ._isInnerLayer=true;hZ.setZIndex(0);this.addTileLayer(hZ);if(this._renderType==="webgl"&&!this.baseLayerAdded){this.baseLayerAdded=true}}if(h1===BMAP_SATELLITE_MAP){this._featureMgr.clearLabelOverlayData();this._featureMgr.setLabelData([]);if(this._preStreetLayerShow===true||typeof this._preStreetLayerShow==="undefined"){this._addHybirdMap()}}var h3=this.tileMgr.tileLayers;for(var h2=0,h0=h3.length;h2<h0;h2++){var h4=h3[h2];var h7=h4.tilesDiv;if(!h7){continue}if(!h4._isInnerLayer&&h7.style.visibility==="hidden"){h7.style.visibility=""}}var h5=new bb("onmaptypechange");h5.zoomLevel=this.zoomLevel;h5.mapType=h1;h5.exMapType=h9;this.dispatchEvent(h5)},showStreetLayer:function(e){e?this._addHybirdMap():this._removeHybirdMap()},hideStreetLayer:function(e){this._hideStreetLayerOptions=e;this._removeHybirdMap(e)},_addHybirdMap:function(){this._isHybridShow=true;if(this.mapType==="B_EARTH_MAP"){if(this._earth){this._earth.showStreetLayer()}return}if(this._hybridTileLayer){this.addTileLayer(this._hybridTileLayer);var h1=new bb("onstreetlayer_show");this.dispatchEvent(h1);return}var hZ=new dT(new hz(-21364736,-10616832),new hz(23855104,15859712));var T=new c5(hZ,"",BMAP_HYBRID_MAP);var i=new cR({copyright:T,transparentPng:true,tileTypeName:"web"});i._isInnerLayer=true;var hY=this.isCanvasMap();i.getTilesUrl=function(h2,h7){var h5=b6.B_STREET_MAP;var h6=aD("ditu","satelliteStreet");var h3=h6.ver;var e=h6.udt;var h4=h5.tileUrls[Math.abs(h2.x+h2.y)%h5.tileUrls.length]+"?qt=vtile&x="+(h2.x+"").replace(/-/gi,"M")+"&y="+(h2.y+"").replace(/-/gi,"M")+"&z="+h7+"&styles=sl&v="+h3+"&udt="+e+"$scaler="+a6()+"&showtext="+(hY?0:1);return h4};this._isHybridShow=true;this.addTileLayer(i);this._hybridTileLayer=i;var h0=new bb("onstreetlayer_show");this.dispatchEvent(h0)},_removeHybirdMap:function(i){this._isHybridShow=false;if(this.mapType==="B_EARTH_MAP"){if(this._earth){this._earth.hideStreetLayer(i)}return}if(this._hybridTileLayer){this.removeTileLayer(this._hybridTileLayer);var T=new bb("onstreetlayer_hide");this.dispatchEvent(T)}},isStreetLayerShow:function(){return this._isHybridShow},getTileId:function(e,h0){var hY=b6[this.mapType];if(typeof hY!=="object"){return null}var T=hY.baseUnits*Math.pow(2,(hY.zoomLevelBase-h0));var hZ=parseInt(e.lng/T,10);var i=parseInt(e.lat/T,10);return{row:hZ,column:i,level:h0}},reset:function(){this.centerAndZoomIn(this.defaultCenter,this.defaultZoomLevel,true)},setOptions:function(i){i=i||{};var hZ=this;for(var hY in i){if(i.hasOwnProperty(hY)){var T=true;if(typeof i[hY]!=="object"){T=i[hY]!==this.config[hY]}this.config[hY]=i[hY];if(hY==="fixCenterWhenResize"){this.config.enableResizeOnCenter=i[hY]}if(!T){continue}switch(hY){case"style":case"styleUrl":var e={os:i.style.os,sv:i.style.sv};if(hY==="style"&&i.styleUrl){break}this.fire(new bb("onstyle_willchange"));this.loadMapStyleFiles(function(){hZ.fire(new bb("onstyle_changed"))},e);break;case"enableAutoResize":if(i[hY]===true){this.enableAutoResize()}else{this.disableAutoResize()}break;case"displayOptions":this.setDisplayOptions(i[hY]);break}}}},enableDragging:function(){this.config.enableDragging=true},disableDragging:function(){this.config.enableDragging=false},enableInertialDragging:function(){this.config.enableInertialDragging=true},disableInertialDragging:function(){this.config.enableInertialDragging=false},enableScrollWheelZoom:function(){this.config.enableWheelZoom=true},disableScrollWheelZoom:function(){this.config.enableWheelZoom=false},enableContinuousZoom:function(){this.config.enableContinuousZoom=true},disableContinuousZoom:function(){this.config.enableContinuousZoom=false},enableResizeOnCenter:function(){this.config.enableResizeOnCenter=true},disableResizeOnCenter:function(){this.config.enableResizeOnCenter=false},enableDoubleClickZoom:function(){this.config.enableDblclickZoom=true},disableDoubleClickZoom:function(){this.config.enableDblclickZoom=false},enableKeyboard:function(){this.config.enableKeyboard=true},disableKeyboard:function(){this.config.enableKeyboard=false},getSize:function(){return new ec(this.width,this.height)},enablePinchToZoom:function(){this.config.enablePinchZoom=true},disablePinchToZoom:function(){this.config.enablePinchZoom=false},enableTilt:function(){this.config.enableTilt=true},disableTilt:function(){this.config.enableTilt=false},enableRotate:function(){this.config.enableRotate=true},disableRotate:function(){this.config.enableRotate=false},enableAutoResize:function(){this.config.enableAutoResize=true;this._watchSize();if(!this.temp.autoResizeTimer){this.temp.autoResizeTimer=setInterval(this._watchSize,16)}},disableAutoResize:function(){this.config.enableAutoResize=false;if(this.temp.autoResizeTimer){clearInterval(this.temp.autoResizeTimer);this.temp.autoResizeTimer=null}},checkResize:function(){this._watchSize()},resize:function(){this._watchSize()},getContainerSize:function(){return new ec(this.container.clientWidth,this.container.clientHeight)},_getProperZoom:function(T){if(!T){T=this.zoomLevel}var i=this.getMinZoom();var e=this.getMaxZoom();var hY=false;if(T<i){hY=true;T=i}if(T>e){hY=true;T=e}if(this._renderType!=="webgl"){T=Math.round(T)}return{zoom:T,exceeded:hY}},getContainer:function(){return this.container},getZoomUnits:function(T){if(this.mapType===BMAP_EARTH_MAP){return Math.pow(2,18-this._earth.getImageZoom())}var e=b6[this.mapType];if(typeof e!=="object"){return null}var i=T||this.zoomLevel;return Math.pow(2,(e.zoomLevelBase-i))},pointToPixelIn:function(h9,ib){if(!h9){return}ib=ib||{};if(this.mapType===BMAP_EARTH_MAP){var h0;if(!h9._llPt){h0=eq.convertMC2LL(h9);h9._llPt=h0}h0=h9._llPt;var h5=null;var hZ=null;if(typeof ib.zoom==="number"){var h8=this._earth;var ia=h8._getEarthZoomByImgZoom(ib.zoom);if(ia<=3){h5=h8._generateTmpPMatrix(ia)}hZ=h8._generateTmpMVMatrix(h8.getCenter(),ia)}var h1=this._earth.fromLatLngToPixel(h0,{useRound:false,isCalcOnBack:true,matrixInfo:{modelViewMatrix:hZ,projectionMatrix:h5}});return h1}if((this._heading%360===0&&this._tilt===0)||!this._webglMapCamera){var h7=this.getZoomUnits(ib.zoom);var h3=ib.center||this.centerPoint;var hY=this.width/2;var h2=this.height/2;var h6;if(h9.lng*h3.lng<0){var i=Math.abs(h9.lng-h3.lng);var e=(d7._mc180X*2-i)/h7;if(h3.lng<0){h6=hY-e}else{h6=hY+e}}else{h6=(h9.lng-h3.lng)/h7+hY}var h4=(h3.lat-h9.lat)/h7+h2;if(ib.useRound!==false){h6=Math.round(h6);h4=Math.round(h4)}return new em(h6,h4)}var T=this._webglMapCamera.fromMCToScreenPixel(h9.lng,h9.lat,ib);if(ib.useRound===false){return T}T.x=Math.round(T.x);T.y=Math.round(T.y);return T},pixelToPointIn:function(e,h5){if(!e){return}h5=h5||{};if(this.mapType===BMAP_EARTH_MAP){if(typeof h5.zoom==="number"){var h3=this._earth;var h0=null;var T=null;var h4=h3._getEarthZoomByImgZoom(h5.zoom);if(h4<=3){h0=h3._generateTmpPMatrix(h4)}T=h3._generateTmpMVMatrix(h3.getCenter(),h4)}var i=this._earth.fromPixelToLatLng(e,{matrixInfo:{modelViewMatrix:T,projectionMatrix:h0}});if(i===null){return null}return eq.convertLL2MC(i)}if((this._heading%360!==0||this._tilt>0)&&this._webglMapCamera){return this._webglMapCamera.fromScreenPixelToMC(e.x,e.y,h5)}var h1=h5.center||this.centerPoint;var h2=this.getZoomUnits(h5.zoom);var hZ=h1.lng+h2*(e.x-this.width/2);var hY=h1.lat-h2*(e.y-this.height/2);return new hz(hZ,hY)},pointToOverlayPixelIn:function(e,hY){hY=hY||{};var T=this.pointToPixelIn(e,{zoom:hY.zoom,center:hY.center,forLabel:true,frustumTest:true,useRound:hY.useRound});if(!T){return}if(hY.fixPosition&&this.mapType!=="B_EARTH_MAP"){var hZ=this.getSize();var i=this.worldSize(hY.zoom);if(T.x>hZ.width){while(T.x>hZ.width){T.x-=i}}else{if(T.x<0){while(T.x<0){T.x+=i}}}}if(this._renderType==="webgl"){return T}T.x-=this.offsetX;T.y-=this.offsetY;return T},overlayPixelToPointIn:function(i,e){if(!i){return}var T=i.clone();if(this._renderType!=="webgl"){T.x+=this.offsetX;T.y+=this.offsetY}return this.pixelToPointIn(T,e)},getProjection:function(){return new eq()},lnglatToMercator:function(e,hY){var i=new hz(e,hY);var T=eq.convertLL2MC(i);return[T.lng,T.lat]},mercatorToLnglat:function(i,e){if(isNaN(i)||isNaN(e)){return[]}i=parseFloat(i);e=parseFloat(e);var hY=new hz(i,e);var T=eq.convertMC2LL(hY);return[T.lng,T.lat]},getBoundsIn:function(){var ib=arguments[0];if(this.mapType===BMAP_EARTH_MAP&&this._earth){var h5=this._earth.getCustomBounds();if(!h5){return this.config.defaultMaxBounds}var h4=h5.getSouthWest();var e=h5.getNorthEast();if(h4.lng>e.lng){e.lng=180}var iv=eq.convertLL2MC(h4);var ij=eq.convertLL2MC(e);var h8=this.config.defaultMaxBounds;var ii=Math.max(iv.lng,h8.sw.lng);var ih=Math.max(iv.lat,h8.sw.lat);var ia=Math.min(ij.lng,h8.ne.lng);var h9=Math.min(ij.lat,h8.ne.lat);var id=new dT(new hz(ii,ih),new hz(ia,h9));id.pointBottomLeft=new hz(ii,ih);id.pointBottomRight=new hz(ia,ih);id.pointTopLeft=new hz(ii,h9);id.pointTopRight=new hz(ia,h9);id.setMinMax();id.makeNormalizedPoint(this._earth.getHeading());return id}ib=ib||{};var hZ=ib.margins||[0,0,0,0];var ip=this.pixelToPointIn({x:hZ[3],y:this.height-hZ[2]},ib);var iu=this.pixelToPointIn({x:this.width-hZ[1],y:hZ[0]},ib);var ig=typeof ib.heading==="number"?ib.heading:(this._heading%360);var T=typeof ib.tilt==="number"?ib.tilt:this._tilt;var h7=this._webglMapCamera;if((ig===0&&T===0)||!h7){this._bounds.setSouthWest(ip);this._bounds.setNorthEast(iu);this._bounds.pointBottomLeft=ip;this._bounds.pointBottomRight=new hz(iu.lng,ip.lat);this._bounds.pointTopRight=iu;this._bounds.pointTopLeft=new hz(ip.lng,iu.lat);this._bounds.setMinMax();this._bounds.makeNormalizedPoint(ig);return this._bounds}var ie=this.pixelToPointIn({x:hZ[3],y:hZ[0]},ib);var hY=h7.getPosition();var iw=Math.sqrt(Math.pow(ie.lng-hY[0],2)+Math.pow(ie.lat-hY[1],2));var iq=this.getZoomUnits();var iy=iw/iq;var im=h7._frustumSideLen;var h3=h7._fovy;if(iy>im||(90-T)<h3/2){var ix=[ie.lng-hY[0],ie.lat-hY[1]];if((90-T)<h3/2){ix[0]=-ix[0];ix[1]=-ix[1]}var io=im*iq;var h2=[ix[0]/iw*io+hY[0],ix[1]/iw*io+hY[1]];var ik=[iu.lng-hY[0],iu.lat-hY[1]];if((90-T)<h3/2){ik[0]=-ik[0];ik[1]=-ik[1]}var h0=[ik[0]/iw*io+hY[0],ik[1]/iw*io+hY[1]];ie.lng=h2[0];ie.lat=h2[1];iu.lng=h0[0];iu.lat=h0[1]}var ic=this.pixelToPointIn({x:this.width-hZ[1],y:this.height-hZ[2]},ib);var il=[ip,iu,ie,ic];var it=il[0].lng;var iz=il[0].lat;var h1=il[0].lng;var h6=il[0].lat;for(var ir=1;ir<4;ir++){if(il[ir].lng<it){it=il[ir].lng}if(il[ir].lng>h1){h1=il[ir].lng}if(il[ir].lat<iz){iz=il[ir].lat}if(il[ir].lat>h6){h6=il[ir].lat}}this._bounds.setSouthWest(new hz(it,iz));this._bounds.setNorthEast(new hz(h1,h6));this._bounds.pointTopLeft=ie;this._bounds.pointTopRight=iu;this._bounds.pointBottomRight=ic;this._bounds.pointBottomLeft=ip;this._bounds.makeNormalizedPoint(ig);this._bounds.setMinMax();return this._bounds},isLoaded:function(){return !!this.loaded},_getBestLevel:function(i,h7){var h0=0;if(this._renderType==="webgl"&&!gb()){h0=100}var h1=h7.margins||[10,10,10,10];var hY=h7.zoomFactor||0;var h2=h1[1]+h1[3];var hZ=h1[0]+h1[2];var e=this.getMinZoom();var h6=this.getMaxZoom();var h5=i.toSpan();var h4=h5.width/(this.width-h2-h0);var h3=h5.height/(this.height-hZ-h0);var T=18-eH(Math.max(h4,h3));if(T<e){T=e}if(T>h6){T=h6}T+=hY;if(this._renderType!=="webgl"){T=Math.floor(T)}return T},getViewportIn:function(h7,hZ){if(this.mapType===BMAP_EARTH_MAP){h7=h7||[];var h1=[];for(var h8=0;h8<h7.length;h8++){if(!h7[h8]){continue}h1.push(eq.convertMC2LL(h7[h8]))}var h9=this._earth.getViewportIn(h1,hZ);var hY=h9.center;var h5=h9.zoom;var id=eq.convertLL2MC(hY);return{center:id,zoom:h5}}var h3={center:this.getCenterIn(),zoom:this.getZoom()};if(!h7||h7.length===0){return h3}hZ=hZ||{};var h2;if(h7 instanceof dT){h2=h7}else{var h0=h7;h2=new dT();for(var h6=h0.length-1;h6>=0;h6--){h2.extend(h0[h6])}if(h2.isEmpty()){return h3}}var ic=h2.getCenter();var e=this._getBestLevel(h2,hZ);if(hZ.margins){var T=hZ.margins;var ib=(T[1]-T[3])/2;var h4=(T[0]-T[2])/2;var ia=this.getZoomUnits(e);ic.lng=ic.lng+ia*ib;ic.lat=ic.lat+ia*h4}return{center:ic,zoom:e}},setViewportIn:function(hY,hZ){if(this.mapType===BMAP_EARTH_MAP){var h3;if(hY&&hY.center){var T=eq.convertMC2LL(hY.center);var h1=this._earth._getEarthZoomByImgZoom(hY.zoom,T);h3={center:T,zoom:h1}}else{h3=[];for(var h0=0;h0<hY.length;h0++){var h2=eq.convertMC2LL(hY[h0]);h3[h0]=new c4(h2.lat,h2.lng)}}this._earth.setViewportIn(h3,hZ);return}var e;if(hY&&hY.center){e=hY}else{e=this.getViewportIn(hY,hZ)}hZ=hZ||{};if(this._renderType==="webgl"){this.centerAndZoomIn(e.center,e.zoom,hZ);return}if(e.zoom===this.zoomLevel&&hZ.enableAnimation!==false){this.panToIn(e.center,{duration:200,callback:hZ.callback})}else{this.centerAndZoomIn(e.center,e.zoom,hZ)}},addSpots:function(T,i){if(!T||T.length===0){return}i=i||{};var h0=i.zIndex||0;var hZ=typeof i.enableMultiResponse==="undefined"?true:!!i.enableMultiResponse;this.spotsPool=this.spotsPool||{};var e="sp"+(this.temp.spotsGuid++);this.spotsPool[e]={spots:T.slice(0),zIndex:h0,enableMultiResponse:hZ};var hY=this;ed.load("hotspot",function(){hY._asyncRegister()});return e},getSpots:function(e){return this.spotsPool[e]&&this.spotsPool[e].spots||[]},removeSpots:function(e){if(!e||!this.spotsPool[e]){return}delete this.spotsPool[e]},clearSpots:function(){delete this.spotsPool},getIconByClickPosition:function(i){if(!this.config.enableIconClick||!this._spotsMgr){return null}var e=this._spotsMgr.getSpotsByScreenPosition(i);if(e[0]&&e[0].userdata){var T=e[0].userdata;return{name:T.name,uid:T.uid,position:T.iconPoint||e[0].pt}}return null},setBounds:function(e){b6[this.mapType].bounds=e.clone()},getCoordType:function(){return this.config.coordType},getPanes:function(){return this._panes},getInfoWindow:function(){if(this.temp.infoWin&&this.temp.infoWin.isOpen()){return this.temp.infoWin}return null},getDistanceIn:function(hZ,e){if(!hZ||!e){return}if(hZ.equals(e)){return 0}if(this.mapType===BMAP_EARTH_MAP){var hY=eq.convertMC2LL(hZ);var T=eq.convertMC2LL(e);return this._earth.getDistance(hY,T)}var i=eq.getDistanceByMC(hZ,e);return i},getOverlays:function(){var h0=[];var h1=this._overlays;var hZ=this._customOverlays;if(h1){for(var hY in h1){if(h1[hY] instanceof cV){h0.push(h1[hY])}}}if(hZ){for(var T=0,e=hZ.length;T<e;T++){h0.push(hZ[T])}}return h0},getMapType:function(){return this.mapType},_asyncRegister:function(){for(var e=this.temp.registerIndex;e<bo._register.length;e++){bo._register[e](this)}this.temp.registerIndex=e},setDefaultCursor:function(e){this.config.defaultCursor=e;if(this.platform){this.platform.style.cursor=this.config.defaultCursor}},getDefaultCursor:function(){return this.config.defaultCursor},setDraggingCursor:function(e){this.config.draggingCursor=e},getDraggingCursor:function(){return this.config.draggingCursor},_syncAndChangeMapType:function(e){var i=this;if(i._renderType==="webgl"&&i.getTilt()>c8.MAX_DRAG_TILT_L2){i.setTilt(c8.MAX_DRAG_TILT_L2,{callback:function(){i._changeEarthMapType(e)}})}else{i._changeEarthMapType(e)}},_changeEarthMapType:function(T){var hY=this;var h1=hY.tileMgr.tileLayers;if(this._mapTypeChangAni){this._mapTypeChangAni.stop()}var h0;if(this._earth){h0=this._earth.getEarthCanvas()}if(!this._earth){this.maskLayer.style.opacity=1;this.maskLayer.style.zIndex=999;this.maskLayer.style.background="#000"}this._mapTypeChangAni=new o({duration:400,render:function(e){if(!hY._earth){return}h0.style.opacity=e},finish:function(){for(var e=h1.length-1,h2=e;h2>=0;h2--){var h4=h1[h2].tilesDiv;if(h4){h4.style.visibility="hidden"}if(h1[h2]._isInnerLayer&&hY._renderType!=="webgl"){hY.removeTileLayer(h1[h2])}}hY._mapTypeChangAni=null;hY._mapTypeChanging=false;function h3(){var h8=hY.getZoom()-2;var h9=hY.getCenterIn();var h6=eq.convertMC2LL(h9);hY._earth=new bo.Earth(hY,{center:h6,zoom:h8,showRealSunlight:hY.config.showRealSunlight,showMilkyway:hY.config.showMilkyway,earthBackground:hY.config.earthBackground});hY._proxyEarthEvents();var h5=hY.mapType;hY.mapType=T;var h7=new bb("onmaptypechange");h7.zoomLevel=this.zoomLevel;h7.mapType=T;h7.exMapType=h5;hY.dispatchEvent(h7);hY._setMapTypeStatus(T);C.extend(hY,bo.EarthView.prototype);if(!hY._navigationCtrl&&hY.config.showControls){hY._navigationCtrl=new eZ(hY)}}if(!hY._earth){if(bo["FeatureStyle"+hY.config.style]){h3()}else{hY.loadMapStyleFiles(function(){h3()})}}if(parseInt(hY.maskLayer.style.opacity,10)===1){setTimeout(function(){hY.maskLayer.style.zIndex=9;hY.maskLayer.style.opacity=0},1000)}}});if(!this._earth){return}var i=this.mapType;this.mapType=T;var hZ=new bb("onmaptypechange");hZ.zoomLevel=this.zoomLevel;hZ.mapType=T;hZ.exMapType=i;this.dispatchEvent(hZ);hY._setMapTypeStatus(T);C.extend(hY,bo.EarthView.prototype)},getMapStyleId:function(){if(typeof this.config.style==="string"){return this.config.style}return this.config.mapStyleId||"custom"},_setMapTypeStatus:function(T){var h2=arguments[1];if(T===BMAP_EARTH_MAP){var h0=this._earth.getEarthCanvas();if(h0){h0.style.display=""}var h3={noAnimation:true};this._earth.setCenter(eq.convertMC2LL(this.centerPoint),h3);this._earth.setImageZoom(this.zoomLevel,h3);this._earth.setTilt(this.getTilt(),h3);this._earth.setHeading(this.getHeading(),h3)}else{if(this.preMapType===BMAP_EARTH_MAP&&this._earth){var h1=this._earth;var hY=h1.getMapZoom();var hZ=h1._imageRawZoom||hY;var i=hZ-hY;var e=h1.getCenter();if(this._renderType==="webgl"){this._tilt=h1.getTilt();if(this.zoomLevel>7){this._heading=h1.getHeading();h2&&h2(e,hY);return}if(h1.getHeading()!==0){h1.setTilt(this.getTilt());h1.setHeading(this.getHeading(),{callback:function(){h2&&h2(e,hY)}})}else{h2&&h2(e,hY)}return}if(i<0.1&&h1.getTilt()===0&&h1.getHeading()===0){h2&&h2(e,hY);return}h1.setTilt(0);h1.setHeading(0);h1.setZoom(h1.getZoom()-i,{callback:function(){h2&&h2(e,hY)}})}}},_proxyEarthEvents:function(){var hZ=this;var h0=this._earth;h0.on("tilesload",function(i){hZ.fire(i)});h0.on("centerandzoom",function(i){hZ.dispatchEvent(new bb("onmoveend"));hZ.dispatchEvent(new bb("onzoomend"))});function hY(i){hZ.fire(i)}var e=["zoomstart","zoomend","tilesload","sunlighttime_change","sunlighttime_clear","centerandzoom","animation_start","animation_stop","movestart","moveend","moving","dragstart","dragend","dragging"];for(var T=0;T<e.length;T++){h0.on(e[T],hY)}},forceEnableEarth:function(){this.config.forceEnableEarth=true;this.config.enableEarth=a8.ifEnableEarth(true);this.dispatchEvent(new bb("forceenableearth"));return this.config.enableEarth},setLock:function(e){if(this.mapType===BMAP_EARTH_MAP){this._earth.setLock(e)}this._lock=e},getLock:function(){if(this.mapType===BMAP_EARTH_MAP){return this._earth.getLock()}return this._lock},getEarth:function(){return this._earth},isSupportEarth:function(){return this.config.enableEarth},isCanvasMap:function(){return !!(this._renderType==="canvas"&&this.getMapType()!=="B_EARTH_MAP")},getCanvasMapCoordByUid:function(hZ){if(this._renderType==="webgl"){var h0=this.tileMgr.tileLayers;for(var hY=0;hY<h0.length;hY++){if(h0[hY].labelProcessor){return h0[hY].labelProcessor.getLabelByUid(hZ,"")}}return null}var e=this.canvas2dMapMgr._labelClick;var T=e.findLabelByUid(hZ);return T?new hz(T.iconPos.geoX,T.iconPos.geoY):null},loadBizData:function(i){var e=new bb("onloadbizdata");e.data=i;this.dispatchEvent(e)},unloadBizData:function(){var e=new bb("onunloadbizdata");this.dispatchEvent(e)},zoomIn:function(e){this.setZoomIn(this.zoomLevel+1,{zoomCenter:e})},zoomOut:function(e){this.setZoomIn(this.zoomLevel-1,{zoomCenter:e})},setMaxZoom:function(e){if(this._renderType==="webgl"){this.config.maxZoom=e<=21?e:21}else{this.config.maxZoom=e<=19?e:19}},setMinZoom:function(e){this.config.minZoom=e>=3?e:3},setCenterIn:function(e,i){this.panToIn(e,i)},getRenderType:function(){return this._renderType},getSolarInfo:function(hY){hY=hY||this._initDate;var T=bz(hY);var e=eq.convertLL2MC(new hz(T[0],T[1]));var h6=e.latLng;var h1=bo.Projection.convertMC2LL(this.centerPoint);var h3=hY.getUTCHours();var h5=h3+24*h1.lng/360;var h4=h5-12;var h2=h4*60*0.25;var h0=Math.asin(Math.sin(dK(h1.lat))*Math.sin(dK(h6.lat))+Math.cos(dK(h1.lat))*Math.cos(dK(h6.lat))*Math.cos(dK(h2)));var hZ=Math.asin(Math.sin(dK(h2))*Math.cos(dK(h6.lat))/Math.cos(h0));var i="north";if(h1.lat<h6.lat){i="south"}return{zenith:e,solarAltitude:h0,solarAzimuth:hZ,centerPosition:i,position:e}},setDisplayOptions:function(T){if(!T){return}for(var e in this._displayOptions){if(this._displayOptions.hasOwnProperty(e)){if(typeof T[e]==="boolean"||(e==="skyColors"&&typeof T.skyColors==="object")||(e==="labelMargin"&&typeof T.labelMargin==="number")){this._displayOptions[e]=T[e]}}}var i=this.getMapType();if(i===da.NORMAL){this.fire(new bb("ondisplayoptions_changed"))}else{if(i===da.EARTH&&this._earth){this._earth.fire(new bb("ondisplayoptions_changed"))}}},getHorizonPosY:function(e){if(!e||!this._webglMapCamera){return null}var i=this._webglMapCamera.fromMCToScreenPixel(e.lng,e.lat,{heading:0});return i.y},getIndoorInfo:function(){if(!this._indoorMgr){return}return this._indoorMgr.getData()},showIndoor:function(e,T){var i=new bb("onindoor_status_changed");i.uid=e;i.floor=T;this.fire(i)},addAreaSpot:function(e,T){if(!e||e.length===0){return}T=T||{};this.areaSpots=this.areaSpots||{};var i=T.id||("sp"+(this.temp.spotsGuid++));this.areaSpots[i]={spot:e,userData:T.userData};var hY=this;ed.load("hotspot",function(){hY._asyncRegister()});return i},getAreaSpot:function(e){if(this.areaSpots&&this.areaSpots[e]){return this.areaSpots[e]}return null},removeAreaSpot:function(e){if(!e||!this.areaSpots[e]){return}delete this.areaSpots[e]},clearAreaSpots:function(){this.areaSpots={}},resetSpotStatus:function(){this.fire(new bb("onspot_status_reset"))},hightlightSpotByUid:function(e,T){var i=new bb("onspot_highlight");i.uid=e;i.tilePosStr=T;this.fire(i)},setZoomIn:function(i,e){e=e||{};this.zoomTo(i,e.zoomCenter||null,e)},restrictBounds:function(e){if(e instanceof dT){this.config.restrictBounds=e;this.restrictCenter(this.getCenterIn());this.fire(new bb("oncenter_changed"))}},getCurrentMaxTilt:function(){var e=this.zoomLevel;if(this.mapType==="B_EARTH_MAP"){return c8.MAX_DRAG_TILT_L2}if(this.config.restrictCenter===false){return c8.MAX_DRAG_TILT}if(e>=19){return c8.MAX_DRAG_TILT}else{if(e<=18){if(e<this._enableTiltZoom){if(e>=this._enableTiltZoom-2){return(1-(this._enableTiltZoom-e)/2)*c8.MAX_DRAG_TILT_L2}return 0}return c8.MAX_DRAG_TILT_L2}else{return(c8.MAX_DRAG_TILT-c8.MAX_DRAG_TILT_L2)*(e-18)+c8.MAX_DRAG_TILT_L2}}},worldSize:function(i){var e=i||this.zoomLevel;return c8.WORLD_SIZE_MC/this.getZoomUnits(e)},setTrafficOn:function(e){if(e&&Number(e)>1){ce.setZIndex(Number(e))}this.addTileLayer(ce)},setTrafficOff:function(){this.removeTileLayer(ce)},showOverlayContainer:function(){this.setDisplayOptions({overlay:true})},hideOverlayContainer:function(){this.setDisplayOptions({overlay:false})},addLabelsToMapTile:function(T){for(var e=0;e<T.length;e++){if(typeof T[e].type==="undefined"){T[e].type="fixed"}if(typeof T[e].rank!=="number"){T[e].rank=50000}T[e].pt=T[e].position;T[e].custom=true;T[e].processedInZoom=0;this._customTileLabels.push(T[e])}this.dispatchEvent(new bb("onadd_tile_labels"))},removeLabelsFromMapTile:function(T){for(var hY=0;hY<T.length;hY++){for(var e=0;e<this._customTileLabels.length;e++){if(this._customTileLabels[e].uid===T[hY]){this._customTileLabels.splice(e,1)}}}this.dispatchEvent(new bb("onremove_tile_labels"))},clearLabels:function(){this._customTileLabels.length=0;this.dispatchEvent(new bb("onclear_labels"))},loadMapStyleFiles:function(h0,e){var T=this.config.style;var hZ=this.config.styleUrl;var hY=this;this._setTextRenderType();if(typeof T==="string"&&!hZ){if(bo["FeatureStyle"+T]){hY.fire(new bb("onstyle_loaded"));h0();return}bo["FeatureStyle"+T]=window.FeatureStyle;bo["iconSetInfo"+T]=window.iconSetInfo_high;bo.indoorStyle=window.indoorStyle;ht.load(e8.getMapStyleFiles(T),function(){if(hY.config.style===T){bo["FeatureStyle"+T]=window.FeatureStyle;bo["iconSetInfo"+T]=window.iconSetInfo_high;bo.indoorStyle=window.indoorStyle;hY.fire(new bb("onstyle_loaded"));h0()}})}else{var i=T;f.init(hY);f.getStyleJson(i,function(h2){var h7=gk;var h9=bo.getGUID("custom");hY.config.mapStyleId=h9;var h5={};C.extend(h5,h2);var h3=Math.floor(hY.getZoom());var h6;window.styleCbk=function(ia,ib){if(ib!==h6){return}if(typeof ia==="string"){ia=JSON.parse(ia)}f.onStyleDataBack(ia,h3,h9,h5,h7);bo.customStyleLoaded=true;hY.fire(new bb("onstyle_loaded"));h0()};bo.customStyleInfo={zoomRegion:{},zoomStyleBody:[],zoomFrontStyle:{}};var h8=f.getStyleUrl(h2,h7,"styleCbk",h3,e);var h1=h8.split("?")[0];h6=h8.split("?")[1];if(hZ){h1=hZ;h6=h1.split("?")[1]}if(!bo.iconSetInfoCustom){var h4=e8.getMapStyleFiles("default");h4.splice(1,1);ht.load(h4,function(){bo.iconSetInfoCustom=window.iconSetInfo_high;bo.indoorStyle=window.indoorStyle;if(h1.indexOf("jsonp")>"-1"){ht.load(h1)}else{bo.customStyleInfo.xhr=gG.post(h1,h6,styleCbk)}})}else{if(h1.indexOf("jsonp")>"-1"){ht.load(h1)}else{bo.customStyleInfo.xhr=gG.post(h1,h6,styleCbk)}}})}},getFeatureStyleTags:function(){var e=[];var hZ=Object.keys(bo);for(var hY=0;hY<hZ.length;hY++){var T=hZ[hY];if(T.indexOf("FeatureStyle")>-1&&bo[T]){e.push(T)}}return e},setCopyrightOffset:function(hY,i){var T=new bb("oncopyrightoffsetchange",{logo:hY,cpy:i});this.dispatchEvent(T)},_setTextRenderType:function(e){if(e){this.config.textRenderType=e;return}if(this.config.textRenderType!==null){return}if(gb()){this.config.textRenderType="canvas"}else{if(typeof this.config.style==="string"){this.config.textRenderType="image"}else{this.config.textRenderType="canvas"}}},destroy:function(){this._destroyed=true;this.fire(new bb("ondestroy"))},centerAndZoom:function(e,h0,T){if(Object.prototype.toString.call(h0)!=="[object Undefined]"){h0=parseInt(h0,10)}if(typeof e==="string"){var hY=this;var hZ=new V();hZ.getPoint(e,function(h1){e=h1;var h2=eq.convertLL2MC(e);hY.centerAndZoomIn(h2,h0,T)})}else{var i=eq.convertLL2MC(e);this.centerAndZoomIn(i,h0,T)}},pointToPixel:function(e,T){var i=eq.convertLL2MC(e);var hY={};C.extend(hY,T);if(hY&&hY.center){hY.center=eq.convertLL2MC(hY.center)}return this.pointToPixelIn(i,hY)},pixelToPoint:function(T,i){var hY={};C.extend(hY,i);if(hY&&hY.center){hY.center=eq.convertLL2MC(hY.center)}var e=this.pixelToPointIn(T,hY);return eq.convertMC2LL(e)},pointToOverlayPixel:function(e,T){var i=eq.convertLL2MC(e);var hY={};C.extend(hY,T);if(hY&&hY.center){hY.center=eq.convertLL2MC(hY.center)}return this.pointToOverlayPixelIn(i,hY)},overlayPixelToPoint:function(T,i){var hY={};C.extend(hY,i);if(hY&&hY.center){hY.center=eq.convertLL2MC(hY.center)}var e=this.overlayPixelToPointIn(T,hY);return eq.convertMC2LL(e)},setViewport:function(T,hY){var e;if(T&&T.center){e={};C.extend(e,T);e.center=eq.convertLL2MC(e.center)}else{e=[];for(var hZ=0;hZ<T.length;hZ++){e[hZ]=eq.convertLL2MC(T[hZ])}}this.setViewportIn(e,hY)},getViewport:function(h0,hY){var T;if(h0&&h0.length){T=[];for(var hZ=0;hZ<h0.length;hZ++){T[hZ]=eq.convertLL2MC(h0[hZ])}}else{if(h0 instanceof dT){T=new dT(eq.convertLL2MC(h0.getSouthWest()),eq.convertLL2MC(h0.getNorthEast()));T.setMinMax()}}var e=this.getViewportIn(T,hY);e.center=eq.convertMC2LL(e.center);return e},getDistance:function(hZ,T){var i=eq.convertLL2MC(hZ);var hY=eq.convertLL2MC(T);var e=this.getDistanceIn(i,hY);return e},setCenter:function(e,T){if(typeof e==="string"){var hY=this;var hZ=new V();hZ.getPoint(e,function(h0){e=h0;var h1=eq.convertLL2MC(e);hY.setCenterIn(h1,T)})}else{var i=eq.convertLL2MC(e);this.setCenterIn(i,T)}},setZoom:function(T,e){var i={};C.extend(i,e);if(i&&i.zoomCenter){i.zoomCenter=eq.convertLL2MC(i.zoomCenter)}this.setZoomIn(T,i)},flyTo:function(e,hY,T){var i=eq.convertLL2MC(e);this.flyToIn(i,hY,T)},panTo:function(e,T){var i=eq.convertLL2MC(e);this.panToIn(i,T)},getCenter:function(){var e=this.getCenterIn();return eq.convertMC2LL(e)},getBounds:function(){var e=this.getBoundsIn();var i=new dT(eq.convertMC2LL(e.getSouthWest()),eq.convertMC2LL(e.getNorthEast()));return i},setMapStyleV2:function(e){this._setTextRenderType("canvas");this.setOptions({style:e})},startViewAnimation:function(T){var e=T._options.delay;var i=this;setTimeout(function(){T._start(i)},e)},pauseViewAnimation:function(e){e._pause(this)},continueViewAnimation:function(e){e._continue(this)},cancelViewAnimation:function(e){e._cancel(this)},getMapScreenshot:function(){return this._webglMapScene._painter._canvas.toDataURL()}});window.BMAP_NORMAL_MAP="B_NORMAL_MAP";window.BMAPGL_NORMAL_MAP="B_NORMAL_MAP";window.BMAP_SATELLITE_MAP="B_SATELLITE_MAP";window.BMAP_HYBRID_MAP="B_STREET_MAP";window.BMAP_EARTH_MAP="B_EARTH_MAP";window.BMAP_NONE_MAP="B_NONE_MAP";window.BMAP_COORD_MERCATOR=1;window.BMAP_SYS_DRAWER=0;window.BMAP_SVG_DRAWER=1;window.BMAP_VML_DRAWER=2;window.BMAP_CANVAS_DRAWER=3;var f={environment:"jsapi",map:null,ontilesloaded:false,onstyle_loaded:false,init:function(i){var e=this;e.map=i;this.changeCopyright();this.setEnvironment(e.map.config.style);this.resetEventListener()},resetEventListener:function(){var e=this;this.ontilesloaded=false;this.onstyle_loaded=false;e.map.addEventListener("ontilesloaded",e.checkLoadedStatus);e.map.addEventListener("onstyle_loaded",e.checkLoadedStatus)},checkLoadedStatus:function(i){f[i.type]=true;if(f.ontilesloaded&&f.onstyle_loaded){this.dispatchEvent(new bb("onstylechangetilesloaded"));this.removeEventListener("ontilesloaded",f.checkLoadedStatus);this.removeEventListener("onstyle_loaded",f.checkLoadedStatus)}},changeCopyright:function(){var e=this;if(e.map.cpyCtrl){e.map.cpyCtrl.hide();if(e.environment!=="customEditor"){e.map.setCopyrightOffset(new ec(1,1))}}else{e.map.addEventListener("oncopyrightaddend",function(){e.map.cpyCtrl.hide();if(e.environment!=="customEditor"){e.map.setCopyrightOffset(new ec(1,1))}})}},setEnvironment:function(e){if(e.customEditor){this.environment="customEditor";bJ.map=this.map}else{if(e.sharing){this.environment="sharing"}else{if(e.preview){this.environment="preview"}else{this.environment="jsapi"}}}},getStyleJson:function(hY,h0){var hZ=this;if(hY.styleJson){h0&&h0(hY.styleJson)}else{if(hY.styleId){var i=hY.styleId;var e=(Math.random()*100000).toFixed(0);bo["_cbk_si_phpui"+e]=function(h2){var h1=[];if(h2.result&&h2.result["error"]===0&&h2.content&&h2.content["status"]===0){h1=hZ.parseJson(h2.content["data"]["json"]);h0&&h0(h1)}else{h0&&h0("default")}};bo["_cbk_si_api"+e]=function(h2){var h1=[];if(h2.status===0){if(h2.info){h1=hZ.parseJson(h2.info["json"])}else{h1=hZ.parseJson(h2.data["json"])}h0&&h0(h1)}else{h0&&h0("default")}};var T="";switch(this.environment){case"jsapi":T=e0.apiHost+"/?qt=custom_map&v=3.0&style_id="+i+"&type=publish&ak="+gk;T+="&callback="+eF+"._cbk_si_phpui"+e;break;case"sharing":T+="/apiconsole/custommap/getSharingJson";T+="?styleid="+i+"&type=edit";T+="&ck="+eF+"._cbk_si_api"+e;break;case"preview":T+="/apiconsole/custommap/getJson";T+="?styleid="+i+"&type=edit";T+="&ck="+eF+"._cbk_si_api"+e;break}ht.load(T)}else{h0&&h0("default")}}},parseJson:function(T){if(T===null||T===""){return[]}var i={t:"featureType",e:"elementType",v:"visibility",c:"color",l:"lightness",s:"saturation",w:"weight",z:"level",h:"hue",f:"fontsize",zri:"curZoomRegionId",zr:"curZoomRegion"};var hZ={all:"all",g:"geometry","g.f":"geometry.fill","g.s":"geometry.stroke",l:"labels","l.t.f":"labels.text.fill","l.t.s":"labels.text.stroke","l.t":"labels.text","l.i":"labels.icon","g.tf":"geometry.topfill","g.sf":"geometry.sidefill"};var hY=T.split(",");var e=hY.map(function(h3){var h2=h3.split("|").map(function(h9){var h7=i[h9.split(":")[0]];var h6=(hZ[h9.split(":")[1]]?hZ[h9.split(":")[1]]:h9.split(":")[1]);switch(h6){case"poi":h6="poilabel";break;case"districtlabel":h6="districtlabel";break}var h8={};h8[h7]=h6;return h8});var h0=h2[0];var h5=1;if(h2[1]["elementType"]){h5=2;C.extend(h0,h2[1])}var h4={};for(var h1=h5;h1<h2.length;h1++){C.extend(h4,h2[h1])}return C.extend(h0,{stylers:h4})});return e},getStyleUrl:function(hY,h0,hZ,i,e){this.styleJson=hY;var T=e8.apiHost+"/custom/v2/mapstyle?version="+4+"&ak="+h0+"&is_all=true&is_new=1&";T+="styles="+encodeURIComponent(this.styleJson2styleStringV2(hY,i));if(e&&e.os&&e.sv){T+="&os="+e.os+"&sv="+e.sv}return T},styleJson2styleStringV2:function(e,h3){var h4={featureType:"t",elementType:"e",visibility:"v",color:"c",lightness:"l",saturation:"s",weight:"w",level:"z",hue:"h",fontsize:"f"};var h6={all:"all",geometry:"g","geometry.fill":"g.f","geometry.stroke":"g.s",labels:"l","labels.text.fill":"l.t.f","labels.text.stroke":"l.t.s","labels.text":"l.t","labels.icon":"l.i","geometry.topfill":"g.tf","geometry.sidefill":"g.sf"};var h7=[];for(var hY=this.map.getMinZoom();hY<=this.map.getMaxZoom();hY++){bo.customStyleInfo.zoomFrontStyle[hY]={}}bo.customStyleInfo.zoomFrontStyle.main={};var T=false;for(var hY=0;!!e[hY];hY++){var h5=e[hY];if(this.isOnlyZoomStyler(h5)){continue}h3=this.getFrontZoom(h5,h3);if((h5.featureType==="land"||h5.featureType==="all"||h5.featureType==="background")&&typeof h5.elementType==="string"&&(h5.elementType==="geometry"||h5.elementType==="geometry.fill"||h5.elementType==="all")&&h5.stylers&&!T){if(h5.stylers["color"]){bo.customStyleInfo.bmapLandColor=h5.stylers["color"]}if(h5.stylers["visibility"]&&h5.stylers["visibility"]==="off"){bo.customStyleInfo.bmapLandColor="#00000000"}if(h5.featureType==="land"){T=true}}if(h5.featureType==="building"&&typeof h5.elementType==="string"&&h5.elementType==="geometry.fill"){bo.customStyleInfo.buildingFill=true}if(h5.featureType==="roadarrow"&&h5.elementType==="labels.icon"&&h5.stylers){bo.customStyleInfo.zoomFrontStyle[h3]["bmapRoadarrowVisibility"]=h5.stylers["visibility"]}var hZ={};C.extend(hZ,h5);var h1=hZ.stylers;delete hZ.stylers;C.extend(hZ,h1);var h0=[];for(var h2 in h4){if(hZ[h2]){if(this.isEditorZoomKeys(h2)){continue}if(h2==="elementType"){h0.push(h4[h2]+":"+h6[hZ[h2]])}else{switch(hZ[h2]){case"poilabel":hZ[h2]="poi";break;case"districtlabel":hZ[h2]="label";break}h0.push(h4[h2]+":"+hZ[h2])}}}if(h0.length>2){h7.push(h0.join("|"))}}return h7.join(",")},getFrontZoom:function(i,e){var T=i.stylers["level"];if(T===undefined){return"main"}else{return parseInt(T,10)}},isZoomConfig:function(e){var i=e.stylers["level"];if(i===undefined){return false}else{return true}},isOnlyZoomStyler:function(e){var i={};C.extend(i,e.stylers);delete i.curZoomRegionId;delete i.curZoomRegion;delete i.level;if(C.isEmptyObject(i)){return true}else{return false}},isSelectZoom:function(i,e){var T=i.stylers["level"];if(T===undefined){return true}else{if(T===e+""){return true}else{return false}}},isEditorZoomKeys:function(e){var i={curZoomRegionId:true,curZoomRegion:true};if(i[e]){return true}else{return false}},getZoomRegion:function(e,i){var hY=e.stylers["level"];var T={};C.extend(T,i);if(hY===undefined){return T}else{T[parseInt(hY,10)]=true;return T}},onStyleDataBack:function(hY,e,i,T,h0){if(hY.status!==0){return}if(hY.data.style.length===3){if(!bo.customStyleInfo.baseFs){bo.customStyleInfo.baseFs=hY.data.style}bo.StyleBody=hY.data.style[2]}else{bo.StyleBody=hY.data.style}var hZ=bo.customStyleInfo.baseFs;bo["FeatureStyle"+i]=hZ;this.updateFrontFeatureStyle()},updateFrontFeatureStyle:function(){if(bo.customStyleInfo.zoomFrontStyle.main["bmapRoadarrowVisibility"]){for(var e=this.map.getMinZoom();e<=this.map.getMaxZoom();e++){if(!bo.customStyleInfo.zoomFrontStyle[e]["bmapRoadarrowVisibility"]){bo.customStyleInfo.zoomFrontStyle[e]["bmapRoadarrowVisibility"]=bo.customStyleInfo.zoomFrontStyle.main["bmapRoadarrowVisibility"]}}}}};var bJ={map:null,labelCache:{},calcDrawMc:function(T,i,e){var hY=[];switch(i){case"fill":hY=this.calcFill(T,e);break;case"line":break;case"building3d":hY=this.calcBuilding3d(T,e);break}return hY},calcFill:function(hZ,T){var h0=[];for(var hY=0;hY<hZ.length;hY=hY+5){var e=this.coordToMc({x:hZ[hY],y:hZ[hY+1]},T.row,T.col,T.mercatorSize,T.baseTileSize);h0.push(e[0],e[1])}return h0},calcLine:function(hZ,T){var h0=[];var h1=new Int16Array(hZ.buffer);for(var hY=0;hY<h1.length;hY=hY+10){var e=this.coordToMc({x:h1[hY]/10,y:h1[hY+1]/10},T.row,T.col,T.mercatorSize,T.baseTileSize);h0.push(e[0],e[1])}return h0},calcBuilding3d:function(h0,T){var h1=[];var hY={};for(var hZ=0;hZ<h0.length/2;hZ=hZ+7){if(h0[hZ]===h0[hZ-7]&&h0[hZ+1]===h0[hZ-6]){continue}if(hY[h0[hZ].toString()+h0[hZ+1].toString()]){continue}hY[h0[hZ].toString()+h0[hZ+1].toString()]=true;var e=this.coordToMc({x:h0[hZ],y:h0[hZ+1]},T.row,T.col,T.mercatorSize,T.baseTileSize);h1.push(e[0],e[1])}return h1},coordToMc:function(hZ,hY,e,i,T){return[hZ.x*(i/T)+e*i,hZ.y*(i/T)+hY*i]},addDrawIntoAreaSpots:function(e,hZ){if(f.environment!=="customEditor"){return}if(!hZ.styleIds){return}for(var T=0;T<hZ.styleIds.length;T++){var h2=0;if(T>0){h2=hZ.verticesLength[T-1]}end=hZ.verticesLength[T];var h0=[];var hY="";if(hZ.vertex){h0=hZ.vertex;hY="building3d"}else{if(hZ.data[0]){h0=hZ.data[0];hY=hZ.type}else{continue}}var h1=this.calcDrawMc(h0.slice(h2,end),hY,e);this.map.addAreaSpot(h1,{userData:{styleId:hZ.styleIds[T],type:"mapstyle"}})}},addLabelIntoAreaSpots:function(e){if(f.environment!=="customEditor"){return}for(var hZ=0;hZ<e.length;hZ++){var h0=e[hZ];for(var hY=0;hY<h0.fixedLabel.length;hY++){var T=h0.fixedLabel[hY];if(!T._mcBds){continue}var h1=[T._mcBds[0].lng,T._mcBds[0].lat,T._mcBds[0].lng,T._mcBds[1].lat,T._mcBds[1].lng,T._mcBds[1].lat,T._mcBds[1].lng,T._mcBds[0].lat];if(!this.labelCache[h1.join()]){this.labelCache[h1.join()]=true;this.map.addAreaSpot(h1,{userData:{styleId:T.styleId,type:"mapstyle",name:T.name}})}}}}};function bR(i,e,hY,T){this.cx=3*i;this.bx=3*(hY-i)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*e;this.by=3*(T-e)-this.cy;this.ay=1-this.cy-this.by;this.p1x=i;this.p1y=T;this.p2x=hY;this.p2y=T}bR.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e};bR.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e};bR.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx};bR.prototype.solveCurveX=function(e,h3){if(typeof h3==="undefined"){h3=0.000001}var h2;var h1;var hZ;var T;var hY;for(hZ=e,hY=0;hY<8;hY++){T=this.sampleCurveX(hZ)-e;if(Math.abs(T)<h3){return hZ}var h0=this.sampleCurveDerivativeX(hZ);if(Math.abs(h0)<0.000001){break}hZ=hZ-T/h0}h2=0;h1=1;hZ=e;if(hZ<h2){return h2}if(hZ>h1){return h1}while(h2<h1){T=this.sampleCurveX(hZ);if(Math.abs(T-e)<h3){return hZ}if(e>T){h2=hZ}else{h1=hZ}hZ=(h1-h2)*0.5+h2}return hZ};bR.prototype.solve=function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))};var cn={};function o(T){var e={duration:1000,fps:30,delay:0,transition:cn.linear,dropLastAnimation:false};if(T){for(var hY in T){e[hY]=T[hY]}}if(T.beginTime){this._beginTime=T.beginTime}this._callbacks=[];this._options=e;if(e.delay){var hZ=this;setTimeout(function(){hZ._doStart()},e.delay)}else{this._doStart()}this._pauseTime=0}o.INFINITE="INFINITE";o.prototype._doStart=function(){if(this._isPausing){var e=performance.now()||new Date().getTime();this._pauseTime+=e-this._isPausing;this._isPausing=undefined}if(window.requestAnimationFrame){var i=this;i._timer=window.requestAnimationFrame(function(T){i._loop(T)})}else{this._beginTime=new Date().getTime();if(this._options.duration===o.INFINITE){this._endTime=null}else{this._endTime=this._beginTime+this._options.duration}this._loop()}};o.prototype._loop=function(hY){var h1=this;hY=hY||new Date().getTime();hY=hY-this._pauseTime;if(!this._beginTime){this._beginTime=hY}if(!this._endTime&&typeof this._options.duration==="number"){this._endTime=this._beginTime+this._options.duration}if(h1._endTime!==null&&hY>=h1._endTime){if(h1._options.dropLastAnimation===false){h1._options.render(h1._options.transition(1),1,hY)}if(typeof h1._options.finish==="function"){h1._options.finish(hY,this)}for(var h0=0,e=h1._callbacks.length;h0<e;h0++){h1._callbacks[h0]()}return}var hZ;if(typeof h1._options.duration==="number"){hZ=(hY-h1._beginTime)/h1._options.duration;h1.schedule=h1._options.transition(hZ)}else{hZ=hY-h1._beginTime;h1.schedule=0}h1._options.render(h1.schedule,hZ,hY);if(!h1.terminative){if(window.requestAnimationFrame){h1._timer=requestAnimationFrame(function T(i){h1._loop(i)})}else{h1._timer=setTimeout(function(){h1._loop()},1000/h1._options.fps)}}};o.prototype.stop=function(i,e){this.terminative=true;if(this._timer){if(window.cancelAnimationFrame){cancelAnimationFrame(this._timer)}else{clearTimeout(this._timer)}this._timer=null;if(typeof this._options.onStop==="function"){this._options.onStop(e)}}if(i){this._endTime=this._beginTime;this._loop()}};o.prototype.pause=function(){if(!this._isPausing){this.stop();this.terminative=undefined;this._isPausing=performance.now()||new Date().getTime()}};o.prototype.cancel=function(){this.stop()};o.prototype.append=function(e){this._callbacks.push(e);return this};cn={_p1:1,_p2:1*1.525,linear:function(e){return e},reverse:function(e){return 1-e},easeInQuad:function(e){return e*e},easeInCubic:function(e){return Math.pow(e,3)},easeInBiquad:function(e){return Math.pow(e,4)},easeInBack:function(e){return e*e*((cn._p1+1)*e-cn._p1)},easeOutQuad:function(e){return -(e*(e-2))},easeOutCubic:function(e){return Math.pow((e-1),3)+1},easeOutBiquad:function(e){return 1-Math.pow((e-1),4)},easeOutBack:function(e){return((e=e-1)*e*((cn._p1+1)*e+cn._p1)+1)},easeInOutQuad:function(e){if(e<0.5){return e*e*2}else{return -2*(e-2)*e-1}},easeInOutCubic:function(e){if(e<0.5){return Math.pow(e,3)*4}else{return Math.pow(e-1,3)*4+1}},easeInOutBiquad:function(e){if(e<0.5){return Math.pow(e,4)*8}else{return 1-(Math.pow(e-1,4)*8)}},easeInOutSine:function(e){return(1-Math.cos(Math.PI*e))/2}};cn.ease=(function(){var e=new bR(0.4,0,0.6,1);return function(i){return e.solve(i)}})();cn["ease-in"]=cn.easeInQuad;cn["ease-out"]=cn.easeOutQuad;var fq={start:function(h4){var hY=h4.el;var e=h4.style;var i=h4.startValue;var h1=h4.endValue;var hZ=h4.duration||1400;var h0=h4.transition||cn.linear;var h3=h4.callback;var h2=h1-i;var T=h4.unit||"";return new o({fps:60,duration:hZ,transition:h0,render:function(h5){hY.style[e]=i+h2*h5+T},finish:function(){h3&&h3()}})}};function cM(hZ,T){eg.call(this);this.keyframes=hZ;var e={duration:1000,delay:0,transition:cn.linear,interation:1};if(T){for(var hY in T){e[hY]=T[hY]}}this._options=e}cM.inherits(eg,"ViewAnimation");cM.prototype._start=function(h0){var T=this;T.map=h0;var hZ=new bb("onanimationstart");T.dispatchEvent(hZ);this._initStatus(T.map);var hY=this._options.duration;var i=this._options.interation;var h1=this._options.transition;var h2=0;T.poiStatus=T.map._displayOptions.poi;if(T.poiStatus){T.map.setDisplayOptions({poi:false})}T.map.viewAnimationTime=new Date().getTime();this.animation=new o({duration:hY,transition:h1,start:function(e){},render:function(h3,e){if(h3===0){T._initStatus(T.map)}else{T._setViewByRate(h3)}},finish:function(h4,h3){if(++h2<i||i==="INFINITE"){var h5=new bb("onanimationiterations");T.dispatchEvent(h5);delete h3._beginTime;delete h3._endTime;h3._doStart()}else{var h5=new bb("onanimationend");T.dispatchEvent(h5);delete T.map.viewAnimationTime;T.map.setDisplayOptions({poi:T.poiStatus})}}})};cM.prototype._getTotalDuration=function(e,i){if(e===o.INFINITE){return o.INFINITE}else{return e*i}};cM.prototype._initStatus=function(e){if(this.keyframes[0]){e.setCenter(this.keyframes[0].center,{noAnimation:true});e.setZoom(this.keyframes[0].zoom,{noAnimation:true});e.setTilt(this.keyframes[0].tilt,{noAnimation:true});e.setHeading(this.keyframes[0].heading,{noAnimation:true})}};cM.prototype._setViewByRate=function(hY){for(var e=0;e<this.keyframes.length-1;e++){var hZ=this.keyframes[e];var T=this.keyframes[e+1];if(hY>=hZ.percentage&&hY<T.percentage){this.map.setHeading(this._getHeadingDelta(hZ,T,hY),{noAnimation:true});this.map.setTilt(this._getTiltDelta(hZ,T,hY),{noAnimation:true});this.map.setCenter(this._getCenterDelta(hZ,T,hY),{noAnimation:true});this.map.setZoom(this._getZoomDelta(hZ,T,hY),{noAnimation:true})}}};cM.prototype._getHeadingDelta=function(T,i,e){var hZ=(e-T.percentage)/(i.percentage-T.percentage);var hY=T.heading+(i.heading-T.heading)*hZ;return hY};cM.prototype._getTiltDelta=function(T,i,e){var hZ=(e-T.percentage)/(i.percentage-T.percentage);var hY=T.tilt+(i.tilt-T.tilt)*hZ;return hY};cM.prototype._getCenterDelta=function(T,i,e){var hZ=(e-T.percentage)/(i.percentage-T.percentage);var hY=T.center.add(i.center.sub(T.center).mult(hZ));return hY};cM.prototype._getZoomDelta=function(hY,T,i){var hZ=(i-hY.percentage)/(T.percentage-hY.percentage);var e=hY.zoom+(T.zoom-hY.zoom)*hZ;return e};cM.prototype._pause=function(e){this.animation.pause()};cM.prototype._continue=function(e){this.animation._doStart()};cM.prototype._cancel=function(T){T.setDisplayOptions({poi:this.poiStatus});this.animation.cancel();delete T.viewAnimationTime;var i=new bb("onanimationcancel");this.dispatchEvent(i)};var ez=undefined;var c0={is64Bit:function(){if(/Windows/.test(navigator.userAgent)){if(/Win64; x64/.test(navigator.userAgent)){return true}else{if(/WOW64/.test(navigator.userAgent)){return true}else{return false}}}return true},isIOS112:function cQ(e){return/11_2/.test(navigator.userAgent)},canUseWebAssembly:function(i){if(ez!==undefined){i&&i(ez);return}if(window.WebAssembly&&this.is64Bit()){if(window.disableWebAssembly===true){ez=false;i&&i(ez)}else{if(!bv()){ez=true;i&&i(ez)}else{if(this.isIOS112()){ez=false;i&&i(ez)}else{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,133,128,128,128,0,1,96,0,1,127,3,130,128,128,128,0,1,0,4,132,128,128,128,0,1,112,0,0,5,131,128,128,128,0,1,0,1,6,129,128,128,128,0,0,7,145,128,128,128,0,2,6,109,101,109,111,114,121,2,0,4,109,97,105,110,0,0,10,138,128,128,128,0,1,132,128,128,128,0,0,65,42,11]);WebAssembly.instantiate(e).then(function(T){ez=true;i&&i(ez)},function(T){ez=false;i&&i(ez)})}}}}else{ez=false;i&&i(ez)}}};var dw={};bo.Utils=dw;function dd(e){return e.style}function dm(i){if(C.Browser.ie>0){i.unselectable="on";i.selectstart=function(){return false};i.onmousedown=function(T){T.preventDefault();return false}}else{var e=dd(i);e.MozUserSelect="none";e.WebkitUserSelect="none";i.addEventListener("mousedown",function(T){T.preventDefault()},false)}}function hk(e){return e&&e.parentNode&&e.parentNode.nodeType!==11}function dI(i,e){i.insertAdjacentHTML("beforeEnd",e);return i.lastChild}function hI(T,i){var hY=document.createElement("div");hY.innerHTML=i;var e=hY.childNodes[0];return T.parentNode.insertBefore(e,T)}function h(i){i=i||window.event;i.stopPropagation?i.stopPropagation():i.cancelBubble=true}function bU(i){i=i||window.event;i.preventDefault?i.preventDefault():i.returnValue=false;return false}function db(i){h(i);return bU(i)}function fP(){var e=document.documentElement;var i=document.body;if(e&&(e.scrollTop||e.scrollLeft)){return[e.scrollTop,e.scrollLeft]}else{if(i){return[i.scrollTop,i.scrollLeft]}else{return[0,0]}}}function fw(hZ){if(!hZ){return}hZ.onload=hZ.onerror=null;var T=hZ.attributes,hY,e,h0;if(T){e=T.length;for(hY=0;hY<e;hY+=1){h0=T[hY].name;if(typeof hZ[h0]==="function"){hZ[h0]=null}}}T=hZ.children;if(T){e=T.length;for(hY=0;hY<e;hY+=1){fw(hZ.children[hY])}}}function bG(i,h1,h0){var hZ=h1.lng-h0.lng;var hY=h1.lat-h0.lat;if(hZ===0){return Math.abs(i.lng-h1.lng)}if(hY===0){return Math.abs(i.lat-h1.lat)}var T=hY/hZ;var e=h1.lat-T*h1.lng;return Math.abs(T*i.lng-i.lat+e)/Math.sqrt(T*T+1)}function g2(i,e){if(!i||!e){return}return Math.round(Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)))}function bP(i,e){if(!i||!e){return 0}return Math.round(Math.sqrt(Math.pow(i.lng-e.lng,2)+Math.pow(i.lat-e.lat,2)))}function c1(T,i){var e=Math.round((T.x+i.x)/2);var hY=Math.round((T.y+i.y)/2);return new em(e,hY)}function hq(e,T){var i=[];T=T||function(hZ){return hZ};for(var hY in e){i.push(hY+"="+T(e[hY]))}return i.join("&")}function S(T,i,h0){var h1=document.createElement(T);if(h0){h1=document.createElementNS(h0,T)}i=i||{};for(var hY in i){var hZ={"for":"htmlFor","class":"cssClass"}[hY]||hY;if(hY==="style"){h1.style.cssText=i[hY];continue}if(hY==="class"){C.ac(h1,i[hY]);continue}if(h1.setAttribute){h1.setAttribute(hZ,i[hY])}else{try{h1[hZ]=i[hY]}catch(h1){}}}return h1}function f4(e){if(e.currentStyle){return e.currentStyle}else{if(e.ownerDocument&&e.ownerDocument.defaultView){return e.ownerDocument.defaultView.getComputedStyle(e,null)}}}function bV(e){return typeof e==="function"}var hv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function g7(hZ){var T="";var h6;var h4;var h2="";var h5;var h3;var h1;var h0="";var hY=0;var e=/[^A-Za-z0-9+/=]/g;if(!hZ||e.exec(hZ)){return hZ}hZ=hZ.replace(/[^A-Za-z0-9+/=]/g,"");do{h5=hv.indexOf(hZ.charAt(hY++));h3=hv.indexOf(hZ.charAt(hY++));h1=hv.indexOf(hZ.charAt(hY++));h0=hv.indexOf(hZ.charAt(hY++));h6=(h5<<2)|(h3>>4);h4=((h3&15)<<4)|(h1>>2);h2=((h1&3)<<6)|h0;T=T+String.fromCharCode(h6);if(h1!==64){T=T+String.fromCharCode(h4)}if(h0!==64){T=T+String.fromCharCode(h2)}h6=h4=h2="";h5=h3=h1=h0=""}while(hY<hZ.length);return T}(function(e){if(!e.Utils){e.Utils={}}var i=e.Utils;i.format=(function(){function T(h1,h0,h2){var hZ=h2[+h0];return typeof(hZ)==="function"?hZ(h0):hZ}function hY(h1,h0,h2){var h4=h0;var h5=[];var hZ=h0.split(":");if(hZ.length===2){h4=hZ[0];h5.push(hZ[1])}var h3=typeof(h2[h4]);if(h3==="function"){return h2[h4].apply(undefined,h5)}else{if(h3==="undefined"){return h1}else{return String(h2[h4])}}}return function(hZ,h0){var h2=h0.splice?T:hY;var h1=hZ.splice?hZ.join(""):hZ;return h1.replace(/{([a-zA-Z0-9_$:.]+)}/g,function(h4,h3){return h2(h4,h3,h0)})}})();i.ErrorMonitor=function(hY,T,hZ){};c0.canUseWebAssembly(function(T){i.canUseWebAssembly=T})})(bo);function gb(){return(bv()||eG())}function bv(){var e=navigator.userAgent;if(e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1){return true}return false}function eG(){var e=navigator.userAgent;if(e.indexOf("Android")>-1){return true}return false}function dK(e){return e*Math.PI/180}function de(e){return e/Math.PI*180}function dO(e,hZ){var hY=Math.pow(10,hZ);if(typeof e==="number"){return Math.round(e*hY)/hY}for(var T=0;T<e.length;T++){e[T]=dO(e[T],hZ)}return e}function fL(T,i,e){if(T<i){T=i}else{if(T>e){T=e}}return T}function f5(e,i){while(e<0){e+=i}return e%i}function eb(i,e){return(i>=0&&e>=0)||(i<0&&e<0)}function a5(i){if(i._gl){return i._gl}var e={alpha:true,antialias:false,failIfMajorPerformanceCaveat:false,preserveDrawingBuffer:false,stencil:false};var T=i.getContext("webgl",e)||i.getContext("experimental-webgl",e);i._gl=T;return T}function eP(hY,T){for(var e=0;e<T.length;e++){C.on(hY,T[e],h)}}function hX(i,T,e){T[e]=i.getUniformLocation(T,e)}function e6(hZ,h0,e,T,i){var hY="";switch(i){case"mat4":hZ.uniformMatrix4fv(h0[e],false,T);return;case"v3":hY="uniform3fv";break;case"f":hY="uniform1f";break;case"i":hY="uniform1i";break}if(hY===""){throw"error"}hZ[hY](h0[e],T)}function K(h6,e){while(h6<0){h6+=360}h6=h6%360;var hY=e.width;var h5=e.height;var h1=hY;var T=h5;if(h6<90){var i=Math.sin(dK(h6))*hY;var h3=Math.sin(dK(h6))*h5;var h4=Math.cos(dK(h6))*hY;var h0=Math.cos(dK(h6))*h5;var h1=Math.ceil(h4+h3);var T=Math.ceil(i+h0)}else{if(h6<180){var h6=h6-90;var i=Math.sin(dK(h6))*hY;var h3=Math.sin(dK(h6))*h5;var h4=Math.cos(dK(h6))*hY;var h0=Math.cos(dK(h6))*h5;var h1=Math.ceil(i+h0);var T=Math.ceil(h4+h3)}else{if(h6<270){var h6=h6-180;var i=Math.sin(dK(h6))*hY;var h3=Math.sin(dK(h6))*h5;var h4=Math.cos(dK(h6))*hY;var h0=Math.cos(dK(h6))*h5;var h1=Math.ceil(h4+h3);var T=Math.ceil(i+h0)}else{var h6=h6-270;var i=Math.sin(dK(h6))*hY;var h3=Math.sin(dK(h6))*h5;var h4=Math.cos(dK(h6))*hY;var h0=Math.cos(dK(h6))*h5;var h1=Math.ceil(i+h0);var T=Math.ceil(h4+h3)}}}var h2=h1-hY;var hZ=T-h5;return[0-h2/2,0-hZ/2,hY+h2/2,h5+hZ/2]}function gL(e){if(e.toDataURL()===gL._blankData){return true}return false}function gB(hZ,hY,T){var i=[T.lng-hZ.lng,T.lat-hZ.lat];var e=[hY.lng-hZ.lng,hY.lat-hZ.lat];return i[0]*e[1]-i[1]*e[0]}function ch(h0,hZ,T){var e;var h1;var hY;var i;if(h0.lng<hZ.lng){e=h0.lng;hY=hZ.lng}else{e=hZ.lng;hY=h0.lng}if(h0.lat<hZ.lat){h1=h0.lat;i=hZ.lat}else{h1=hZ.lat;i=h0.lat}if(T.lng<e||T.lng>hY||T.lat<h1||T.lat>i){return false}return true}function gD(h2,h1,h0,hY){var hZ=gB(h0,hY,h2);var T=gB(h0,hY,h1);var i=gB(h2,h1,h0);var e=gB(h2,h1,hY);if(hZ*T<0&&i*e<0){return true}else{if(hZ===0&&ch(h0,hY,h2)){return true}else{if(T===0&&ch(h0,hY,h1)){return true}else{if(i===0&&ch(h2,h1,h0)){return true}else{if(e===0&&ch(h2,h1,hY)){return true}else{return false}}}}}}function hG(T,i){var e=i.parentNode;if(e.lastChild===i){e.appendChild(T)}else{e.insertBefore(T,i.nextSibling)}}function hM(h4,h5){if(h5===0){return h4}var h3=0;var h1=0;if(!h4){throw"异常"}if(h4.length===0){return[]}for(var hZ=1,T=h4.length-1;hZ<T;hZ++){var h2=bG(h4[hZ],h4[0],h4[h4.length-1]);if(h2>h3){h1=hZ;h3=h2}}var e=[];if(h3>=h5){var h7=h4.slice(0,h1);var h6=h4.slice(h1,h4.length);var h0=hM(h7,h5);var hY=hM(h6,h5);for(var hZ=0,T=h0.length;hZ<T;hZ++){e.push(h0[hZ])}for(var hZ=0,T=hY.length;hZ<T;hZ++){e.push(hY[hZ])}}else{e.push(h4[0]);e.push(h4[h4.length-1])}return e}function eH(e){if(Math.log2){return Math.log2(e)}return Math.log(e)/Math.LN2}function br(T,i,e){return Math.min(e,Math.max(i,T))}function cJ(e,i){if(!i){return e}var h0=i[0];var hZ=i[1];var hY=i[2];var T=i[3];var h2=[];var h1=[];h2[0]=T*e[0]+hY*e[2];h2[1]=e[1];h2[2]=-hY*e[0]+T*e[2];h1[0]=h2[0];h1[1]=hZ*h2[1]-h0*h2[2];h1[2]=h0*h2[1]+hZ*h2[2];return h1}var aP=Math.PI/180;var E=180/Math.PI;function bz(T){var i=(T-Date.UTC(2000,0,1,12))/86400000/36525;var e=(d3.utcDay.floor(T)-T)/86400000*360-180;return[e-U(i)*E,gI(i)*E]}function U(hY){var hZ=gd(hY);var i=dL(hY);var T=aj(hY);var h0=Math.tan(f8(hY)/2);h0*=h0;return h0*Math.sin(2*T)-2*hZ*Math.sin(i)+4*hZ*h0*Math.sin(i)*Math.cos(2*T)-0.5*h0*h0*Math.sin(4*T)-1.25*hZ*hZ*Math.sin(2*i)}function gI(e){return Math.asin(Math.sin(f8(e))*Math.sin(g5(e)))}function g5(e){return bh(e)-(0.00569+0.00478*Math.sin((125.04-1934.136*e)*aP))*aP}function bh(e){return aj(e)+dR(e)}function dL(e){return(357.52911+e*(35999.05029-0.0001537*e))*aP}function aj(i){var e=(280.46646+i*(36000.76983+i*0.0003032))%360;return(e<0?e+360:e)/180*Math.PI}function dR(i){var e=dL(i);return(Math.sin(e)*(1.914602-i*(0.004817+0.000014*i))+Math.sin(e+e)*(0.019993-0.000101*i)+Math.sin(e+e+e)*0.000289)*aP}function f8(e){return fi(e)+0.00256*Math.cos((125.04-1934.136*e)*aP)*aP}function fi(e){return(23+(26+(21.448-e*(46.815+e*(0.00059-e*0.001813)))/60)/60)*aP}function gd(e){return 0.016708634-e*(0.000042037+1.267e-7*e)}function a6(){return window.devicePixelRatio||1}function aF(T){var i;var e;var hY;if(T>=0){hY=Math.floor(T/65536)*65536;i=hY;e=T-hY}else{hY=Math.floor(-T/65536)*65536;i=-hY;e=T+hY}return[i,e]}function G(e){if(e.lng>=0&&e.lat>=0){return new hz(e.lng-10000000,e.lat-6000000)}if(e.lng>=0&&e.lat<0){return new hz(e.lng-10000000,e.lat+6000000)}if(e.lng<0&&e.lat>=0){return new hz(e.lng+10000000,e.lat-6000000)}if(e.lng<0&&e.lat<0){return new hz(e.lng+10000000,e.lat+6000000)}}var fH=null;if(window.performance&&window.performance.now){fH=function(){return performance.now()}}else{if(Date.now){fH=function(){return Date.now()}}else{fH=function(){return(new Date).getTime()}}}function bL(hY,e,i){var T="mouseWheel";if(C.Platform.macintosh){if(!isNaN(hY)&&(hY<10||hY!==120)&&(e%1===0&&e<5)){T="padScroll"}if(C.Browser.firefox&&(e%1===0&&e<5&&i===0)){T="padScroll"}}if(C.Browser.safari&&hY===12){T="mouseWheel"}return T}function dg(h7,h2){var h6=h7[0];var h5=h7[1];var hY=false;for(var h1=0,h0=h2.length-2;h1<h2.length;h1+=2){var h4=h2[h1];var hZ=h2[h1+1];var h3=h2[h0];var T=h2[h0+1];var e=((hZ>h5)!==(T>h5))&&(h6<(h3-h4)*(h5-hZ)/(T-hZ)+h4);if(e){hY=!hY}h0=h1}return hY}function cE(T,e,i,hY){hY=hY||0.4;if(T>i){T=Math.pow(T-i+1,hY)+i-1}else{if(T<e){T=e-Math.pow(e-T+1,hY)+1}}return T}function gr(h2){var h0="";for(var T=0;T<h2.length;T++){var h3=h2.charCodeAt(T)<<1;var e=h3.toString(2);var hZ=e.length;var h6=e;if(hZ<8){h6="00000000"+e;h6=h6.substr(e.length,8)}h0+=h6}var h4=5-h0.length%5;var hY=[];for(var T=0;T<h4;T++){hY[T]="0"}h0=hY.join("")+h0;var h5=[];for(var T=0;T<h0.length/5;T++){var h3=h0.substr(T*5,5);var h1=parseInt(h3,2)+50;h5.push(String.fromCharCode(h1))}return h5.join("")+h4.toString()}function aD(T,i){var e=bo.TILE_VERSION||window.TILE_VERSION;if(!e||!e[T]||!e[T][i]||!e[T][i].version||!e[T][i].updateDate){e=e8.tvc}return{ver:e[T][i].version,udt:e[T][i].updateDate}}function fF(){var e=bo.MSV||window.MSV;if(!e||!e.mapstyle||!e.mapstyle.updateDate||!e.mapstyle.version){e=e8.msv}return{ver:e.mapstyle.version,udt:e.mapstyle.updateDate}}function eu(e,hZ){var hY=e.slice(0);for(var T=0;T<hY.length;T++){hY[T]+=hZ}return hY}var a4=null;function by(e){if(a4){return}e.fire(new bb("onloadtile"));a4=setTimeout(function(){a4=null},1000)}function e5(){if(cr("//map.baidu.com")||cr("//maps.baidu.com")||cr("//ditu.baidu.com")){return true}return false}dw.inMapHost=e5();if(typeof window._inMapHost==="boolean"){dw.inMapHost=window._inMapHost}function cr(i){var T=window.location;var e=document.createElement("a");e.href=i;return e.hostname===T.hostname&&e.port===T.port&&e.protocol===T.protocol}function ed(){}C.extend(ed,{Request:{INITIAL:-1,WAITING:0,LOADED:1,COMPLETED:2},Dependency:{poly:["marker"],hotspot:["poly"],infowindow:["marker","hotspot"],simpleInfowindow:["marker"],tools:["marker","poly"],mapgl:["glcommon","poly"],earth:["glcommon"],control:["scommon"],scommon:[],localSearch:["scommon"],otherSearch:["scommon"],route:["scommon"],buslineSearch:["route"],autocomplete:["scommon"]},MD5Mapping:{control:"g3zqlu",marker:"mamric",poly:"vwsps4",infowindow:"dclnic",simpleInfowindow:"jasyo0",hotspot:"wwsiwd",menu:"jcw4z5",tools:"j0eutf",oppc:"elxtnf",oppcgl:"ehm2jp",mapgl:"p3h5ps",markeranimation:"zzkoer",earth:"amj1zp",glcommon:"munqoc",localSearch:"bq2iqp",scommon:"1w04rz",otherSearch:"10yyd4",route:"zfsegb",buslineSearch:"sq02ey",autocomplete:"p43bea"},Config:{baseUrl:e8.apiHost+"/getmodules?v=1.0&type=webgl",jsModPath:(dw.inMapHost?"":e8.mapHost)+"/res/newui/",timeout:5000},delayFlag:false,Module:{modules:{},modulesNeedToLoad:[]},_getMd5ModsStr:function(h0){var hZ=[];for(var h2=0,T=h0.length;h2<T;h2++){var h1=h0[h2];var e=this.MD5Mapping[h1];var hY="$"+h1+"$";if(e!==hY){hZ.push(h1+"_"+e)}}return hZ.join(",")},load:function(i,h0,hY){var e=this.getModuleInfo(i);if(e.status===this.Request.COMPLETED){if(hY===true){h0()}}else{if(e.status===this.Request.INITIAL){this.combine(i);this.addToLoadQueue(i);var T=this;if(T.delayFlag===false){T.delayFlag=true;setTimeout(function(){var h1=T.Config.baseUrl+"&mod="+T._getMd5ModsStr(T.Module.modulesNeedToLoad);ht.load(h1);T.Module.modulesNeedToLoad.length=0;T.delayFlag=false},1)}e.status=this.Request.WAITING;function hZ(h3){var h2=T.getModuleInfo(i);if(h2.status!==T.Request.COMPLETED){if(window.map){var h1=new bb("onmod_timeout");h1.timeout=h3/1000;h1.moduleName=i;window.map.fire(h1)}}}setTimeout(hZ,this.Config.timeout,this.Config.timeout);setTimeout(hZ,this.Config.timeout*2,this.Config.timeout*2)}if(h0){e.callbacks.push(h0)}}},combine:function(e){if(e&&this.Dependency[e]){var hY=this.Dependency[e];for(var T=0;T<hY.length;T++){this.combine(hY[T]);if(!this.Module.modules[hY[T]]){this.addToLoadQueue(hY[T])}}}},addToLoadQueue:function(e){var i=this.getModuleInfo(e);if(i.status===this.Request.INITIAL){i.status=this.Request.WAITING;this.Module.modulesNeedToLoad.push(e)}},run:function(T,hY){var h2=this.getModuleInfo(T);var h5=this.Dependency[T];if(h5){for(var h0=0;h0<h5.length;h0++){var h1=this.getModuleInfo(h5[h0]);if(h1.status!==this.Request.COMPLETED){h1.modsNeedToRun.push({name:T,code:hY});return}}}try{eval(hY)}catch(h3){return}h2.status=this.Request.COMPLETED;for(var h0=0,hZ=h2.callbacks.length;h0<hZ;h0++){h2.callbacks[h0]()}h2.callbacks.length=0;for(h0=0;h0<h2.modsNeedToRun.length;h0++){var h4=h2.modsNeedToRun[h0];this.run(h4.name,h4.code)}h2.modsNeedToRun.length=0},getModuleInfo:function(i){var e;if(!this.Module.modules[i]){this.Module.modules[i]={status:this.Request.INITIAL,callbacks:[],modsNeedToRun:[]}}e=this.Module.modules[i];return e}});window._jsload=function(hZ,h0){var i=ed.getModuleInfo(hZ);i.status=ed.Request.LOADED;if(h0!==""){ed.run(hZ,h0)}else{if(window.map){var e=new bb("ongetmodules_fail");e.moduleName=hZ;window.map.fire(e)}var T=document.createElement("script");var hY=ed.MD5Mapping[hZ];T.src=ed.Config.jsModPath+hZ+"_"+hY+".js";document.getElementsByTagName("head")[0].appendChild(T)}};function ac(){this._timeData={}}var fe;if(typeof window!=="undefined"){fe=window}else{fe=self}ac.prototype.mark=function(e){this._timeData[e]=this._getTime()};ac.prototype.getMark=function(e){return this._timeData[e]};ac.prototype.getTime=function(i,e){return parseFloat((this._timeData[e]-this._timeData[i]).toFixed(2))};ac.prototype.print=function(){};ac.prototype.clear=function(){this._timeData={}};if(fe.performance&&fe.performance.now){ac.prototype._getTime=function(){return performance.now()}}else{ac.prototype._getTime=function(){return Date.now()}}!function(i,T){T(i.d3=i.d3||{})}(window,function(iF){function iX(i3,i4,T,it){function e(i){return i3(i=new Date(+i)),i}return e.floor=e,e.ceil=function(i){return i3(i=new Date(i-1)),i4(i,1),i3(i),i},e.round=function(i){var i5=e(i),i6=e.ceil(i);return i6-i>i-i5?i5:i6},e.offset=function(i,i5){return i4(i=new Date(+i),null==i5?1:Math.floor(i5)),i},e.range=function(i6,i,i5){var i7=[];if(i6=e.ceil(i6),i5=null==i5?1:Math.floor(i5),!(i>i6&&i5>0)){return i7}do{i7.push(new Date(+i6))}while(i4(i6,i5),i3(i6),i>i6);return i7},e.filter=function(i){return iX(function(i5){for(;i3(i5),!i(i5);){i5.setTime(i5-1)}},function(i5,i6){for(;--i6>=0;){for(;i4(i5,1),!i(i5);){}}})},T&&(e.count=function(i,i5){return iH.setTime(+i),iL.setTime(+i5),i3(iH),i3(iL),Math.floor(T(iH,iL))},e.every=function(i){return i=Math.floor(i),isFinite(i)&&i>0?i>1?e.filter(it?function(i5){return it(i5)%i===0}:function(i5){return e.count(0,i5)%i===0}):e:null}),e}function iM(e){return iX(function(i){i.setDate(i.getDate()-(i.getDay()+7-e)%7),i.setHours(0,0,0,0)},function(i,T){i.setDate(i.getDate()+7*T)},function(i,T){return(T-i-(T.getTimezoneOffset()-i.getTimezoneOffset())*iG)/iU})}function iE(e){return iX(function(i){i.setUTCDate(i.getUTCDate()-(i.getUTCDay()+7-e)%7),i.setUTCHours(0,0,0,0)},function(i,T){i.setUTCDate(i.getUTCDate()+7*T)},function(i,T){return(T-i)/iU})}var iH=new Date,iL=new Date,iS=iX(function(){},function(i,T){i.setTime(+i+T)},function(i,T){return T-i});iS.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?iX(function(i){i.setTime(Math.floor(i/e)*e)},function(i,T){i.setTime(+i+T*e)},function(i,T){return(T-i)/e}):iS:null};var i1=iS.range,iZ=1000,iG=60000,iW=3600000,iO=86400000,iU=604800000,h4=iX(function(e){e.setTime(Math.floor(e/iZ)*iZ)},function(i,T){i.setTime(+i+T*iZ)},function(i,T){return(T-i)/iZ},function(e){return e.getUTCSeconds()}),iY=h4.range,iN=iX(function(e){e.setTime(Math.floor(e/iG)*iG)},function(i,T){i.setTime(+i+T*iG)},function(i,T){return(T-i)/iG},function(e){return e.getMinutes()}),ic=iN.range,iA=iX(function(i){var T=i.getTimezoneOffset()*iG%iW;0>T&&(T+=iW),i.setTime(Math.floor((+i-T)/iW)*iW+T)},function(i,T){i.setTime(+i+T*iW)},function(i,T){return(T-i)/iW},function(e){return e.getHours()}),iT=iA.range,io=iX(function(e){e.setHours(0,0,0,0)},function(i,T){i.setDate(i.getDate()+T)},function(i,T){return(T-i-(T.getTimezoneOffset()-i.getTimezoneOffset())*iG)/iO},function(e){return e.getDate()-1}),h3=io.range,ik=iM(0),im=iM(1),hZ=iM(2),ii=iM(3),h6=iM(4),iD=iM(5),iK=iM(6),h1=ik.range,iC=im.range,ia=hZ.range,iz=ii.range,iP=h6.range,iB=iD.range,i0=iK.range,iR=iX(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(i,T){i.setMonth(i.getMonth()+T)},function(i,T){return T.getMonth()-i.getMonth()+12*(T.getFullYear()-i.getFullYear())},function(e){return e.getMonth()}),i2=iR.range,ih=iX(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(i,T){i.setFullYear(i.getFullYear()+T)},function(i,T){return T.getFullYear()-i.getFullYear()},function(e){return e.getFullYear()});ih.every=function(e){return isFinite(e=Math.floor(e))&&e>0?iX(function(i){i.setFullYear(Math.floor(i.getFullYear()/e)*e),i.setMonth(0,1),i.setHours(0,0,0,0)},function(i,T){i.setFullYear(i.getFullYear()+T*e)}):null};var h9=ih.range,iI=iX(function(e){e.setUTCSeconds(0,0)},function(i,T){i.setTime(+i+T*iG)},function(i,T){return(T-i)/iG},function(e){return e.getUTCMinutes()}),iq=iI.range,ip=iX(function(e){e.setUTCMinutes(0,0,0)},function(i,T){i.setTime(+i+T*iW)},function(i,T){return(T-i)/iW},function(e){return e.getUTCHours()}),il=ip.range,ij=iX(function(e){e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCDate(i.getUTCDate()+T)},function(i,T){return(T-i)/iO},function(e){return e.getUTCDate()-1}),ig=ij.range,ie=iE(0),id=iE(1),ib=iE(2),h8=iE(3),h7=iE(4),h2=iE(5),h0=iE(6),hY=ie.range,iy=id.range,iV=ib.range,iJ=h8.range,iQ=h7.range,ix=h2.range,iw=h0.range,iv=iX(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCMonth(i.getUTCMonth()+T)},function(i,T){return T.getUTCMonth()-i.getUTCMonth()+12*(T.getUTCFullYear()-i.getUTCFullYear())},function(e){return e.getUTCMonth()}),iu=iv.range,h5=iX(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(i,T){i.setUTCFullYear(i.getUTCFullYear()+T)},function(i,T){return T.getUTCFullYear()-i.getUTCFullYear()},function(e){return e.getUTCFullYear()});h5.every=function(e){return isFinite(e=Math.floor(e))&&e>0?iX(function(i){i.setUTCFullYear(Math.floor(i.getUTCFullYear()/e)*e),i.setUTCMonth(0,1),i.setUTCHours(0,0,0,0)},function(i,T){i.setUTCFullYear(i.getUTCFullYear()+T*e)}):null};var ir=h5.range;iF.timeInterval=iX,iF.timeMillisecond=iS,iF.timeMilliseconds=i1,iF.utcMillisecond=iS,iF.utcMilliseconds=i1,iF.timeSecond=h4,iF.timeSeconds=iY,iF.utcSecond=h4,iF.utcSeconds=iY,iF.timeMinute=iN,iF.timeMinutes=ic,iF.timeHour=iA,iF.timeHours=iT,iF.timeDay=io,iF.timeDays=h3,iF.timeWeek=ik,iF.timeWeeks=h1,iF.timeSunday=ik,iF.timeSundays=h1,iF.timeMonday=im,iF.timeMondays=iC,iF.timeTuesday=hZ,iF.timeTuesdays=ia,iF.timeWednesday=ii,iF.timeWednesdays=iz,iF.timeThursday=h6,iF.timeThursdays=iP,iF.timeFriday=iD,iF.timeFridays=iB,iF.timeSaturday=iK,iF.timeSaturdays=i0,iF.timeMonth=iR,iF.timeMonths=i2,iF.timeYear=ih,iF.timeYears=h9,iF.utcMinute=iI,iF.utcMinutes=iq,iF.utcHour=ip,iF.utcHours=il,iF.utcDay=ij,iF.utcDays=ig,iF.utcWeek=ie,iF.utcWeeks=hY,iF.utcSunday=ie,iF.utcSundays=hY,iF.utcMonday=id,iF.utcMondays=iy,iF.utcTuesday=ib,iF.utcTuesdays=iV,iF.utcWednesday=h8,iF.utcWednesdays=iJ,iF.utcThursday=h7,iF.utcThursdays=iQ,iF.utcFriday=h2,iF.utcFridays=ix,iF.utcSaturday=h0,iF.utcSaturdays=iw,iF.utcMonth=iv,iF.utcMonths=iu,iF.utcYear=h5,iF.utcYears=ir,Object.defineProperty(iF,"__esModule",{value:!0})});function gt(e){this._elemType=e;this._objCollection={}}gt.prototype.get=function(){var i=null;for(var e in this._objCollection){if(this._objCollection[e]&&this._objCollection[e]._free===true){this._objCollection[e]._free=false;return this._objCollection[e]}}i=S(this._elemType);e=bo.getGUID("obj_pool_");this._objCollection[e]=i;return i};gt.prototype.free=function(e){if(!e){return}e._free=true;if(e.tagName.toLowerCase()==="img"){e.src="";e.crossOrigin=null;e.onload=e.onerror=null}};gt.prototype.clear=function(){for(var e in this._objCollection){if(this._objCollection[e]&&this._objCollection[e].tagName.toLowerCase==="img"){this._objCollection[e].onload=this._objCollection[e].onerror=null}}this._objCollection={}};var gG={get:function(i,hZ,e,T){var hY=new XMLHttpRequest();hY.open("GET",i,true);hY.timeout=10000;hY.ontimeout=function(){T&&T()};hY.onreadystatechange=function(h0){if(this.readyState===4){if(this.status===200){hZ&&hZ(hY.responseText)}else{e&&e()}}};hY.send()},post:function(i,h0,hZ,e,T){var hY=new XMLHttpRequest();hY.open("POST",i,true);hY.setRequestHeader("Content-type","application/x-www-form-urlencoded");hY.timeout=10000;hY.ontimeout=function(){T&&T()};hY.onreadystatechange=function(h1){if(this.readyState===4){if(this.status===200){hZ&&hZ(hY.responseText,h0)}else{e&&e()}}};hY.send(h0);return hY}};var ht=(function(e){function i(h0,T,hZ){var hY=S("script",{src:h0,type:"text/javascript",charset:"utf-8"});if(hY.addEventListener){hY.addEventListener("load",function(h2){var h1=h2.target;h1.parentNode.removeChild(h1);T&&T()},false);hY.addEventListener("error",function(h1){hZ&&hZ(null)},false)}else{if(hY.attachEvent){hY.attachEvent("onreadystatechange",function(h2){var h1=window.event.srcElement;if(h1&&(h1.readyState==="loaded"||h1.readyState==="complete")){h1.parentNode.removeChild(h1)}T&&T()})}}e.getElementsByTagName("head")[0].appendChild(hY)}return{load:function(h1,T,hY){if(typeof h1==="string"){i(h1,T,hY)}else{if(h1.length>0){var h0=h1.length;for(var hZ=0;hZ<h0;hZ++){i(h1[hZ],function(){h0--;if(h0===0&&T){T()}})}}}}}})(window.document);function cL(){}cL.instances={};cL.getInstance=function(i,T){if(cL.instances[i]){return cL.instances[i]}var e=new di(i,T);cL.instances[i]=e;return e};function di(e,i){this._name=e;this._baseZoom=18;this._opts={tileSize:256};C.extend(this._opts,i||{})}di.mapZoomBaseIndex=[8,8,8,8,7,7,6,6,5,5,4,3,3,3,2,2,1,1,0,0,0,0,0,0,0,0];di.baseScaleZoom=[19,17,15,12,10,9,7,5,3];di.baseScaleZoomMercatorSize=[512,2048,4096,32768,65536,262144,1048576,4194304,8388608];di.mapZoomBaseZoomMapping=[3,3,3,3,5,5,7,7,9,9,10,12,12,12,15,15,17,17,19,19,19,19,19,19,19,19];di.mapZoomStartZoomMapping=[3,3,3,3,4,4,6,6,8,8,10,11,11,11,14,14,16,16,18,18,18,18,18,18,18,18];di.baseScaleTileSize=[1024,1024,512,512,256,512,512,512,256];di.mapZoomTileSize=[256,256,256,256,256,512,256,512,256,512,256,256,512,1024,256,512,512,1024,512,1024,2048,4096,4096*2,4096*2*2,4096*2*2*2,4096*2*2*2*2];di.baseZoomInfo={"3":[3],"5":[4,5],"7":[6,7],"9":[8,9],"10":[10],"12":[11,12,13],"15":[14,15],"17":[16,17],"19":[18,19,20,21,22,23,24,25]};di.prototype={getName:function(){return this._name},getTileSize:function(e){e=Math.floor(e);if(e<3){e=3}if(this._name==="na"){return di.mapZoomTileSize[e]}return this._opts.tileSize},getBaseTileSize:function(i){i=Math.floor(i);if(this._name==="na"){var e=di.mapZoomBaseZoomMapping[i];return di.mapZoomTileSize[e]}return this._opts.tileSize},getDataZoom:function(e){e=Math.floor(e);if(this._name==="na"){return di.mapZoomBaseZoomMapping[e]}return e},getZoomUnits:function(e){return Math.pow(2,(this._baseZoom-e))},getMercatorSize:function(T,i){if(this._name==="na"){T=Math.floor(T);var e=di.mapZoomBaseIndex[T];return di.baseScaleZoomMercatorSize[e]}return this._opts.tileSize*this.getZoomUnits(i)},getBaseZoom:function(){return this._baseZoom},getParentTile:function(hY,h4,h3,T,i){if(this._name==="na"){var hZ=di.baseZoomInfo[h3];T--;if(hZ.indexOf(T)>-1){return{col:hY,row:h4,zoom:h3,useZoom:T}}else{var h1=di.mapZoomBaseIndex[h3];var h0=di.baseScaleZoom[h1+1];if(!h0){return null}var h2=this.getFactorByZooms(h0,h3);var e=di.baseZoomInfo[h0];return{col:Math.floor(hY/h2),row:Math.floor(h4/h2),zoom:h0,useZoom:e[e.length-1]}}return null}if(h3-1<i){return null}return{col:Math.floor(hY/2),row:Math.floor(h4/2),zoom:h3-1,useZoom:h3-1}},getChildTiles:function(hZ,h1,e,T,h8,ie){if(this._name==="na"){var hY=di.baseZoomInfo[e];T+=ie;if(hY.indexOf(T)>-1){return[{col:hZ,row:h1,zoom:e,useZoom:T}]}else{var ic=0;var h9=e;while(ic<ie){var id=di.mapZoomBaseIndex[h9];var h3=di.baseScaleZoom[id-1];if(!h3){return null}var h4=di.baseZoomInfo[h3];if(h4[ie-1]){var h5=[];var h7=this.getFactorByZooms(e,h3);var i=hZ*h7;var h6=h1*h7;for(var ib=0;ib<h7;ib++){var h0=i+ib;for(var ia=0;ia<h7;ia++){var h2=h6+ia;h5.push({col:h0,row:h2,zoom:h3,useZoom:h4[ie-1]})}}return h5}ic+=h4.length;if(ie===h4.length){h9=h3}}}return null}var h5=[];if(e+ie>h8){return null}var h7=Math.pow(2,ie);var i=hZ*h7;var h6=h1*h7;var h3=e+ie;var h5=[];for(var ib=0;ib<2;ib++){var h0=i+ib;for(var ia=0;ia<2;ia++){var h2=h6+ia;h5.push({col:h0,row:h2,zoom:h3,useZoom:h3})}}return h5},getFactorByZooms:function(i,hY){var T=di.mapZoomBaseIndex[i];var hZ=di.mapZoomBaseIndex[hY];var e=di.baseScaleZoomMercatorSize[T];var h0=di.baseScaleZoomMercatorSize[hZ];return e/h0}};var a8={};var ag=["swiftshader","microsoft basic render driver"];var cl=["intel","nvidia","amd","apple","geforce"];function dv(e){e=e.toLowerCase();if(ag.indexOf(e)>=0){return true}if(e.indexOf("mobile")>=0){return true}return false}function fJ(T){T=T.toLowerCase();for(var e=0;e<cl.length;e++){if(T.indexOf(cl[e])>=0){return true}}return false}function dZ(e){if(!e){return false}if(dv(e)){return false}if(fJ(e)){return true}return false}a8.ifEnableEarth=function(i){var e=a8.ifEnableEarth;if(!i&&typeof e._enable==="boolean"){return e._enable}if(a8.ifSupportWebGL()){e._enable=true;return true}e._enable=false;return false};a8.ifEnableWebGLMap=function(i){var e=a8.ifEnableWebGLMap;if(!i&&typeof e._enable==="boolean"){return e._enable}if(a8.ifSupportWebGL()){if(dw.inMapHost){e._enable=true;return true}else{if(window.Blob||window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder){e._enable=true;return true}else{e._enable=false;return false}}}e._enable=false;return false};a8.params={};a8.ifSupportWebGL=function(){var i=a8.ifSupportWebGL;if(typeof i._supportWebGL==="boolean"){return i._supportWebGL}if(!window.WebGLRenderingContext){i._supportWebGL=false;return false}var T=document.createElement("canvas");T.width=300;T.height=150;var hZ=null;var h5={alpha:true,antialias:false,failIfMajorPerformanceCaveat:true,preserveDrawingBuffer:false,stencil:false};try{hZ=T.getContext("webgl",h5)||T.getContext("experimental-webgl",h5)}catch(h1){i._supportWebGL=false}if(hZ===null){i._supportWebGL=false}else{i._supportWebGL=true;var h3=hZ.getExtension("WEBGL_debug_renderer_info");var h2="";if(h3){h2=hZ.getParameter(h3.UNMASKED_RENDERER_WEBGL);if(dZ(h2)===true){i._supportWebGL=true}var h4=hZ.getParameter(h3.UNMASKED_VENDOR_WEBGL);i._renderer=h2;i._vendor=h4}if(!h3&&C.Browser.firefox){i._supportWebGL=true}if(!h3&&C.Platform.macintosh){i._supportWebGL=true}if(hZ.drawingBufferWidth!==T.width||hZ.drawingBufferHeight!==T.height){i._supportWebGL=false}if(hZ.getParameter(hZ.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<4){i._supportWebGL=false}var hY=hZ.getParameter(hZ.MAX_TEXTURE_SIZE);a8.params.maxTextureSize=hY;if(hY<4096){i._supportWebGL=false}var h0=hZ.getParameter(hZ.MAX_TEXTURE_IMAGE_UNITS);if(h0<8){i._supportWebGL=false}if(!hZ.getShaderPrecisionFormat||hZ.getShaderPrecisionFormat(hZ.FRAGMENT_SHADER,hZ.HIGH_FLOAT).precision<23){i._supportWebGL=false}}return i._supportWebGL};a8.ifSupportCanvas2d=function(){var hZ=a8.ifSupportCanvas2d;if(typeof hZ.supportCanvas2d==="boolean"){return hZ.supportCanvas2d}var T=document.createElement("canvas");var i=null;try{i=T.getContext("2d")}catch(hY){hZ.supportCanvas2d=false}if(i===null){hZ.supportCanvas2d=false}else{hZ.supportCanvas2d=true}return hZ.supportCanvas2d};a8.ifCanvas2dInBlackList=function(){return true};a8.ifEnableCanvas2dMap=function(){return false;var i=navigator.userAgent;var e=0;var hY=0;var hZ=0;if(/macintosh/ig.test(i)){var T=0;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)){T=parseInt((RegExp["\x241"]||RegExp["\x242"]),10)}if(T>0){return false}return true}if(/windows nt (\d+\.\d)/ig.test(i)){hY=parseFloat(RegExp.$1);if(hY>=6.1){if(/chrome\/(\d+\.\d)/i.test(i)){e=parseFloat(RegExp.$1);if(e>=31){return true}}if(/MSIE (\d+(\.\d+)?)/.test(i)){hZ=parseFloat(RegExp.$1);if(hZ>=10){return true}}if(/Firefox/.test(i)){return true}if(/rv:11.0/ig.test(i)){return true}if(/edge/ig.test(i)){return true}}}return false};a8.ifSupportCSS3=function(h2,i){var h1=document.createElement("div");var h0="Webkit Moz O ms".split(" ");var e=h0.length;var T="";var hY=h1.style;if(h2 in hY){T=h2}h2=h2.replace(/^[a-z]/,function(h3){return h3.toUpperCase()});while(e--){var hZ=h0[e]+h2;if(hZ in hY){T=hZ;break}}if(i){return T}else{return T.length>0?true:false}};a8.isModernBrowser=a8.ifSupportCanvas2d()&&a8.ifSupportCSS3("transform");function e4(i,e){this._size=i;this._curSize=0;this._cache={};this._least=null;this._most=null;this._options={clearCallback:null,removeOldCallback:null};e=e||{};for(var T in e){this._options[T]=e[T]}this._getDataTimes=0;this._hitTimes=0}e4.prototype.setData=function(hY,h0){var i=this._cache;var T=this._size;if(T===0){return}var e=this._curSize;if(e===T){this._removeOld()}var hZ;if(!i[hY]){hZ={key:hY,data:h0,older:null,newwer:null};i[hY]=hZ;if(this._least===null){this._least=hZ}if(this._most===null){this._most=hZ}this._curSize++}else{hZ=i[hY];hZ.data=h0;if(this._most===hZ){return}hZ.older&&(hZ.older.newer=hZ.newer);hZ.newer&&(hZ.newer.older=hZ.older);if(this._least===hZ){this._least=hZ.newer}}if(this._most&&this._most!==hZ){this._most.newer=hZ;hZ.older=this._most;this._most=hZ;hZ.newer=null}};e4.prototype.getData=function(e){var i=this._cache[e];this._getDataTimes++;if(i){this._hitTimes++;var T=i.data;if(this._most===i){return T}i.older&&(i.older.newer=i.newer);i.newer&&(i.newer.older=i.older);if(this._least===i){this._least=i.newer}this._most.newer=i;i.older=this._most;i.newer=null;this._most=i;return T}return null};e4.prototype.getAllData=function(){return this._cache};e4.prototype.getHitRate=function(){return this._hitTimes/this._getDataTimes};e4.prototype.removeData=function(i){var e=this._cache;var T=e[i];if(!T){return}if(this._options.clearCallback){this._options.clearCallback(T.data,T.key)}T.older&&(T.older.newer=T.newer);T.newer&&(T.newer.older=T.older);if(this._least===T){this._least=T.newer}if(this._most===T){this._most=T.older}delete e[i];this._curSize--};e4.prototype._removeOld=function(){var e=this._cache;var hY=Math.round(this._size*0.6);var T=0;while(this._least&&T<hY){var i=this._least;this._least=i.newer;i.newer&&(i.newer.older=null);if(this._options.clearCallback){this._options.clearCallback(i.data,i.key)}delete e[i.key];T++}this._curSize-=T;if(this._options.removeOldCallback){this._options.removeOldCallback()}};e4.prototype.clear=function(){var e=this._cache;var i=this._least;if(this._options.clearCallback){while(i){this._options.clearCallback(i.data,i.key);i=i.newer}}this._least=this._most=null;this._cache={};this._curSize=0};e4.prototype.forEach=function(e){var i=this._least;while(i){e(i.data);i=i.newer}};e4.prototype.clearExcept=function(i){var e=this._cache;var T=this._least;while(T){if(!i[T.key]){if(this._options.clearCallback){this._options.clearCallback(T.data,T.key)}T.older&&(T.older.newer=T.newer);T.newer&&(T.newer.older=T.older);if(this._least===T){this._least=T.newer}if(this._most===T){this._most=T.older}delete e[T.key];this._curSize--}T=T.newer}};!function(T,i){"object"==typeof bo&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(T="undefined"!=typeof globalThis?globalThis:T||self).gcoord=i()}(this,(function(){
/* *****************************************************************************
        Copyright (c) Microsoft Corporation.

        Permission to use, copy, modify, and/or distribute this software for any
        purpose with or without fee is hereby granted.

        THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
        PERFORMANCE OF THIS SOFTWARE.
        ***************************************************************************** */
var iF=function(){return(iF=Object.assign||function(iK){for(var i,T=1,iM=arguments.length;T<iM;T++){for(var iL in i=arguments[T]){Object.prototype.hasOwnProperty.call(i,iL)&&(iK[iL]=i[iL])}}return iK}).apply(this,arguments)},ip=Math.sin,ir=Math.cos,iw=Math.sqrt,iv=Math.abs,iJ=Math.PI,iB=6378245,io=0.006693421622965823;function iE(T,i){return T>=72.004&&T<=137.8347&&i>=0.8293&&i<=55.8271}function iH(iM,iL){var iP,i,iR,T=(iR=300+(iP=iM-105)+2*(i=iL-35)+0.1*iP*iP+0.1*iP*i+0.1*iw(iv(iP)),iR+=2*(20*ip(6*iP*iJ)+20*ip(2*iP*iJ))/3,(iR+=2*(20*ip(iP*iJ)+40*ip(iP/3*iJ))/3)+2*(150*ip(iP/12*iJ)+300*ip(iP/30*iJ))/3),iK=function(iU,iT){var iS=2*iU-100+3*iT+0.2*iT*iT+0.1*iU*iT+0.2*iw(iv(iU));return iS+=2*(20*ip(6*iU*iJ)+20*ip(2*iU*iJ))/3,iS+=2*(20*ip(iT*iJ)+40*ip(iT/3*iJ))/3,iS+2*(160*ip(iT/12*iJ)+320*ip(iT*iJ/30))/3}(iM-105,iL-35),iO=iL/180*iJ,iN=ip(iO),iQ=iw(iN=1-io*iN*iN);return[T=180*T/(iB/iQ*ir(iO)*iJ),iK=180*iK/(iB*(1-io)/(iN*iQ)*iJ)]}function iy(iK){var i=iK[0],T=iK[1];if(!iE(i,T)){return[i,T]}var iL=iH(i,T);return[i+iL[0],T+iL[1]]}function iq(iM){var iQ=iM[0],T=iM[1];if(!iE(iQ,T)){return[iQ,T]}for(var iK=[iQ,T],iO=iK[0],iL=iK[1],iP=iy([iO,iL]),iN=iP[0]-iQ,iR=iP[1]-T;iv(iN)>0.000001||iv(iR)>0.000001;){iN=(iP=iy([iO-=iN,iL-=iR]))[0]-iQ,iR=iP[1]-T}return[iO,iL]}var iC=Math.sin,iD=Math.cos,h6=Math.atan2,iG=Math.sqrt,im=3000*Math.PI/180;function iu(iK){var i=iK[0]-0.0065,T=iK[1]-0.006,iM=iG(i*i+T*T)-0.00002*iC(T*im),iL=h6(T,i)-0.000003*iD(i*im);return[iM*iD(iL),iM*iC(iL)]}function ia(iK){var i=iK[0],T=iK[1],iM=iG(i*i+T*T)+0.00002*iC(T*im),iL=h6(T,i)+0.000003*iD(i*im);return[iM*iD(iL)+0.0065,iM*iC(iL)+0.006]}var ij=180/Math.PI,h1=Math.PI/180,h3=6378137,iI=20037508.342789244;function ig(i){return[i[0]*ij/h3,(0.5*Math.PI-2*Math.atan(Math.exp(-i[1]/h3)))*ij]}function ix(iK){var i=Math.abs(iK[0])<=180?iK[0]:iK[0]-360*(iK[0]<0?-1:1),T=[h3*i*h1,h3*Math.log(Math.tan(0.25*Math.PI+0.5*iK[1]*h1))];return T[0]>iI&&(T[0]=iI),T[0]<-iI&&(T[0]=-iI),T[1]>iI&&(T[1]=iI),T[1]<-iI&&(T[1]=-iI),T}var ie,id,ic,il,h9,hY,ik=Math.abs,iz=[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],h8=[75,60,45,30,15,0],h0=[[1.410526172116255e-8,0.00000898305509648872,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-0.03801003308653,17337981.2],[-7.435856389565537e-9,0.000008983055097726239,-0.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,0.00000898305509983578,0.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,0.32710905363475,6856817.37],[-1.981981304930552e-8,0.000008983055099779535,0.03278182852591,40.31678527705744,0.65659298677277,-4.44255534477492,0.85341911805263,0.12923347998204,-0.04625736007561,4482777.06],[3.09191371068437e-9,0.000008983055096812155,0.00006995724062,23.10934304144901,-0.00023663490511,-0.6321817810242,-0.00663494467273,0.03430082397953,-0.00466043876332,2555164.4],[2.890871144776878e-9,0.000008983055095805407,-3.068298e-8,7.47137025468032,-0.00000353937994,-0.02145144861037,-0.00001234426596,0.00010322952773,-0.00000323890364,826088.5]],iA=[[-0.0015702102444,111320.7020616939,1704480524535203,-10338987376042340,26112667856603880,-35149669176653700,26595700718403920,-10725012454188240,1800819912950474,82.5],[0.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[0.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[0.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-0.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-0.0003218135878613132,111320.7020701615,0.00369383431289,823725.6402795718,0.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,0.37238884252424,7.45]];function h7(iL,T,iK){var iN=ik(T)/iK[9],iM=iK[0]+iK[1]*ik(iL),i=iK[2]+iK[3]*iN+iK[4]*Math.pow(iN,2)+iK[5]*Math.pow(iN,3)+iK[6]*Math.pow(iN,4)+iK[7]*Math.pow(iN,5)+iK[8]*Math.pow(iN,6);return[iM*=iL<0?-1:1,i*=T<0?-1:1]}function it(iK){for(var i=iK[0],T=iK[1],iM=[],iL=0;iL<h8.length;iL++){if(ik(T)>h8[iL]){iM=iA[iL];break}}return h7(i,T,iM)}function h5(iK){for(var i=iK[0],T=iK[1],iM=[],iL=0;iL<iz.length;iL++){if(T>=iz[iL]){iM=h0[iL];break}}return h7(i,T,iM)}function h4(T,i){if(!T){throw new Error(i)}}function ih(i){return !!i&&"[object Array]"===Object.prototype.toString.call(i)}function ib(i){return !isNaN(Number(i))&&null!==i&&!ih(i)}function h2(){for(var iK=[],i=0;i<arguments.length;i++){iK[i]=arguments[i]}var T=iK.length-1;return function(){for(var iL=[],iN=0;iN<arguments.length;iN++){iL[iN]=arguments[iN]}for(var iM=T,e=iK[T].apply(null,iL);iM--;){e=iK[iM].call(null,e)}return e}}function hZ(i1,iQ,iS){if(void 0===iS&&(iS=!1),null!==i1){for(var iV,iU,i4,iX,iP,i0,i3,iW,iR=0,iY=0,iZ=i1.type,iL="FeatureCollection"===iZ,i2="Feature"===iZ,iO=iL?i1.features.length:1,iT=0;iT<iO;iT++){iP=(iW=!!(i3=iL?i1.features[iT].geometry:i2?i1.geometry:i1)&&"GeometryCollection"===i3.type)?i3.geometries.length:1;for(var iN=0;iN<iP;iN++){var iM=0,T=0;if(null!==(iX=iW?i3.geometries[iN]:i3)){var iK=iX.type;switch(iR=!iS||"Polygon"!==iK&&"MultiPolygon"!==iK?0:1,iK){case null:break;case"Point":if(!1===iQ(i0=iX.coordinates,iY,iT,iM,T)){return !1}iY++,iM++;break;case"LineString":case"MultiPoint":for(i0=iX.coordinates,iV=0;iV<i0.length;iV++){if(!1===iQ(i0[iV],iY,iT,iM,T)){return !1}iY++,"MultiPoint"===iK&&iM++}"LineString"===iK&&iM++;break;case"Polygon":case"MultiLineString":for(i0=iX.coordinates,iV=0;iV<i0.length;iV++){for(iU=0;iU<i0[iV].length-iR;iU++){if(!1===iQ(i0[iV][iU],iY,iT,iM,T)){return !1}iY++}"MultiLineString"===iK&&iM++,"Polygon"===iK&&T++}"Polygon"===iK&&iM++;break;case"MultiPolygon":for(i0=iX.coordinates,iV=0;iV<i0.length;iV++){for(T=0,iU=0;iU<i0[iV].length;iU++){for(i4=0;i4<i0[iV][iU].length-iR;i4++){if(!1===iQ(i0[iV][iU][i4],iY,iT,iM,T)){return !1}iY++}T++}iM++}break;case"GeometryCollection":for(iV=0;iV<iX.geometries.length;iV++){if(!1===hZ(iX.geometries[iV],iQ,iS)){return !1}}break;default:throw new Error("Unknown Geometry Type")}}}}}}!function(i){i.WGS84="WGS84",i.WGS1984="WGS84",i.EPSG4326="WGS84",i.GCJ02="GCJ02",i.AMap="GCJ02",i.BD09="BD09",i.BD09LL="BD09",i.Baidu="BD09",i.BMap="BD09",i.BD09MC="BD09MC",i.BD09Meter="BD09MC",i.EPSG3857="EPSG3857",i.EPSG900913="EPSG3857",i.EPSG102100="EPSG3857",i.WebMercator="EPSG3857",i.WM="EPSG3857"}(hY||(hY={}));var ii={WGS84:{to:(ie={},ie[hY.GCJ02]=iy,ie[hY.BD09]=h2(ia,iy),ie[hY.BD09MC]=h2(it,ia,iy),ie[hY.EPSG3857]=ix,ie)},GCJ02:{to:(id={},id[hY.WGS84]=iq,id[hY.BD09]=ia,id[hY.BD09MC]=h2(it,ia),id[hY.EPSG3857]=h2(ix,iq),id)},BD09:{to:(ic={},ic[hY.WGS84]=h2(iq,iu),ic[hY.GCJ02]=iu,ic[hY.EPSG3857]=h2(ix,iq,iu),ic[hY.BD09MC]=it,ic)},EPSG3857:{to:(il={},il[hY.WGS84]=ig,il[hY.GCJ02]=h2(iy,ig),il[hY.BD09]=h2(ia,iy,ig),il[hY.BD09MC]=h2(it,ia,iy,ig),il)},BD09MC:{to:(h9={},h9[hY.WGS84]=h2(iq,iu,h5),h9[hY.GCJ02]=h2(iu,h5),h9[hY.EPSG3857]=h2(ix,iq,iu,h5),h9[hY.BD09]=h5,h9)}};return iF(iF({},hY),{CRSTypes:hY,transform:function(iO,iM,iN){if(h4(!!iO,"The args[0] input coordinate is required"),h4(!!iM,"The args[1] original coordinate system is required"),h4(!!iN,"The args[2] target coordinate system is required"),iM===iN){return iO}var iQ=ii[iM];h4(!!iQ,"Invalid original coordinate system: "+iM);var iP=iQ.to[iN];h4(!!iP,"Invalid target coordinate system: "+iN);var T=typeof iO;if(h4("string"===T||"object"===T,"Invalid input coordinate type: "+T),"string"===T){try{iO=JSON.parse(iO)}catch(iM){throw new Error("Invalid input coordinate: "+iO)}}var iL=!1;ih(iO)&&(h4(iO.length>=2,"Invalid input coordinate: "+iO),h4(ib(iO[0])&&ib(iO[1]),"Invalid input coordinate: "+iO),iO=iO.map(Number),iL=!0);var iK=iP;return iL?iK(iO):(hZ(iO,(function(iR){var i;i=iK(iR),iR[0]=i[0],iR[1]=i[1]})),iO)}})}));var g6={ColorRefTable:{aliceblue:["#f0f8ff","rgb(240,248,255)"],antiquewhite:["#faebd7","rgb(250,235,215)"],aqua:["#00ffff","rgb(0,255,255)"],aquamarine:["#7fffd4","rgb(127,255,212)"],azure:["#f0ffff","rgb(240,255,255)"],beige:["#f5f5dc","rgb(245,245,220)"],bisque:["#ffe4c4","rgb(255,228,196)"],black:["#000000","rgb(0,0,0)"],blanchedalmond:["#ffebcd","rgb(255,235,205)"],blue:["#0000ff","rgb(0,0,255)"],blueviolet:["#8a2be2","rgb(138,43,226)"],brown:["#a52a2a","rgb(165,42,42)"],burlywood:["#deb887","rgb(222,184,135)"],cadetblue:["#5f9ea0","rgb(95,158,160)"],chartreuse:["#7fff00","rgb(127,255,0)"],chocolate:["#d2691e","rgb(210,105,30)"],coral:["#ff7f50","rgb(255,127,80)"],cornflowerblue:["#6495ed","rgb(100,149,237)"],cornsilk:["#fff8dc","rgb(255,248,220)"],crimson:["#dc143c","rgb(220,20,60)"],cyan:["#00ffff","rgb(0,255,255)"],darkblue:["#00008b","rgb(0,0,139)"],darkcyan:["#008b8b","rgb(0,139,139)"],darkgoldenrod:["#b8860b","rgb(184,134,11)"],darkgray:["#a9a9a9","rgb(169,169,169)"],darkgreen:["#006400","rgb(0,100,0)"],darkgrey:["#a9a9a9","rgb(169,169,169)"],darkkhaki:["#bdb76b","rgb(189,183,107)"],darkmagenta:["#8b008b","rgb(139,0,139)"],darkolivegreen:["#556b2f","rgb(85,107,47)"],darkorange:["#ff8c00","rgb(255,140,0)"],darkorchid:["#9932cc","rgb(153,50,204)"],darkred:["#8b0000","rgb(139,0,0)"],darksalmon:["#e9967a","rgb(233,150,122)"],darkseagreen:["#8fbc8f","rgb(143,188,143)"],darkslateblue:["#483d8b","rgb(72,61,139)"],darkslategray:["#2f4f4f","rgb(47,79,79)"],darkslategrey:["#2f4f4f","rgb(47,79,79)"],darkturquoise:["#00ced1","rgb(0,206,209)"],darkviolet:["#9400d3","rgb(148,0,211)"],deeppink:["#ff1493","rgb(255,20,147)"],deepskyblue:["#00bfff","rgb(0,191,255)"],dimgray:["#696969","rgb(105,105,105)"],dimgrey:["#696969","rgb(105,105,105)"],dodgerblue:["#1e90ff","rgb(30,144,255)"],firebrick:["#b22222","rgb(178,34,34)"],floralwhite:["#fffaf0","rgb(255,250,240)"],forestgreen:["#228b22","rgb(34,139,34)"],fuchsia:["#ff00ff","rgb(255,0,255)"],gainsboro:["#dcdcdc","rgb(220,220,220)"],ghostwhite:["#f8f8ff","rgb(248,248,255)"],gold:["#ffd700","rgb(255,215,0)"],goldenrod:["#daa520","rgb(218,165,32)"],gray:["#808080","rgb(128,128,128)"],green:["#008000","rgb(0,128,0)"],greenyellow:["#adff2f","rgb(173,255,47)"],grey:["#808080","rgb(128,128,128)"],honeydew:["#f0fff0","rgb(240,255,240)"],hotpink:["#ff69b4","rgb(255,105,180)"],indianred:["#cd5c5c","rgb(205,92,92)"],indigo:["#4b0082","rgb(75,0,130)"],ivory:["#fffff0","rgb(255,255,240)"],khaki:["#f0e68c","rgb(240,230,140)"],lavender:["#e6e6fa","rgb(230,230,250)"],lavenderblush:["#fff0f5","rgb(255,240,245)"],lawngreen:["#7cfc00","rgb(124,252,0)"],lemonchiffon:["#fffacd","rgb(255,250,205)"],lightblue:["#add8e6","rgb(173,216,230)"],lightcoral:["#f08080","rgb(240,128,128)"],lightcyan:["#e0ffff","rgb(224,255,255)"],lightgoldenrodyellow:["#fafad2","rgb(250,250,210)"],lightgray:["#d3d3d3","rgb(211,211,211)"],lightgreen:["#90ee90","rgb(144,238,144)"],lightgrey:["#d3d3d3","rgb(211,211,211)"],lightpink:["#ffb6c1","rgb(255,182,193)"],lightsalmon:["#ffa07a","rgb(255,160,122)"],lightseagreen:["#20b2aa","rgb(32,178,170)"],lightskyblue:["#87cefa","rgb(135,206,250)"],lightslategray:["#778899","rgb(119,136,153)"],lightslategrey:["#778899","rgb(119,136,153)"],lightsteelblue:["#b0c4de","rgb(176,196,222)"],lightyellow:["#ffffe0","rgb(255,255,224)"],lime:["#00ff00","rgb(0,255,0)"],limegreen:["#32cd32","rgb(50,205,50)"],linen:["#faf0e6","rgb(250,240,230)"],magenta:["#ff00ff","rgb(255,0,255)"],maroon:["#800000","rgb(128,0,0)"],mediumaquamarine:["#66cdaa","rgb(102,205,170)"],mediumblue:["#0000cd","rgb(0,0,205)"],mediumorchid:["#ba55d3","rgb(186,85,211)"],mediumpurple:["#9370db","rgb(147,112,219)"],mediumseagreen:["#3cb371","rgb(60,179,113)"],mediumslateblue:["#7b68ee","rgb(123,104,238)"],mediumspringgreen:["#00fa9a","rgb(0,250,154)"],mediumturquoise:["#48d1cc","rgb(72,209,204)"],mediumvioletred:["#c71585","rgb(199,21,133)"],midnightblue:["#191970","rgb(25,25,112)"],mintcream:["#f5fffa","rgb(245,255,250)"],mistyrose:["#ffe4e1","rgb(255,228,225)"],moccasin:["#ffe4b5","rgb(255,228,181)"],navajowhite:["#ffdead","rgb(255,222,173)"],navy:["#000080","rgb(0,0,128)"],oldlace:["#fdf5e6","rgb(253,245,230)"],olive:["#808000","rgb(128,128,0)"],olivedrab:["#6b8e23","rgb(107,142,35)"],orange:["#ffa500","rgb(255,165,0)"],orangered:["#ff4500","rgb(255,69,0)"],orchid:["#da70d6","rgb(218,112,214)"],palegoldenrod:["#eee8aa","rgb(238,232,170)"],palegreen:["#98fb98","rgb(152,251,152)"],paleturquoise:["#afeeee","rgb(175,238,238)"],palevioletred:["#db7093","rgb(219,112,147)"],papayawhip:["#ffefd5","rgb(255,239,213)"],peachpuff:["#ffdab9","rgb(255,218,185)"],peru:["#cd853f","rgb(205,133,63)"],pink:["#ffc0cb","rgb(255,192,203)"],plum:["#dda0dd","rgb(221,160,221)"],powderblue:["#b0e0e6","rgb(176,224,230)"],purple:["#800080","rgb(128,0,128)"],red:["#ff0000","rgb(255,0,0)"],rosybrown:["#bc8f8f","rgb(188,143,143)"],royalblue:["#4169e1","rgb(65,105,225)"],saddlebrown:["#8b4513","rgb(139,69,19)"],salmon:["#fa8072","rgb(250,128,114)"],sandybrown:["#f4a460","rgb(244,164,96)"],seagreen:["#2e8b57","rgb(46,139,87)"],seashell:["#fff5ee","rgb(255,245,238)"],sienna:["#a0522d","rgb(160,82,45)"],silver:["#c0c0c0","rgb(192,192,192)"],skyblue:["#87ceeb","rgb(135,206,235)"],slateblue:["#6a5acd","rgb(106,90,205)"],slategray:["#708090","rgb(112,128,144)"],slategrey:["#708090","rgb(112,128,144)"],snow:["#fffafa","rgb(255,250,250)"],springgreen:["#00ff7f","rgb(0,255,127)"],steelblue:["#4682b4","rgb(70,130,180)"],tan:["#d2b48c","rgb(210,180,140)"],teal:["#008080","rgb(0,128,128)"],thistle:["#d8bfd8","rgb(216,191,216)"],tomato:["#ff6347","rgb(255,99,71)"],turquoise:["#40e0d0","rgb(64,224,208)"],violet:["#ee82ee","rgb(238,130,238)"],wheat:["#f5deb3","rgb(245,222,179)"],white:["#ffffff","rgb(255,255,255)"],whitesmoke:["#f5f5f5","rgb(245,245,245)"],yellow:["#ffff00","rgb(255,255,0)"],yellowgreen:["#9acd32","rgb(154,205,50)"]},parseHexToRgbaArray:function(h0){var h1=h0.replace("#","");if(h1.length===3){h1+="f"}else{if(h1.length===6){h1+="ff"}}var e=[];var hZ=h1.length;var hY=hZ===8?2:1;for(var T=0;T<hZ;T=T+hY){if(hY===2){e.push(parseInt(h1.slice(T,T+2),16))}else{e.push(parseInt(h1.slice(T,T+1)+h1.slice(T,T+1),16))}}return e},parseRgbaStrToArray:function(i){var e=[0,0,0,255];if(i.indexOf("rgba(")===0){var hY=i.replace("rgba(","").replace(")","");var T=hY.split(",");e[0]=parseInt(T[0],10);e[1]=parseInt(T[1],10);e[2]=parseInt(T[2],10);e[3]=Math.round(parseFloat(T[3])*255)}else{if(i.indexOf("rgb(")===0){var hY=i.replace("rgb(","").replace(")","");var hZ=hY.split(",");e[0]=parseInt(hZ[0],10);e[1]=parseInt(hZ[1],10);e[2]=parseInt(hZ[2],10);e[3]=255}}return e},parseHexAndOpacityToRgbaArray:function(hZ,h0){var T=[];var h3=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;var h2=hZ.toLowerCase();if(h3.test(h2)){if(h2.length===4){var e="#";for(var h1=1;h1<4;h1++){e+=h2.slice(h1,h1+1).concat(h2.slice(h1,h1+1))}h2=e}for(var hY=1;hY<7;hY+=2){T.push(parseInt(h2.slice(hY,hY+2),16))}T.push(h0)}return T},parseCSSColor:function(e){if(e.indexOf("#")===0){return g6.parseHexToRgbaArray(e)}return g6.parseRgbaStrToArray(e)},rgbToHSV:function(hZ){var e=hZ[0]/255;var T=hZ[1]/255;var h0=hZ[2]/255;var h3=Math.max(e,T,h0);var hY=Math.min(e,T,h0);var h2=h3-hY;var i;if(h2===0){i=0}else{if(h3===e){i=60*(((T-h0)/h2)%6)}else{if(h3===T){i=60*((h0-e)/h2+2)}else{if(h3===h0){i=60*((e-T)/h2+4)}}}}var h4=h3===0?0:(h2/h3);var h1=h3;while(i<0){i+=360}return[i,h4,h1]},hsvToRGB:function(hY){var h2=hY[2]*hY[1];var T=h2*(1-Math.abs((hY[0]/60)%2-1));var i=hY[2]-h2;var hZ=hY[0];var h1;var h0;var e;if(hZ>=0&&hZ<60){h1=h2;h0=T;e=0}else{if(hZ>=60&&hZ<120){h1=T;h0=h2;e=0}else{if(hZ>=120&&hZ<180){h1=0;h0=h2;e=T}else{if(hZ>=180&&hZ<240){h1=0;h0=T;e=h2}else{if(hZ>=240&&hZ<300){h1=T;h0=0;e=h2}else{if(hZ>=300&&hZ<360){h1=h2;h0=0;e=T}}}}}}h1=(h1+i)*255>255?255:(h1+i)*255;h0=(h0+i)*255>255?255:(h0+i)*255;e=(e+i)*255>255?255:(e+i)*255;return[Math.round(h1),Math.round(h0),Math.round(e)]},formatColorCssToRgbaArray:function(h0,T,hY){hY=(typeof hY!=="boolean")?true:hY;if(typeof h0!=="string"){return hY?[0,0,0,1]:[0,0,0,255]}var i=(h0||"Black").trim().toLowerCase();var e=[];var hZ=g6.ColorRefTable[i];if(hZ!==undefined){i=hZ[0]}e=g6.parseCSSColor(i);if(T!==undefined&&!isNaN(Number(T))){T=Number(T);e[3]=g6.fitTo(T,0,1)}else{e[3]=Number((e[3]/255).toFixed(2))}if(!hY){e[3]=Math.floor(e[3]*255)}return e},fitTo:function(T,i,e){if(T<i){T=i}else{if(T>e){T=e}}return T}};(function(h0){function ia(ig,ij){var ii=(ig&65535)+(ij&65535);var ih=(ig>>16)+(ij>>16)+(ii>>16);return(ih<<16)|(ii&65535)}function h9(ig,ih){return(ig<<ih)|(ig>>>(32-ih))}function h4(il,ii,ih,ig,ik,ij){return ia(h9(ia(ia(ii,il),ia(ig,ij)),ik),ih)}function e(ii,ih,im,il,ig,ik,ij){return h4((ih&im)|(~ih&il),ii,ih,ig,ik,ij)}function h1(ii,ih,im,il,ig,ik,ij){return h4((ih&il)|(im&~il),ii,ih,ig,ik,ij)}function h7(ii,ih,im,il,ig,ik,ij){return h4(ih^im^il,ii,ih,ig,ik,ij)}function id(ii,ih,im,il,ig,ik,ij){return h4(im^(ih|~il),ii,ih,ig,ik,ij)}function T(ir,il){ir[il>>5]|=128<<(il%32);ir[((il+64)>>>9<<4)+14]=il;var ii;var ik;var ij;var ih;var ig;var iq=1732584193;var ip=-271733879;var io=-1732584194;var im=271733878;for(ii=0;ii<ir.length;ii+=16){ik=iq;ij=ip;ih=io;ig=im;iq=e(iq,ip,io,im,ir[ii],7,-680876936);im=e(im,iq,ip,io,ir[ii+1],12,-389564586);io=e(io,im,iq,ip,ir[ii+2],17,606105819);ip=e(ip,io,im,iq,ir[ii+3],22,-1044525330);iq=e(iq,ip,io,im,ir[ii+4],7,-176418897);im=e(im,iq,ip,io,ir[ii+5],12,1200080426);io=e(io,im,iq,ip,ir[ii+6],17,-1473231341);ip=e(ip,io,im,iq,ir[ii+7],22,-45705983);iq=e(iq,ip,io,im,ir[ii+8],7,1770035416);im=e(im,iq,ip,io,ir[ii+9],12,-1958414417);io=e(io,im,iq,ip,ir[ii+10],17,-42063);ip=e(ip,io,im,iq,ir[ii+11],22,-1990404162);iq=e(iq,ip,io,im,ir[ii+12],7,1804603682);im=e(im,iq,ip,io,ir[ii+13],12,-40341101);io=e(io,im,iq,ip,ir[ii+14],17,-1502002290);ip=e(ip,io,im,iq,ir[ii+15],22,1236535329);iq=h1(iq,ip,io,im,ir[ii+1],5,-165796510);im=h1(im,iq,ip,io,ir[ii+6],9,-1069501632);io=h1(io,im,iq,ip,ir[ii+11],14,643717713);ip=h1(ip,io,im,iq,ir[ii],20,-373897302);iq=h1(iq,ip,io,im,ir[ii+5],5,-701558691);im=h1(im,iq,ip,io,ir[ii+10],9,38016083);io=h1(io,im,iq,ip,ir[ii+15],14,-660478335);ip=h1(ip,io,im,iq,ir[ii+4],20,-405537848);iq=h1(iq,ip,io,im,ir[ii+9],5,568446438);im=h1(im,iq,ip,io,ir[ii+14],9,-1019803690);io=h1(io,im,iq,ip,ir[ii+3],14,-187363961);ip=h1(ip,io,im,iq,ir[ii+8],20,1163531501);iq=h1(iq,ip,io,im,ir[ii+13],5,-1444681467);im=h1(im,iq,ip,io,ir[ii+2],9,-51403784);io=h1(io,im,iq,ip,ir[ii+7],14,1735328473);ip=h1(ip,io,im,iq,ir[ii+12],20,-1926607734);iq=h7(iq,ip,io,im,ir[ii+5],4,-378558);im=h7(im,iq,ip,io,ir[ii+8],11,-2022574463);io=h7(io,im,iq,ip,ir[ii+11],16,1839030562);ip=h7(ip,io,im,iq,ir[ii+14],23,-35309556);iq=h7(iq,ip,io,im,ir[ii+1],4,-1530992060);im=h7(im,iq,ip,io,ir[ii+4],11,1272893353);io=h7(io,im,iq,ip,ir[ii+7],16,-155497632);ip=h7(ip,io,im,iq,ir[ii+10],23,-1094730640);iq=h7(iq,ip,io,im,ir[ii+13],4,681279174);im=h7(im,iq,ip,io,ir[ii],11,-358537222);io=h7(io,im,iq,ip,ir[ii+3],16,-722521979);ip=h7(ip,io,im,iq,ir[ii+6],23,76029189);iq=h7(iq,ip,io,im,ir[ii+9],4,-640364487);im=h7(im,iq,ip,io,ir[ii+12],11,-421815835);io=h7(io,im,iq,ip,ir[ii+15],16,530742520);ip=h7(ip,io,im,iq,ir[ii+2],23,-995338651);iq=id(iq,ip,io,im,ir[ii],6,-198630844);im=id(im,iq,ip,io,ir[ii+7],10,1126891415);io=id(io,im,iq,ip,ir[ii+14],15,-1416354905);ip=id(ip,io,im,iq,ir[ii+5],21,-57434055);iq=id(iq,ip,io,im,ir[ii+12],6,1700485571);im=id(im,iq,ip,io,ir[ii+3],10,-1894986606);io=id(io,im,iq,ip,ir[ii+10],15,-1051523);ip=id(ip,io,im,iq,ir[ii+1],21,-2054922799);iq=id(iq,ip,io,im,ir[ii+8],6,1873313359);im=id(im,iq,ip,io,ir[ii+15],10,-30611744);io=id(io,im,iq,ip,ir[ii+6],15,-1560198380);ip=id(ip,io,im,iq,ir[ii+13],21,1309151649);iq=id(iq,ip,io,im,ir[ii+4],6,-145523070);im=id(im,iq,ip,io,ir[ii+11],10,-1120210379);io=id(io,im,iq,ip,ir[ii+2],15,718787259);ip=id(ip,io,im,iq,ir[ii+9],21,-343485551);iq=ia(iq,ik);ip=ia(ip,ij);io=ia(io,ih);im=ia(im,ig)}return[iq,ip,io,im]}function h8(ih){var ii;var ig="";var ij=ih.length*32;for(ii=0;ii<ij;ii+=8){ig+=String.fromCharCode((ih[ii>>5]>>>(ii%32))&255)}return ig}function h3(ih){var ij;var ig=[];ig[(ih.length>>2)-1]=undefined;for(ij=0;ij<ig.length;ij+=1){ig[ij]=0}var ii=ih.length*8;for(ij=0;ij<ii;ij+=8){ig[ij>>5]|=(ih.charCodeAt(ij/8)&255)<<(ij%32)}return ig}function h2(ig){return h8(T(h3(ig),ig.length*8))}function ie(ii,il){var ih;var ik=h3(ii);var ig=[];var ij=[];var im;ig[15]=ij[15]=undefined;if(ik.length>16){ik=T(ik,ii.length*8)}for(ih=0;ih<16;ih+=1){ig[ih]=ik[ih]^909522486;ij[ih]=ik[ih]^1549556828}im=T(ig.concat(h3(il)),512+il.length*8);return h8(T(ij.concat(im),512+128))}function ic(ij){var ii="0123456789abcdef";var ih="";var ig;var ik;for(ik=0;ik<ij.length;ik+=1){ig=ij.charCodeAt(ik);ih+=ii.charAt((ig>>>4)&15)+ii.charAt(ig&15)}return ih}function h5(ig){return unescape(encodeURIComponent(ig))}function hY(ig){return h2(h5(ig))}function h6(ig){return ic(hY(ig))}function i(ig,ih){return ie(h5(ig),h5(ih))}function ib(ig,ih){return ic(i(ig,ih))}function hZ(ih,ii,ig){if(!ii){if(!ig){return h6(ih)}return hY(ih)}if(!ig){return ib(ii,ih)}return i(ii,ih)}if(typeof define==="function"&&define.amd){define(function(){return hZ})}else{if(typeof module==="object"&&module.exports){module.exports=hZ}else{h0.md5=hZ}}})(this);var cB={request:function(h7,ia,h3,h4,h8){var h2=new Date().getTime();var hZ=(Math.random()*100000).toFixed(0);bo._rd["_cbk"+hZ]=function(ig){if(ig.result&&ig.result["error"]&&ig.result["error"]===202){alert("该AK因为恶意行为已经被管理员封禁！");return}h3=h3||{};h7&&h7(ig,h3);delete bo._rd["_cbk"+hZ]};h4=h4||"";var h9;var h5;if(h3&&h3.useEncodeURI){h9=hq(ia,encodeURI);h5=hq(ia)}else{h9=hq(ia,encodeURIComponent);h5=hq(ia)}var ie=this;var T=e8.apiHost+"/"+h4+"?"+h9+"&ie=utf-8&oue=1&fromproduct=jsapi";var e=e8.apiHost+"/"+h4+"?"+h5+"&ie=utf-8&oue=1&fromproduct=jsapi";if(!h8){T+="&res=api";e+="&res=api"}T+="&callback="+eF+"._rd._cbk"+hZ;e+="&callback="+eF+"._rd._cbk"+hZ;var i=window.___abvk?window.___abvk:this.getSeckeyCidItem("SECKEY_ABVK");var h1=this.getSeckeyCidItem("BMAP_SECKEY");var ib=encodeURIComponent(i+","+h1);var h0=i+","+h1;T+="&ak="+gk+"&v=gl&seckey="+ib+"&timeStamp="+h2;e+="&ak="+gk+"&v=gl&seckey="+h0+"&timeStamp="+h2;var id="F5L2O6R6AD8990O";var ic="H0A9P8P7Y6ABQO0";var hY=e.substr(e.indexOf("?")+1);var h6=md5(md5(hY+id)+ic);T+="&sn="+h6.substring(h6.length-12);ht.load(T)},getSeckeyCidItem:function(i){if(navigator.cookieEnabled){var T=new RegExp("(^| )"+i+"=([^;]*)(;|$)");var e=document.cookie.match(T);if(e){return unescape(e[2])}return -1}if(localStorage){return localStorage.getItem(i)?localStorage.getItem(i):-1}if(sessionStorage){return sessionStorage.getItem(i)?localStorage.getItem(i):-1}}};window.srqtimer=null;window.firstTime=true;window.srqcount=0;bo._rd={};var D={request:function(h1,e){if(e){var h0=(Math.random()*100000).toFixed(0);BMapGL._rd["_cbk"+h0]=function(h3){e&&e(h3);delete BMapGL._rd["_cbk"+h0]};h1+="&callback=BMapGL._rd._cbk"+h0}function hZ(h4){var h3;var h5=new RegExp("(^| )"+h4+"=([^;]*)(;|$)");if(h3=document.cookie.match(h5)){return unescape(h3[2])}else{return -1}}var T=window.___abvk?window.___abvk:this.getSeckeyCidItem("SECKEY_ABVK");var h2=this.getSeckeyCidItem("BMAP_SECKEY");var i=encodeURIComponent(T+","+h2);h1+="&seckey="+i;var hY=S("script",{src:h1,type:"text/javascript",charset:"utf-8"});if(hY.addEventListener){hY.addEventListener("load",function(h4){var h3=h4.target;h3.parentNode.removeChild(h3)},false);hY.addEventListener("error",function(h3){e&&e([,,,,,])},false)}else{if(hY.attachEvent){hY.attachEvent("onreadystatechange",function(h4){var h3=window.event.srcElement;if(h3&&(h3.readyState=="loaded"||h3.readyState=="complete")){h3.parentNode.removeChild(h3)}})}}document.getElementsByTagName("head")[0].appendChild(hY);hY=null},getSeckeyCidItem:function(i){if(navigator.cookieEnabled){var T=new RegExp("(^| )"+i+"=([^;]*)(;|$)");var e=document.cookie.match(T);if(e){return unescape(e[2])}return -1}if(localStorage){return localStorage.getItem(i)?localStorage.getItem(i):-1}if(sessionStorage){return sessionStorage.getItem(i)?localStorage.getItem(i):-1}}};function a7(){this._map=null;this._container;this._type="control";this.blockInfoWindow=true;this._visible=true}a7.inherits(eg,"Control");C.extend(a7.prototype,{initialize:function(e){this._map=e;if(this._container){if(this._opts&&this._opts.container){this._opts.container.appendChild(this._container)}else{e.container.appendChild(this._container)}return this._container}return},_i:function(e){if(!this._container&&this.initialize&&bV(this.initialize)){this._container=this.initialize(e)}this._opts=this._opts||{printable:false};this._setStyle();this._setPosition();if(this._container){this._container._jsobj=this}},_setStyle:function(){var i=this._container;if(i){var e=i.style;e.position="absolute";e.zIndex=this._cZIndex||"10";e.MozUserSelect="none";if(!this._opts.printable){C.ac(i,"BMap_noprint")}C.on(i,"contextmenu",db)}},remove:function(){this._map=null;if(!this._container){return}this._container.parentNode&&this._container.parentNode.removeChild(this._container);this._container._jsobj=null;this._container=null},_render:function(e){if(this._opts&&this._opts.container){this._container=dI(this._opts.container,'<div unselectable="on"></div>')}else{var i='<div unselectable="on"></div>';if(e&&e.config.autoSafeArea&&bv()){this._safeAreaContainer=dI(this._map.container,i);this._safeAreaContainer.style.position="absolute";this._safeAreaContainer.style.bottom="env(safe-area-inset-bottom)";this._container=dI(this._safeAreaContainer,i)}else{this._container=dI(this._map.container,i)}}if(this._visible===false){this._container.style.display="none"}return this._container},_setPosition:function(){this.setAnchor(this._opts.anchor)},setAnchor:function(hY){if(this.anchorFixed||typeof hY!=="number"||isNaN(hY)||hY<BMAP_ANCHOR_TOP_LEFT||hY>BMAP_ANCHOR_BOTTOM_RIGHT){hY=this.defaultAnchor}this._opts.offset=this._opts.offset||this.defaultOffset;var T=this._opts.anchor;this._opts.anchor=hY;if(!this._container){return}var h0=this._container;var e=this._opts.offset.width;var hZ=this._opts.offset.height;h0.style.left=h0.style.top=h0.style.right=h0.style.bottom="auto";switch(hY){case BMAP_ANCHOR_TOP_LEFT:h0.style.top=hZ+"px";h0.style.left=e+"px";break;case BMAP_ANCHOR_TOP_RIGHT:h0.style.top=hZ+"px";h0.style.right=e+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:h0.style.bottom=hZ+"px";h0.style.left=e+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:h0.style.bottom=hZ+"px";h0.style.right=e+"px";break;default:break}var i=["TL","TR","BL","BR"];C.rc(this._container,"anchor"+i[T]);C.ac(this._container,"anchor"+i[hY])},getAnchor:function(){return this._opts.anchor},setOffset:function(e){if(!e){return}this._opts=this._opts||{};this._opts.offset=new ec(e.width,e.height);if(!this._container){return}this.setAnchor(this._opts.anchor)},getOffset:function(){return this._opts.offset},getDom:function(){return this._container},show:function(){if(this._visible===true){return}this._visible=true;if(this._container){this._container.style.display=""}this.dispatchEvent(new bb("onshow"))},hide:function(){if(this._visible===false){return}this._visible=false;if(this._container){this._container.style.display="none"}this.dispatchEvent(new bb("onhide"))},isPrintable:function(){return !!this._opts.printable},isVisible:function(){if(!this._container&&!this._map){return false}return !!this._visible},_asyncLoadCode:function(){var e=this;ed.load("control",function(){if(e._asyncDraw){e._asyncDraw()}})}});var hK={TOP_LEFT:0,TOP_RIGHT:1,BOTTOM_LEFT:2,BOTTOM_RIGHT:3};bo.ControlAnchor=hK;window.BMAP_ANCHOR_TOP_LEFT=0;window.BMAP_ANCHOR_TOP_RIGHT=1;window.BMAP_ANCHOR_BOTTOM_LEFT=2;window.BMAP_ANCHOR_BOTTOM_RIGHT=3;function dH(e){a7.call(this);e=e||{};this._opts={printable:false};C.extend(this._opts,e);this._copyrightCollection=[];this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new ec(5,2);this.setAnchor(e.anchor);this._canShow=true;this.sateMapStyle=false;this.blockInfoWindow=false;this._asyncLoadCode()}dH.inherits(a7,"CopyrightControl");C.extend(dH.prototype,{initialize:function(e){this._map=e;return this._container},addCopyright:function(hY){var e={minZoom:0,bounds:null,content:"",mapType:""};for(var T in hY){e[T]=hY[T]}if(this._map){var h1=e.minZoom;if(h1===-1||h1<this._map.getMinZoom()||h1>this._map.getMaxZoom()){e.minZoom=this._map.getMinZoom()}if(e.mapType!==""&&!b6[e.mapType]){e.mapType=BMAPGL_NORMAL_MAP}}var hZ=this.getCopyright(hY.id);if(hZ){for(var h0 in e){hZ[h0]=e[h0]}}else{this._copyrightCollection.push(e)}},getCopyright:function(hY){for(var T=0,e=this._copyrightCollection.length;T<e;T++){if(this._copyrightCollection[T].id===hY){return this._copyrightCollection[T]}}},addSateMapStyle:function(){this.sateMapStyle=true;if(this._container){C.ac(this._container,"BMap_cpyCtrl_w")}},removeSateMapStyle:function(){this.sateMapStyle=false;if(this._container){C.rc(this._container,"BMap_cpyCtrl_w")}}});function ee(e){a7.call(this);e=e||{};this.canCheckSize=e.canCheckSize===false?false:true;this.curCityName="";this.curCityCode="";this.defaultOffset=new ec(10,10);this.defaultAnchor=hK.TOP_LEFT;this.onChangeBefore=[];this.onChangeAfter=[];this.onChangeSuccess=[];this._opts={printable:false,offset:e.offset||this.defaultOffset,anchor:e.anchor||this.defaultAnchor,expand:!!(e.expand)};if(e.onChangeBefore&&bV(e.onChangeBefore)){this.onChangeBefore.push(e.onChangeBefore)}if(e.onChangeAfter&&bV(e.onChangeAfter)){this.onChangeAfter.push(e.onChangeAfter)}if(e.onChangeSuccess&&bV(e.onChangeSuccess)){this.onChangeSuccess.push(e.onChangeSuccess)}this.setAnchor(e.anchor);this._asyncLoadCode()}ee.inherits(a7,"CityListControl");C.extend(ee.prototype,{initialize:function(e){this._map=e;return this._container}});function ho(e){a7.call(this);e=e||{};this._opts={printable:false};this._opts=C.extend(C.extend(this._opts,{unit:"metric"}),e);this.defaultAnchor=BMAP_ANCHOR_BOTTOM_LEFT;this.defaultOffset=new ec(81,18);if(gb()){this.defaultOffset=new ec(75,10)}this.setAnchor(e.anchor);this._units={metric:{name:"metric",conv:1,incon:1000,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5280,u1:"英尺",u2:"英里"}};this.sateMapStyle=false;if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._scaleText=null;this._numberArray={};this._asyncLoadCode()}window.BMAP_UNIT_METRIC="metric";window.BMAP_UNIT_IMPERIAL="us";ho.inherits(a7,"ScaleControl");C.extend(ho.prototype,{initialize:function(e){this._map=e;return this._container},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit},getUnit:function(){return this._opts.unit},addSateMapStyle:function(){this.sateMapStyle=true;var e=this._container;if(e){C.ac(e.children[0],"dark")}},removeSateMapStyle:function(){this.sateMapStyle=false;var e=this._container;if(e){C.rc(e.children[0],"dark")}}});window.BMAP_NAVIGATION_CONTROL_LARGE=0;window.BMAP_NAVIGATION_CONTROL_SMALL=1;window.BMAP_NAVIGATION_CONTROL_PAN=2;window.BMAP_NAVIGATION_CONTROL_ZOOM=3;window.BMAP_NAVIGATION_CONTROL_ANIM=4;function dt(e){a7.call(this);e=e||{};this._opts={printable:false};C.extend(this._opts,e);this.controlHeight=[{width:65,height:227,zoomHeight:227,zoomWidth:37,sliderHeight:180},{width:65,height:47,zoomHeight:(this._opts.forceNew===true)?56:47,zoomWidth:37,sliderHeight:0},{width:37,height:57,zoomHeight:0,zoomWidth:0,sliderHeight:0},{width:26,height:56,zoomHeight:56,zoomWidth:6,sliderHeight:0},{width:56,height:47,zoomHeight:47,zoomWidth:37,sliderHeight:180}];this.defaultAnchor=BMAP_ANCHOR_TOP_LEFT;this.defaultOffset=new ec(10,10);this.setAnchor(e.anchor);this.setType(e.type);this._maxTotalZoomLv=19;this._minZoomLevel=-1;this._maxZoomLevel=-1;this._totalZoomLv=-1;this._sliderInterval=10;this._sliderHeight=180;this._minBarY=1;this._maxBarY=-1;this._curBarY=-1;this._zoomDom=null;this._zoomBtnDom=null;this._sliderDom=null;this._sliderBaseDom=null;this._cZIndex="1100";this._asyncLoadCode()}dt.inherits(a7,"NavigationControl");C.extend(dt.prototype,{initialize:function(e){this._map=e;return this._container},setType:function(e){if(typeof e=="number"&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&e<=BMAP_NAVIGATION_CONTROL_ANIM){this._opts.type=e}else{this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE}},getType:function(){return this._opts.type}});function bC(i){a7.call(this);i=i||{};this._opts={printable:false};this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT;this.defaultOffset=new ec(10,10);this.setAnchor(i.anchor);this._opts=C.extend(C.extend(this._opts,{offset:this.defaultOffset,enableSwitch:true}),i);var e=this;ed.load("control",function(){e._asyncDraw()})}bC.inherits(a7,"MapTypeControl");C.extend(bC.prototype,{initialize:function(e){this._map=e;return this._container},showStreetLayer:function(e){this._map.showStreetLayer(e)}});function cy(e){a7.call(this);e=e||{};this._opts={};this._opts=C.extend(this._opts,e);this._zoomInDisabled=false;this._zoomOutDisabled=false;this._zoomInTapped=false;this._zoomOutTapped=false;this.defaultAnchor=hK.BOTTOM_RIGHT;this.defaultOffset=new ec(15,20);this.setAnchor(e.anchor);this._asyncLoadCode()}cy.inherits(a7,"ZoomControl");C.extend(cy.prototype,{initialize:function(e){this._map=e;return this._container}});function bA(e){a7.call(this);e=e||{};this._opts={autoZoom:true,autoViewport:true};this._opts=C.extend(this._opts,e);this.defaultAnchor=hK.BOTTOM_LEFT;this.defaultOffset=new ec(10,50);this.watchPosition=this._opts.watchPosition||false;this.useCompass=this._opts.useCompass||false;this.locMarker=null;this.locLevel=16;this.setAnchor(this._opts.anchor);this.onLocationStart=e.onLocationStart||null;this._asyncLoadCode()}bA.inherits(a7,"LocationControl");C.extend(bA.prototype,{initialize:function(e){this._map=e;return this._container},startLocation:function(){this._startLocationCalled=true},stopLocationTrace:function(){},setOptions:function(e){e=e||{};C.extend(this._opts,e)}});function af(e){a7.call(this);e=e||{};this._opts={};this._opts=C.extend(this._opts,e);this.defaultAnchor=hK.BOTTOM_LEFT;this.defaultOffset=new ec(5,15);if(gb()){this.defaultOffset=new ec(10,10)}this.setAnchor(e.anchor)}af.inherits(a7,"LogoControl");C.extend(af.prototype,{initialize:function(i){this._map=i;var e=this._container=document.createElement("div");e.innerHTML='<img src="'+e8.apiHost+'/images/logo_hd.png"  style="height:21px;width:62px;"/>';i.getContainer().appendChild(e);return e}});function gH(e,i){this._map=e;this._indoorInfo=i;this._visible=true;this._adjustVisible=true;this._isMobile=gb();this._sizeConfig={FLOOR_BTN_HEIGHT:this._isMobile?35:26,SWITCH_ARROW_HEIGHT:this._isMobile?20:15};this._init()}gH.prototype._init=function(){this._render();this._bindDom();this._bind();this._adjustDisplayHeight();var e=new bb("onindoor_bar_show");e.uid=this._indoorInfo.uid;this._map.dispatchEvent(e)};gH.prototype._render=function(){if(!this._indoorInfo){return}var h2=this._isMobile;var e=this._div=S("div");C.ac(e,"floor-select-container");h2&&C.ac(e,"mobile");h2&&C.ac(e,"all-border-radius");var i=this._btnTop=S("button");C.ac(i,"floor-switch-top");C.ac(i,"top-border-radius");var h0=S("div");C.ac(h0,"floor-switch-top-icon");i.appendChild(h0);var hZ=this._btnBottom=S("button");var T=S("div");C.ac(T,"floor-switch-bottom-icon");hZ.appendChild(T);C.ac(hZ,"floor-switch-bottom");C.ac(hZ,"bottom-border-radius");var hY=this._floorsContainer=S("div");C.ac(hY,"floors-container");hY.appendChild(this._createFloorsDom());this._div.appendChild(i);this._div.appendChild(hY);this._div.appendChild(hZ);var h3=0;if(this._btnTop.style.display===""){h3=2*this._sizeConfig.SWITCH_ARROW_HEIGHT}this._div.style.height=parseInt(this._floorsContainer.style.height,10)+h3+"px";this._map.getContainer().appendChild(this._div);if(!h2){var h1=this;setTimeout(function(){h1._div.style.right="20px"},20)}};gH.prototype._createFloorsDom=function(){if(!this._indoorInfo){return}var T=this._ol=S("ol");var h0=this._indoorInfo.currentFloor;for(var hZ=this._indoorInfo.floors.length-1;hZ>=0;hZ--){var h1=this._indoorInfo.floors[hZ].floorName;var e=S("li");var hY=S("button");C.ac(hY,"btn-select-floor");if(hZ===h0){C.ac(hY,"selected")}hY.setAttribute("data-floor",hZ);hY.innerHTML=h1;e.appendChild(hY);T.appendChild(e)}return T};gH.prototype._updateUI=function(){if(!this._ol){this._render();this._bind();this._adjustDisplayHeight();return}this._ol=null;this._ol=this._createFloorsDom();this._floorsContainer.innerHTML="";this._floorsContainer.appendChild(this._ol);this._adjustDisplayHeight()};gH.prototype._bindDom=function(){var e=this;C.on(this._floorsContainer,"click",function(hY){var T=hY.target||hY.srcElement;if(T.tagName.toLowerCase()==="button"){e._map.showIndoor(e._indoorInfo.uid,parseInt(T.getAttribute("data-floor"),10));var i=new bb("onindoor_bar_click");i.uid=e._indoorInfo.uid;e._map.dispatchEvent(i)}});C.on(this._floorsContainer,"mouseover",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.ac(i,"hover")}});C.on(this._floorsContainer,"mouseout",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.rc(i,"hover")}});C.on(this._floorsContainer,"touchstart",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.ac(i,"onmousedown")}});C.on(this._floorsContainer,"touchend",function(T){var i=T.target;if(i.tagName.toLowerCase()==="button"){C.rc(i,"onmousedown")}});C.on(this._btnTop,"mouseover",function(i){if(this._disable){return}C.ac(this,"hover")});C.on(this._btnTop,"mouseout",function(i){C.rc(this,"hover")});C.on(this._btnBottom,"mouseover",function(i){if(this._disable){return}C.ac(this,"hover")});C.on(this._btnBottom,"mouseout",function(i){C.rc(this,"hover")});C.on(this._btnTop,"touchstart",function(i){if(this.className.indexOf("disable")>-1){return}C.ac(this,"onmousedown")});C.on(this._btnTop,"touchend",function(i){C.rc(this,"onmousedown")});C.on(this._btnBottom,"touchstart",function(i){if(this.className.indexOf("disable")>-1){return}C.ac(this,"onmousedown")});C.on(this._btnBottom,"touchend",function(i){C.rc(this,"onmousedown")});C.on(this._btnTop,"click",function(i){e._setBarSliderTop(parseInt(e._ol.style.top,10)+26)});C.on(this._btnBottom,"click",function(i){e._setBarSliderTop(parseInt(e._ol.style.top,10)-26)});C.on(this._div,"mousemove",h);C.on(this._div,"wheel",db);C.on(this._div,"mousewheel",db);this._map.addEventListener("resize",function(){e._adjustDisplayHeight()})};gH.prototype._adjustDisplayHeight=function(){if(!this._indoorInfo){return}var h0=this._map.getSize().height;var h1=this._sizeConfig.FLOOR_BTN_HEIGHT;var h2=h0-291-100;if(this._isMobile){h2=h0-12-108-this._map.config.bottomOffset}var e=this._indoorInfo.floors.length;var T=e*h1;var hY=e;var h4=0;var h5=this._floorsContainer.children[0];if(T>h2){this._showArrow=true;C.rc(h5.children[0].children[0],"top-border-radius");C.rc(h5.children[e-1].children[0],"bottom-border-radius")}else{this._showArrow=false;C.ac(h5.children[0].children[0],"top-border-radius");C.ac(h5.children[e-1].children[0],"bottom-border-radius")}while(T>h2){if(hY===0){break}hY--;h4=2*this._sizeConfig.SWITCH_ARROW_HEIGHT;T=hY*h1+h4}this._currentDisplayHeight=T;if(hY<3){this._setAdjustVisbile(false)}else{this._setAdjustVisbile(true)}this._floorsContainer.style.height=hY*h1+"px";var hZ=this._indoorInfo.currentFloor;var i=e-hZ;var h3=hZ-1;this._div.style.height=parseInt(this._floorsContainer.style.height,10)+h4+"px";var h6=-(e-(hZ+Math.round(hY/2)))*h1;this._setBarSliderTop(h6);if(hY<e){C.show(this._btnTop);C.show(this._btnBottom)}else{C.hide(this._btnTop);C.hide(this._btnBottom);this._setBarSliderTop(0)}if(this._isMobile){this._div.style.bottom=108+this._map.config.bottomOffset+"px"}};gH.prototype._setBarSliderTop=function(hY){var T=26;var i=this._indoorInfo.floors.length;var e=i*T;if(this._currentDisplayHeight){if(this._showArrow){e=this._currentDisplayHeight-30}else{e=this._currentDisplayHeight}}if(e-hY>=i*T){hY=e-i*T;C.ac(this._btnBottom,"disable");C.rc(this._btnBottom,"hover");this._btnBottom._disable=true}else{C.rc(this._btnBottom,"disable");this._btnBottom._disable=false}if(hY>=0){hY=0;C.ac(this._btnTop,"disable");C.rc(this._btnTop,"hover");this._btnTop._disable=true}else{C.rc(this._btnTop,"disable");this._btnTop._disable=false}this._ol.style.top=hY+"px"};gH.prototype._setAdjustVisbile=function(e){if(this._adjustVisible===e){return}this._adjustVisible=e;if(e&&this._visible){this._div.style.right="20px"}else{this._div.style.right="-30px"}};gH.prototype._bind=function(){var i=this._map;var e=this;i.on("indoor_status_changed",function(h2){if(e._visible===false){return}var T=e._ol;var h0=h2.uid;if(!h0){return}var h1=h2.floor;for(var hZ=0;hZ<T.children.length;hZ++){var hY=T.children[hZ].children[0];if(parseInt(hY.getAttribute("data-floor"),10)===h1){C.ac(hY,"selected")}else{C.rc(hY,"selected")}}});i.on("zoomend",function(T){if(this.getZoom()<17){e._setAdjustVisbile(false)}else{e._setAdjustVisbile(true)}})};gH.prototype.setInfo=function(e){if(this._indoorInfo&&this._indoorInfo.uid===e.uid){return}this._indoorInfo=e;this._updateUI()};gH.prototype.show=function(){if(this._visible===true){return}this._visible=true;if(!this._isMobile){this._div.style.right="20px"}else{this._div.style.display=""}var e=new bb("onindoor_bar_show");e.uid=this._indoorInfo.uid;this._map.dispatchEvent(e)};gH.prototype.hide=function(){if(this._visible===false){return}this._visible=false;if(!this._isMobile){this._div.style.right="-30px"}else{this._div.style.display="none"}};function eZ(e){this._opts=e||{};this.defaultOffset=new ec(2,80);this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT;if(this._opts.anchor===undefined){this.setAnchor(this.defaultAnchor)}else{this.setAnchor(this._opts.anchor)}this._firstAnimation=true}eZ.inherits(a7,"NavigationControl3D");C.extend(eZ.prototype,{initialize:function(T){this._map=T;this._createDom();this._bindDom();this._bind();if(!gb()){this._headingControl=new hN(this._map,this._div)}this._tiltControl=new ev(this._map,this._div);this._render();var i=this._map.getMapType();var e=this;if(i==="B_EARTH_MAP"||this._map._renderType==="webgl"){e._div.style.opacity="1";e._div.style.visibility="visible"}else{e._div.style.opacity="0";e._div.style.visibility="hidden"}return this._container},_createDom:function(){var i=this._div=document.createElement("div");this._container=i;var e=i.style;e.position="absolute";e.zIndex=5;e.width="52px";e.height="82px";e.right="-3px";e.bottom="79px";e.opacity="0";e.visibility="hidden";e.WebkitTransition=e.transition="opacity .3s ease-out,visibility .3s ease-out"},_render:function(){var e=document.getElementById("map-operate");if(e){e.appendChild(this._div)}else{this._map.getContainer().appendChild(this._div)}},_bindDom:function(){this._div.addEventListener("mousemove",h)},_bind:function(){if(this._map._renderType==="webgl"){return}var e=this;this._map.on("maptypechange",function(){if(this.mapType==="B_EARTH_MAP"){if(e._firstAnimation){e._firstAnimation=false;setTimeout(function(){e._div.style.opacity="1";e._div.style.visibility="visible"},300)}else{e._div.style.opacity="1";e._div.style.visibility="visible"}}else{e._div.style.opacity="0";e._div.style.visibility="hidden"}})}});function hN(T,i){this._map=T;this._target=T;var hY=T.temp.originMapType||T.mapType;if(hY==="B_EARTH_MAP"&&T._earth){this._target=T._earth}this._outContainer=i||T.getContainer();this._imgRatio=a6()>=c8.HIGH_RES_MIN_RATIO?2:1;this._imgPath=e8.imgPath+"earth-navi-control-pc4"+(this._imgRatio===2?"-2x.png":".png");this._enabled=true;var e=this;this._setHeadingOptions={callback:function(){e._target.setLock(false)}};this._init()}C.extend(hN.prototype,{_init:function(){this._createDom();this._render();this._bindDom();this._bind();this._updateUI();this._checkEnable()},_checkEnable:function(){if(this._target.getZoom()>=this._target._enableHeadingZoom){this.enable()}else{this.disable()}},_createDom:function(){var i=this._div=S("div");var e=i.style;e.position="absolute";e.zIndex=5;e.top="0";e.left="0";e.width="52px";e.height="54px";e.background="url("+this._imgPath+") no-repeat";e.backgroundSize="266px auto";this._rotateCCW=this._createButton();this._rotateCCW.title="逆时针转动";e=this._rotateCCW.style;e.left="2px";e.top="5px";e.zIndex="1";e.width="15px";e.height="42px";e.backgroundPosition="-75px -5px";this._rotateCW=this._createButton();this._rotateCW.title="顺时针转动";e=this._rotateCW.style;e.right="2px";e.top="5px";e.zIndex="1";e.width="15px";e.height="42px";e.backgroundPosition="-75px -5px";e.WebkitTransform=e.transform="scaleX(-1)";this._compass=this._createButton();this._compass.title="恢复正北方向";e=this._compass.style;e.left="19px";e.top="4px";e.width="14px";e.height="44px";e.backgroundPosition="-56px -4px";e.WebkitTransform=e.transform="rotate(0deg)";this._div.appendChild(this._rotateCCW);this._div.appendChild(this._compass);this._div.appendChild(this._rotateCW);this._domRendered=true},_createButton:function(){var e=S("button");var i=e.style;i.position="absolute";i.outline="none";i.border="none";i.background="url("+this._imgPath+") no-repeat";i.backgroundSize="266px auto";i.cursor="pointer";return e},_render:function(){this._outContainer.appendChild(this._div)},enable:function(){this._enabled=true;if(this._domRendered){this._rotateCCW.style.cursor="pointer";this._rotateCCW.style.opacity=1;this._rotateCW.style.cursor="pointer";this._rotateCW.style.opacity=1;this._compass.style.cursor="pointer";this._compass.style.opacity=1}},disable:function(){this._enabled=false;if(this._domRendered){this._rotateCCW.style.cursor="";this._rotateCCW.style.opacity=0.4;this._rotateCW.style.cursor="";this._rotateCW.style.opacity=0.4;this._compass.style.cursor="";this._compass.style.opacity=0.4}},_bindDom:function(){eP(this._div,["mousedown","click","dblclick"]);var i=this._map;var e=this;this._rotateCW.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}if(e._target.getHeading()===360){e._target.setHeading(0)}e._target.setLock(true);e._target.setHeading(e._target.getHeading()+90,e._setHeadingOptions);i.fire(new bb("onrotatecwclick"))},false);this._rotateCCW.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}if(e._target.getHeading()===-360){e._target.setHeading(0)}e._target.setLock(true);e._target.setHeading(e._target.getHeading()-90,e._setHeadingOptions);i.fire(new bb("onrotateccwclick"))},false);this._rotateCW.addEventListener("mouseover",function(){if(e._enabled===false){return}this.style.backgroundPosition="-89px -5px"},false);this._rotateCW.addEventListener("mouseout",function(){if(e._enabled===false){return}this.style.backgroundPosition="-75px -5px"},false);this._rotateCCW.addEventListener("mouseover",function(){if(e._enabled===false){return}this.style.backgroundPosition="-89px -5px"},false);this._rotateCCW.addEventListener("mouseout",function(){if(e._enabled===false){return}this.style.backgroundPosition="-75px -5px"},false);this._compass.addEventListener("click",function(){if(e._isOperating||e._enabled===false){return}if(e._target.getLock()){return}e._target.setLock(true);var T=false;if(e._target.getTilt()!==0){T=true;e._target.setTilt(0,e._setHeadingOptions)}if(e._target.getHeading()%360!==0){T=true;e._target.resetHeading(e._setHeadingOptions)}if(!T){e._target.setLock(false)}i.fire(new bb("oncompassclick"))},false)},_bind:function(){var e=this;this._bindTarget(this._target);if(this._map._renderType==="webgl"){this._map.addEventListener("maptypechange",function(i){if(this.mapType==="B_EARTH_MAP"){e._target=e._map._earth}else{e._target=e._map}e._bindTarget(e._target);e._checkEnable()})}},_bindTarget:function(i){if(i===this._map&&this._mapBinded){return}if(i===this._map._earth&&this._earthBinded){return}var e=this;i.addEventListener("heading_changed",function(T){e._updateUI()});i.addEventListener("animation_start",function(T){e._isOperating=true});i.addEventListener("animation_end",function(T){e._isOperating=false});i.on("load",function(){e._checkEnable()});i.on("zoom_changed",function(){e._checkEnable()});if(i===this._map){this._mapBinded=true}else{this._earthBinded=true}},_updateUI:function(){var e=this._target.getHeading();var i=this._compass.style;i.WebkitTransform=i.transform="rotate("+e+"deg)"},hide:function(){this._div.style.display="none"},show:function(){this._div.style.display="block"}});function ev(T,i){this._map=T;this._target=T;var hY=T.temp.originMapType||T.mapType;if(hY==="B_EARTH_MAP"&&T._earth){this._target=T._earth}this._outContainer=i||T.getContainer();this._imgRatio=a6()>=c8.HIGH_RES_MIN_RATIO?2:1;this._imgPath=e8.imgPath+"gl-navi-control-pc4"+(this._imgRatio===2?"-2x.png":".png");this._enabled=true;var e=this;this._setTiltOptions={callback:function(){e._target.setLock(false)}};this._init()}C.extend(ev.prototype,{_init:function(){this._createDom();this._render();this._bindDom();this._bind();this._checkEnable()},_checkEnable:function(){if(this._target.getZoom()>=this._target._enableTiltZoom){this.enable()}else{this.disable()}},_createDom:function(){var e=this._div=S("button");e.title="倾斜";var i=e.style;i.position="absolute";i.zIndex=5;i.outline="none";i.border="none";i.cursor="pointer";i.width="26px";i.height="26px";i.top="56px";i.right="13px";i.background="url("+this._imgPath+") no-repeat #fff";i.backgroundSize="266px auto";i.backgroundPosition="-110px 1px";i.boxShadow="1px 2px 1px rgba(0, 0, 0, 0.15)"},enable:function(){this._enabled=true;if(this._div){this._div.style.cursor="pointer"}this._updateUI()},disable:function(){this._enabled=false;if(this._div){this._div.style.cursor=""}this._updateUI()},_render:function(){this._outContainer.appendChild(this._div)},_bindDom:function(){var e=this;this._div.addEventListener("mousedown",function(hY){if(!e._enabled){return}if(e._target.getLock()){return}var i=e._target.getTilt();var T;if(i===e._map.getCurrentMaxTilt()){T="out"}else{if(i===0){T="in"}else{T=e._preTrend?e._preTrend:"in"}}e._curTrend=T;e._clickTimer=setTimeout(function(){e._map.fire(new bb("ontiltmsdown"));e._tiltAni=new o({duration:9999999,render:function(hZ){i=e._target.getTilt();if(T==="in"&&i<e._map.getCurrentMaxTilt()){e._target.setTilt(i+1,{noAnimation:true})}else{if(T==="out"&&i>0){e._target.setTilt(i-1,{noAnimation:true})}}},finish:function(){e._tiltAni=null}});e._clickTimer=null},200);hY.stopPropagation()},false);this._div.addEventListener("mouseup",function(i){if(!e._enabled){return}if(e._tiltAni){e._tiltAni.stop()}e._preTrend=e._curTrend},false);this._div.addEventListener("click",function(hY){if(!e._enabled){return}if(!e._clickTimer){return}if(e._target.getLock()){return}clearTimeout(e._clickTimer);e._map.fire(new bb("ontiltclick"));var i=e._target.getTilt();e._target.setLock(true);hY.stopPropagation();var T=e._map.getCurrentMaxTilt();if(e._curTrend==="in"){e._target.setTilt(T,e._setTiltOptions)}else{if(e._curTrend==="out"){e._target.setTilt(0,e._setTiltOptions)}else{if(i<T){e._target.setTilt(T,e._setTiltOptions)}else{e._target.setTilt(0,e._setTiltOptions)}}}},false);this._div.addEventListener("mouseover",function(i){if(!e._enabled){return}e._mouseOver=true;e._updateUI()},false);this._div.addEventListener("mouseout",function(i){if(!e._enabled){return}e._mouseOver=false;e._updateUI()},false);eP(this._div,["mousedown","click","dblclick"])},_bind:function(){var e=this;var i=this._map;this._bindTarget(this._target);if(this._map._renderType==="webgl"){this._map.addEventListener("maptypechange",function(T){if(this.mapType==="B_EARTH_MAP"){e._target=e._map._earth}else{e._target=e._map}e._bindTarget(e._target);e._checkEnable()})}},_bindTarget:function(i){if(i===this._map&&this._mapBinded){return}if(i===this._map._earth&&this._earthBinded){return}var e=this;i.on("load",function(){e._checkEnable()});i.on("zoom_changed",function(){e._checkEnable()});i.on("tilt_changed",function(){e._updateUI()});if(i===this._map){this._mapBinded=true}else{this._earthBinded=true}},_updateUI:function(){var T=this._target.getTilt();var i=0;var hY=0;var e=0;if(T>0){i=78}if(this._mouseOver){e=52}if(this._enabled===false){hY=26;e=0;i=0}var hZ="-"+(110+i+hY+e)+"px 1px";this._div&&(this._div.style.backgroundPosition=hZ);if(this._enabled){if(T>0){this._div&&(this._div.title="恢复")}else{this._div&&(this._div.title="倾斜")}}else{this._div&&(this._div.title="请放大地图后操作")}},hide:function(){this._div.style.display="none"},show:function(){this._div.style.display="block"}});function cf(i){eg.call(this);this._opts={container:null,cursor:"default"};this._opts=C.extend(this._opts,i);this._type="contextmenu";this._map=null;this._container;this._left=0;this._top=0;this._items=[];this._rItems=[];this._dividers=[];this._enable=true;this.curPixel=null;this.curPoint=null;this._isOpen=false;var e=this;ed.load("menu",function(){e._draw()})}cf.inherits(eg,"ContextMenu");C.extend(cf.prototype,{initialize:function(e){this._map=e},remove:function(){this._map=null},addItem:function(hZ,e){if(!hZ||hZ._type!="menuitem"||hZ._text==""||hZ._width<=0){return}for(var hY=0,T=this._items.length;hY<T;hY++){if(this._items[hY]===hZ){return}}if(e===undefined||e>this._items.length-1){e=-1}hZ._insertIndex=e;if(e===-1){this._items.push(hZ);this._rItems.push(hZ)}else{this._items.splice(e,0,hZ);this._rItems.splice(e,0,hZ)}},removeItem:function(hY){if(!hY||hY._type!="menuitem"){return}for(var T=0,e=this._items.length;T<e;T++){if(this._items[T]===hY){this._items[T].remove();this._items.splice(T,1);delete hY._insertIndex;e--}}for(var T=0,e=this._rItems.length;T<e;T++){if(this._rItems[T]===hY){this._rItems[T].remove();this._rItems.splice(T,1);delete hY._insertIndex;e--}}},addSeparator:function(e){if(e===undefined||e>this._items.length-1){e=-1}var i={_type:"divider",_dIndex:this._dividers.length,_insertIndex:e};this._dividers.push({dom:null});if(e===-1){this._items.push(i)}else{this._items.splice(e,0,i)}},removeSeparator:function(T){if(!this._dividers[T]){return}for(var hY=0,e=this._items.length;hY<e;hY++){if(this._items[hY]&&this._items[hY]._type=="divider"&&this._items[hY]._dIndex==T){this._items.splice(hY,1);e--}if(this._items[hY]&&this._items[hY]._type=="divider"&&this._items[hY]._dIndex>T){this._items[hY]._dIndex--}}this._dividers.splice(T,1)},getDom:function(){return this._container},show:function(){if(this._isOpen==true){return}this._isOpen=true},hide:function(){if(this._isOpen==false){return}this._isOpen=false},setCursor:function(e){if(!e){return}this._opts.cursor=e},getItem:function(e){return this._rItems[e]},enable:function(){this._enable=true},disable:function(){this._enable=false}});function fE(T,hY,i){if(!T||!hY||typeof hY!="function"){return}eg.call(this);this._opts={width:100,id:""};i=i||{};this._opts.width=(i.width*1)?i.width:100;this._opts.id=i.id?i.id:"";this._text=T+"";this._callback=hY;this._map=null;this._type="menuitem";this._contextmenu=null;this._container=null;this._enabled=true;var e=this;ed.load("menu",function(){e._draw()})}fE.inherits(eg,"MenuItem");C.extend(fE.prototype,{initialize:function(e,i){this._map=e;this._contextmenu=i},remove:function(){this._contextmenu=null;this._map=null},setText:function(e){if(!e){return}this._text=e+""},getDom:function(){return this._container},enable:function(){this._enabled=true},disable:function(){this._enabled=false}});function dT(e,i){this.setSouthWest(e);this.setNorthEast(i)}C.extend(dT.prototype,{isEmpty:function(){return this.sw===null&&this.ne===null},equals:function(e){if(!e||e.isEmpty()||this.isEmpty()){return false}return this.sw.equals(e.sw)&&this.ne.equals(e.ne)},containsBounds:function(e){if(!e||e.isEmpty()||this.isEmpty()){return false}return(e.sw.lng>this.sw.lng&&e.ne.lng<this.ne.lng&&e.sw.lat>this.sw.lat&&e.ne.lat<this.ne.lat)},getCenter:function(){if(this.isEmpty()){return null}return new hz((this.sw.lng+this.ne.lng)/2,(this.sw.lat+this.ne.lat)/2)},intersects:function(T){if(!T||T.isEmpty()||this.isEmpty()){return null}if(Math.max(T.sw.lng,T.ne.lng)<Math.min(this.sw.lng,this.ne.lng)||Math.min(T.sw.lng,T.ne.lng)>Math.max(this.sw.lng,this.ne.lng)||Math.max(T.sw.lat,T.ne.lat)<Math.min(this.sw.lat,this.ne.lat)||Math.min(T.sw.lat,T.ne.lat)>Math.max(this.sw.lat,this.ne.lat)){return null}var hZ=Math.max(this.sw.lng,T.sw.lng);var i=Math.min(this.ne.lng,T.ne.lng);var hY=Math.max(this.sw.lat,T.sw.lat);var e=Math.min(this.ne.lat,T.ne.lat);return new dT(new hz(hZ,hY),new hz(i,e))},setMinMax:function(){this.minX=this.sw?this.sw.lng:null;this.minY=this.sw?this.sw.lat:null;this.maxX=this.ne?this.ne.lng:null;this.maxY=this.ne?this.ne.lat:null},containsPoint:function(e){if(!e){return}return(e.lng>=this.sw.lng&&e.lng<=this.ne.lng&&e.lat>=this.sw.lat&&e.lat<=this.ne.lat)},extend:function(e){if(!e){return}var i=e.lng;var T=e.lat;if(!this.sw){this.sw=e.clone()}if(!this.ne){this.ne=e.clone()}if(this.sw.lng>i){this.sw.lng=i}if(this.ne.lng<i){this.ne.lng=i}if(this.sw.lat>T){this.sw.lat=T}if(this.ne.lat<T){this.ne.lat=T}},getMin:function(){return this.sw},getMax:function(){return this.ne},getSouthWest:function(){return this.sw},getNorthEast:function(){return this.ne},setSouthWest:function(e){this.sw=e?e.clone():null},setNorthEast:function(e){this.ne=e?e.clone():null},clone:function(){return new dT(this.sw,this.ne)},toSpan:function(){if(this.isEmpty()){return new ec(0,0)}return new ec(Math.abs(this.ne.lng-this.sw.lng),Math.abs(this.ne.lat-this.sw.lat))},div:function(e){if(!e||e.isEmpty()||this.isEmpty()){return 0}return((this.ne.lng-this.sw.lng)*(this.ne.lat-this.sw.lat))/((e.ne.lng-e.sw.lng)*(e.ne.lat-e.sw.lat))},makeNormalizedPoint:function(e){this.normalizedTopLeft=this.pointTopLeft.clone();this.normalizedTopRight=this.pointTopRight.clone();this.normalizedBottomRight=this.pointBottomRight.clone();this.normalizedBottomLeft=this.pointBottomLeft.clone();while(e<0){e+=360}e=e%360;if(e>=0&&e<90||e>=270&&e<360){if(this.normalizedTopRight.lng<this.normalizedTopLeft.lng){this.normalizedTopRight.lng+=c8.WORLD_SIZE_MC}if(this.normalizedBottomRight.lng<this.normalizedBottomLeft.lng){this.normalizedBottomRight.lng+=c8.WORLD_SIZE_MC}}else{if(this.normalizedTopLeft.lng<this.normalizedTopRight.lng){this.normalizedTopLeft.lng+=c8.WORLD_SIZE_MC}if(this.normalizedBottomLeft.lng<this.normalizedBottomRight.lng){this.normalizedBottomLeft.lng+=c8.WORLD_SIZE_MC}}},toString:function(){return"Bounds"}});function hz(e,i){if(isNaN(e)){e=g7(e);e=isNaN(e)?0:e}if(typeof e==="string"){e=parseFloat(e)}if(isNaN(i)){i=g7(i);i=isNaN(i)?0:i}if(typeof i==="string"){i=parseFloat(i)}this.lng=e;this.lat=i}hz.prototype.equals=function(i){if(!i){return false}var hY=Math.abs(this.lat-i.lat);var T=Math.abs(this.lng-i.lng);var e=1e-8;if(hY<e&&T<e){return true}return false};hz.prototype.clone=function(){return new hz(this.lng,this.lat)};hz.prototype.add=function(e){return new hz(this.lng+e.lng,this.lat+e.lat)};hz.prototype.sub=function(e){return new hz(this.lng-e.lng,this.lat-e.lat)};hz.prototype.mult=function(e){return new hz(this.lng*e,this.lat*e)};hz.prototype.div=function(e){return new hz(this.lng/e,this.lat/e)};hz.prototype.mag=function(){return Math.sqrt(this.lng*this.lng+this.lat*this.lat)};hz.prototype.toString=function(){return"Point"};function eq(){}C.extend(eq,{EARTHRADIUS:6370996.81,MCBAND:[12890594.86,8362377.87,5591021,3481989.83,1678043.12,0],LLBAND:[86,60,45,30,15,0],MC2LL:[[1.410526172116255e-8,0.00000898305509648872,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-0.03801003308653,17337981.2],[-7.435856389565537e-9,0.000008983055097726239,-0.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,10260144.86],[-3.030883460898826e-8,0.00000898305509983578,0.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,0.32710905363475,6856817.37],[-1.981981304930552e-8,0.000008983055099779535,0.03278182852591,40.31678527705744,0.65659298677277,-4.44255534477492,0.85341911805263,0.12923347998204,-0.04625736007561,4482777.06],[3.09191371068437e-9,0.000008983055096812155,0.00006995724062,23.10934304144901,-0.00023663490511,-0.6321817810242,-0.00663494467273,0.03430082397953,-0.00466043876332,2555164.4],[2.890871144776878e-9,0.000008983055095805407,-3.068298e-8,7.47137025468032,-0.00000353937994,-0.02145144861037,-0.00001234426596,0.00010322952773,-0.00000323890364,826088.5]],LL2MC:[[-0.0015702102444,111320.7020616939,1704480524535203,-10338987376042340,26112667856603880,-35149669176653700,26595700718403920,-10725012454188240,1800819912950474,82.5],[0.0008277824516172526,111320.7020463578,647795574.6671607,-4082003173.641316,10774905663.51142,-15171875531.51559,12053065338.62167,-5124939663.577472,913311935.9512032,67.5],[0.00337398766765,111320.7020202162,4481351.045890365,-23393751.19931662,79682215.47186455,-115964993.2797253,97236711.15602145,-43661946.33752821,8477230.501135234,52.5],[0.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-0.0003441963504368392,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-0.0003218135878613132,111320.7020701615,0.00369383431289,823725.6402795718,0.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,0.37238884252424,7.45]],getDistanceByMC:function(h0,hY){if(!h0||!hY){return 0}var i;var hZ;var e;var T;h0=this.convertMC2LL(h0);if(!h0){return 0}i=dK(h0.lng);hZ=dK(h0.lat);hY=this.convertMC2LL(hY);if(!hY){return 0}e=dK(hY.lng);T=dK(hY.lat);return this.getDistance(i,e,hZ,T)},getDistanceByLL:function(h0,hY){if(!h0||!hY){return 0}h0.lng=this.getLoop(h0.lng,-180,180);h0.lat=this.getRange(h0.lat,-80,84);hY.lng=this.getLoop(hY.lng,-180,180);hY.lat=this.getRange(hY.lat,-80,84);var i;var e;var hZ;var T;i=dK(h0.lng);hZ=dK(h0.lat);e=dK(hY.lng);T=dK(hY.lat);return this.getDistance(i,e,hZ,T)},proximityCovertMC2LL:function(e){if(e===null){return e}if(e.lng<180&&e.lng>-180&&e.lat<90&&e.lat>-90){return e}return this.convertMC2LL(e)},convertMC2LL:function(e){if(e===null){return e}if(!e){return new hz(0,0)}var T;var hZ;T=new hz(Math.abs(e.lng),Math.abs(e.lat));for(var hY=0;hY<this.MCBAND.length;hY++){if(T.lat>=this.MCBAND[hY]){hZ=this.MC2LL[hY];break}}var h0=this.convertor(e,hZ);return new c4(h0.lat,h0.lng)},convertLL2MC:function(h1){if(!h1){return new hz(0,0)}var h3=h1.lat;var hY=h1.lng;hY=this.getLoop(h1.lng,-180,180);h3=fL(h3,-85,85);var h0;for(var hZ=0;hZ<this.LLBAND.length;hZ++){if(h3>=this.LLBAND[hZ]){h0=this.LL2MC[hZ];break}}if(!h0){for(hZ=0;hZ<this.LLBAND.length;hZ++){if(h3<=-this.LLBAND[hZ]){h0=this.LL2MC[hZ];break}}}var T=new hz(hY,h3);var h2=this.convertor(T,h0);var e=new hz(h2.lng,h2.lat);e.latLng=new c4(h1.lat,h1.lng);return e},convertor:function(T,hY){if(!T||!hY){return}var e=hY[0]+hY[1]*Math.abs(T.lng);var i=Math.abs(T.lat)/hY[9];var hZ=hY[2]+hY[3]*i+hY[4]*i*i+hY[5]*i*i*i+hY[6]*i*i*i*i+hY[7]*i*i*i*i*i+hY[8]*i*i*i*i*i*i;e*=(T.lng<0?-1:1);hZ*=(T.lat<0?-1:1);return new hz(e,hZ)},getDistance:function(i,e,hY,T){return this.EARTHRADIUS*Math.acos((Math.sin(hY)*Math.sin(T)+Math.cos(hY)*Math.cos(T)*Math.cos(e-i)))},getRange:function(T,i,e){if(i!=null){T=Math.max(T,i)}if(e!=null){T=Math.min(T,e)}return T},getLoop:function(T,i,e){while(T>e){T-=e-i}while(T<i){T+=e-i}return T}});C.extend(eq.prototype,{lnglatToMercator:function(e){return eq.convertLL2MC(e)},lngLatToPoint:function(e){var i=eq.convertLL2MC(e);return new em(i.lng,i.lat)},mercatorToLnglat:function(e){return eq.convertMC2LL(e)},pointToLngLat:function(i){var e=new hz(i.x,i.y);var T=eq.convertMC2LL(e);return new c4(T.lat,T.lng)},pointToPixel:function(i,h0,hZ,hY){if(!i){return}i=this.lnglatToMercator(i);var T=this.getZoomUnits(h0);var e=Math.round((i.lng-hZ.lng)/T+hY.width/2);var h1=Math.round((hZ.lat-i.lat)/T+hY.height/2);return new em(e,h1)},mercatorToPixel:function(h0,hZ,hY,T){if(!h0){return}var i=this.getZoomUnits(hZ);var e=Math.round((h0.lng-hY.lng)/i+T.width/2);var h1=Math.round((hY.lat-h0.lat)/i+T.height/2);return new em(e,h1)},pixelToPoint:function(hY,h1,h0,hZ){if(!hY){return}var i=this.getZoomUnits(h1);var T=h0.lng+i*(hY.x-hZ.width/2);var h2=h0.lat-i*(hY.y-hZ.height/2);var e=new hz(T,h2);return this.mercatorToLnglat(e)},tileToBound:function(hY,h2){var i=hY.col;var h5=hY.row;var h4=hY.baseTileSize;var h3=this.getZoomUnits(hY.zoom);var T={x:Math.round(h2.lng/h3),y:Math.round(h2.lat/h3)};var h0={lbx:i*h4,lby:h5*h4,rtx:(i+1)*h4,rty:(h5+1)*h4};var e={lbx:h2.lng+(h0.lbx-T.x)*h3,lby:h2.lat+(h0.lby-T.y)*h3,rtx:h2.lng+(h0.rtx-T.x)*h3,rty:h2.lat+(h0.rty-T.y)*h3};var hZ=eq.convertMC2LL(new hz(e.lbx,e.lby));var h1=eq.convertMC2LL(new hz(e.rtx,e.rty));return{MC:new dT(new hz(e.lbx,e.lby),new hz(e.rtx,e.rty)),LL:new dT(hZ,h1)}},getZoomUnits:function(e){return Math.pow(2,(18-e))},setCoordType:function(e){this.coordsType=e}});function ey(){}C.extend(ey,{RADIUS:6378137,EXTENT4326:[-180,-90,180,90],WORLD_EXTENT:[-180,-85,180,85],HALF_SIZE:20037508.342789244,METERS_PER_UNIT:111319.49079327358,EXTENT3857:[-20037508.342789244,-20037508.342789244,20037508.342789244,20037508.342789244],MAX_SAFE_Y:238107693.26496765,origin:[-20037508.342789244,20037508.342789244],size:156543.03392804097,gridSize:[256,256],resolutions:[156543.03392804097,78271.51696402048,39135.75848201024,19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564,1222.99245256282,611.49622628141,305.748113140705,152.8740565703525,76.43702828517625,38.21851414258813,19.109257071294063,9.554628535647032,4.777314267823516,2.388657133911758,1.194328566955879,0.5971642834779395,0.29858214173896974,0.14929107086948487,0.07464553543474244,0.03732276771737122],calcResolutions:function(i){this.resolutions=[];for(var e=0;e<i;++e){this.resolutions.push(this.size/Math.pow(2,e))}return this.resolutions},forEachTileCoord:function(h4,h3,T,h1){var e=this.getTileRangeForExtentFactory(h4,h3,T);for(var hZ=e.minX,h2=e.maxX;hZ<=h2;++hZ){for(var hY=e.minY,h0=e.maxY;hY<=h0;++hY){h1([h3,hZ,hY])}}},getTileRangeForExtentFactory:function(T,hZ,i,hY){var e;switch(i.source){case"BD09MC":e=this.getBDTileRangeForExtentAndZ(T,hZ,hY);break;case"EPSG3857":e=this.getTileRangeForExtentAndZ(T,hZ,hY);break;default:e=this.getTileRangeForExtentAndZ(T,hZ,hY);break}return e},getBDTileRangeForExtentAndZ:function(T,hZ,hY){var i=[0,0,0];this.getBDTileCoordForXYAndZ_(T[0],T[1],hZ,false,i);var e=i[1];var h0=i[2];this.getBDTileCoordForXYAndZ_(T[2],T[3],hZ,true,i);return this.createOrUpdateTileRange(e,i[1],h0,i[2],hY)},getTileRangeForExtentAndZ:function(T,hZ,hY){var i=[0,0,0];this.getTileCoordForXYAndZ_(T[0],T[3],hZ,false,i);var e=i[1];var h0=i[2];this.getTileCoordForXYAndZ_(T[2],T[1],hZ,true,i);return this.createOrUpdateTileRange(e,i[1],h0,i[2],hY)},getBDTileCoordForXYAndZ_:function(e,h2,h0,hZ,hY){var h1=256*Math.pow(2,(18-h0));var T=e/h1;var i=h2/h1;if(hZ){T=Math.ceil(T)-1;i=Math.ceil(i)-1}else{T=Math.floor(T);i=Math.floor(i)}return this.createOrUpdateTileCoord(h0,T,i,hY)},getTileCoordForXYAndZ_:function(h5,h4,h2,h3,e){var h6=this.origin;var i=(this.resolutions.length===0?this.calcResolutions(21)[h2]:this.resolutions[h2]);var h8=this.gridSize;var hY=h3?0.5:0;var T=h3?0.5:0;var h7=Math.floor((h5-h6[0])/i+hY);var h0=Math.floor((h6[1]-h4)/i+T);var h1=h7/h8[0];var hZ=h0/h8[1];if(h3){h1=Math.ceil(h1)-1;hZ=Math.ceil(hZ)-1}else{h1=Math.floor(h1);hZ=Math.floor(hZ)}return this.createOrUpdateTileCoord(h2,h1,hZ,e)},getTileCoordForCoordAndZ:function(T,i,e){return this.getTileCoordForXYAndZ_(T[0],T[1],i,false,e)},getTileRangeExtent:function(T,h1){var h2=this.origin;if(this.resolutions.length===0){this.calcResolutions(23)}var hZ=this.resolutions[T[0]];var h3=this.gridSize;var h0=h2[0]+T[1]*h3[0]*hZ;var hY=h2[1]-(T[2]+1)*h3[1]*hZ;var i=h0+h3[0]*hZ;var e=hY+h3[1]*hZ;return this.createOrUpdateTileRange(h0,i,hY,e,h1)},getRangeExtent:function(i,h6,h2,h8,hY){var h3=this.calPiexlResolution(h8,hY);var h1=h6/2*h3;var h4=h2/2*h3;var h0=i[0]-h1;var T=i[0]+h1;var hZ=i[1]-h4;var e=i[1]+h4;var h5=gcoord.transform([h0,hZ],gcoord[hY.target],gcoord[hY.source]);var h7=gcoord.transform([T,e],gcoord[hY.target],gcoord[hY.source]);return this.createOrUpdateTileRange(h5[0],h7[0],h5[1],h7[1])},getMousePoint:function(h1,h0,i,hZ,T){var hY=aH(h1,h0);return this.calLngLatByMapViewPixelInverse(hY.clientPos,i,h0.width,h0.height,hZ,T)},calLngLatByMapViewPixelInverse:function(hY,e,i,h5,h6,T){var h1=this.calPiexlResolution(h6,T);var h0=hY.x-i/2;var hZ=hY.y-h5/2;var h3=e[0]+h0*h1;var h2=e[1]-hZ*h1;var h4=gcoord.transform([h3,h2],gcoord[T.target],gcoord[T.source]);return h4},calPiexlResolution:function(T,i){var e;switch(i.target){case"BD09MC":e=Math.pow(2,(18-T));break;case"EPSG3857":e=this.resolutions[Math.floor(T)];break;default:e=Math.pow(2,(18-T));break}return e},getXYZCellPixelCoor:function(h1,hZ,hY,i){var h3=this.gridSize;var h2;var h0;switch(i.source){case"EPSG3857":var T=Math.pow(2,hY-1)-(hZ+1);var e=h1-Math.pow(2,hY-1);h2=e*h3[0];h0=T*h3[1];break;case"BD09MC":h2=h1*h3[0];h0=hZ*h3[1];default:break}return{x:h2,y:h0}},getBaiduCellPixelCoor:function(e,hY,T){var i=256;return{x:e*i,y:hY*i}},getPointPixelCoor:function(e,h3,i){var h1;var h0;var T=Math.pow(2,(18-h3));var hY=this.resolutions[Math.floor(h3)];var hZ=eq.convertMC2LL(e);switch(i.source){case"EPSG3857":var h2=gcoord.transform([hZ.lng,hZ.lat],gcoord.BD09LL,gcoord.EPSG3857);h1=h2[0]/hY;h0=h2[1]/hY;break;case"BD09MC":h1=e.lng/T;h0=e.lat/T;default:break}return[h1,h0]},getResolutionScale:function(hY,T){var hZ;var i=this.resolutions[Math.floor(hY)];var e=Math.pow(2,(18-hY));switch(T.target){case"BD09MC":hZ=i/e;break;case"EPSG3857":hZ=e/i;break;default:hZ=i/e;break}return hZ},getBaiduResolutionScale:function(T){var i=this.resolutions[Math.floor(T)];var e=Math.pow(2,(18-T));var hY=e/i;return hY},getTileCoordCenter:function(T){var e=this.origin;if(this.resolutions.length===0){this.calcResolutions(23)}var i=this.resolutions[T[0]];var hY=this.gridSize;return[e[0]+(T[1]+0.5)*hY[0]*i,e[1]-(T[2]+0.5)*hY[1]*i,]},transformBDmcPoint:function(hY,e){e=e||"EPSG3857";var i=eq.convertMC2LL(new hz(hY.lng,hY.lat));var T=gcoord.transform([i.lng,i.lat],gcoord.BD09LL,gcoord[e]);return T},getTilesLoop:function(T,e){var i=Math.pow(2,T);while(e>i-1){e=e-i}while(e<0){e=e+i}return e},getLoopBox:function(e,hY){var i=this.HALF_SIZE*2;if(e[0]>0&&hY[2]<0){hY[2]=hY[2]+i}else{if(e[0]<0&&hY[0]>0){hY[0]=hY[0]-i}}return hY},createOrUpdateTileCoord:function(T,e,hY,i){if(i!==undefined){i[0]=T;i[1]=e;i[2]=hY;return i}else{return[T,e,hY]}},createOrUpdateTileRange:function(e,hY,hZ,T,i){if(i!==undefined){i.minX=e;i.maxX=hY;i.minY=hZ;i.maxY=T;return i}else{return{minX:e,maxX:hY,minY:hZ,maxY:T}}},fromEPSG4326:function(T,h3,h1){var hZ=T.length;var h0=h1>1?h1:2;var e=h3;if(e===undefined){if(h0>2){e=T.slice()}else{e=new Array(hZ)}}for(var hY=0;hY<hZ;hY+=h0){e[hY]=(this.HALF_SIZE*T[hY])/180;var h2=this.RADIUS*Math.log(Math.tan((Math.PI*(+T[hY+1]+90))/360));if(h2>this.MAX_SAFE_Y){h2=this.MAX_SAFE_Y}else{if(h2<-this.MAX_SAFE_Y){h2=-this.MAX_SAFE_Y}}e[hY+1]=h2}return e},toEPSG4326:function(T,h2,h1){var hZ=T.length;var h0=h1>1?h1:2;var e=h2;if(e===undefined){if(h0>2){e=T.slice()}else{e=new Array(hZ)}}for(var hY=0;hY<hZ;hY+=h0){e[hY]=(180*T[hY])/this.HALF_SIZE;e[hY+1]=(360*Math.atan(Math.exp(T[hY+1]/this.RADIUS)))/Math.PI-90}return e},findParentGridAndPosition:function(hY,h8,h7,h2,h3,h5,h1){if(h7-1<0){return false}var h9=hY;var h4=h8;var T=h7;for(var h0=1;h0<=h1;h0++){var e=this.findParent(h9,h4,T,h0);if(!e){return false}var h6=this.getTileKey(e);var hZ=h2.getData(h6);if(hZ&&hZ.status==="ready"){if(h3[h6]){continue}h5.setData(hZ,this.drawIndex,0);h3[h6]=true;return true}h9=e.col;h4=e.row;T=e.zoom}},findParent:function(i,hZ,T,hY){if(T-1<0){return null}var e=i%2;var h0=hZ%2;return{col:Math.floor(i/2),row:Math.floor(hZ/2),sonX:e,sonY:h0,thumbLB:[e*0.5,1-h0*0.5-0.5],thumbRT:[e*0.5+0.5,1-h0*0.5],radio:Math.pow(2,hY),zoom:T-1,useZoom:T-1}},getTileKey:function(e,hY){hY=hY||{};var i=typeof hY.useZoom==="number"?hY.useZoom:e.useZoom;var T=e.style||this.mapStyleId||"default";return this.mapType+"_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},lon2tile:function(i,e){return(Math.floor((i+180)/360*Math.pow(2,e)))},lat2tile:function(T,i){var e=Math.tan(T*Math.PI/180)+1/Math.cos(T*Math.PI/180);return(Math.floor((1-Math.log(e)/Math.PI)/2*Math.pow(2,i)))},tile2long:function(e,i){return(e/Math.pow(2,i)*360-180)},tile2lat:function(T,e){var i=Math.PI-2*Math.PI*T/Math.pow(2,e);return(180/Math.PI*Math.atan(0.5*(Math.exp(i)-Math.exp(-i))))}});function c4(i,e){if(i<-90){i=-90}else{if(i>90){i=90}}while(e<-180){e+=360}while(e>180){e-=360}e=e||0;i=i||0;hz.call(this,e,i)}c4.inherits(hz,"LatLng");C.extend(c4.prototype,{equals:function(e){return(this.lat===e.lat&&this.lng===e.lng)},clone:function(){return new c4(this.lat,this.lng)},add:function(e){return new c4(this.lng+e.lng,this.lat+e.lat)},sub:function(e){return new c4(this.lat-e.lat,this.lng-e.lng)},mult:function(e){return new c4(this.lng*e,this.lat*e)},div:function(e){return new c4(this.lng/e,this.lat/e)},mag:function(){return Math.sqrt(this.lng*this.lng+this.lat*this.lat)},getLngSpan:function(e){var i=this.lng;var T=Math.abs(e-i);if(T>180){T=360-T}return T},toString:function(){return"LatLng"}});function eL(e,i){if(e&&!i){i=e}this._sw=this._ne=null;this._swLng=this._swLat=null;this._neLng=this._neLat=null;if(e){this._sw=new c4(e.lat,e.lng);this._ne=new c4(i.lat,i.lng);this._swLng=e.lng;this._swLat=e.lat;this._neLng=i.lng;this._neLat=i.lat}}C.extend(eL.prototype,{isEmpty:function(){return !this._sw||!this._ne},equals:function(e){if(this.isEmpty()){return false}return this.getSouthWest().equals(e.getSouthWest())&&this.getNorthEast().equals(e.getNorthEast())},getSouthWest:function(){return this._sw},getNorthEast:function(){return this._ne},containsBounds:function(e){if(this.isEmpty()||e.isEmpty()){return false}return(e._swLng>this._swLng&&e._neLng<this._neLng&&e._swLat>this._swLat&&e._neLat<this._neLat)},getCenter:function(){if(this.isEmpty()){return null}return new c4((this._swLat+this._neLat)/2,(this._swLng+this._neLng)/2)},intersects:function(T){if(Math.max(T._swLng,T._neLng)<Math.min(this._swLng,this._neLng)||Math.min(T._swLng,T._neLng)>Math.max(this._swLng,this._neLng)||Math.max(T._swLat,T._neLat)<Math.min(this._swLat,this._neLat)||Math.min(T._swLat,T._neLat)>Math.max(this._swLat,this._neLat)){return false}var hZ=Math.max(this._swLng,T._swLng);var i=Math.min(this._neLng,T._neLng);var hY=Math.max(this._swLat,T._swLat);var e=Math.min(this._neLat,T._neLat);this._sw=new c4(hY,hZ);this._ne=new c4(e,i);this._swLng=hZ;this._swLat=hY;this._neLng=i;this._neLat=e;return true},containsPoint:function(e){if(this.isEmpty()){return false}return(e.lng>=this._swLng&&e.lng<=this._neLng&&e.lat>=this._swLat&&e.lat<=this._neLat)},extend:function(e){var i=e.lng;var T=e.lat;if(!this._sw){this._sw=new c4(0,0)}if(!this._ne){this._ne=new c4(0,0)}if(!this._swLng||this._swLng>i){this._sw.lng=this._swLng=i}if(!this._neLng||this._neLng<i){this._ne.lng=this._neLng=i}if(!this._swLat||this._swLat>T){this._sw.lat=this._swLat=T}if(!this._neLat||this._neLat<T){this._ne.lat=this._neLat=T}},toSpan:function(){if(this.isEmpty()){return new c4(0,0)}return new c4(Math.abs(this._neLat-this._swLat),Math.abs(this._neLng-this._swLng))},union:function(i){if(i.isEmpty()){return false}var e=i.getSouthWest();var T=i.getNorthEast();if(this._swLat>e.lat){this._swLat=e.lat}if(this._swLng>e.lng){this._swLng=e.lng}if(this._neLat<T.lat){this._neLat=T.lat}if(this._neLng<T.lng){this._neLng=T.lng}this._sw=new c4(this._swLat,this._swLng);this._ne=new c4(this._neLat,this._neLng);return true},toString:function(){return this._swLat+", "+this._swLng+", "+this._neLat+", "+this._neLng}});window.COORDINATES_WGS84=1;window.COORDINATES_WGS84_MC=2;window.COORDINATES_GCJ02=3;window.COORDINATES_GCJ02_MC=4;window.COORDINATES_BD09=5;window.COORDINATES_BD09_MC=6;window.COORDINATES_MAPBAR=7;window.COORDINATES_51=8;function ax(){}ax.inherits(eg,"Convertor");C.extend(ax.prototype,{translate:function(i,hZ,hY,T){hZ=hZ||1;hY=hY||5;if(i.length>10){T&&T({status:25});return}var e=e8.apiHost+"/geoconv/v1/?coords=";C.each(i,function(h0){e+=h0.lng+","+h0.lat+";"});e=e.replace(/;$/gi,"");e=e+"&from="+hZ+"&to="+hY+"&v=gl&type=webgl&ak="+gk;D.request(e,function(h1){if(h1.status===0){var h0=[];C.each(h1.result,function(h2){h0.push(new hz(h2.x,h2.y))});delete h1.result;h1.points=h0}T&&T(h1)})}});var dV={idle:0,freeze:1,zooming:2,dragging:3,moving:4,readyToDrag:5,readyToPinch:6,pinching:7,stdMapCtrlDrag:8,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,arrowOpCodes:{37:1,38:2,39:4,40:8}};var ek={_map:null,_html:"<div class='BMap_opMask' unselectable='on'></div>",_maskElement:null,_cursor:"default",inUse:false,show:function(e){if(!this._map){this._map=e}this.inUse=true;if(!this._maskElement){this._createMask(e)}this._maskElement.style.display="block"},_createMask:function(i){if(!this._map){this._map=i}if(!this._map){return}var e=this._maskElement=dI(this._map.container,this._html);C.on(e,"mouseup",function(T){if(T.button==2){db(T)}});C.on(e,"contextmenu",db);e.style.display="none"},getDrawPoint:function(hY,h1,hZ){hY=window.event||hY;var i=hY.offsetX||hY.layerX||0;var h0=parseInt(hY.offsetY)||parseInt(hY.layerY)||0;var T=hY.target||hY.srcElement;if(T!=ek.getDom(this._map)&&h1==true){while(T&&T!=this._map.container){if(!(T.clientWidth==0&&T.clientHeight==0&&T.offsetParent&&T.offsetParent.nodeName.toLowerCase()=="td")){i+=T.offsetLeft;h0+=T.offsetTop}T=T.offsetParent}}if(T!=ek.getDom(this._map)&&T!=this._map.container){return}if(typeof i==="undefined"||typeof h0==="undefined"){return}if(isNaN(i)||isNaN(h0)){return}if(hZ){i=i+hZ.x;h0=h0+hZ.y}return this._map.pixelToPointIn(new em(i,h0))},hide:function(){if(!this._map){return}this.inUse=false;if(this._maskElement){this._maskElement.style.display="none"}},getDom:function(e){if(!this._maskElement){this._createMask(e)}return this._maskElement},setCursor:function(e){this._cursor=e||"default";if(this._maskElement){this._maskElement.style.cursor=this._cursor}}};function bl(){this._type="overlay"}bl.inherits(C.BaseClass,"Overlay");bl.getZIndex=function(i,e){i=i*1;if(!i){return 0}if(e){i=eq.convertMC2LL(new hz(0,i)).lat}return(i*-100000)<<1};C.extend(bl.prototype,{_i:function(e){this._map=e;if(!this.domElement&&bV(this.initialize)){this.domElement=this.initialize(e);if(this.domElement){this.domElement.style.WebkitUserSelect="none"}}this.draw()},initialize:function(e){throw"initialize方法未实现"},draw:function(){throw"draw方法未实现"},remove:function(){if(this.domElement&&this.domElement.parentNode){this.domElement.parentNode.removeChild(this.domElement)}this.domElement=null;this.dispatchEvent(new bb("onremove"))},hide:function(){this._visible=false;C.hide(this.domElement)},show:function(){this._visible=true;C.show(this.domElement)},getMap:function(){return this._map},dispose:function(){C.BaseClass.prototype.decontrol.call(this)}});function cV(){C.BaseClass.call(this);bl.call(this);this._visible=true;this._visibleInternal=true;this.infoWindow=null;this._dblclickTime=0}cV.inherits(bl,"OverlayInternal");C.extend(cV.prototype,{initialize:function(e){this.map=e;C.BaseClass.call(this,this.hashCode);return null},draw:function(){},remove:function(){this.decontrol();bl.prototype.remove.call(this)},hide:function(){this._visible=false},show:function(){this._visible=true},getDom:function(){return this.domElement},getContainer:function(){return this.domElement},setClassName:function(){},setConfig:function(i){if(!i){return}for(var e in i){if(i.hasOwnProperty(e)){this._config[e]=i[e]}}},getPoint:function(T,hY){if(!T){return this.point}else{var e=hY?hY.width:0;var hZ=hY?hY.height:0;if(this.map){var i=this.map.pointToPixelIn(this.point);if(this._config&&this._config.offset){i.x=i.x+this._config.offset.width+e;i.y=i.y+this._config.offset.height+hZ}else{i.x=i.x+e;i.y=i.y+hZ}return this.map.pixelToPointIn(i)}}},setZIndex:function(e){this.zIndex=e},isVisible:function(){if(!this.domElement){return false}return !!this._visible},enableMassClear:function(){this._config.enableMassClear=true},disableMassClear:function(){this._config.enableMassClear=false},showInternal:function(){this._visibleInternal=true},hideInternal:function(e){this._visibleInternal=false;this._hideInternalReason=e}});function e2(e){this.map=e;this._overlays={};this._overlayArray=[];this._customOverlays=[];e._overlays=this._overlays;e._overlayArray=this._overlayArray;e._customOverlays=this._customOverlays;this._zoomingOrMoving=false;this._init()}e2.prototype._init=function(){if(this.map._renderType!=="webgl"){this._createOverlayContainers()}else{this._createWebGLOverlayContainers()}this._bind()};e2.prototype._createOverlayContainers=function(){var e=this.map;e.temp.overlayDiv=e.overlayDiv=this._createOverlayDiv(e.platform,200);e.temp.overlayDivEx=e.overlayDivEx=this._createOverlayDiv(e.platform,50);e._panes.floatPane=this._createOverlayDiv(e.temp.overlayDiv,800);e._panes.markerMouseTarget=this._createOverlayDiv(e.temp.overlayDiv,700);e._panes.floatShadow=this._createOverlayDiv(e.temp.overlayDiv,600);e._panes.labelPane=this._createOverlayDiv(e.temp.overlayDiv,500);e._panes.markerPane=this._createOverlayDiv(e.temp.overlayDiv,400);if(e.isCanvasMap()){e._panes.mapPane=this._createOverlayDiv(e.temp.overlayDivEx,50)}else{e._panes.mapPane=this._createOverlayDiv(e.temp.overlayDiv,200)}};e2.prototype._createWebGLOverlayContainers=function(){var e=this.map;e.temp.overlayDiv=e.overlayDiv=this._createOverlayDiv(e.platform,200);e._panes.floatPane=this._createOverlayDiv(e.temp.overlayDiv,800);e._panes.markerMouseTarget=this._createOverlayDiv(e.temp.overlayDiv,700);e._panes.floatShadow=this._createOverlayDiv(e.temp.overlayDiv,600);e._panes.labelPane=this._createOverlayDiv(e.temp.overlayDiv,500);e._panes.markerPane=this._createOverlayDiv(e.temp.overlayDiv,400)};e2.prototype._createOverlayDiv=function(e,hY){var T=S("div");var i=T.style;i.position="absolute";i.top=i.left=i.width=i.height="0";i.zIndex=hY;e.appendChild(T);return T};e2.prototype._bind=function(){var hZ=this.map;var hY=this;function i(h1){hY.draw(h1)}if(hZ._renderType!=="webgl"){hZ.addEventListener("load",i);hZ.addEventListener("moveend",i);hZ.addEventListener("resize",i);hZ.addEventListener("zoomend",i);hZ.addEventListener("zooming_inner",i)}else{hZ.on("update",i)}hZ.addEventListener("zoomend",function(h1){if(this.mapType==="B_EARTH_MAP"){if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}}});hZ.addEventListener("oncenterandzoom",function(h1){hY.draw(h1);if(this.mapType==="B_EARTH_MAP"){if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}}});hZ.addEventListener("maptypechange",function(h1){if(this.mapType==="B_EARTH_MAP"){if(this._panes.mapPane){this._panes.mapPane.style.display="none"}if(this._earth.getZoom()<this._earth.zoomForNight+1){this.temp.overlayDiv.style.display="none";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display="none"}}else{if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}if(this._panes.markerPane){this._panes.markerPane.style.display="none"}}else{if(this._panes.mapPane){this._panes.mapPane.style.display=""}if(this._panes.markerPane){this._panes.markerPane.style.display=""}if(this.temp.overlayDiv.style.display==="none"){this.temp.overlayDiv.style.display="";if(this.temp.overlayDivEx){this.temp.overlayDivEx.style.display=""}if(this.temp.infoWin&&this.temp.infoWin.isOpen()){this.temp.infoWin.redraw()}}}hY.draw(h1)});hZ.on("earthstatuschange",function h0(h1){hY.draw(h1)});hZ.addEventListener("addoverlay",function(h5){var h2=h5.target;if(h2 instanceof cV){if(!hY._overlays[h2.hashCode]){hY._overlays[h2.hashCode]=h2;hY._overlayArray.push(h2)}}else{var h4=false;for(var h3=0,h1=hY._customOverlays.length;h3<h1;h3++){if(hY._customOverlays[h3]===h2){h4=true;break}}if(!h4){hY._customOverlays.push(h2)}}});hZ.addEventListener("removeoverlay",function(h4){var h2=h4.target;if(h2 instanceof cV){delete hY._overlays[h2.hashCode];for(var h3=0;h3<hY._overlayArray.length;h3++){if(hY._overlayArray[h3]===h2){hY._overlayArray.splice(h3,1);break}}}else{for(var h3=0,h1=hY._customOverlays.length;h3<h1;h3++){if(hY._customOverlays[h3]===h2){hY._customOverlays.splice(h3,1);break}}}});hZ.addEventListener("clearoverlays",function(h3){this.closeInfoWindow();this.closeSimpleInfoWindow();for(var h2 in hY._overlays){if(hY._overlays[h2]._config.enableMassClear){this.removeOverlay(hY._overlays[h2])}}for(var h1=hY._customOverlays.length-1;h1>0;h1--){if(hY._customOverlays[h1].enableMassClear!==false){this.removeOverlay(hY._customOverlays[h1]);hY._customOverlays.splice(h1,1)}}});hZ.addEventListener("infowindowopen",function(h2){var h1=this.infoWindow;if(h1){C.hide(h1.popDom);C.hide(h1.shadowDom)}});function T(){if(this.getMapType()==="B_EARTH_MAP"||this._renderType==="webgl"){if(hY._zoomingOrMoving===false){this._panes.markerMouseTarget.style.display="none";hY._zoomingOrMoving=true}}}function e(h3){if(this.getMapType()==="B_EARTH_MAP"||this._renderType==="webgl"){if(hY._zoomingOrMoving===true){this._panes.markerMouseTarget.style.display="";hY._zoomingOrMoving=false;for(var h2=0;h2<hY._overlayArray.length;h2++){var h1=hY._overlayArray[h2];if(h1 instanceof dr===true){h1.draw(h3)}}}}}hZ.addEventListener("movestart",T);hZ.addEventListener("moveend",e);hZ.addEventListener("zoomstart",T);hZ.addEventListener("zoomend",e);hZ.addEventListener("animation_start",T);hZ.addEventListener("animation_end",e);hZ.addEventListener("displayoptions_changed",function(h1){if(this._displayOptions.overlay===false){this.temp.overlayDiv.style.display="none"}else{this.temp.overlayDiv.style.display=""}})};e2.prototype.draw=function(h1){h1=h1||{};if(this.map.getMapType()==="B_EARTH_MAP"){for(var hZ=0;hZ<this._overlayArray.length;hZ++){var T=this._overlayArray[hZ];if(T instanceof w===true){continue}if(this._zoomingOrMoving){if(T instanceof dr===true){continue}}T.draw(h1)}}else{for(var hZ=0,hY=this._overlayArray.length;hZ<hY;hZ++){var T=this._overlayArray[hZ];if(this._zoomingOrMoving&&T instanceof dr===true){continue}T.draw(h1)}}C.each(this._customOverlays,function(e){e.draw(h1)});if(this.map.temp.infoWin){this.map.temp.infoWin.setPosition(h1.center,h1.zoom)}if(this.map.getMapType()!=="B_EARTH_MAP"&&this.map._renderType!=="webgl"){if(bo.DrawerSelector){var h0=bo.DrawerSelector.getDrawer(this.map);h0.setPalette()}}};bo.register(function(e){e._overlayMgr=new e2(e)});function w(e){cV.call(this);this._config={strokeColor:"#000",strokeWeight:2,strokeOpacity:1,strokeStyle:"solid",dashArray:null,strokeLineCap:"round",strokeLineJoin:"round",enableMassClear:true,getParseTolerance:null,getParseCacheIndex:null,enableParse:true,enableEditing:false,mouseOverTolerance:5,geodesic:false,clip:true,texture:null,textureSize:null,textureZoomWithMap:false,textureRepeat:true};this.setConfig(e);if(this._config.strokeOpacity<0||this._config.strokeOpacity>1){this._config.strokeOpacity=1}if(this._config.fillOpacity<0||this._config.fillOpacity>1){this._config.fillOpacity=1}if(this._config.strokeStyle!=="solid"&&this._config.strokeStyle!=="dashed"&&this._config.strokeStyle!=="dotted"){this._config.strokeStyle="solid"}this.domElement=null;this._bounds=new dT();this.points=[];this.greatCirclePoints=[];this._parseCache=[];this._holesCache=[];this._parseCacheGL=[];this._parseCacheGLRaw=[];this._areaCacheGL=[];this._strokeStyleInfoForGL=[[]];this._fillStyleInfoForGL="";this.vertexMarkers=[];this._temp={}}w.JOININDEX={miter:0,round:1,bevel:2};w.CAPINDEX={round:0,butt:1,square:2};w.inherits(cV,"Graph");w.getGraphPoints=function(i){var e=[];if(!i||i.length===0){return e}if(typeof i==="string"){var T=i.split(";");C.each(T,function(hZ){var hY=hZ.split(",");e.push(new hz(hY[0],hY[1]))})}if(i.constructor===Array&&i.length>0){e=i}return e};w.parseTolerance={0:[0.09,0.005,0.0001,0.00001],1:[9000,500,20,1]};C.extend(w.prototype,{initialize:function(e){this.map=e;return null},draw:function(){},setPoints:function(e){this._clearCache();this.points=w.getGraphPoints(e).slice(0);this._calcBounds()},setPathIn:function(e){this.setPoints(e)},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds=new dT();if(!this.hasMultipleParts){C.each(this.points,function(i){e._bounds.extend(i)})}else{C.each(this.points,function(i){C.each(i,function(T){e._bounds.extend(T)})})}},getPoints:function(){return this.points},getPathIn:function(){return this.points},setPointAt:function(i,e){if(!e||!this.points[i]){return}this._clearCache();this.points[i]=new hz(e.lng,e.lat);this._calcBounds()},setPositionAt:function(i,e){if(!e||!this.points[i]){return}var T=eq.convertLL2MC(e);this.setPointAt(i,T)},setOptions:function(i){i=i||{};for(var e in i){if(i.hasOwnProperty(e)){this._config[e]=i[e]}}},setStrokeColor:function(e){this._config.strokeColor=e},getStrokeColor:function(){return this._config.strokeColor},setStrokeLineCap:function(e){this._config.strokeLineCap=e},getStrokeLineCap:function(){return this._config.strokeLineCap},setStrokeLineJoin:function(e){this._config.strokeLineJoin=e},getStrokeLineJoin:function(){return this._config.strokeLineJoin},setStrokeWeight:function(e){if(e>0){this._config.strokeWeight=e}},getStrokeWeight:function(){return this._config.strokeWeight},setStrokeOpacity:function(e){if(!e||e>1||e<0){return}this._config.strokeOpacity=e},getStrokeOpacity:function(){return this._config.strokeOpacity},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e},getFillOpacity:function(){return this._config.fillOpacity},setStrokeStyle:function(e){if(e!=="solid"&&e!=="dashed"&&e!=="dotted"){return}this._config.strokeStyle=e},getStrokeStyle:function(){return this._config.strokeStyle},setFillColor:function(e){this._config.fillColor=e||""},getFillColor:function(){return this._config.fillColor},getBoundsIn:function(){this._bounds.setMinMax();return this._bounds},getBounds:function(){var e=this.getBoundsIn();var i=new dT(eq.convertMC2LL(e.getSouthWest()),eq.convertMC2LL(e.getNorthEast()));i.setMinMax();return i},remove:function(){if(this.map){this.map.removeEventListener("onmousemove",this._graphMouseEvent);this.map.removeEventListener("onclick",this._graphClickEvent)}cV.prototype.remove.call(this);this._clearCache();var e=new bb("onlineupdate");e.action="remove";e.overlay=this;this.fire(e)},enableEditing:function(){if(this.points.length<2){return}this._config.enableEditing=true;var e=this;ed.load("poly",function(){e.addVertexs()},true)},disableEditing:function(){this._config.enableEditing=false;var e=this;ed.load("poly",function(){e.clearVertexs()},true)},getLength:function(){if(typeof this._length==="number"){return this._length}if(typeof this._config.totalLength==="number"){this._length=this._config.totalLength;return this._length}var T=0;if(this.points.length<=1){this._length=0;return T}for(var e=0;e<this.points.length-1;e++){T+=bP(this.points[e],this.points[e+1])}this._length=T;return T},getParsedPoints:function(){var e=this._simplification(this.points);if(this.hasMultipleParts){return e}return[e]},_simplification:function(h2){var e=this.map;var h1=this.getParseCacheIndex(e.getZoom());var h4;if(this._parseCache[h1]){h4=this._parseCache[h1]}else{var hZ=h2;if(this.greatCirclePoints.length>0){hZ=this.greatCirclePoints}var h0=this.getParseTolerance(e.getZoom(),e.config.coordType);if(!this.hasMultipleParts){var h3=hM(hZ,h0)}else{var h3=[];for(var T=0;T<hZ.length;T++){var hY=hM(hZ[T],h0);h3.push(hY)}}h4=this._parseCache[h1]=h3}return h4},_clearCache:function(){this._length=null;this._parseCache.length=0;this._parseCacheGL.length=0;this._parseCacheGLRaw.length=0;this._areaCacheGL.length=0},canRenderDataBeMerged:function(){var e=this._config;if(e.texture){return false}return true}});if(C.Browser.ie&&document.namespaces&&!document.namespaces.olv){document.namespaces.add("olv","urn:schemas-microsoft-com:vml")}function hi(h0,hY,T){if(!h0||!hY){return}this.imageUrl=null;this.imageDom=null;if(typeof h0==="string"){this.imageUrl=h0}else{this.imageDom=h0;if(!this.imageDom.id){this.imageDom.id=bo.getGUID("icon_dom_")}}this.size=hY;var hZ=new ec(Math.floor(hY.width/2),Math.floor(hY.height/2));var i={offset:hZ,imageOffset:new ec(0,0)};T=T||{};for(var e in T){i[e]=T[e]}if(T.anchor){i.offset=T.anchor}this.anchor=this.offset=i.offset;this.imageOffset=i.imageOffset;this.infoWindowOffset=T.infoWindowOffset||this.offset;this.printImageUrl=T.printImageUrl||"";this.imageSize=T.imageSize||this.size;this.srcSetObject={};this.setImageSrcset(T.srcset||T.srcSet)}hi.prototype.setImageUrl=function(e){if(!e){return}this.imageUrl=e;this._renderData=null};hi.prototype.getCurrentImageUrl=function(){if(window.devicePixelRatio>1&&this.srcSetObject["2x"]){return this.srcSetObject["2x"]}return this.imageUrl};hi.prototype.setPrintImageUrl=function(e){if(!e){return}this.printImageUrl=e};hi.prototype.setSize=function(e){if(!e){return}this.size=new ec(e.width,e.height);this._renderData=null};hi.prototype.setOffset=function(e){if(!e){return}this.anchor=this.offset=new ec(e.width,e.height);this._renderData=null};hi.prototype.setAnchor=function(e){this.setOffset(e)};hi.prototype.setImageOffset=function(e){if(!e){return}this.imageOffset=new ec(e.width,e.height);this._renderData=null};hi.prototype.setInfoWindowOffset=function(e){if(!e){return}this.infoWindowOffset=new ec(e.width,e.height)};hi.prototype.setImageSize=function(e){if(!e){return}this.imageSize=new ec(e.width,e.height)};hi.prototype.setImageSrcset=function(T){var e="";if(!T){return}for(var i in T){if(T.hasOwnProperty(i)){this.srcSetObject[i]=T[i];e=T[i]+" "+i+","}}this.srcSet=e};hi.prototype.toString=function(){return"Icon"};hi.prototype.generateRenderData=function(h0){var T=this.offset;var e=this.size;var h2=this.imageOffset;var h1=[];h1.push(-T.width,T.height-e.height,0);h1.push(e.width-T.width,T.height-e.height,0);h1.push(e.width-T.width,T.height,0);h1.push(-T.width,T.height-e.height,0);h1.push(e.width-T.width,T.height,0);h1.push(-T.width,T.height,0);if(h0!==0){for(var hZ=0;hZ<h1.length;hZ+=3){var hY=vec2.fromValues(h1[hZ],h1[hZ+1]);vec2.rotate(hY,hY,[0,0],dK(-h0));h1[hZ]=hY[0];h1[hZ+1]=hY[1]}}return{vertex:h1}};hi.prototype.getRenderData=function(e){this._renderData=this.generateRenderData(e);return this._renderData};function an(T,i){C.BaseClass.call(this);this.content=T;this.map=null;this._config={width:0,height:0,maxWidth:600,offset:new ec(0,0),title:"",maxContent:"",enableMaximize:false,enableAutoPan:true,enableCloseOnClick:true,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:false,onClosing:function(){return true}};this.setConfig(i);if(this._config.width!==0){if(this._config.width<220){this._config.width=220}if(this._config.width>730){this._config.width=730}}if(this._config.height!==0){if(this._config.height<60){this._config.height=60}if(this._config.height>650){this._config.height=650}}if(this._config.maxWidth!==0){if(this._config.maxWidth<220){this._config.maxWidth=220}if(this._config.maxWidth>730){this._config.maxWidth=730}}this.isWinMax=false;this.IMG_PATH=e8.imgPath;this.overlay=null;var e=this;ed.load("infowindow",function(){e._draw()})}an.inherits(C.BaseClass,"InfoWindow");C.extend(an.prototype,{setWidth:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<220){e=220}if(e>730){e=730}}this._config.width=e},setHeight:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<60){e=60}if(e>650){e=650}}this._config.height=e},setMaxWidth:function(e){e=e*1;if(!e&&e!==0||isNaN(e)||e<0){return}if(e!==0){if(e<220){e=220}if(e>730){e=730}}this._config.maxWidth=e},setTitle:function(e){this._config.title=e||""},setContent:function(e){this.content=e||""},getContent:function(){return this.content},setMaxContent:function(e){this._config.maxContent=e||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=true},disableAutoPan:function(){this._config.enableAutoPan=false},enableCloseOnClick:function(){this._config.enableCloseOnClick=true},disableCloseOnClick:function(){this._config.enableCloseOnClick=false},enableMaximize:function(){this._config.enableMaximize=true},disableMaximize:function(){this._config.enableMaximize=false},show:function(){this._visible=true},hide:function(){this._visible=false},close:function(){this.hide()},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=true},restore:function(){this.isWinMax=false},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])===typeof(i[e])){this._config[e]=i[e]}}},isVisible:function(){return this.isOpen()},isOpen:function(){return false},getPointIn:function(){if(this.overlay&&this.overlay.getPoint){return this.overlay.getPoint()}},getTitle:function(){return this._config.title||""},getPosition:function(){return this.latLng;var e=this.getPointIn();return eq.convertMC2LL(e)},getPoint:function(){var e=this.getPointIn();return eq.convertMC2LL(e)},getOffset:function(){return this._config.offset},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},toString:function(){return"InfoWindow"}});c8.prototype.openInfoWindow=function(T,e){T.latLng=new c4(e.lat,e.lng);var i=eq.convertLL2MC(e);this.openInfoWindowIn(T,i)};c8.prototype.closeInfoWindow=function(){var e=this.temp.infoWin||this.temp._infoWin;if(e&&e.overlay){e.overlay.closeInfoWindow()}};c8.prototype.openInfoWindowIn=function(hY,e){if(!hY||hY.toString()!=="InfoWindow"||!e||e.toString()!=="Point"){return}var i=this.temp;if(!i.marker){var T=new hi(e8.imgPath+"blank.gif",{width:1,height:1});i.marker=new dr(e,{icon:T,width:1,height:1,offset:new ec(0,0),infoWindowOffset:new ec(0,0),clickable:false});i.marker._fromMap=1}else{i.marker.setPoint(e)}this.addOverlay(i.marker);i.marker.show();i.marker.openInfoWindow(hY)};cV.prototype.openInfoWindow=function(e){if(this.map){this.map.closeInfoWindow();e._visible=true;this.map.temp._infoWin=e;e.overlay=this;C.BaseClass.call(e,e.hashCode)}};cV.prototype.closeInfoWindow=function(){if(this.map&&this.map.temp._infoWin){this.map.temp._infoWin._visible=false;this.map.temp._infoWin.decontrol();this.map.temp._infoWin=null}};function aM(T,i){cV.call(this);this.content=T;this.map=null;this.domElement=null;this._config={width:0,offset:new ec(0,0),styles:{backgroundColor:"#fff",border:"1px solid #f00",padding:"1px",whiteSpace:"nowrap",fontSize:"12px",zIndex:"80",MozUserSelect:"none"},point:null,enableMassClear:true};i=i||{};this.setConfig(i);if(this._config.width<0){this._config.width=0}this.point=this._config.point;var e=this;ed.load("marker",function(){e._draw()})}aM.inherits(cV,"Label");C.extend(aM.prototype,{setPoint:function(e){if(e&&e.toString()==="Point"&&!this.getMarker()){this.point=this._config.point=new hz(e.lng,e.lat)}},setContent:function(e){this.content=e},getContent:function(e){return this.content},setOpacity:function(e){if(e>=0&&e<=1){this._config.opacity=e}},setOffset:function(e){if(!e||e.toString()!=="Size"){return}this._config.offset=new ec(e.width,e.height)},getOffset:function(){return this._config.offset},setStyle:function(e){e=e||{};this._config.styles=C.extend(this._config.styles,e)},setStyles:function(e){this.setStyle(e)},setTitle:function(e){this._config.title=e||""},getTitle:function(){return this._config.title},setMarker:function(e){if(this._marker&&this._marker!==e){this._marker._config.label=null}this._marker=e;if(e){this.point=this._config.point=e.getPoint()}else{this.point=this._config.point=null}},getMarker:function(){return this._marker||null},getPositionIn:function(){return this.getPoint()},});function fV(T,i){var hY={};for(var e in i){if(i.hasOwnProperty(e)){if(e==="position"){hY.point=eq.convertLL2MC(i[e]);this.latLng=new c4(i[e]["lat"],i[e]["lng"])}else{hY[e]=i[e]}}}aM.call(this,T,hY)}fV.inherits(aM,"LabelOut");C.extend(fV.prototype,{toString:function(){return"Label"},setPosition:function(e){this.latLng=new c4(e.lat,e.lng);var i=eq.convertLL2MC(e);this.setPoint(i)},getPosition:function(){return this.latLng;var e=this.getPositionIn();return eq.convertMC2LL(e)}});window.BMAP_ANIMATION_DROP=1;window.BMAP_ANIMATION_BOUNCE=2;function dr(e,i){cV.call(this);i=i||{};this.point=e;this._rotation=0;this.map=null;this._animation=null;this.domElement=null;this.iconDom=null;this.infoWindowDom=null;this.siblingElement=null;this.textureCoord=null;this.textureCoordGLMap=null;this.collisionDetectionFailed=false;this._config={offset:new ec(0,0),opacity:1,icon:null,title:"",infoWindow:null,label:null,baseZIndex:0,clickable:true,zIndexFixed:false,isTop:false,enableMassClear:true,enableDragging:false,raiseOnDrag:false,restrictDraggingArea:false,startAnimation:"",enableCollisionDetection:false,rank:0,enableDraggingMap:false};this.setConfig(i);if(!i.icon){this._config.icon=new hi(e8.imgPath+"marker_red.png",new ec(23,25),{offset:new ec(10,25),infoWindowOffset:new ec(10,0)})}this._isDragging=false;var T=this;ed.load("marker",function(){T._draw()})}dr.TOP_ZINDEX=bl.getZIndex(-90)+1000000;dr.DRAG_ZINDEX=dr.TOP_ZINDEX+1000000;dr._injectMethond=function(e){C.extend(dr.prototype,e)};dr.inherits(cV,"Marker");C.extend(dr.prototype,{toString:function(){return"Marker"},setIcon:function(e){if(e){this._config.icon=e;this.textureCoord=this.textureCoordGLMap=null}},getIcon:function(){return this._config.icon},setLabel:function(e){if(!(e instanceof aM)){return}this._config.label=e;e._config.enableMassClear=this._config.enableMassClear;e.setPoint(this.point)},getLabel:function(){return this._config.label},enableDragging:function(){this._config.enableDragging=true},disableDragging:function(){this._config.enableDragging=false},setPoint:function(e){if(e){this.point=this._config.point=new hz(e.lng,e.lat);this.latLng=eq.convertMC2LL(e)}},setPositionIn:function(e){this.setPoint(e)},getPositionIn:function(){return this.getPoint()},setTop:function(i,e){this._config.isTop=!!i;if(i){this._addi=e||0}},setTitle:function(e){this._config.title=e||""},getTitle:function(){return this._config.title},setOffset:function(e){if(e){this._config.offset=e}},getOffset:function(){return this._config.offset},setAnimation:function(e){this._animation=e},setRank:function(e){this._config.rank=e},getRank:function(){return this._config.rank},setRotation:function(e){while(e<0){e+=360}this._rotation=e%360},getRotation:function(){return this._rotation}});function aC(e,T){this.latLng=new c4(e.lat,e.lng);var i=eq.convertLL2MC(e);dr.call(this,i,T)}aC.inherits(dr,"MarkerOut");C.extend(aC.prototype,{toString:function(){return"Marker"},setPosition:function(e){this.latLng=new c4(e.lat,e.lng);var i=eq.convertLL2MC(e);this.setPositionIn(i)},getPosition:function(){return this.latLng;var e=this.getPositionIn();return eq.convertMC2LL(e)},});window.BMAP_SHAPE_CIRCLE=1;window.BMAP_SHAPE_RECT=2;function bd(i,e,T){cV.call(this,e,T);this.domElement=null;this.point=i;T=T||{};this._config={};this._config.height=e||0;this._config.size=typeof T.size==="number"?T.size:50;this._config.fillOpacity=typeof T.fillOpacity==="number"?T.fillOpacity:0.8;this._config.shape=typeof T.shape==="number"?T.shape:1;fL(this._config.fillOpacity,0,1);if(T.fillColor===""){this._config.fillColor=""}else{this._config.fillColor=T.fillColor?T.fillColor:"#f00"}this._config.icon=T.icon instanceof hi?T.icon:"";this._config.enableMassClear=T.enableMassClear||true;var hY=this;ed.load("marker",function(){hY._draw()})}bd.inherits(cV,"Marker3D");C.extend(bd.prototype,{setPoint:function(e){this.point=this._config.point=new hz(e.lng,e.lat);this.latLng=eq.convertMC2LL(e);var i=new bb("onstatus_change");i.overlay=this;i.action="setPoint";this.fire(i)},setPositionIn:function(e){this.setPoint(e)},getPositionIn:function(){return this.getPoint()},setDomAttribute:function(i,T){var e=new bb("onlineupdate");e.overlay=this;this.dispatchEvent(e)}});function cv(i,e,hY){this.latLng=new c4(i.lat,i.lng);var T=eq.convertLL2MC(i);bd.call(this,T,e,hY)}cv.inherits(bd,"Marker3d");C.extend(cv.prototype,{toString:function(){return"Marker3D"},setHeight:function(e){this._config.height=Number(e);this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getHeight:function(){return this._config.height},setFillOpacity:function(e){if(e>1||e<0){return}this._config.fillOpacity=e;this.setDomAttribute("fillopacity",e)},getFillOpacity:function(){return this._config.fillOpacity},setFillColor:function(e){this._config.fillColor=e||"";this.setDomAttribute("fillcolor",e)},getFillColor:function(){return this._config.fillColor},setIcon:function(i){if(!i||!this.map){return}this._config.icon=i;if(this._config.icon){var e=this._config.icon.getCurrentImageUrl();var hY=i.getCurrentImageUrl()!==e;this._config.icon=i;this.textureCoord=this.textureCoordGLMap=null;this.draw();var T=new bb("onstatus_change");T.overlay=this;T.action="setIcon";T.imageUrlChanged=hY;this.fire(T)}},getIcon:function(){return this._config.icon},setPosition:function(e){this.latLng=new c4(e.lat,e.lng);var i=eq.convertLL2MC(e);this.setPositionIn(i)},getPosition:function(){var e=this.getPositionIn();return eq.convertMC2LL(e)}});function a(T,e){w.call(this,e);this._normalizedBounds=new dT();this.setPoints(T);var i=this;ed.load("poly",function(){i._draw()})}a.inherits(w,"Polyline");C.extend(a.prototype,{getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},setPoints:function(T){this._clearCache();this.points=w.getGraphPoints(T).slice(0);if(this._config.geodesic===true){this.greatCirclePoints.length=0;for(var e=0;e<this.points.length-1;e++){this.calcGreatCirclePoints(this.points[e],this.points[e+1])}}this._calcBounds()},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){C.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{C.each(e.points,function(i){e._bounds.extend(i)})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-c8.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>c8.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-c8.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=c8.WORLD_SIZE_MC_HALF}},calcGreatCirclePoints:function(hY,T){var h0=hY.latLng;var hZ=T.latLng;if(h0.equals(hZ)){return}var e=eq.getDistance(dK(h0.lng),dK(h0.lat),dK(hZ.lng),dK(hZ.lat));if(e<250000){return}var h4=Math.round(e/150000);var h8=this.calcAngularDistance(h0,hZ);this.greatCirclePoints.push(hY);var h7=h0.lng;var h6=hY;for(var h1=0;h1<h4;h1++){var h3=this.calcMiddlePoint(h0,hZ,h1/h4,h8);var h5=eq.convertLL2MC(h3);var h2=h5.lng;var h9=bP(h5,h6);if(h9>30037726){if(h5.lng<h6.lng){h5.lng+=c8.WORLD_SIZE_MC}else{h5.lng-=c8.WORLD_SIZE_MC}}this.greatCirclePoints.push(h5);h6=h5}var h9=bP(T,h6);if(h9>30037726){if(T.lng<h6.lng){T.lng+=c8.WORLD_SIZE_MC}else{T.lng-=c8.WORLD_SIZE_MC}}this.greatCirclePoints.push(T)},calcMiddlePoint:function(h5,h4,h6,ia){var hZ=h5.lat;var hY=h4.lat;var h9=h5.lng;var h7=h4.lng;var ib=dK(hZ);var h8=dK(hY);var i=dK(h9);var e=dK(h7);var id=Math.sin((1-h6)*ia)/Math.sin(ia);var ic=Math.sin(h6*ia)/Math.sin(ia);var h2=id*Math.cos(ib)*Math.cos(i)+ic*Math.cos(h8)*Math.cos(e);var h1=id*Math.cos(ib)*Math.sin(i)+ic*Math.cos(h8)*Math.sin(e);var h0=id*Math.sin(ib)+ic*Math.sin(h8);var T=Math.atan2(h0,Math.sqrt(Math.pow(h2,2)+Math.pow(h1,2)));var h3=Math.atan2(h1,h2);return new hz(de(h3),de(T))},calcAngularDistance:function(hZ,i){var h0=dK(hZ.lat);var hY=dK(i.lat);var T=dK(hZ.lng);var e=dK(i.lng);return Math.acos(Math.sin(h0)*Math.sin(hY)+Math.cos(h0)*Math.cos(hY)*Math.cos(Math.abs(e-T)))}});function ak(hZ,e){if(!hZ||hZ.length===0){return}var hY=[];for(var T=0;T<hZ.length;T++){hY[T]=eq.convertLL2MC(hZ[T])}a.call(this,hY,e)}ak.inherits(a,"PolylineOut");C.extend(ak.prototype,{toString:function(){return"Polyline"},setPath:function(hY){if(!hY||hY.length===0){return}var T=[];for(var e=0;e<hY.length;e++){T[e]=eq.convertLL2MC(hY[e])}this.setPathIn(T)},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var hY=[];for(var T=0;T<e.length;T++){hY[T]=eq.convertMC2LL(e[T])}return hY},getBounds:function(i){var e=this.getBoundsIn(i);var T=new dT(eq.convertMC2LL(e.getSouthWest()),eq.convertMC2LL(e.getNorthEast()));return T}});function es(T,hY,e){w.call(this,e);this._normalizedBounds=new dT();this._cps=hY;this._path=T;this.setPoints(T);var i=this;ed.load("poly",function(){i._draw()})}es.inherits(a,"BezierCurve");C.extend(es.prototype,{getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},setPoints:function(e){this._clearCache();this.points=w.getGraphPoints(e).slice(0);this.points=this.calcBezierPoints(this.points,this._cps);this._calcBounds()},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){C.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{C.each(e.points,function(i){e._bounds.extend(i)})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-c8.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>c8.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-c8.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=c8.WORLD_SIZE_MC_HALF}},getPathIn:function(){return this._path},setPathIn:function(e){this._path=e;this.setPoints(e)},getCpsIn:function(){return this._cps},setCpsIn:function(e){this._cps=e;this.setPoints(this._path)},calcBezierPoints:function(hY,h0){var T=[];for(var e=0;e<hY.length-1;e++){var hZ=[hY[e],h0[e][0],h0[e][1],hY[e+1]];T=T.concat((this.bezierbetweenTwoP(hZ)))}return T},bezierbetweenTwoP:function(h0){var T=100;var hZ=1/T;var e=[];for(var hY=0;hY<T;hY++){e.push(this.getPointOnCubicBezier(h0,hY*hZ))}return e},getPointOnCubicBezier:function(h1,h5){var i;var h0;var hY;var h6;var hZ;var T;var h4;var e;var h3;var h2;hY=3*(h1[1].lng-h1[0].lng);h0=3*(h1[2].lng-h1[1].lng)-hY;i=h1[3].lng-h1[0].lng-hY-h0;T=3*(h1[1].lat-h1[0].lat);hZ=3*(h1[2].lat-h1[1].lat)-T;h6=h1[3].lat-h1[0].lat-T-hZ;h4=h5*h5;e=h4*h5;h3=(i*e)+(h0*h4)+(hY*h5)+h1[0].lng;h2=(h6*e)+(hZ*h4)+(T*h5)+h1[0].lat;return new hz(h3,h2)}});function ft(hZ,h1,e){if(!hZ||hZ.length===0){return}this.userPath=hZ;this.userCps=h1;var hY=[];for(var T=0;T<hZ.length;T++){hY[T]=eq.convertLL2MC(hZ[T])}if(!h1||h1.length===0){return}var h0=[];for(var T=0;T<h1.length;T++){h0[T]=[];h0[T][0]=eq.convertLL2MC(h1[T][0]);if(h1[T][1]){h0[T][1]=eq.convertLL2MC(h1[T][1])}else{h0[T][1]=eq.convertLL2MC(h1[T][0])}}es.call(this,hY,h0,e)}ft.inherits(es,"BezierCurveOut");C.extend(ft.prototype,{toString:function(){return"BezierCurve"},setPath:function(hY){if(!hY||hY.length===0){return}this.userPath=hY;var T=[];for(var e=0;e<hY.length;e++){T[e]=eq.convertLL2MC(hY[e])}this.setPathIn(T)},getPath:function(){return this.userPath;var e=this.getPathIn();if(!e||e.length===0){return[]}var hY=[];for(var T=0;T<e.length;T++){hY[T]=eq.convertMC2LL(e[T])}return hY},getControlPoints:function(){return this.userCps;var e=this.getCpsIn();if(!e||e.length===0){return[]}var hY=[];for(var T=0;T<e.length;T++){hY[T]=[];hY[T][0]=eq.convertMC2LL(e[T][0]);hY[T][1]=eq.convertMC2LL(e[T][1])}return hY},setControlPoints:function(hY){if(!hY||hY.length===0){return}this.userCps=hY;var T=[];for(var e=0;e<hY.length;e++){T[e]=[];T[e][0]=eq.convertLL2MC(hY[e][0]);if(hY[e][1]){T[e][1]=eq.convertLL2MC(hY[e][1])}else{T[e][1]=eq.convertLL2MC(hY[e][0])}}this.setCpsIn(T)},getBounds:function(i){var e=this.getBoundsIn(i);var T=new dT(eq.convertMC2LL(e.getSouthWest()),eq.convertMC2LL(e.getNorthEast()));return T}});function fr(e,T){w.call(this,T);this._normalizedBounds=new dT();this.setPoints(e);var i=this;ed.load("poly",function(){i._draw()})}fr.inherits(a,"PolylineMultipart");C.extend(fr.prototype,{setPoints:function(e){if(!e){return}this._clearCache();this.points=this._unifyArgs(e);this._calcBounds()},_unifyArgs:function(T){var e=[];var i=[];if(T.constructor===Array){if(T[0].constructor===hz){i.push(T)}else{i=T}}else{if(typeof T==="string"){i.push(T)}}C.each(i,function(hY){e.push(w.getGraphPoints(hY))});return e},setPointAt:function(i,e,T){T=T||0;if(!e||!this.points[T]||!this.points[T][i]){return}this._clearCache();this.points[T][i]=new hz(e.lng,e.lat);this._calcBounds()},getBoundsIn:function(e){if(!e){this._bounds.setMinMax();return this._bounds}this._normalizedBounds.setMinMax();return this._normalizedBounds},_calcBounds:function(){if(!this.points){return}var e=this;e._bounds.setNorthEast(null);e._bounds.setSouthWest(null);if(e.greatCirclePoints&&e.greatCirclePoints.length>0){C.each(e.greatCirclePoints,function(i){e._bounds.extend(i)})}else{C.each(e.points,function(i){C.each(i,function(T){e._bounds.extend(T)})})}e._normalizedBounds.setSouthWest(e._bounds.getSouthWest());e._normalizedBounds.setNorthEast(e._bounds.getNorthEast());if(e._normalizedBounds.sw.lng<-c8.WORLD_SIZE_MC_HALF||e._normalizedBounds.ne.lng>c8.WORLD_SIZE_MC_HALF){e._normalizedBounds.sw.lng=-c8.WORLD_SIZE_MC_HALF;e._normalizedBounds.ne.lng=c8.WORLD_SIZE_MC_HALF}}});function aQ(T,e){w.call(this,e);e=e||{};if(typeof e.fillOpacity==="number"){this._config.fillOpacity=e.fillOpacity}else{this._config.fillOpacity=0.6}fL(this._config.fillOpacity,0,1);if(e.fillColor===""){this._config.fillColor=""}else{this._config.fillColor=e.fillColor?e.fillColor:"#fff"}this._parseFillCacheWebGL=[];this.setPoints(T,e);var i=this;ed.load("poly",function(){i._draw()})}aQ.inherits(w,"Polygon");C.extend(aQ.prototype,{setPoints:function(h0){var hY=[];if(typeof h0==="string"||h0.length===1||h0[0] instanceof hz||h0[0] instanceof c4||this instanceof ge||h0.length===0){if(h0.length===1){h0=h0[0]}var e=this._processSinglePointArray(h0);this._userPoints=e.userPoints;hY=e.innerPoints;this.hasMultipleParts=false}else{this._userPoints=[];for(var hZ=0;hZ<h0.length;hZ++){var T=this._processSinglePointArray(h0[hZ]);this._userPoints.push(T.userPoints);hY.push(T.innerPoints)}this.hasMultipleParts=true}w.prototype.setPoints.call(this,hY)},setPathIn:function(e){this.setPoints(e)},_processSinglePointArray:function(e){var i=w.getGraphPoints(e).slice(0);innerPoints=i.slice(0);if(innerPoints.length>1&&!innerPoints[0].equals(innerPoints[innerPoints.length-1])){innerPoints.push(new hz(innerPoints[0].lng,innerPoints[0].lat))}return{userPoints:i,innerPoints:innerPoints}},setPointAt:function(i,e){if(!this._userPoints[i]){return}this._clearCache();this._userPoints[i]=new hz(e.lng,e.lat);this.points[i]=new hz(e.lng,e.lat);if(i===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hz(e.lng,e.lat)}this._calcBounds()},setPositionAt:function(i,e){if(!this._userPoints[i]){return}var T=eq.convertLL2MC(e);this.setPointAt(i,T)},getPoints:function(){var e=this._userPoints;if(e.length===0){e=this.points}return e},getPathIn:function(){return this.getPoints()}});function hb(h3,h0){if(!h3||h3.length===0){return}var h2=[];if(typeof h3==="string"||h3[0] instanceof hz||h3[0] instanceof c4){var e=this._processSinglePointArray(h3);for(var h1=0;h1<e.innerPoints.length;h1++){h2[h1]=eq.convertLL2MC(e.innerPoints[h1])}}else{for(var h1=0;h1<h3.length;h1++){var T=this._processSinglePointArray(h3[h1]);var hZ=[];for(var hY=0;hY<T.innerPoints.length;hY++){hZ[hY]=eq.convertLL2MC(T.innerPoints[hY])}h2.push(hZ)}}aQ.call(this,h2,h0)}hb.inherits(aQ,"PolygonOut");C.extend(hb.prototype,{toString:function(){return"Polygon"},setPath:function(hY){if(!hY||hY.length===0){return}hY=w.getGraphPoints(hY);var T=[];for(var e=0;e<hY.length;e++){T[e]=eq.convertLL2MC(hY[e])}this.setPathIn(T)},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var hY=[];for(var T=0;T<e.length;T++){hY[T]=eq.convertMC2LL(e[T])}return hY}});function ge(i,e,T){this.point=i;this.radius=Math.abs(e);aQ.call(this,[],T)}ge.parseTolerance={0:[0.01,0.0001,0.00001,0.000004],1:[1000,10,1,0.4]};ge.inherits(aQ,"Circle");C.extend(ge.prototype,{initialize:function(e){this.map=e;this.points=this._getPerimeterPoints(this.point,this.radius);this._calcBounds();return null},getPoint:function(){return this.point},setPoint:function(e){if(!e){return}this.point=e;this.latLng=eq.convertMC2LL(e)},setCenterIn:function(e){var i=arguments[1];this.setPoint(e,i)},setRadius:function(e){this.radius=Math.abs(e)},getCenterIn:function(){return this.point},getRadius:function(){return this.radius},_getPerimeterPoints:function(e,h5){if(!e||!h5||!this.map){return[]}var T=this.map;var h2=e.lng;var h0=e.lat;var ib=eq.convertMC2LL(e);h2=ib.lng;h0=ib.lat;var ic=[];var h7=h5/eq.EARTHRADIUS;var h4=(Math.PI/180)*h0;var ia=(Math.PI/180)*h2;for(var h3=0;h3<360;h3+=9){var h1=(Math.PI/180)*h3;var h8=Math.asin(Math.sin(h4)*Math.cos(h7)+Math.cos(h4)*Math.sin(h7)*Math.cos(h1));var h6=Math.atan2(Math.sin(h1)*Math.sin(h7)*Math.cos(h4),Math.cos(h7)-Math.sin(h4)*Math.sin(h8));var h9=((ia-h6+Math.PI)%(2*Math.PI))-Math.PI;var hZ=new c4(h8*(180/Math.PI),h9*(180/Math.PI));ic.push(eq.convertLL2MC(hZ))}var hY=ic[0];ic.push(new hz(hY.lng,hY.lat));if(hY){this._radiusMercator=Math.sqrt(Math.pow(hY.lng-this.point.lng,2)+Math.pow(hY.lat-this.point.lat,2))}else{this._radiusMercator=this.radius}return ic}});function dF(i,e,hY){this.latLng=new c4(i.lat,i.lng);var T=eq.convertLL2MC(i);ge.call(this,T,e,hY)}dF.inherits(ge,"CircleOut");C.extend(dF.prototype,{toString:function(){return"Circle"},setCenter:function(e){this.latLng=new c4(e.lat,e.lng);var i=eq.convertLL2MC(e);this.setCenterIn(i)},getCenter:function(){return this.latLng},getPath:function(){var e=this.getPathIn();if(!e||e.length===0){return[]}var hY=[];for(var T=0;T<e.length;T++){hY[T]=eq.convertMC2LL(e[T])}return hY}});function bs(hY,e,i){w.call(this,i);i=i||{};if(typeof i.topFillOpacity==="number"){this._config.topFillOpacity=i.topFillOpacity}else{this._config.topFillOpacity=0.6}if(typeof i.sideFillOpacity==="number"){this._config.sideFillOpacity=i.sideFillOpacity}else{this._config.sideFillOpacity=0.8}fL(this._config.sideFillOpacity,0,1);if(i.topFillColor===""){this._config.topFillColor=""}else{this._config.topFillColor=i.topFillColor?i.topFillColor:"#fff"}if(i.sideFillColor===""){this._config.sideFillColor=""}else{this._config.sideFillColor=i.sideFillColor?i.sideFillColor:"#fff"}this._parseFillCacheWebGL=[];this.setPoints(hY,i);this._config.altitude=e||0;var T=this;ed.load("poly",function(){T._draw()})}bs.inherits(w,"Prism");C.extend(bs.prototype,{setPoints:function(h0){var hY=[];if(typeof h0==="string"||h0[0] instanceof hz||h0[0] instanceof c4||this instanceof ge||h0.length===0){var e=this._processSinglePointArray(h0);this._userPoints=e.userPoints;hY=e.innerPoints;this.hasMultipleParts=false}else{this._userPoints=[];for(var hZ=0;hZ<h0.length;hZ++){var T=this._processSinglePointArray(h0[hZ]);this._userPoints.push(T.userPoints);hY.push(T.innerPoints)}this.hasMultipleParts=true}w.prototype.setPoints.call(this,hY)},setPathIn:function(e){this.setPoints(e)},_processSinglePointArray:function(e){var i=w.getGraphPoints(e).slice(0);innerPoints=i.slice(0);if(innerPoints.length>1&&!innerPoints[0].equals(innerPoints[innerPoints.length-1])){innerPoints.push(new hz(innerPoints[0].lng,innerPoints[0].lat))}return{userPoints:i,innerPoints:innerPoints}},setPointAt:function(i,e){if(!this._userPoints[i]){return}this._clearCache();this._userPoints[i]=new hz(e.lng,e.lat);this.points[i]=new hz(e.lng,e.lat);if(i===0&&!this.points[0].equals(this.points[this.points.length-1])){this.points[this.points.length-1]=new hz(e.lng,e.lat)}this._calcBounds()},getPoints:function(){var e=this._userPoints;if(e.length===0){e=this.points}return e},getPathIn:function(){return this.getPoints()},setTopFillOpacity:function(e){if(e>1||e<0){return}this._config.topFillOpacity=e;this._setDomAttribute("topfillopacity",e)},getTopFillOpacity:function(){return this._config.topFillOpacity},setSideFillOpacity:function(e){if(e>1||e<0){return}this._config.sideFillOpacity=e;this._setDomAttribute("sidefillopacity",e)},getSideFillOpacity:function(){return this._config.sideFillOpacity},setTopFillColor:function(e){this._config.topFillColor=e||"";this._setDomAttribute("topfillcolor",e)},getTopFillColor:function(){return this._config.topFillColor},setSideFillColor:function(e){this._config.sideFillColor=e||"";this._setDomAttribute("sidefillcolor",e)},getSideFillColor:function(){return this._config.sideFillColor},setAltitude:function(e){this._config.altitude=Number(e);this.draw();var i=new bb("onlineupdate");i.overlay=this;this.dispatchEvent(i)},getAltitude:function(){return this._config.altitude}});function cg(h2,h0,h3){if(!h2||h2.length===0){return}this.userPath=h2;var e=[];if(typeof h2==="string"||h2[0] instanceof hz||h2[0] instanceof c4){var h4=this._processSinglePointArray(h2);for(var hZ=0;hZ<h4.innerPoints.length;hZ++){e[hZ]=eq.convertLL2MC(h4.innerPoints[hZ])}}else{for(var hZ=0;hZ<h2.length;hZ++){var h1=this._processSinglePointArray(h2[hZ]);var T=[];for(var hY=0;hY<h1.innerPoints.length;hY++){T[hY]=eq.convertLL2MC(h1.innerPoints[hY])}e.push(T)}}bs.call(this,e,h0,h3)}cg.inherits(bs,"PrismOut");C.extend(cg.prototype,{toString:function(){return"Prism"},setPath:function(hY){if(!hY||hY.length===0){return}this.userPath=hY;var T=[];for(var e=0;e<hY.length;e++){T[e]=eq.convertLL2MC(hY[e])}this.setPathIn(T)},getPath:function(){return this.userPath;var e=this.getPathIn();if(!e||e.length===0){return[]}var hY=[];for(var T=0;T<e.length;T++){hY[T]=eq.convertMC2LL(e[T])}return hY}});function dX(T,e){w.call(this,e);e=e||{};this._config.type=e.type||"image";this._config.url=e.url||"";this._config.opacity=typeof e.opacity==="number"?e.opacity:1;fL(this._config.opacity,0,1);this._parseFillCacheWebGL=[];this.setPoints(T,e);var i=this;ed.load("poly",function(){i._draw()})}dX.inherits(w,"GroundOverlay");C.extend(dX.prototype,{setPoints:function(i){var e=w.getGraphPoints(i).slice(0);this.hasMultipleParts=false;w.prototype.setPoints.call(this,e)},setPathIn:function(e){this.setPoints(e)},getPoints:function(){return this.points},getPathIn:function(){return this.getPoints()}});function cp(hZ,T){if(!hZ){return}var h1=[new hz(hZ.sw.lng,hZ.ne.lat),new hz(hZ.ne.lng,hZ.ne.lat),new hz(hZ.ne.lng,hZ.sw.lat),new hz(hZ.sw.lng,hZ.sw.lat)];var e=w.getGraphPoints(h1).slice(0);var h0=[];for(var hY=0;hY<e.length;hY++){h0[hY]=eq.convertLL2MC(e[hY])}dX.call(this,h0,T)}cp.inherits(dX,"GroundOverlayOut");C.extend(cp.prototype,{toString:function(){return"GroundOverlay"}});var bB={};function hO(T,i){C.BaseClass.call(this);this.content=T;this.map=null;this._config={width:0,height:0,maxWidth:600,offset:new ec(0,0),title:"",maxContent:"",enableMaximize:false,enableAutoPan:true,enableCloseOnClick:true,margin:[10,10,40,10],collisions:[[10,10],[10,10],[10,10],[10,10]],ifMaxScene:false,onClosing:function(){return true}};this.setConfig(i);if(this._config.width<50){this._config.width=50}if(this._config.width>730){this._config.width=730}if(this._config.height!=0){if(this._config.height<50){this._config.height=50}if(this._config.height>650){this._config.height=650}}if(this._config.maxWidth!==0){if(this._config.maxWidth<50){this._config.maxWidth=50}if(this._config.maxWidth>730){this._config.maxWidth=730}}this.isWinMax=false;this.IMG_PATH=e8.imgPath;this.overlay=null;var e=this;ed.load("simpleInfowindow",function(){e._draw()})}hO.inherits(C.BaseClass,"SimpleInfoWindow");C.extend(hO.prototype,{setWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>730){e=730}}this._config.width=e},setHeight:function(e){e=e*1;e-=10;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>650){e=650}}this._config.height=e},setMaxWidth:function(e){e=e*1;if(!e&&e!=0||isNaN(e)||e<0){return}if(e!=0){if(e<50){e=50}if(e>730){e=730}}this._config.maxWidth=e},setTitle:function(e){this._config.title=e||""},setContent:function(e){this.content=e||""},setMaxContent:function(e){this._config.maxContent=e||""},redraw:function(){},enableAutoPan:function(){this._config.enableAutoPan=true},disableAutoPan:function(){this._config.enableAutoPan=false},enableCloseOnClick:function(){this._config.enableCloseOnClick=true},disableCloseOnClick:function(){this._config.enableCloseOnClick=false},enableMaximize:function(){this._config.enableMaximize=true},disableMaximize:function(){this._config.enableMaximize=false},show:function(){this._visible=true},hide:function(){this._visible=false},close:function(){this.hide()},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},maximize:function(){this.isWinMax=true},restore:function(){this.isWinMax=false},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])==typeof(i[e])){this._config[e]=i[e]}}},isVisible:function(){return this.isOpen()},isOpen:function(){return false},getPoint:function(){if(this.overlay&&this.overlay.getPoint){return this.overlay.getPoint()}},getOffset:function(){return this._config.offset},dispose:function(){C.BaseClass.prototype.decontrol.call(this)},toString:function(){return"SimpleInfoWindow"}});c8.prototype.openSimpleInfoWindow=function(hY,e){if(!hY||hY.toString()!="SimpleInfoWindow"||!e||e.toString()!="Point"){return}var i=this.temp;if(!i.marker){var T=new hi(e8.imgPath+"blank.gif",{width:1,height:1});i.marker=new dr(e,{icon:T,width:1,height:1,offset:new ec(0,0),infoWindowOffset:new ec(0,0),clickable:false});i.marker._fromMap=1}else{i.marker.setPoint(e)}this.addOverlay(i.marker);i.marker.show();i.marker.openSimpleInfoWindow(hY)};c8.prototype.closeSimpleInfoWindow=function(){var e=this.temp.infoWin||this.temp._infoWin;if(e&&e.overlay){e.overlay.closeSimpleInfoWindow()}};cV.prototype.openSimpleInfoWindow=function(e){if(this.map){this.map.closeSimpleInfoWindow();e._visible=true;this.map.temp._infoWin=e;e.overlay=this;C.BaseClass.call(e,e.hashCode)}};cV.prototype.closeSimpleInfoWindow=function(){if(this.map&&this.map.temp._infoWin){this.map.temp._infoWin._visible=false;this.map.temp._infoWin.decontrol();this.map.temp._infoWin=null}};function em(e,i){e=isNaN(e)?0:e;i=isNaN(i)?0:i;this.x=e;this.y=i}em.prototype.equals=function(e){if(!e){return false}return e.x===this.x&&e.y===this.y};em.prototype.clone=function(){return new em(this.x,this.y)};em.prototype.toString=function(){return"Pixel"};function ec(i,e){if(typeof i!=="number"){this.width=parseFloat(i)}else{this.width=i}if(typeof e!=="number"){this.height=parseFloat(e)}else{this.height=e}}ec.prototype.equals=function(e){return !!(e&&this.width===e.width&&this.height===e.height)};ec.prototype.toString=function(){return"Size"};var bH={B_NORMAL_MAP:{tileUrls:eu(e8.tileDomain,e8.rasterTilePath),vectorTileUrls:eu(e8.tileDomain,e8.vectorTilePath),tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,webgl:{minZoom:3,maxZoom:25},zoomLevelBase:18,errorUrl:e8.imgPath+"bg.png",bounds:new dT(new hz(-21364736,-11708041.66),new hz(23855104,12474104.17)),imgExtend:"png"},B_SATELLITE_MAP:{tileUrls:["//maponline0.bdimg.com/starpic/?qt=satepc&","//maponline1.bdimg.com/starpic/?qt=satepc&","//maponline2.bdimg.com/starpic/?qt=satepc&","//maponline3.bdimg.com/starpic/?qt=satepc&"],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:e8.imgPath+"bg.png",bounds:new dT(new hz(-21364736,-10616832),new hz(23855104,15859712)),imgExtend:"png"},B_STREET_MAP:{tileUrls:eu(e8.tileDomain,e8.rasterTilePath),tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:e8.imgPath+"bg.png",bounds:new dT(new hz(-21364736,-10616832),new hz(23855104,15859712)),imgExtend:"png"},BMAP_CUSTOM_LAYER:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:e8.imgPath+"blank.gif",bounds:new dT(new hz(-21364736,-10616832),new hz(23855104,15859712)),imgExtend:"png"},B_EARTH_MAP:{tileUrls:[""],tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,webgl:{minZoom:3,maxZoom:21},zoomLevelBase:18,errorUrl:e8.imgPath+"blank.gif",bounds:new dT(new hz(-21364736,-10616832),new hz(23855104,15859712)),imgExtend:"png"},B_NONE_MAP:{tileUrls:"",tileSize:256,baseUnits:256,zoomLevelMin:3,zoomLevelMax:19,minDataZoom:3,maxDataZoom:19,minZoom:3,maxZoom:19,zoomLevelBase:18,errorUrl:e8.imgPath+"bg.png",bounds:new dT(new hz(-21364736,-11708041.66),new hz(23855104,12474104.17)),imgExtend:"png"}};var b6=bH;function bT(h3,i,hZ,T,hY){this.mgr=h3;this.position=hZ;this._cbks=[];this.name=h3.getTileName(T,hY,h3.map.config.style);this.info=T;this._transparentPng=hY.isTransparentPng();var h4=S("img");dm(h4);h4.galleryImg=false;var h2=h4.style;h2.position="absolute";h2.width=h3.tileSize+"px";h2.height=h3.tileSize+"px";h2.left=hZ[0]+"px";h2.top=hZ[1]+"px";this.img=h4;this.src=i;if(ab&&hZ._offsetX===0){h2.opacity=0;h2.willChange="opacity"}var h1=this;this.img.onload=function(ic){if(!h1.mgr){return}var h7=h1.mgr;var h5=h7.bufferTiles;if(h7.bufferNumber>0){h5[h1.name]=h1;h5.push(h1.name)}var h9=h5.length-h7.bufferNumber;for(var ia=0;h9>0&&ia<h5.length;ia++){var ib=h5[ia];if(!h7.mapTiles[ib]){if(h5[ib]){h5[ib].mgr=null;var h8=h5[ib].img;if(h8.parentNode){fw(h8);h8.parentNode.removeChild(h8)}h8=null;h5[ib].img=null;h5[ib]=null;delete h5[ib]}h5.splice(ia,1);ia--;h9--}}h1.loaded=true;h7.imgNumber++;if(!hk(h1.img)){if(hY.tilesDiv){hY.tilesDiv.appendChild(h1.img)}}var ic=new bb("onimagechange");ic.action="show";ic.tile=h1.name;h7.map.dispatchEvent(ic);if(ab&&hZ._offsetX===0){var h6=new o({fps:10,duration:300,render:function(e){if(h1.img&&h1.img.style){h1.img.style.opacity=e*1}},finish:function(){if(h1.img&&h1.img.style){delete h1.img.style.opacity;h1.img.style.willChange="auto"}}})}h1._callCbks()};this.img.onerror=function(h7){h1.error=true;h1._callCbks();if(!h1.mgr){return}var h5=h1.mgr;var h6=b6[hY.mapType];if(h6.errorUrl){h1.img.src=h6.errorUrl}if(!hk(h1.img)){if(hY.tilesDiv){hY.tilesDiv.appendChild(h1.img)}}};h4=null;var h0=new bb("onimagebefore");h0.tile=h1.name;h3.map.dispatchEvent(h0)}bT.prototype._addLoadCbk=function(e){this._cbks.push(e)};bT.prototype._load=function(){if(FeBrowser.ie<=6&&FeBrowser.ie>0&&this._transparentPng){this.img.src=e8.imgPath+"blank.gif"}else{this.img.src=this.src}};bT.prototype._callCbks=function(){var T=this;for(var e=0;e<T._cbks.length;e++){T._cbks[e]()}T._cbks.length=0};var ab=(!C.Browser.ie||C.Browser.ie>8);function fj(e){this.tileLayers=[];this.map=e;this.bufferNumber=300;this.mapTiles=[];this.bufferTiles=[];this.config=b6[this.map.mapType];this.errorUrl=this.config.errorUrl;this.tileSize=this.config.tileSize;this.baseUnits=this.config.baseUnits;this.baseZoomLevel=this.config.zoomLevelBase;this.tileURLs=this.config.tileUrls;this.imgNumber=0;this.numLoading=0;this.temp={}}bo.register(function(i){if(i._renderType==="webgl"){return}var e=i.tileMgr=new fj(i);i.addEventListener("mousewheel",function(T){e.mouseWheel(T)});i.addEventListener("dblclick",function(T){e.dblClick(T)});i.addEventListener("rightdblclick",function(T){e.dblClick(T)});i.addEventListener("minuspress",function(T){e.keypress(T)});i.addEventListener("pluspress",function(T){e.keypress(T)});i.addEventListener("load",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.loadTiles()});i.addEventListener("zoomstartcode",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e._zoom(T)});i.addEventListener("moving",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.moveGridTiles()});i.addEventListener("resize",function(T){if(this.mapType===BMAP_EARTH_MAP){return}e.resizeMap(T)});i.addEventListener("addtilelayer",function(T){e.addTileLayer(T)});i.addEventListener("removetilelayer",function(T){e.removeTileLayer(T)})});C.extend(fj.prototype,{addTileLayer:function(hY){var T=this;var i=hY.target;T.tileLayers.push(i);if(T.map.loaded){T.moveGridTiles()}},removeTileLayer:function(h5){var h6=this;var h3=h5.target;var h1=h3.mapType;var h0=h6.mapTiles;var h8=h6.bufferTiles;for(var T in h8){var hY=T.split("-")[1];if(hY==h1){delete h8[T]}}for(var T in h0){var hY=T.split("-")[1];if(hY==h1){delete h0[T]}}if(h6.zoomsDiv&&h6.zoomsDiv.parentNode){h6.zoomsDiv.parentNode.removeChild(h6.zoomsDiv);h6.zoomsDiv.innerHTML=""}var hZ=h6.map;if(hZ.deepZoom){var h7=hZ.deepZoom.preDeepZoomDiv;if(h7&&h7.parentNode){h7.parentNode.removeChild(h7)}}for(var h4=0,h2=h6.tileLayers.length;h4<h2;h4++){if(h3==h6.tileLayers[h4]){h6.tileLayers.splice(h4,1)}}h6.moveGridTiles()},hideDeepZoomDiv:function(){var i=this,T=i.map;if(T.deepZoom){var e=T.deepZoom.preDeepZoomDiv;if(e&&e.style.display!="none"){e.style.display="none"}}},getTileLayer:function(hZ){var hY=this;for(var T=0,e=hY.tileLayers.length;T<e;T++){tilelayer=hY.tileLayers[T];if(tilelayer.mapType==hZ){return tilelayer}}return null},_zoom:function(T){var i=this;if(i.zoomsDiv&&i.zoomsDiv.style.display!="none"){i.zoomsDiv.style.display="none"}i.hideDeepZoomDiv();i.moveGridTiles()},resizeMap:function(i){this.loaded=false;this.moveGridTiles()},_checkTilesLoaded:function(){this.numLoading--;var e=this;if(this.numLoading==0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(e.numLoading==0){e.map.dispatchEvent(new bb("ontilesloaded"))}e._checkLoadedTimer=null},80)}},getTileName:function(e,T,i){var hZ=T.mapType;var hY="TILE-"+hZ+"-"+i+"-"+e[0]+"-"+e[1]+"-"+e[2];return hY},hideTile:function(hY,T){var i=hY.img;if(hk(i)){if(hY.loaded){this.imgNumber--}if(i.parentNode){fw(i);i.parentNode.removeChild(i)}}var hZ=new bb("onimagechange");hZ.tile=this.getTileName(hY.info,T,this.map.config.style);hZ.action="hide";delete this.mapTiles[hY.name];if(!hY.loaded){fw(i);hY._callCbks();i=null;hY.img=null;hY.mgr=null}this.map.dispatchEvent(hZ)},loadTiles:function(){var i=this;if(C.Browser.ie){try{document.execCommand("BackgroundImageCache",false,true)}catch(T){}}if(this.zoomsDiv&&this.zoomsDiv.style.display!="none"){this.zoomsDiv.style.display="none"}i.hideDeepZoomDiv();i.moveGridTiles()},getCell:function(hZ,hY){var e=this.baseUnits*Math.pow(2,(this.baseZoomLevel-hY));var T=parseInt(hZ.lng/e);var i=parseInt(hZ.lat/e);return[T,i,e*(T+0.5),e*(i+0.5)]},moveGridTiles:function(){var ic=this.map,io=ic.getMapType(),il=this.tileLayers.length;var ij=ic.centerPoint;if(io!==BMAP_SATELLITE_MAP){ij=d7.calcLoopCenterPoint(ij)}var h3=ic.width;var iB=ic.getZoomUnits();var ik=iB*h3;var iq=ij.lng-ik/2;var h8=ij.lng+ik/2;var ib=d7.isAddWidth(iq,h8);for(var it=0;it<il;it++){var hZ=this.tileLayers[it];if(hZ.baseLayer||il==1){this.tilesDiv=hZ.tilesDiv}var ie=b6[hZ.mapType];var hY=ic.zoomLevel;var iw=ic.getZoomUnits(ic.zoomLevel);var h7=ie.baseUnits*Math.pow(2,(ie.zoomLevelBase-hY));var h5=Math.floor(ij.lng/h7);var ir=Math.floor(ij.lat/h7);var ia=ie.tileSize;var ig=[h5,ir,(ij.lng-h5*h7)/h7*ia,(ij.lat-ir*h7)/h7*ia];var h6=ib?ic.width/2*1.5:ic.width/2;var h9=ig[0]-Math.ceil((h6-ig[2])/ia);var iA=ig[1]-Math.ceil((ic.height/2-ig[3])/ia);var iu=ig[0]+Math.ceil((h6+ig[2])/ia);var ih=ig[1]+Math.ceil((ic.height/2+ig[3])/ia);var h4=[];for(var iy=h9;iy<iu;iy++){for(var ix=iA;ix<ih;ix++){h4.push([iy,ix]);var im="id_"+iy+"_"+ix+"_"+hY;h4[im]=true}}if(hZ.mapType!==BMAP_SATELLITE_MAP){h4=d7.calcLoopTiles(h4,hY)}h4.sort((function(i){return function(id,iD){return((0.4*Math.abs(id[0]-i[0])+0.6*Math.abs(id[1]-i[1]))-(0.4*Math.abs(iD[0]-i[0])+0.6*Math.abs(iD[1]-i[1])))}})([ig[0],ig[1]]));var T=this.mapTiles;var e=-ij.lng/iw;var iC=ij.lat/iw;var ip=[e,iC];for(var ii in T){var h1=T[ii];var iz=h1.info;if(!iz){continue}var im="id_"+iz[0]+"_"+iz[1]+"_"+iz[2];if(!h4[im]){this.hideTile(h1,hZ)}}var h0=-ic.offsetX+ic.width/2;var h2=-ic.offsetY+ic.height/2;hZ.tilesDiv.style.left=Math.round(e+h0)-ip[0]+"px";hZ.tilesDiv.style.top=Math.round(iC+h2)-ip[1]+"px";this.numLoading+=h4.length;for(var iy=0,iv=h4.length;iy<iv;iy++){this.showTile([h4[iy][0],h4[iy][1],ic.zoomLevel],ip,hZ,iy,ic.config.style)}}},showTile:function(h1,h0,h4,h9){this.centerPos=h0;var h2=b6[h4.mapType];var h5=this.map.config.style;var hY=this.getTileName(h1,h4,h5);var hZ=(h1[0]*h2.tileSize)+h0[0];var T=(-1-h1[1])*h2.tileSize+h0[1];var h8=[hZ,T];var h3=null;if(h4.mapType!==BMAP_SATELLITE_MAP){h3=d7.calcLoopParam(h1[0],h1[2]);var h7=h3.offsetX;h8[0]+=h7;h8._offsetX=h7}var ic=this;var ib=this.mapTiles[hY];if(ib){ib.img.style.left=h8[0]+"px";ib.img.style.top=h8[1]+"px";if(ib.loaded){this._checkTilesLoaded()}else{ib._addLoadCbk(function(){ic._checkTilesLoaded()})}return}ib=this.bufferTiles[hY];if(ib){this.imgNumber++;h4.tilesDiv.insertBefore(ib.img,h4.tilesDiv.lastChild);this.mapTiles[hY]=ib;ib.img.style.left=h8[0]+"px";ib.img.style.top=h8[1]+"px";if(ib.loaded){this._checkTilesLoaded()}else{ib._addLoadCbk(function(){ic._checkTilesLoaded()})}var ia=new bb("onimagechange");ia.action="cache";ia.tile=this.getTileName(h1,h4,h5);this.map.dispatchEvent(ia)}else{var h6=new em(h1[0],h1[1]);if(h3){h6.x=h3.col}var i=h4.getTilesUrl(h6,h1[2]);ib=new bT(this,i,h8,h1,h4);ib._addLoadCbk(function(){ic._checkTilesLoaded()});ib._load();this.mapTiles[hY]=ib;by(this.map)}},mouseWheel:function(h2){var h1=this.map;if(!h1.config.enableWheelZoom){return}var h3=h1.zoomLevel+(h2.trend===true?1:-1);var hZ=h1._getProperZoom(h3);if(hZ.exceeded){var T=new bb("onzoomexceeded");T.targetZoom=h3;h1.dispatchEvent(T);return}h1.dispatchEvent(new bb("onzoomstart"));h1.lastLevel=h1.zoomLevel;h1.zoomLevel=hZ.zoom;var i=h2.pixel;var hY=h1.pixelToPointIn(i,{zoom:h1.lastLevel});var h0=h1.getZoomUnits(h1.zoomLevel);h1.centerPoint=new hz(hY.lng+h0*(h1.width/2-i.x),hY.lat-h0*(h1.height/2-i.y));this.zoom(i)},dblClick:function(T){var i=this.map;if(!i.config.enableDblclickZoom){return}if(i.mapType==="B_EARTH_MAP"){return}if(i.currentOperation===dV.dragging){return}if(T.type=="onrightdblclick"){i.zoomOut(T.point)}else{i.zoomIn(T.point)}},keypress:function(T){var i=this.map;if(i.getMapType()===BMAP_EARTH_MAP){return}T.type=="onpluspress"?i.zoomIn():i.zoomOut()}});function cR(hY){this.opts=hY||{};this.copyright=this.opts.copyright||{};this.transparentPng=this.opts.transparentPng||false;this.png8=this.opts.png8||false;this.baseLayer=this.opts.baseLayer||false;this.dataType=this.opts.dataType||1;this.transform=this.opts.transform||0;this.isFlat=this.opts.isFlat===false?false:true;this.showLabel=this.opts.showLabel===false?false:true;var e=this.opts.tileTypeName||"web";this.tileType=cL.getInstance(e);this.clipTile=this.opts.clipTile||false;this._type="tilelayer";var i=gb()?128:256;this.cacheSize=this.opts.cacheSize||i;var T=this;this.tileCache=new e4(this.cacheSize,{clearCallback:function(hZ){if(hZ.label){if(hZ.label.textImageBitmap){hZ.label.textImageBitmap.close()}if(hZ.label.indoorTextImageBitmap){hZ.label.indoorTextImageBitmap.close()}}T._removeIndoorData(hZ)}});this.scaler=a6()>=1.5?2:1;this.normalUdt=aD("ditu","normal").udt;this.numLoading=0;this.useThumbData=false;this.useThumbData=this.opts.useThumbData||false;if(this.baseLayer){this.useThumbData=true}if(typeof this.opts.customLayer==="boolean"){this.customLayer=this.opts.customLayer}else{this.customLayer=true}}cR.inherits(eg,"TileLayer");C.extend(cR.prototype,{isTransparentPng:function(){return this.transparentPng},getTilesUrl:function(h5,e){var T=b6[this.mapType];if(typeof T!=="object"){return null}var hY=h5.x;var h6=h5.y;if(this.mapType!==BMAP_SATELLITE_MAP){var h6=d7.calcLoopParam(h6,e).col}var i="";if(this.opts.tileUrlTemplate){i=this.opts.tileUrlTemplate;i=i.replace(/\{X\}/,h6);i=i.replace(/\{Y\}/,hY);i=i.replace(/\{Z\}/,e)}else{if(this.mapType===BMAPGL_NORMAL_MAP){var h4=this.isCanvasMap?0:1;var h0=T.tileUrls[Math.abs(h6+hY)%T.tileUrls.length];if(window.offLineIPAddress){h0=window.offLineIPAddress+"tile5/"}var hZ=this.map.config.style;i=h0+"?qt=vtile&x="+hY+"&y="+h6+"&z="+e+(hZ==="default"?"":("&styleId=1"))+"&styles=pl&udt="+this.normalUdt+"&scaler="+this.scaler+"&showtext="+h4;i=i.replace(/-(\d+)/gi,"M$1")}if(this.mapType===BMAP_SATELLITE_MAP){var h1=aD("ditu","satellite");var h3=h1.ver;var h2=h1.udt;i=T.tileUrls[Math.abs(h6+hY)%T.tileUrls.length]+"u=x="+hY+";y="+h6+";z="+e+";v="+h3+";type=sate&fm=46&udt="+h2;i=i.replace(/-(\d+)/gi,"M$1")}}return i},initialize:function(h0){this.map=h0;if(h0._renderType==="webgl"){var hZ=null;if(this.customLayer!==false){hZ=this.getTilesUrl}C.extend(this,fY);this.labelProcessor=new dj(this);this.callbackDataQueue=[];if(hZ){this.getTilesUrl=hZ}var i=this;h0.on("indoor_data_refresh",function(h1){if(!i.baseLayer){return}i._refreshIndoorData(h1.uid,h1.floor)});h0.on("custom_labels_ready",function(h1){if(!i.baseLayer){return}i._doWorkAfterLabelImageLoad(h1.virtualTile,h1.labelCanvas,null,h1.imgKey)});h0.on("glmoduleloaded",function(){if(!i.baseLayer){return}i.updateAllIconsTextureCoords()})}if(!h0.temp.layerZIndex){h0.temp.layerZIndex=0}this.zIndex=this.zIndex||0;if(this.baseLayer){this.zIndex=0}this.adjustZIndex();if(!h0.temp.layid){h0.temp.layid=0}if(!this.opts.mapType){this.mapType="BMAP_CUSTOM_LAYER_"+h0.temp.layid;h0.temp.layid++}else{this.mapType=this.opts.mapType}var T=b6[this.mapType];if(!T){b6[this.mapType]={tileUrls:[],tileSize:256,baseUnits:256,zoomLevelMin:1,zoomLevelMax:19,minZoom:3,maxZoom:19,minDataZoom:3,maxDataZoom:19,zoomLevelBase:18,errorUrl:e8.imgPath+"/blank.gif",bounds:new dT(new hz(-21364736,-10616832),new hz(23855104,15859712)),imgExtend:"png"}}if(h0._renderType!=="webgl"){var hY=dI(h0.platform,'<div style="position:absolute;z-index:'+this.zIndex+'"></div>');hY.style.display="";hY.style.left=Math.ceil(-h0.offsetX+h0.width/2)+"px";hY.style.top=Math.ceil(-h0.offsetY+h0.height/2)+"px";this.tilesDiv=hY}this.isCanvasMap=h0.isCanvasMap();this.lastZoom=h0.getZoom();var e=this;this.addEventListener("initDrawData",function(h1){if(e.opts.boundary){e.addBoundary(e.opts.boundary)}})},remove:function(){if(this.tilesDiv&&this.tilesDiv.parentNode){this.tilesDiv.innerHTML="";this.tilesDiv.parentNode.removeChild(this.tilesDiv)}delete this.tilesDiv},getCopyright:function(){return this.copyright},getMapType:function(){return this.mapType},adjustZIndex:function(){if(this.map&&this.map._featureMgr){var e=this.map._featureMgr.result.bkData;while(e[this.zIndex]){this.zIndex+=1}}},setZIndex:function(e){this.setTargetZIndex(e)},setTargetZIndex:function(e){this.zIndex=e;this.drawIndex=e;if(this.tilesDiv){this.tilesDiv.style.zIndex=e}},calcLoopParam:function(e,i){return d7.calcLoopParam(e,i)},addBoundary:function(h0){if(!h0||!this.map){return}if(typeof h0==="string"){h0=[h0]}for(var hY=0;hY<h0.length;hY++){var T=new BMapGL.Polygon(h0[hY]);if(T&&bV(T._i)){var hZ=new bb("onbeforeaddoverlay",T);hZ.overlay=T;hZ.isLayerMask=true;this.map.dispatchEvent(hZ);T._i(this.map);if(this.boundary){this.boundary.push(T)}else{this.boundary=[T]}}}this.updateBoundary()},clearBoundary:function(){this.boundary=false;this.updateBoundary()},updateBoundary:function(){if(this.boundary===undefined||!this.map){return}var i=this.map._featureMgr.result.bkData;if(i[this.zIndex]){i[this.zIndex].boundary=this.boundary;this.map.dispatchEvent(new bb("onrefresh"));if(this.boundary===false){var T=new bb("onremoveLayerMask");T.hasLayerBoundary=this.map._featureMgr.hasLayerBoundary();this.map.dispatchEvent(T)}}}});function c5(i,e,T){this.bounds=i;this.content=e;this.mapType=T}c5.inherits(eg,"Copyright");var gu={get:function(e){if(!gu.singleton){gu.singleton=new ai(e)}return gu.singleton}};function ai(i){this._map=i;this._tileMgr=i.tileMgr;this._animationDiv=null;this._preAnimationDiv=null;this._animation=null;this._baseLayerDiv=null;this._transformStyleName=a8.ifSupportCSS3("transform",true);this._transformOriginStyleName=a8.ifSupportCSS3("transformOrigin",true);this._preZoomTimes=1;this._preRenderTick=1;this._enableCanvas2dMap=!!(i.getRenderType()==="canvas");this._isIE9=!!(C.Browser.ie===9);var e=this;i.addEventListener("maptypechange",function(){e.hide()});i.addEventListener("load",function(){e.hide()})}C.extend(ai.prototype,{prepareLayer:function(){var hY=this._map;var e=this._tileMgr;this._canvas2dMapMgr=hY.canvas2dMapMgr;var T=this._baseLayerDiv=e.tilesDiv;if(!this._animationDiv){var i=this._preAnimationDiv;if(i){i.parentNode&&i.parentNode.removeChild(i);this._preAnimationDiv=null}this._preAnimationDiv=this._animationDiv=T.cloneNode(true);hY.platform.insertBefore(this._animationDiv,hY.platform.firstChild)}this.show()},prepareAniParam:function(){var hY=this._animationDiv;if(!hY){return}var e=hY.children.length;var T;this._zoomAniInfo=[];for(var hZ=e-1;hZ>-1;hZ--){var h0={};T=hY.children[hZ].style;h0.top=parseInt(T.top,10);h0.left=parseInt(T.left,10);this._zoomAniInfo[hZ]=h0}},prepareLabelLayer:function(){var hZ=this._map;if(this._enableCanvas2dMap&&hZ.canvas2dMapMgr){if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.parentNode.removeChild(this.touchZoomLabelCanvas)}var i=hZ.canvas2dMapMgr._labelCanvas;this.touchZoomLabelCanvas=i.cloneNode(false);var e=this.touchZoomLabelCanvas.getContext("2d");e.drawImage(i,0,0);hZ.platform.insertBefore(this.touchZoomLabelCanvas,hZ.platform.firstChild);var hY=parseInt(i.style.left,10);var T=parseInt(i.style.top,10);this.touchZoomLabelCanvas.style.zIndex=9;this.touchZoomLabelCanvas.style[this._transformOriginStyleName]=(this._fixPosition.x-(hZ.offsetX+hY))+"px "+(this._fixPosition.y-(hZ.offsetY+T))+"px";i.style.visibility="hidden"}},show:function(){if(this._animationDiv){this._animationDiv.style.visibility=""}},showLabel:function(){var i=this._map;if(this._enableCanvas2dMap&&i.canvas2dMapMgr){var e=i.canvas2dMapMgr._labelCanvas;if(e){e.style.visibility=""}if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.style.zIndex=-2;this.touchZoomLabelCanvas.style.visibility="hidden"}}},hide:function(){if(this._animationDiv){this._animationDiv.style.visibility="hidden"}if(this._preAnimationDiv){this._preAnimationDiv.style.visibility="hidden"}},hideNonAnimationLayers:function(){var hY=this._map;if(hY.getRenderType()==="dom"){if(hY.overlayDiv){hY.overlayDiv.style.visibility="hidden"}if(hY.overlayDivEx){hY.overlayDivEx.style.visibility="hidden"}}var h0=hY.tileMgr.tileLayers;var hZ;for(var T=0,e=h0.length;T<e;T++){hZ=h0[T];hZ.tilesDiv.style.visibility="hidden"}},showNonAnimationLayers:function(){var hY=this._map;if(hY.getRenderType()==="dom"){if(hY.overlayDiv){hY.overlayDiv.style.visibility=""}if(hY.overlayDivEx){hY.overlayDivEx.style.visibility=""}}var h0=hY.tileMgr.tileLayers;var hZ;for(var T=0,e=h0.length;T<e;T++){hZ=h0[T];hZ.tilesDiv.style.visibility=""}},setFixPosition:function(e){this._fixPosition=e},setZoom:function(e,h4){var h1=this._fixPosition;var ia=this._map;var ib=this._baseLayerDiv;var h2={x:h1.x-parseInt(ib.style.left,10)-ia.offsetX,y:h1.y-parseInt(ib.style.top,10)-ia.offsetY};var hY=this._animationDiv;if(!hY){return}var h8=hY.children.length;var h6;var h9=this._transformStyleName;var h0=this._transformOriginStyleName;var ic=this;var ie;var h3;for(var h7=h8-1;h7>-1;h7--){var h5=this._zoomAniInfo[h7];h6=hY.children[h7].style;var hZ=h5.left-h2.x;var T=h5.top-h2.y;h5.dx=hZ*e-hZ;h5.dy=T*e-T;h5.preDx=hZ-hZ;h5.preDy=T-T;ie=h5.preDx+(h5.dx-h5.preDx);h3=h5.preDy+(h5.dy-h5.preDy)+h4;h6.left=h5.left+ie+"px";h6.top=h5.top+h3+"px";h6.width=h6.height=256*e+"px"}if(this._enableCanvas2dMap){var id=!ic._isIE9?"translate3d(0px, "+h4+"px, 0) scale("+e+")":"translate(0px, "+h4+"px) scale("+e+")";this.touchZoomLabelCanvas.style[h9]=id}},setZoomFinish:function(){this._animationDiv=null},startAnimation:function(h1){this.prepareLayer();this.hideNonAnimationLayers();var il=this._map;if(this.touchZoomLabelCanvas){this.touchZoomLabelCanvas.style.display="none"}h1=h1||{};var ij=h1.zoomCount||0;var h6=h1.fixPosition;var ih=h1.fixMCPosition;var h4=h1.pixOffset;this._zoomCount=ij;var hY=il.getZoom();var ik=hY+ij;var e=il.config.enableContinuousZoom;var ia=0.5;var h5=5;var T=Math.pow(2,ij);var io=this._baseLayerDiv;var h7={x:h6.x-parseInt(io.style.left,10)-il.offsetX,y:h6.y-parseInt(io.style.top,10)-il.offsetY};var h2=this._animationDiv;var ie=h2.children.length;var iq=this._preZoomTimes;var ii=[];var ig=this._transformStyleName;var h3=this._transformOriginStyleName;for(var id=ie-1;id>-1;id--){var ib={};var ic=h2.children[id].style;ib.top=parseInt(ic.top,10);ib.left=parseInt(ic.left,10);var h0=ib.left-h7.x;var hZ=ib.top-h7.y;ib.dx=h0*T-h0;ib.dy=hZ*T-hZ;ib.preDx=h0*iq-h0;ib.preDy=hZ*iq-hZ;ii[id]=ib}var im=this;var h9;var ip;var h8;this._zoomAni=new o({fps:60,duration:e?500:1,transition:function(i){i=i*h5/(2*ia);return h5*i-ia*i*i},render:function(iA){iA=iA*(4*ia)/(h5*h5);h9=iq+iA*(T-iq);var it=hY+eH(h9);var iy=null;var ix=0;var iB=0;if(h1.onAnimationBeforeLooping){var iC=h1.onAnimationBeforeLooping(iA,it);iy=iC.loopingCenter;ix=iC.yDiff;iB=iC.totalYDiff}for(var iu=ii.length-1;iu>-1;iu--){var iv=ii[iu];if(h2.children[iu]){var iz=h2.children[iu].style;ip=iv.preDx+(iv.dx-iv.preDx)*iA-h4.width*iA;h8=iv.preDy+(iv.dy-iv.preDy)*iA-h4.height*iA+ix;iz.left=iv.left+ip+"px";iz.top=iv.top+h8+"px";iz.height=iz.width=256*h9+"px"}}var ir=h4.width*iA;var iw=h4.height*iA;if(il.isRestrict){im._enableCanvas2dMap&&im._canvas2dMapMgr.clearLabel()}else{im._enableCanvas2dMap&&im._canvas2dMapMgr.drawLabel(h9,h6,hY,ik,ij,iA,ir,iw,iB,ix)}im._preZoomTimes=h9;im._preRenderTick=iA;h1.onAnimationLooping&&h1.onAnimationLooping(iA,it,iy)},finish:function(){im._preZoomTimes=1;im._zoomAni=null;im._animationDiv=null;h1.onAnimationFinish&&h1.onAnimationFinish();im.showNonAnimationLayers()}});return this._zoomAni},stopAnimation:function(){if(this._zoomAni){this._zoomAni.stop();this._zoomAni=null}}});function c(e){this._initVars(e);this._initColorCanvas();this._bindEvent(e)}C.extend(c.prototype,{_initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this._labelCtx=e._labelCtx;this.ratio=this._map.config.ratio;this.sizeRatio=this.ratio>1?2:1;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000},_initColorCanvas:function(){var i=256,T=S("canvas"),e=T.style;e.width=i+"px";e.height=i+"px";T.width=i;T.height=i;this._colorCvsSize=i;this._colorCvs=T;this._colorCtx=T.getContext("2d")},getLabelImageData:function(ib){var ia=ib.textImg;var T=ib.textPos;var h8=this.ratio;var h6=this.sizeRatio/h8;var hZ=this._colorCtx;var h3=this._colorCvsSize;hZ.clearRect(0,0,h3,h3);var h5=0;var e=0;var h2=0;for(var h4=0;h4<T.length;h4++){if(T[h4].width>h5){h5=T[h4].width;e=h4;h2=T[h4].drawX}}h5/=h6;var h7=0;for(var h4=0,h1=T.length;h4<h1;h4++){var h9=T[h4];var ic;if(h4===e){ic=0}else{ic=h9.drawX-h2}hZ.drawImage(ia,h9.srcX,h9.srcY,h9.width,h9.height,ic,h7,h9.width/h6,h9.height/h6);if(h9.width/h6>h5){h5=h9.width/h6}h7+=h9.height/h6+2*h8}var hY=hZ.getImageData(0,0,h5,h7);var h0=hZ.getImageData(0,0,h5,h7);return[hY,h0]},_bindEvent:function(i){var e=this,T=i._map;T.addEventListener("onspotmouseover",function(h1){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(h1.spots.length>0){var h0=h1.spots[0].userdata.uid;var hZ=h1.spots[0].userdata.name;var hY=e.findLabelByUid(h0,hZ);hY&&e._toHighLightColor(hY)}});T.addEventListener("onspotmouseout",function(h1){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(h1.spots.length>0){var h0=h1.spots[0].userdata.uid;var hZ=h1.spots[0].userdata.name;var hY=e.findLabelByUid(h0,hZ);hY&&e._toDefaultColor(hY)}});T.addEventListener("onspotclick",function(h1){if(!this.isCanvasMap()||!this.temp.isPermitSpotOver){return}if(h1.spots&&h1.spots.length>0){var h0=h1.spots[0].userdata.uid;var hZ=h1.spots[0].userdata.name;var hY=e.findLabelByUid(h0,hZ);hY&&e._changeBaseMapState(hY)}else{e._recoverNormalState()}});T.on("spot_status_reset",function(){e._recoverNormalState()});T.on("spot_highlight",function(hZ){var hY=e.findLabelByUid(hZ.uid);hY&&e._changeBaseMapState(hY)})},_getTextBound:function(h9){if(!h9.textPos){return null}var h7=this.ratio;var h5=this.sizeRatio/h7;var T=h9.textPos;var h8=h9.baseDrawX;var h6=h9.baseDrawY;var h3=h8*h7+(T[0].drawX-h8)/h5;var h1=h6*h7+(T[0].drawY-h6)/h5;var hZ=h3+T[0].width/h5;var e=h1+T[0].height/h5;for(var h4=0,h2=T.length;h4<h2;h4++){var ia=T[h4];var h0=h8*h7+(ia.drawX-h8)/h5;if(h0<h3){h3=h0}var hY=h6*h7+(ia.drawY-h6)/h5;if(hY<h1){h1=hY}if(h0+ia.width>hZ){hZ=h0+ia.width}if(hY+ia.height>e){e=hY+ia.height}}return[h3,h1,hZ,e]},_toHighLightColor:function(T){if(T._tempRank&&T._tempRank==this.RANK5){return}var h2=this._getTextBound(T);if(!h2){return}var hY=Math.round(h2[0]);var i=Math.round(h2[1]);var e=this.getLabelImageData(T);var h0=e[0];var hZ=e[1];var h1=this._canvas2dMapMgr.getFilterImageData(h0,this.RANK5);T._oldImgData=hZ;this._labelCtx.putImageData(h1,hY,i)},_toDefaultColor:function(e){if(e._tempRank&&e._tempRank==this.RANK5){return}if(e._oldImgData){var i=this.sizeRatio;var T=this._getTextBound(e);if(!T){return}this._labelCtx.putImageData(e._oldImgData,Math.round(T[0]),Math.round(T[1]));e._oldImgData=null}},_changeBaseMapState:function(hY){var T=this._canvas2dMapMgr;var i=hY.guid;var e=hY.guidExt;var hZ={guid:i,name:hY.name,guidExt:e};T._labelStrategy.setStrategyInfo(hZ);T._loadData()},_recoverNormalState:function(){var e=this._canvas2dMapMgr;e._labelStrategy.setStrategyInfo(null);e._loadData()},findLabelByUid:function(h0,hY){var h2=this._canvas2dMapMgr,e=h2._computedLabel;for(var hZ=0,T=e.length;hZ<T;hZ++){var h1=e[hZ];if(!h2.isClickableLabel(h1)){continue}if(h0&&h1.guid===h0){return h1}if(hY&&h1.name===hY){return h1}}return null}});function ef(e){this._initVars(e)}C.extend(ef.prototype,{_initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this.ratio=this._map.config.ratio;this._strategyInfo=null;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000},setStrategyInfo:function(e){this._strategyInfo=e},preComputeLabel:function(h4,iY,iH,ih,iS,jc){var iB=[],ic=h4._centerX,ia=h4._centerY,jd=ih*iS;var iN=this.ratio;var h3=this._map.getZoom();var iw=0;if(h3===5){iw=4}if(h3===8){iw=-6}h4.sort(function(je,i){if(je.x*je.y<i.x*i.y){return -1}else{return 1}});for(var iy=0,iu=h4.length;iy<iu;iy++){var i3=h4[iy],io=i3.x,ik=i3.y,ii=i3.z;var iq=d7.calcLoopParam(io,ii).offsetX;var iL=io*jd,iK=(ik+1)*jd,hY=(iL-ic)/ih+iY/2+iq,T=(ia-iK)/ih+iH/2;for(var iv=0,i7=i3.length;iv<i7;iv++){var h6=i3[iv],id=undefined,ib=undefined,i5=undefined,i4=undefined;var iU=h6.baseDrawX=hY+h6.baseX;var iT=h6.baseDrawY=T+h6.baseY;if(h6.type=="fixed"){var iF=h6.iconPos,ig=h6.textPos,i9=h6.textImg;if(iF){iF.drawX=hY+iF.destX;iF.drawY=T+iF.destY;id=iF.drawX;ib=iF.drawY;i5=iF.drawX+iF.width;i4=iF.drawY+iF.height}if(ig&&i9){for(var iV=0;iV<ig.length;iV++){var i8=ig[iV];i8.drawX=hY+i8.destX;i8.drawY=T+i8.destY;if(!id){id=i8.drawX;ib=i8.drawY;i5=i8.drawX+i8.width;i4=i8.drawY+i8.height}else{if(i8.drawX<id){id=i8.drawX}if(i8.drawY<ib){ib=i8.drawY}if(i8.drawX+i8.width>i5){i5=i8.drawX+i8.width}if(i8.drawY+i8.height>i4){i4=i8.drawY+i8.height}}}}}else{h6.tileX=hY;h6.tileY=T;id=hY+h6.minXOriginal;ib=T+h6.minYOriginal;i5=hY+h6.maxXOriginal;i4=T+h6.maxYOriginal}if(id!=undefined){var iX=iU+(id-iU)/iN;var iW=iT+(ib-iT)/iN;var iz=iU+(i5-iU)/iN;var ix=iT+(i4-iT)/iN;h6.minX=iX;h6.minY=iW;h6.maxX=iz;h6.maxY=ix;var i1=(iX+iz)/2,i0=(iW+ix)/2,iI=ic+(i1-iY/2)*ih,iG=ia+(iH/2-i0)*ih;h6.geoX=iI;h6.geoY=iG;iB.push(h6)}}}if(jc){for(var iy=0,iu=jc.length;iy<iu;iy++){var it=jc[iy];var iQ=it[0];var h7=it[1];var iF=iQ.iconPos;var h1=iF.geoX;var hZ=iF.geoY;var iU=(h1-ic)/ih+iY/2;var iT=(ia-hZ)/ih+iH/2;var id=iU+iF.destX;var ib=iT+iF.destY;var i5=id+iF.width;var i4=ib+iF.height;iQ.textPos=iQ.textPos||iQ._textPos;var ig=iQ.textPos;var iZ=ig[0];var im=iU+iZ.destX;var h9=iT+iZ.destY;if(h9<ib){ib=h9}if(im+iZ.width>i5){i5=im+iZ.width}if(h9+iZ.height>i4){i4=h9+iZ.height}if(ig.length===2){var il=ig[1];var ij=iU+il.destX;var h8=iT+il.destY;if(h8<ib){ib=h8}if(ij+il.width>i5){i5=ij+il.width}if(h8+il.height>i4){i4=h8+il.height}}iQ._tempBounds=[id,ib,i5,i4];var iF=h7.iconPos;var h1=iF.geoX;var hZ=iF.geoY;var iU=(h1-ic)/ih+iY/2;var iT=(ia-hZ)/ih+iH/2;var id=iU+iF.destX;var ib=iT+iF.destY;var i5=id+iF.width;var i4=ib+iF.height;h7.textPos=h7.textPos||h7._textPos;var ig=h7.textPos;var iZ=ig[0];var im=iU+iZ.destX;var h9=iT+iZ.destY;if(im<id){id=im}if(h9<ib){ib=h9}if(h9+iZ.height>i4){i4=h9+iZ.height}if(ig.length===2){var il=ig[1];var ij=iU+il.destX;var h8=iT+il.destY;if(ij<id){id=ij}if(h8<ib){ib=h8}if(h8+il.height>i4){i4=h8+il.height}}h7._tempBounds=[id,ib,i5,i4]}for(var iy=0,iu=jc.length;iy<iu;iy++){var it=jc[iy];var iQ=it[0];var h7=it[1];if(iy===0&&h7.textPos){h7._textPos=h7.textPos;delete h7.textPos}var i2=iQ;if(!iQ.textPos&&h7.textPos){i2=h7}var i6=i2._tempBounds;for(iv=iy+1;iv<iu;iv++){var ir=jc[iv];var iC=ir[0];var jb=ir[1];var ie=0;var ja=iC._tempBounds;if(!(i6[2]<ja[0]||i6[0]>ja[2]||i6[3]<ja[1]||i6[1]>ja[3])){ie++;if(iC.textPos){iC._textPos=iC.textPos;delete iC.textPos}}var ja=jb._tempBounds;if(!(i6[2]<ja[0]||i6[0]>ja[2]||i6[3]<ja[1]||i6[1]>ja[3])){ie++;if(jb.textPos){jb._textPos=jb.textPos;delete jb.textPos}}if(ie>=2){if(i2.textPos){i2._textPos=i2.textPos;delete i2.textPos}}}}for(var iy=0,iu=jc.length;iy<iu;iy++){var it=jc[iy];var iQ=it[0];var h7=it[1];var iD=iQ;if(!iQ.textPos&&h7.textPos){iD=h7}var iF=iD.iconPos;var h1=iF.geoX;var hZ=iF.geoY;var iU=iD.baseDrawX=(h1-ic)/ih+iY/2;var iT=iD.baseDrawY=(ia-hZ)/ih+iH/2;iF.drawX=iU+iF.destX;iF.drawY=iT+iF.destY;var id=iF.drawX;var ib=iF.drawY;var i5=iF.drawX+iF.width;var i4=iF.drawY+iF.height;var ig=iD.textPos;if(ig){var iZ=ig[0];iZ.drawX=iU+iZ.destX;iZ.drawY=iT+iZ.destY;if(iZ.drawX<id){id=iZ.drawX}if(iZ.drawY<ib){ib=iZ.drawY}if(iZ.drawX+iZ.width>i5){i5=iZ.drawX+iZ.width}if(iZ.drawY+iZ.height>i4){i4=iZ.drawY+iZ.height}if(ig.length===2){var il=ig[1];il.drawX=iU+il.destX;il.drawY=iT+il.destY;if(il.drawX<id){id=il.drawX}if(il.drawY<ib){ib=il.drawY}if(il.drawX+il.width>i5){i5=il.drawX+il.width}if(il.drawY+il.height>i4){i4=il.drawY+il.height}}}var iX=iU+(id-iU)/iN;var iW=iT+(ib-iT)/iN;var iz=iU+(i5-iU)/iN;var ix=iT+(i4-iT)/iN;iD.minX=iX;iD.minY=iW;iD.maxX=iz;iD.maxY=ix;var iP=(iX+iz)/2;var iO=(iW+ix)/2;var h2=ic+(iP-iY/2)*ih;var h0=ia+(iH/2-iO)*ih;iD.geoX=h2;iD.geoY=h0;iB.push(iD)}}var iR=this._strategyInfo;if(iR){var iA=iR.guid;var iJ=iR.name;var ip=iR.guidExt;for(var iy=0,iu=iB.length;iy<iu;iy++){var h5=iB[iy];delete h5._tempRank;if(!this._canvas2dMapMgr.isClickableLabel(h5)||(ip===1&&!h5.guidExt)){continue}if((iA&&iA===h5.guid)||(iJ&&iJ===h5.name)){h5._tempRank=this.RANK5}}}else{for(var iy=0,iu=iB.length;iy<iu;iy++){var h5=iB[iy];if(h5.type=="line"||!h5.iconPos){continue}delete h5._tempRank}}iB.sort(function(jf,je){var jg=jf._tempRank?jf._tempRank:jf.rank,i=je._tempRank?je._tempRank:je.rank;if(jg===i){return jf.baseX-je.baseX}return i-jg});for(var iy=0,iu=iB.length;iy<iu;iy++){var i2=iB[iy];i2.isDel=false;i2.isFadeout=false;i2._schedule=0;i2._isIgnore=false;i2.arrIntersectIndex=[];for(iv=iy+1;iv<iu;iv++){var iE=iB[iv];if(!(i2.maxX-iw<iE.minX||i2.minX>iE.maxX-iw||i2.maxY-iw<iE.minY||i2.minY>iE.maxY-iw)){i2.arrIntersectIndex.push(iv)}}}for(var iy=0,iu=iB.length;iy<iu;iy++){var h5=iB[iy];if(h5.isDel==false){var e=h5.arrIntersectIndex;for(var iv=0,i7=e.length;iv<i7;iv++){var iM=iB[e[iv]];iM.isDel=true;if(iM.guidExt===1){iM.isDel=false}}}}return iB}});function ah(e){this._map=e;this._initCanvas();this._initVars();this._bindEvent();this._tileType=cL.getInstance("na")}bo.register(function(i){if(i.getRenderType()==="canvas"){var e=i.config.style;if(bo["FeatureStyle"+e]){i.canvas2dMapMgr=new ah(i)}else{i.loadMapStyleFiles(function(){i.canvas2dMapMgr=new ah(i);i.canvas2dMapMgr._loadData()})}}});C.extend(ah.prototype,{_initCanvas:function(){var h1=this._map,hZ=h1.getSize(),hY=hZ.width,i=hZ.height,e=h1.platform,h2=S("canvas"),h0=h2.style;var T=this.ratio=h1.config.ratio;this._width=hY;this._height=i;h0.cssText="position: absolute;left:0;top:0;width:"+hY+"px;height:"+i+"px;z-index:100;";h2.width=hY*T;h2.height=i*T;this._labelCanvas=h2;this._labelCtx=h2.getContext("2d");e.appendChild(h2)},_initVars:function(){var e=aD("ditu","normal");this._udt=e.udt;this._version=e.ver;this._labelDataUrls=b6.B_NORMAL_MAP.vectorTileUrls;this._style=bo["FeatureStyle"+this._map.config.style];this._labelCount=0;this._vectorDrawLib=new a0(this);this._cache={maxNum:500,delNum:50,arrCache:[]};this._computedLabel=null;this._spotData=null;this._labelStrategy=new ef(this);this._labelClick=new c(this);this._biz=new gT(this);this._map.temp.isPermitSpotOver=true;this.labelStyleParam="pl";if(this._map.getMapType()===BMAP_SATELLITE_MAP){this.labelStyleParam="sl"}this.statRequestCount=0;this.statResponseCount=0},_resizeHandler:function(h0){var h2=this,i=h2._map,hZ=i.getSize(),T=hZ.width,h4=hZ.height;var h1=this.ratio;var h5=this._labelCanvas,hY=h5.style;hY.width=T+"px";hY.height=h4+"px";h5.width=T*h1;h5.height=h4*h1;h2._width=T;h2._height=h4;var h3=true;h2._loadData(h3)},_bindEvent:function(){var e=this,i=e._map;i.addEventListener("load",function(T){e.clearLabel();e._loadData()});i.addEventListener("zoomend",function(T){if(!T.notClearLabel){e.clearLabel()}e._loadData()});i.addEventListener("moveend",function(T){e._loadData()});i.addEventListener("resize",function(T){e._resizeHandler(T)});i.addEventListener("maptypechange",function(T){if(T.mapType===BMAP_EARTH_MAP){e.hideLabelCanvas()}else{e.showLabelCanvas();if(T.mapType===BMAPGL_NORMAL_MAP){e.labelStyleParam="pl"}else{if(T.mapType===BMAP_SATELLITE_MAP){e.labelStyleParam="sl"}}e._loadData()}});i.addEventListener("streetlayer_show",function(T){if(this.isCanvasMap()){e.showLabelCanvas()}});i.addEventListener("streetlayer_hide",function(T){if(this.isCanvasMap()){e.hideLabelCanvas()}});i.addEventListener("loadbizdata",function(hY){var T=hY.data;e._biz.proecessBizData(T,function(){e.updateLabel()})});i.addEventListener("unloadbizdata",function(T){e._biz.clearBizData();e.updateLabel()});e.isDrawText=false;setTimeout(function(){if(!e.isDrawText){i.dispatchEvent(new bb("onmapwhitescreen"))}},10000)},getStyle:function(){return this._style},_getZoomUnits:function(e){return Math.pow(2,18-e)},_createCacheForm:function(T,h2,h1,i){var h0=this;var e=h0._cache;var hY=e.arrCache;var h3=this._getLabelId(T,h2,h1,i);var hZ={id:h3,updateLabelCounter:0};hY.push(hZ);hY[h3]=hZ;return hZ},_getLabelId:function(i,hY,T,e){return"_"+i+"_"+hY+"_"+T+"_"+e+"_"+this.labelStyleParam},_getCache:function(i,hY,T,e){return this._cache.arrCache[this._getLabelId(i,hY,T,e)]},_setCacheValue:function(hZ,ic,ia,hY,h5){var h7=this;var e=h7._cache;var h1=e.arrCache;var h3=e.maxNum;var h0=e.delNum;var ib=this._getLabelId(hZ,ic,ia,hY);var h6=h1[ib];if(h5){h6.lb=h5}if(h1.length>h3){var T=h1.splice(0,h0);for(var h4=0,h2=T.length;h4<h2;h4++){var h8=T[h4],h9=h8.id;if(h1[h9].lb){h1[h9].lb=null}h1[h9]=null;delete h1[h9]}T=null}},_loadData:function(ia){var ix=this._map;if(!ix.isCanvasMap()){return}var h3=ix.getCenterIn();var iw=d7.calcLoopCenterPoint(h3);var h2=this._tileType;var h5=this._width/2;var ij=this._height;var ik=ix.getZoom();var ig=h2.getDataZoom(ik);var h7=ix.getZoomUnits(ik);var ie=h7*h5;var iv=iw.lng-ie;var iu=iw.lng+ie;var ib=d7.isAddWidth(iv,iu);h5=ib?h5*1.5:h5;var ic=h2.getTileSize(ik);var hZ=h2.getMercatorSize(ik,ig);var h6=Math.floor(iw.lng/hZ);var h8=Math.floor(iw.lat/hZ);var h0=[h6,h8,(iw.lng-h6*hZ)/hZ*ic,(iw.lat-h8*hZ)/hZ*ic];var im=h0[0]-Math.ceil((h5-h0[2])/ic);var ir=h0[1]-Math.ceil((ij/2-h0[3])/ic);var ii=h0[0]+Math.ceil((h5+h0[2])/ic);var io=h0[1]+Math.ceil((ij/2+h0[3])/ic);ix.temp.isPermitSpotOver=false;var e=[];for(var iq=im;iq<ii;iq++){for(var ip=ir;ip<io;ip++){e.push([iq,ip,ig]);var ih="id_"+iq+"_"+ip+"_"+ik;e[ih]=true}}e._zoom=ig;e=d7.calcLoopTiles(e,ik);e.sort((function(i){return function(id,iz){return((0.4*Math.abs(id[0]-i[0])+0.6*Math.abs(id[1]-i[1]))-(0.4*Math.abs(iz[0]-i[0])+0.6*Math.abs(iz[1]-i[1])))}})([h0[0],h0[1]]));var h9=this._cache.arrCache;this._curViewLabels=[];var hY="viewKey_"+Math.floor(h3.lng)+"_"+Math.floor(h3.lat)+"_"+ik;this.statRequestCount=0;this.statResponseCount=0;this._labelCount+=e.length;var h4=ik;for(var iq=0,il=e.length;iq<il;iq++){var h6=e[iq][0];var h8=e[iq][1];var T=e[iq][2];var h1=this._getLabelId(h6,h8,T,h4);var it=h9[h1];if(!it){it=this._createCacheForm(h6,h8,T,h4)}if(typeof it.lb==="undefined"){it.lb=null;this._loadLabelData(h6,h8,T,h4,ic,hY);this.statRequestCount++}else{if(it.lb){this._curViewLabels.push(it.lb);this._labelCount--}else{if(ia){this._loadLabelData(h6,h8,T,h4,ic,hY)}it.updateLabelCounter++}}}if(this._labelCount===0){this.updateLabel()}var iy=this;if(iy.errorTimer){clearTimeout(iy.errorTimer)}iy.errorTimer=setTimeout(function(){if(iy._labelCount!==0){iy._labelCount=0;iy.updateLabel()}var iz=new bb("onloaddatatimeout");var iA=0;var id=0;var iB=0;var i=0;if(iy.statRequestCount===iy.statResponseCount){iA=1}else{id=1}if(id===1){i=iy.statRequestCount-iy.statResponseCount;iB=iy.statResponseCount}iz.noTimeoutCount=iA;iz.timeoutCount=id;iz.timeoutNoLoaded=i;iz.timeoutLoaded=iB;iy._map.dispatchEvent(iz)},500)},clearLabel:function(){var e=this._width;var T=this._height;var i=this.ratio;this._labelCtx.clearRect(0,0,e*i,T*i)},updateLabel:function(){var i=this._map;var e=i.getCenterIn();var hY=this._width;var h1=this._height;var h4=i.getZoom();var h3=this._tileType.getTileSize(h4);var h2=this._getZoomUnits(h4);var T=this._labelCtx;this._labelCanvas.style.left=-i.offsetX+"px";this._labelCanvas.style.top=-i.offsetY+"px";var h0=this._curViewLabels;h0._centerX=e.lng;h0._centerY=e.lat;var hZ=this._biz.bizLabels;this._computedLabel=this._labelStrategy.preComputeLabel(h0,hY,h1,h2,h3,hZ);this._computedLabel._zoom=h4;this.clearLabel();this._vectorDrawLib.drawIconAndText(T,this._computedLabel,h4);this._addSpotData();i.temp.isPermitSpotOver=true;if(h0.length>0){this.isDrawText=true}},_loadLabelData:function(h7,h6,h5,T,h8,e){var h0=h7.toString();var hY=h6.toString();var h2="cbk_"+h0.replace("-","_")+"_"+hY.replace("-","__")+"_"+Math.floor(h5);var ic=eF+"."+h2;var ib=this._labelDataUrls;var h4=Math.abs(h7+h6)%ib.length;var ii=ib[h4];if(window.offLineIPAddress){ii=window.offLineIPAddress+"pvd/"}var i=this.labelStyleParam;var ia="?qt=vtile";var id="";if(this._map.config.style!=="default"){id="&styleId=1"}var h9="x={x}&y={y}&z={z}&udt={udt}&v={v}&styles={styles}"+id+"&textonly=1&textimg=1&scaler={scaler}&fn="+encodeURIComponent(ic);var ie=d7.calcLoopParam(h7,h5).col;var h3=this.ratio>1?2:1;var h1=h9.replace(/{x}/,ie).replace(/{y}/,h6).replace(/{z}/,Math.floor(h5)).replace(/{styles}/,i).replace(/{udt}/,this._udt).replace(/{v}/,this._version).replace(/{scaler}/,h3);var hZ=ii+ia+"&param="+window.encodeURIComponent(gr(h1));var ih=this;var ig=ih._map;bo[h2]=function(ij){ih._vectorDrawLib.parseLabelData(ij,h7,h6,h5,T,h8,function(ip){var il=ig.getCenterIn();var iq=ig.getZoom();var it="viewKey_"+Math.floor(il.lng)+"_"+Math.floor(il.lat)+"_"+iq;ih._labelCount--;var iu=ih._getCache(h7,h6,h5,T).updateLabelCounter;ih._labelCount-=iu;var im=ih._curViewLabels;if(it===e||(ih._labelCount<0&&iq===h5)){im.push(ip)}if(it===e){ih.statResponseCount++}if(ih._labelCount<=0){var ik=(new Date()).getTime();ih.updateLabel();var io=(new Date()).getTime();var ir=new bb("oncanvasmaploaded");ir.drawTime=io-ik;if(ih.statResponseCount===ih.statRequestCount){ir.isAllLoadedDrawing=true}ig.dispatchEvent(ir)}ih._setCacheValue(h7,h6,h5,T,ip);delete bo[h2]})};ht.load(hZ)},drawLabel:function(T,hY,h5,i,h3,hZ,e,h0,h4,h1){var h2=this;if(!h2._computedLabel){return}if(h2._computedLabel._zoom!==h5){h2.clearLabel();return}h2._map.temp.isPermitSpotOver=false;h2.clearLabel();h2._vectorDrawLib.zoomingIconAndText(this._labelCtx,h2._computedLabel,T,hY,i,h3,hZ,e,h0,h4,h1)},_addSpotData:function(){this._spotData=[];var h5=this._map.getZoom();for(var h0=0,hZ=this._computedLabel.length;h0<hZ;h0++){var h2=this._computedLabel[h0];if(!this.isClickableLabel(h2)||(h2.guidExt===1&&h2.startScale>h5)){continue}var h1=[];h1[0]=(h2.minX-h2.maxX)/2;h1[1]=(h2.minY-h2.maxY)/2;h1[2]=(h2.maxX-h2.minX)/2;h1[3]=(h2.maxY-h2.minY)/2;var hY=null;if(h2.iconPos){hY=new hz(h2.iconPos.geoX,h2.iconPos.geoY)}var T=h2.name?h2.name.replace("\\\\","<br>"):"";if(h2.iconPos&&h2.iconPos.iconType.indexOf("ditie")>-1&&this._map.getZoom()>14){T=""}var h4={n:T,pt:new hz(h2.geoX,h2.geoY),userdata:{iconPoint:hY,uid:h2.guid,name:T,type:h2.iconPos?h2.iconPos.iconType:"",iconImg:h2.iconImg,mapPoi:true,adver_log:h2.adver_log||""},bd:h1,tag:"MAP_SPOT_INFO"};this._spotData.push(h4)}var h3=new bb("onspotsdataready");h3.spots=this._spotData;this._map._spotDataOnCanvas=this._spotData;this._map.dispatchEvent(h3)},isClickableLabel:function(e){if(e.isDel||(!e.guid&&!e.name)){return false}return true},getFilterImageData:function(T,h1){var h2=T.data,h0=this._labelStrategy,h1=parseInt(h1);for(var h3=0,hZ=h2.length;h3<hZ;h3+=4){var e=h2[h3],h4=h2[h3+1],h5=h2[h3+2],h6=h2[h3+3];if(h6===0){continue}var hY=Math.round((e+h4+h5)/3);var h7=hY-90;h7=h7<0?0:h7;if(h1===h0.RANK5){h2[h3]=51+h7*1.3;h2[h3+1]=133+h7*0.8;h2[h3+2]=255}}return T},showLabelCanvas:function(){this._labelCanvas.style.visibility=""},hideLabelCanvas:function(){this._labelCanvas.style.visibility="hidden"}});var b9=5;var dY=4;var hx=3;var fl=2;var hR=1;var d1=0;var hU=3;var hn=5;var I={3:{start:3,base:3},4:{start:4,base:5},5:{start:4,base:5},6:{start:6,base:7},7:{start:6,base:7},8:{start:8,base:9},9:{start:8,base:9},10:{start:10,base:10},11:{start:11,base:12},12:{start:11,base:12},13:{start:11,base:12},14:{start:14,base:15},15:{start:14,base:15},16:{start:16,base:17},17:{start:16,base:17},18:{start:18,base:19},19:{start:18,base:19},20:{start:18,base:19},21:{start:18,base:19}};function a0(hY){this._canvas2dMapMgr=hY;var i=this.ratio=hY._map.config.ratio;this._featureStyle=null;this._map=hY._map;var T=fF();var e="udt="+T.udt+"&v="+T.ver;this.sizeRatio=this.ratio>1?2:1;this._binaryCache={};this._iconCache={};this._initColorCanvas()}C.extend(a0.prototype,{_initColorCanvas:function(){var i=256,T=S("canvas"),e=T.style;e.width=i+"px";e.height=i+"px";T.width=i;T.height=i;this._colorCvs=T;this._colorCtx=T.getContext("2d")},parseLabelData:function(i,h0,hZ,hY,e,h3,h2){if(!this._featureStyle){this._featureStyle=this._canvas2dMapMgr.getStyle()}if(!i||!i[0]){h2([]);return}var h1=this._map.getZoomUnits();var T=this;this.loadTextPng(i,h3,h0,hZ,hY,e,h1,h2)},loadTextPng:function(ig,h6,h4,h3,h1,i,hZ,hY){var ie=this;var e=ig[5];var id=this._map;var ia=id.getZoom();var T=id.getSize();var ib=T.width;var h9=T.height;var ic=id.getCenterIn();var h2=ic.lng;var h0=ic.lat;var h8=h4*h6*hZ;var h7=(h3+1)*h6*hZ;if(e){var h5=new Image();h5.onload=function(){ie.calcIconAndTextInfo(ig,h5,h6,h4,h3,h1,i,hZ,h8,h7,hY);delete this.onload};h5.src=e}else{setTimeout(function(){ie.calcIconAndTextInfo(ig,null,h6,h4,h3,h1,i,hZ,h8,h7,hY)},1)}},calcIconAndTextInfo:function(ii,h8,h9,h7,h4,h2,hY,h0,ib,ia,hZ){var ih=this;var ig=ih._featureStyle;var h5=[];h5.x=h7;h5.y=h4;h5.z=h2;var h6=ih._canvas2dMapMgr,T=h7*h0*h9,ie=(h4+1)*h0*h9,h1={tileLeft:T,tileTop:ie,zoomUnits:h0};var e=[];if(ii[0]){for(var ic=0;ic<ii[0].length;ic++){if(ii[0][ic][0]===hU){e.push(ii[0][ic])}}}var h3=ii[2]||[];for(var ic=0;ic<e.length;ic++){this._getFixedLabelInfo(e[ic],h8,hY,h0,h9,ib,ia,h5)}var id=Math.pow(2,hY-h2);for(ic=0;ic<h3.length;ic++){this._getLineLabelInfo(h3[ic],h8,h2,hY,h0,h9,ib,ia,id,h5)}hZ(h5)},_getFixedLabelInfo:function(h8,ic,hZ,h3,id,ih,ig,ij){var h7=h8[1];if(!h7){return}var il=this._map.getZoom();var iv=this._map.config.style;var iw=this._featureStyle;var h4=hZ;if(h4===9){h4=8}for(var ir=0;ir<h7.length;ir++){var ix=h7[ir];var e=ix[0];var hY=eo.getStyleFromCache(iv,e,"point",h4,iw);var iq=eo.getStyleFromCache(iv,e,"pointText",h4,iw);if((!iq||iq.length===0)&&(!hY||hY.length===0)){if(h4===5){var h2=ix[1];if(!h2){continue}for(var im=0;im<h2.length;im++){var ik=h2[im][4];if(ik&&ik[7]==="北京"){hY=eo.getStyleFromCache(iv,e,"point",6,iw);iq=eo.getStyleFromCache(iv,e,"pointText",6,iw);break}else{continue}}}else{continue}}var h2=ix[1];if(!h2){continue}var it=null;var h5=1;var T=0;var ib=0;if(hY&&hY[0]){hY=hY[0];it=hY.icon;h5=hY.zoom?hY.zoom/100:1}else{hY=null}for(var im=0;im<h2.length;im++){var ik=h2[im][4];if(!ik){continue}var ip=ik[2];if(!this._isVisible(ip,il)){continue}var h6=ik[12];if(iq&&iq.length>0&&!h6){continue}var ia=Math.round(ik[0]/100);var h9=Math.round(ik[1]/100);var io={lng:ih+ia,lat:ig-(id*h3-h9)};var h1=ia/h3;var h0=id-h9/h3;var ie=ik[7]||"";var iu=ik[5];var ii={type:"fixed",name:ie,textImg:ic,rank:ik[4],baseX:h1,baseY:h0,iconPos:null,textPos:null,guid:ik[3]||"",tracer:ip,direction:iu,startScale:3};if((iu!==dY&&h6||!h6)&&it!==null){ii.iconPos=this._getIconPosition(it,h5,h1,h0,io);if(ii.iconPos){T=ii.iconPos.width;ib=ii.iconPos.height}}if(T===0){ii.direction=dY}if(h6){ii.textPos=this._getTextDrawData(ik,h1,h0,T,ib)}if(ii.textPos||ii.iconPos){ij.push(ii)}}}},_isVisible:function(e,i){var hY;if(!this._binaryCache[e]){hY=e.toString(2);if(hY.length<8){hY=new Array(8-hY.length+1).join("0")+hY}this._binaryCache[e]=hY}hY=this._binaryCache[e];var T=I[i].start;return hY[i-T]==="1"},_getIconPosition:function(h2,h0,T,i,e){var hY=this._map.config.style;var h3=bo["iconSetInfo"+hY][h2];if(!h3){if(h2.charCodeAt(0)>=48&&h2.charCodeAt(0)<=57){h3=bo["iconSetInfo"+hY]["_"+h2]}}if(!h3){return null}var hZ=h3[0];var h1=h3[1];hZ=hZ*h0;h1=h1*h0;return{srcX:0,srcY:0,destX:T-hZ/2,destY:i-h1/2,width:hZ,height:h1,geoX:e.lng,geoY:e.lat,mcPt:e,iconType:h2}},_getTextDrawData:function(h9,h8,h7,hY,h5){var ie=h9[5];if(typeof ie!=="number"){ie=0}var h3=this.ratio;var h2=h3/2;hY*=h2;h5*=h2;var h4=h9[12];var hZ=h4.length;var ii=0;var ih=0;var id=[];var ic=0;var ig=0;for(var ib=0;ib<hZ;ib++){ig+=Math.round(h4[ib][3])}for(var ib=0;ib<hZ;ib++){var h1=h4[ib];var h0=h1[0];var i=h1[1];var T=h1[2];var e=h1[3];var ij=2*h3;var ia=0;if(hY!==0){ia=2*h3}if(hY===0){ie=dY}switch(ie){case hx:var h6=h7-ig/2-ij*(hZ-1)/2;ii=h8-T-hY/2-ia;ih=h6+ic+ij*ib;break;case hR:var h6=h7-ig/2-ij*(hZ-1)/2;ii=h8+hY/2+ia;ih=h6+ic+ij*ib;break;case fl:var h6=h7-h5/2-ig-ij*(hZ-1)-ij;ii=h8-T/2;ih=h6+ic+ij*ib;break;case d1:var h6=h7+h5/2+ij/2;ii=h8-T/2;ih=h6+ic+ij*ib;break;case dY:var h6=h7-e/2-ij*(hZ-1)/2;ii=h8-T/2;ih=h6+ic+ij*ib;break}ic+=e;if(T>0&&e>0){id.push({srcX:h0,srcY:i,destX:ii,destY:ih,width:T,height:e})}}if(id.length>0){return id}return null},_getLineLabelInfo:function(h6,hY,hZ,im,iB,id,ik,ij,il,ic){if(h6.length!==10){return}var ip=this.ratio;var T=this.ratio;var ix=h6[7].length;var ie=h6[1];var iz=h6[3];var iF=h6[8];var h2=h6[4];var e=2;var h0=h2.slice(0,e);for(var iC=e;iC<h2.length;iC+=e){h0[iC]=h0[iC-e]+h2[iC];h0[iC+1]=h0[iC-(e-1)]+h2[iC+1]}for(var iC=e;iC<h2.length;iC+=e){if(iC%(iz*e)===0||iC%(iz*e)===1){continue}h0[iC]=h0[iC-e]+h2[iC]/il;h0[iC+1]=h0[iC-(e-1)]+h2[iC+1]/il}for(var iE=0;iE<ix;iE++){var iA=h6[7][iE];if(!this._isVisible(iA,im)){continue}var ir=h6[6][iE];var ib=iE*iz*e;h2=h0.slice(ib,ib+iz*e);var ig=[];var iq=undefined;var io=undefined;var ia=undefined;var h9=undefined;var iF=h6[9].slice(0);if(ir){iF.reverse()}var iv;var it;for(var iD=0;iD<iz;iD++){var h8=h6[5][iz*iE+iD];var iw=h2[iD*e]/100;var iu=h2[iD*e+1]/100;var h7=iF[iD];var h3=h7[0];var h5=h7[1];var h1=h7[2];var h4=h7[3];var ii;var ih;var iH;var iG;if(iD===0){iv=iH=iw/iB;it=id-iu/iB;iG=iu/iB}else{iH=iw/iB;iG=iu/iB}var iJ=iv+(iH-iv)*T-h1/2;var iI=it+(id-iG-it)*T-h4/2;if(iq===undefined){iq=iv-h1/2;io=it-h4/2;ia=iq+h1;h9=io+h4}else{if(iJ<iq){iq=iJ}if(iI<io){io=iI}if(iJ+h1>ia){ia=iJ+h1}if(iI+h4>h9){h9=iI+h4}}ig.push({angle:h8,srcX:h3,srcY:h5,destX:iJ,destY:iI,width:h1,height:h4})}var iy={type:"line",textImg:hY,rank:ie,baseX:iv,baseY:it,arrWordPos:ig,minXOriginal:iq,minYOriginal:io,maxXOriginal:ia,maxYOriginal:h9,text:""};ic.push(iy)}},alterColor:function(h1,e,h0){var T=this._colorCtx,i=this._canvas2dMapMgr;T.clearRect(0,0,h1.width,h1.height);T.drawImage(e,h1.srcX,h1.srcY,h1.width,h1.height,0,0,h1.width,h1.height);var hZ=T.getImageData(0,0,h1.width,h1.height),hY=i.getFilterImageData(hZ,h0);T.putImageData(hY,0,0)},drawIconAndText:function(id,ic,e){var h4=this.ratio;var h2=this.sizeRatio/h4;var h6=2/h4;var iq=this;for(var ih=0,ie=ic.length;ih<ie;ih++){var h5=ic[ih];if(h5.isDel==false){var hZ=h5.baseDrawX;var hY=h5.baseDrawY;if(h5.type=="fixed"){var h1=h5.iconPos,ii=h5.textPos,ia=h5.textImg,il=h5.startScale;if(h1&&il<=e){var T=this._iconCache[h1.iconType];if(T){if(T.img){id.drawImage(T.img,0,0,T.img.width,T.img.height,Math.round(hZ*h4+(h1.drawX-hZ)/h6),Math.round(hY*h4+(h1.drawY-hY)/h6),h1.width/h6,h1.height/h6)}else{T.drawLabels.push(h5)}}else{if(!T){this._iconCache[h1.iconType]={img:null,drawLabels:[h5]};var it=new Image();it._iconName=h1.iconType;it.onload=function(){var iz=iq._iconCache[this._iconName];iz.img=this;this.onload=null;for(var iv=0;iv<iz.drawLabels.length;iv++){var ix=iz.drawLabels[iv];var iw=ix.baseDrawX;var iu=ix.baseDrawY;var iy=ix.iconPos;id.drawImage(this,0,0,this.width,this.height,Math.round(iw*h4+(iy.drawX-iw)/h6),Math.round(iu*h4+(iy.drawY-iu)/h6),iy.width/h6,iy.height/h6)}iz.drawPos=[]};it.src=e8.getIconSetPath(iq._map.config.style)+h1.iconType+".png"}}}if(ii&&ia&&il<=e){for(var h3=0;h3<ii.length;h3++){var ib=ii[h3];if(!h5._tempRank){id.drawImage(ia,ib.srcX,ib.srcY,ib.width,ib.height,Math.round(hZ*h4+(ib.drawX-hZ)/h2),Math.round(hY*h4+(ib.drawY-hY)/h2),ib.width/h2,ib.height/h2)}else{this.alterColor(ib,ia,h5._tempRank);id.drawImage(this._colorCvs,0,0,ib.width,ib.height,Math.round(hZ*h4+(ib.drawX-hZ)/h2),Math.round(hY*h4+(ib.drawY-hY)/h2),ib.width/h2,ib.height/h2)}}}}else{var h0=h5.arrWordPos,ia=h5.textImg,h9=h5.tileX,h7=h5.tileY;for(var ig=0,h8=h0.length;ig<h8;ig++){var ij=h0[ig];var ir=Math.round(h9+ij.destX);var ip=Math.round(h7+ij.destY);var ik=ij.angle;ir=hZ*h4+ir-hZ;ip=hY*h4+ip-hY;if(ik>10&&ik<350){id.save();var io=Math.round(ir+ij.width/2);var im=Math.round(ip+ij.height/2);id.translate(io,im);id.rotate(-ik/180*Math.PI);id.drawImage(ia,ij.srcX,ij.srcY,ij.width,ij.height,-Math.round(ij.width/2),-Math.round(ij.height/2),ij.width/h2,ij.height/h2);id.restore()}else{id.drawImage(ia,ij.srcX,ij.srcY,ij.width,ij.height,ir,ip,ij.width/h2,ij.height/h2)}}}}}},isCollide:function(h0,h9,h8,e,h2,T,h4){for(var hZ=0,hY=T.length;hZ<hY;hZ++){var h3=T[hZ],h1=1/Math.pow(2,h4+1),h7=h1*h3[3]/2,h6=h1*h3[4]/2,h5=h3[0];if(h5!=h0){if(!(h9+e<h3[1]-h7||h9>h3[1]+h3[3]+h7||h8+h2<h3[2]-h6||h8>h3[2]+h3[4]+h6)){return true}}}return false},zoomingIconAndText:function(iq,ij,hY,io,ip,iS,iy,h6,iE,ix,ig){var iT=this.ratio;var h7=this.sizeRatio/iT;var iU=2/iT;var i4=iT/2;var iO=io.x;var iN=io.y;var ir=2*iT;if(ig!==0){iN+=ix}var ia=undefined,h3=undefined,h0=undefined,h5=undefined,ie=undefined;var iD=iS>0?true:false;if(!iD){ia=[];var iH=1-iy}for(var i0=0,iY=ij.length;i0<iY;i0++){var iV=ij[i0];if(iV.isDel==false){var i5=iV.baseDrawX;var i2=iV.baseDrawY;iq.save();iq.translate(-h6*iT,-iE*iT);if(iV.isFadeout){if(!iD&&iV._schedule<=iy&&!iV._isIgnore){iq.globalAlpha=iH;iV._schedule=iy}else{iV._isIgnore=true;continue}}if(iV.type=="fixed"){var it=iV.iconPos,iA=iV.textPos,h1=iV.textImg,iu=iV.startScale;var T;var iL=0;if(it){iL=ir}if(it&&!iV.iconImg&&this._iconCache[it.iconType]){T=this._iconCache[it.iconType].img}if(it&&iu<=ip&&T){h5=it.width;ie=it.height;h3=(iO+(i5-iO)*hY)*iT-h5/2/iU;h0=(iN+(i2-iN)*hY)*iT-ie/2/iU+ig;if(!iD&&this.isCollide(i0,h3,h0,h5,ie,ia,iS)){iV.isFadeout=true}iq.drawImage(T,it.srcX,it.srcY,T.width,T.height,Math.round(h3),Math.round(h0),h5/iU,ie/iU);!iD&&ia.push([i0,h3,h0,h5,ie])}if(iA&&h1&&iu<=ip){var iz;var iB;var ii=0;var iw=0;if(it){ii=it.width;iw=it.height}var iM=iA.length;var h9=0;var iC=0;for(var ik=0;ik<iM;ik++){var iX=iA[ik];iC+=iX.height;if(h9<iX.width){h9=iX.width}}iC+=(ik-1)*ir;if(!iD&&this.isCollide(i0,h3,h0,h9,iC,ia,iS)){iV.isFadeout=true}var iW=0;for(var ik=0;ik<iM;ik++){var iX=iA[ik];switch(iV.direction){case hx:iz=-(ii/2/iU+iX.width+iL);iB=-iC/2+iW+ir*ik;break;case hR:iz=ii/2/iU+iL;iB=-iC/2+iW+ir*ik;break;case fl:iz=-iX.width/2;iB=-iw/2/iU-iC+iW-ir*(ik+1);break;case d1:iz=-iX.width/2;iB=iw/2/iU+iW+ir*(ik+1);break;case dY:iz=-iX.width/2;iB=-iC/2+iW+ir*ik;break}iW+=iX.height;h3=(iO+(i5-iO)*hY)*iT+iz/h7;h0=(iN+(i2-iN)*hY)*iT+iB/h7;+ig;h5=iX.width;ie=iX.height;if(!iV._tempRank){iq.drawImage(h1,iX.srcX,iX.srcY,h5,ie,Math.round(h3),Math.round(h0),h5/h7,ie/h7)}else{this.alterColor(iX,h1,iV._tempRank);iq.drawImage(this._colorCvs,0,0,h5,ie,Math.round(h3),Math.round(h0),h5/h7,ie/h7)}!iD&&ia.push([i0,h3,h0,h5,ie])}}}else{var ih=iV.arrWordPos,h1=iV.textImg,i3=iV.tileX,i1=iV.tileY;var h8=ih[0];var h4=Math.round(i3+h8.destX);var h2=Math.round(i1+h8.destY);for(var iZ=0,iK=ih.length;iZ<iK;iZ++){var iR=ih[iZ];var i7=Math.round(i3+iR.destX);var i6=Math.round(i1+iR.destY);var im=iR.angle;var iJ=Math.round((iO+(i5-iO)*hY)*iT-h8.width/2+i7-h4);var iI=Math.round((iN+(i2-iN)*hY)*iT-h8.height/2+i6-h2);h3=iJ;h0=iI;h5=iR.width;ie=iR.height;if(!iD&&this.isCollide(i0,h3,h0,h5,ie,ia,iS)){iV.isFadeout=true}if(im>10&&im<350){var iQ=iJ+iR.width/2;var iP=iI+iR.height/2;var hZ=im/180*Math.PI;var iv=Math.cos(hZ);var ib=Math.sin(hZ);var iG=iv;var ic=iv;var iF=ib;var id=-ib;var il=iQ-iQ*iv-iP*ib;var e=iP+iQ*ib-iP*iv;iq.save();iq.transform(iG,id,iF,ic,il,e);iq.drawImage(h1,iR.srcX,iR.srcY,h5,ie,h3,h0,h5/h7,ie/h7);iq.restore()}else{iq.drawImage(h1,iR.srcX,iR.srcY,h5,ie,h3,h0,h5/h7,ie/h7)}!iD&&ia.push([i0,h3,h0,h5,ie])}}iq.restore()}}}});function gT(e){this.initVars(e)}C.extend(gT.prototype,{initVars:function(e){this._map=e._map;this._canvas2dMapMgr=e;this.base64Prefix="data:image/png;base64,";this.bizData=null;this.objTextsPng=null;this.arrIconsPng=null;this.bizLabels=null},proecessBizData:function(h0,h4){var h2=this;this.bizData=h0;this.objTextsPng=null;this.arrIconsPng=null;var T=h0.textsPng;var h6=h0.iconsPng;if(!T||!h6){return}var h3=new Image();h3.onload=function(){h2.objTextsPng=this;h2.calcIconAndTextInfo(h4);this.onload=null};h3.src=this.base64Prefix+T;var h5=h6.length;var e=[];for(var hZ=0;hZ<h5;hZ++){var h1=h6[hZ];var hY=new Image();(function(i){hY.onload=function(){h5--;e[i]=this;if(h5===0){h2.arrIconsPng=e;h2.calcIconAndTextInfo(h4)}this.onload=null}})(hZ);hY.src=this.base64Prefix+h1}},calcIconAndTextInfo:function(h7){if(this.objTextsPng&&this.arrIconsPng){var h3=this.bizData;var h1=h3.pois;var e=[];for(var h4=0,h0=h1.length;h4<h0;h4++){var hY=h1[h4];var h2=this.arrIconsPng[hY.iconPng];var hZ=h2.height/2;var h6={type:"fixed",name:"",textImg:this.objTextsPng,iconImg:h2,rank:hY.rank,iconPos:{srcX:0,srcY:0,destX:-h2.width/2,destY:-hZ/2,width:h2.width,height:hZ,geoX:hY.x,geoY:hY.y,iconType:"vectorCustom"},textPos:this.calcTextPos(hY.pos,h2),startScale:hY.from<12?12:hY.from,guid:hY.guid,guidExt:1,adver_log:hY.adver_log||""};var T={type:"fixed",textDirLeft:"left",name:"",textImg:this.objTextsPng,iconImg:h2,rank:hY.rank,iconPos:{srcX:0,srcY:0,destX:-h2.width/2,destY:-hZ/2,width:h2.width,height:hZ,geoX:hY.x,geoY:hY.y,iconType:"vectorCustom"},textPos:this.calcTextPosLeft(hY.pos,h2),startScale:hY.from<12?12:hY.from,guid:hY.guid,guidExt:1,adver_log:hY.adver_log||""};var h5=[h6,T];e.push(h5)}this.bizLabels=e;h7&&h7()}},calcTextPos:function(h1,T){var i=[];var h0=h1.length/4;var hZ=T.width/2;if(h0===1){var hY={srcX:h1[0],srcY:h1[1],destX:hZ,destY:-h1[3]/2,width:h1[2],height:h1[3]};i.push(hY)}else{var hY={srcX:h1[0],srcY:h1[1],destX:hZ,destY:-h1[3],width:h1[2],height:h1[3]};var e={srcX:h1[4],srcY:h1[5],destX:hZ,destY:0,width:h1[6],height:h1[7]};i.push(hY);i.push(e)}return i},calcTextPosLeft:function(h1,T){var i=[];var h0=h1.length/4;var hZ=T.width/2;if(h0===1){var hY={srcX:h1[0],srcY:h1[1],destX:-hZ-h1[2],destY:-h1[3]/2,width:h1[2],height:h1[3]};i.push(hY)}else{var hY={srcX:h1[0],srcY:h1[1],destX:-hZ-h1[2],destY:-h1[3],width:h1[2],height:h1[3]};var e={srcX:h1[4],srcY:h1[5],destX:-hZ-h1[2],destY:0,width:h1[6],height:h1[7]};i.push(hY);i.push(e)}return i},clearBizData:function(){this.bizData=null;this.bizLabels=null}});function c7(){}C.extend(c7.prototype,{centerAndZoomIn:function(T,h4,h5){h5=h5||{};if(!this.loaded){this.firstTileLoad=false}h4=this._getProperZoom(h4).zoom;if(h5.noAnimation!==true&&this.loaded){var h0=this._ifUseAnimation(T,h4);if(h0){this.flyToIn(T,h4,h5);return}}var h2=this;if(!T&&!h4){return}this._stopAllAnimations();if(T&&!T.equals(this.centerPoint)){this.fire(new bb("oncenter_changed"))}if(h4&&h4!==this.zoomLevel){this.fire(new bb("onzoom_changed"))}T=T||this.centerPoint;h4=h4||this.zoomLevel;h4=this._getProperZoom(h4).zoom;if(this.mapType===BMAP_EARTH_MAP){if(!this._earth){this.mapType=BMAPGL_NORMAL_MAP;this.temp.originMapType=BMAP_EARTH_MAP;function h3(){h2._earth=new bo.Earth(h2,{showRealSunlight:h2.config.showRealSunlight,showMilkyway:h2.config.showMilkyway,earthBackground:h2.config.earthBackground});h2._proxyEarthEvents();h2._changeEarthMapType(BMAP_EARTH_MAP);C.extend(h2,bo.EarthView.prototype);delete h2.temp.originMapType}ed.load("earth",function(){if(bo["FeatureStyle"+h2.config.style]){h3()}else{h2.loadMapStyleFiles(function(){h3()})}})}}this.lastLevel=this.zoomLevel||h4;this.zoomLevel=h4;var h1=new bb("onload");h1.point=T;h1.zoom=h4;this.centerPoint=new hz(T.lng,T.lat);this.defaultZoomLevel=this.defaultZoomLevel||this.zoomLevel;this.defaultCenter=this.defaultCenter||this.centerPoint;if(this.mapType!==BMAP_EARTH_MAP){this.centerPoint=this.restrictCenter(this.centerPoint)}if(!this.loaded&&!(this.temp.originMapType===BMAP_EARTH_MAP)){var i=this.config.defaultMaxBounds;var hZ=new c5(i,"baidu",this.mapType);if(this.mapType!==BMAP_NONE_MAP){var hY=new cR({mapType:this.mapType,copyright:hZ,dataType:this.mapType===BMAP_SATELLITE_MAP?eM:gz,customLayer:this.mapType===BMAP_SATELLITE_MAP,baseLayer:true,transparentPng:true,tileTypeName:this.mapType===BMAP_SATELLITE_MAP?"web":"na"});hY._isInnerLayer=true;this.addTileLayer(hY);this.baseLayerAdded=true}if(this.mapType===BMAP_SATELLITE_MAP&&this._isHybridShow===true){this._addHybirdMap()}this.on("zoom_changed",function(){if(this._heading===0){return}if(this.getZoom()<7&&this.config.restrictCenter===true){h2.resetHeading()}})}this.loaded=true;this.dispatchEvent(h1);h5.callback&&h5.callback()},_ifUseAnimation:function(hY,h3){var h2=this.getSize();var T={zoom:this.zoomLevel};var h5={zoom:h3};var h4=this.pointToPixelIn(this.centerPoint);var hZ=this.pointToPixelIn(hY,T);var h1=this.pointToPixelIn(this.centerPoint,h5);var h7=this.pointToPixelIn(hY,h5);var h0=Math.abs(h4.x-hZ.x);var i=Math.abs(h4.y-hZ.y);var e=Math.abs(h1.x-h7.x);var h6=Math.abs(h1.y-h7.y);if((h0>h2.width||i>h2.height)&&(e>h2.width||h6>h2.height)){return false}return true},_setPlatformPosition:function(h5,h4,h7){h7=h7||{};if(h5===0&&h4===0&&!h7.point){return}if(isNaN(h7.initMapOffsetX)){h7.initMapOffsetX=this.offsetX}if(isNaN(h7.initMapOffsetY)){h7.initMapOffsetY=this.offsetY}var h1=dK(this._heading);if(this._tilt>0){h4=h4/Math.cos(dK(this._tilt))}var h6=h5*Math.cos(h1)+h4*Math.sin(h1);var h3=-h5*Math.sin(h1)+h4*Math.cos(h1);h6=h6+h7.initMapOffsetX;h3=h3+h7.initMapOffsetY;if(h7.point){var i=this.restrictCenter(h7.point);if(!i.equals(this.centerPoint)){this.centerPoint=i.clone();this.fire(new bb("oncenter_changed"))}}else{var hY=this.offsetX-h6;var e=this.offsetY-h3;var h2=this.centerPoint.lng;var h0=this.centerPoint.lat;var hZ=new hz(h2,h0);var T=this.getZoomUnits();this.centerPoint=this.restrictCenter(new hz(hZ.lng+hY*T,hZ.lat-e*T),T);this.fire(new bb("oncenter_changed"))}this.offsetX=h6;this.offsetY=h3;this.dispatchEvent(new bb("onmoving"))},restrictCenter:function(h6,e){if(this.config.restrictCenter===false){return h6}e=e||this.getZoomUnits();var h4=this.pixelToPointIn(new em(this.width,0),{center:h6});var h1=this.pixelToPointIn(new em(0,this.height),{center:h6});var h7=h6.lng;var ic=h6.lat;if(this.config.restrictBounds!==null&&!this.config.restrictBounds.isEmpty()){var ib=this.config.restrictBounds;var T=ib.getSouthWest();var h9=ib.getNorthEast();var h5=eq.convertLL2MC(T);var hZ=eq.convertLL2MC(h9);var h2=this.calcNewZoomByRestriction(h7,ic,h1,h4,h5.lng,hZ.lng,h5.lat,hZ.lat);if(h2>this.zoomLevel){this.zoomLevel=h2;return h6}h6.lng=this.calcNewLngByBounds(h7,h1,h4,h5.lng,hZ.lng,e);h6.lat=this.calcNewLatByBounds(ic,h1,h4,h5.lat,hZ.lat,e);return h6}var h3=this.pixelToPointIn(new em(0,0),{center:h6});var hY=this.pixelToPointIn(new em(0,this.height),{center:h6});if(this.zoomLevel<5){if(h3.lat>c8.MAX_LAT&&hY.lat<c8.MIN_LAT){var i=c8.MAX_LAT-h6.lat;var h0=h6.lat-c8.MIN_LAT;var ia;if(i<h0){ia=i/(this.height/2)}else{ia=h0/(this.height/2)}var h8=18-eH(ia);this.zoomLevel=h8;return h6}}if(h3.lat>c8.MAX_LAT){h6.lat=c8.MAX_LAT-this.height/2*e}else{if(hY.lat<c8.MIN_LAT){h6.lat=c8.MIN_LAT+this.height/2*e}}return h6},calcNewZoomByRestriction:function(h5,h4,e,h3,hZ,h1,hY,h0){var h8=0;var h9=0;if(typeof hY==="number"&&typeof h0==="number"&&h3.lat>h0&&e.lat<hY){var T=h0-h4;var i=h4-hY;var h2;if(T<i){h2=T/(this.height/2)}else{h2=i/(this.height/2)}h8=18-eH(h2)}if(typeof hZ==="number"&&typeof h1==="number"&&h3.lng>h1&&e.lng<hZ){var h7=h1-h5;var h6=h5-hZ;var h2;if(h7<h6){h2=h7/(this.width/2)}else{h2=h6/(this.width/2)}h9=18-eH(h2)}return Math.max(h8,h9)||this.zoomLevel},calcNewLatByBounds:function(i,hY,T,h1,h0,e){var hZ=i;if(T.lat>h0){hZ=h0-this.height/2*e}else{if(hY.lat<h1){hZ=h1+this.height/2*e}}return hZ},calcNewLngByBounds:function(h1,h0,hY,hZ,T,e){var i=h1;if(hY.lng>T){i=T-this.width/2*e}else{if(h0.lng<hZ){i=hZ+this.width/2*e}}return i},zoomTo:function(e,h9,ia){var h5=b6[this.mapType];if(!h5){return}var h4=this._getProperZoom(e);e=h4.zoom;if(this.zoomLevel===e){ia&&ia.callback&&ia.callback();return}var h0=e;this.lastLevel=this.zoomLevel;ia=ia||{};if(this.zoomEventStatus==="idle"){this.fire(new bb("onzoomstart"));this.zoomEventStatus="zooming"}if(!h9&&(this.getInfoWindow()&&this.temp.infoWin&&this.temp.infoWin.isOpen())){h9=eq.convertLL2MC(this.getInfoWindow().getPoint())}var T=null;if(ia.fixPixel){T=ia.fixPixel}else{if(h9){T=this.pointToPixelIn(h9,{useRound:false})}}var h1=this.pixelToPointIn(T);var h2=this.centerPoint.clone();this.fixPoint=h9;this.fixPixel=T;this.fixCenter=h2;this.mousePosMCPoint=h1;if(ia.noAnimation){e=h4.zoom;this.zoomLevel=e;this.fire(new bb("onzoom_changed"));var hZ=this.getCurrentMaxTilt();if(this._tilt>hZ){this._tilt=hZ}if(h9){if(this._heading%360!==0||this._tilt>0){var i=this._webglMapCamera.fromScreenPixelToMC(T.x,T.y,{center:h2,zoom:this.zoomLevel});if(i){var h6=i.sub(h1);var hY=h2.sub(h6);this.centerPoint=this.restrictCenter(hY)}}else{var h3=this.getZoomUnits();var hY=new hz(h9.lng-h3*(T.x-this.width/2),h9.lat+h3*(T.y-this.height/2));this.centerPoint=this.restrictCenter(hY,h3)}this.fire(new bb("oncenter_changed"))}this._checkFireZoomend();ia.callback&&ia.callback();return}this._animationInfo.zoom={current:this.zoomLevel,diff:e-this.zoomLevel,target:e};var h7=this;h7._checkFireZoomend();var h8=this._tilt;if(this.fixPoint||h8>c8.MAX_DRAG_TILT_L2){ia.renderCallback=function(){var ie=h7.getCurrentMaxTilt();if(h7._tilt>ie){h7._tilt=ie}var ig=h7.fixPixel;if(!h7.fixPixel||!h7.fixPoint){return}var ib=h7.fixPixel;var im=h7.fixPoint;var ij=h7.fixCenter;var ih=h7.mousePosMCPoint;if(h7._heading%360!==0||h7._tilt>0){var ic=h7._webglMapCamera.fromScreenPixelToMC(ib.x,ib.y,{center:ij,zoom:h7.zoomLevel,tilt:h7._tilt});if(ic){var il=ic.sub(ih);var id=ij.sub(il);h7.centerPoint=h7.restrictCenter(id)}}else{var ii=ib;var ik=h7.getZoomUnits();var id=new hz(im.lng-ik*(ii.x-h7.width/2),im.lat+ik*(ii.y-h7.height/2));h7.centerPoint=h7.restrictCenter(id,ik)}h7.fire(new bb("oncenter_changed"))}}if(ia.fromMouseWheel===true){this._startInfiniteZoomAnimation(ia);ia.callback&&ia.callback();return}this._startAnimation(ia)},_checkFireZoomend:function(){var e=this;if(e.fireZoomendTimer){clearTimeout(e.fireZoomendTimer)}e.fireZoomendTimer=setTimeout(function(){if(e.zoomEventStatus==="zooming"){e.fire(new bb("onzoomend"));e.zoomEventStatus="idle"}e.fireZoomendTimer=null},150)},deepZoomMedia:function(e){var i=this;if(!i.temp.isStdCtrlBusy){i.temp.isStdCtrlBusy=true;i.deepZoomTo(i.zoomLevel+e);setTimeout(function(){i.temp.isStdCtrlBusy=false},400)}},deepZoomTo:function(e){this.zoomTo(e)},flyToIn:function(T,iv,id){id=id||{};var hZ=this._getProperZoom(iv);iv=hZ.zoom;if(this.centerPoint.equals(T)&&this.zoomLevel===iv&&typeof id.heading!=="number"&&typeof id.tilt!=="number"){return}var e=this.getHeading()%360;var h5=this.getTilt();var ib=0;var ig=0;var h8=this.getBounds().containsPoint(T);if(typeof id.heading==="number"){ib=id.heading}else{if(h8){ib=e}}if(typeof id.tilt==="number"){ig=id.tilt}else{if(h8){ig=h5}}this._heading=e;var ir=ib-e;var im=ig-h5;var h9=this;var h1=this.zoomLevel;var h2=1.42;var ii=this.zoomScale(iv-h1);var ix=this.getZoomUnits();var h7=this.centerPoint.div(ix);var iy=T.div(ix);var iq=this.worldSize();var il=h2;var ik=Math.max(this.width,this.height);var ij=ik/ii;var h6=iy.sub(h7).mag();var i=il*il;function iu(iA){var iz=(ij*ij-ik*ik+(iA?-1:1)*i*i*h6*h6)/(2*(iA?ij:ik)*i*h6);return Math.log(Math.sqrt(iz*iz+1)-iz)}function hY(iz){return(Math.exp(iz)-Math.exp(-iz))/2}function h3(iz){return(Math.exp(iz)+Math.exp(-iz))/2}function ic(iz){return hY(iz)/h3(iz)}var h4=iu(0);var io=function(iz){return(h3(h4)/h3(h4+il*iz))};var ip=function(iz){return ik*((h3(h4)*ic(h4+il*iz)-hY(h4))/i)/h6};var h0=(iu(1)-h4)/il;if(Math.abs(h6)<0.000001||h0===Infinity||isNaN(h0)){if(Math.abs(ik-ij)<0.000001){this._animationInfo.zoom={current:this.zoomLevel,diff:iv-this.zoomLevel};this._animationInfo.center={current:this.centerPoint,diff:T.sub(this.centerPoint)};this._animationInfo.heading={current:e,diff:ib-e};this._animationInfo.tilt={current:h5,diff:ig-h5};this.setLock(true);this._startAnimation({callback:function(iz){h9.setLock(false);if(id.callback){id.callback(iz)}},duration:id.duration});return}var iw=ij<ik?-1:1;h0=Math.abs(Math.log(ij/ik))/il;ip=function(){return 0};io=function(iz){return Math.exp(iw*il*iz)}}var it=1.7;if(h0<0.3){it=0.8}else{if(h0>5){it=(h0-5)/2+it}}var ie=id.duration||1000*h0/it;if(isNaN(ie)){var ih={};for(var ia in id){ih[ia]=id[ia];ih.noAnimation=true}this.centerAndZoomIn(T,iv,ih);return}this.fire(new bb("onmovestart"));this.fire(new bb("onzoomstart"));this.setLock(true);this._startAnimation({duration:ie,renderCallback:function(iz,iA){var iB=iz*h0;var iE=ip(iB);var iD=h1+h9.scaleZoom(1/io(iB));if(iD<h9.getMinZoom()){iD=h9.getMinZoom()}if(iD>h9.getMaxZoom()){iD=h9.getMaxZoom()}if(iD!==h9.zoomLevel){h9.zoomLevel=iD;h9.fire(new bb("onzoom_changed"))}h9.centerPoint=h7.add(iy.sub(h7).mult(iE)).mult(ix);h9.fire(new bb("oncenter_changed"));if(typeof ib==="number"){var iC=iz/0.7;if(iC>1){iC=1}h9.setHeading(e+ir*iz,{noAnimation:true})}if(typeof ig==="number"){h9.setTilt(h5+im*iz,{noAnimation:true})}},callback:function(iz,iA){h9.setLock(false);if(iA&&iA.stop===true){h9.fire(new bb("onmoveend"));h9.fire(new bb("onzoomend"));id.callback&&id.callback(iz);return}if(iv!==h9.zoomLevel){h9.zoomLevel=iv;h9.fire(new bb("onzoom_changed"))}h9.fire(new bb("onmoveend"));h9.fire(new bb("onzoomend"));id.callback&&id.callback(iz)}})},zoomScale:function(e){return Math.pow(2,e)},scaleZoom:function(e){return Math.log(e)/Math.LN2},panToIn:function(i,T){T=T||{};if(!i||i.equals(this.centerPoint)){T.callback&&T.callback();return}var hY=this.pointToPixelIn(i);var e=Math.round(this.width/2);var h0=Math.round(this.height/2);var hZ=this._ifUseAnimation(i,this.zoomLevel);if(T.noAnimation===true||hZ===false){this._stopAllAnimations();this._panToIn(e-hY.x,h0-hY.y,i);T.callback&&T.callback();return}this.flyToIn(i,this.zoomLevel,T)},_panToIn:function(i,e,hY){var T=this.temp;if(T.operating===true){return}if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}this.dispatchEvent(new bb("onmovestart"));this._setPlatformPosition(i,e,{point:hY});this.dispatchEvent(new bb("onmoveend"))},_stopAllAnimations:function(e){e=e||{};if(this._ani){this._ani.stop(!!e.goToEnd,{stopCurrentAnimation:e.stopCurrentAnimation});this._ani=null}if(this._infiniteAni){this._infiniteAni.stop();this._infiniteAni=null}},panBy:function(i,e,T){i=Math.round(i)||0;e=Math.round(e)||0;T=T||{};if(Math.abs(i)<=this.width&&Math.abs(e)<=this.height&&T.noAnimation!==true){this._panBy(i,e,T)}else{this._panToIn(i,e,T.point);T.callback&&T.callback()}},_panBy:function(i,e,hZ){if(this.temp.operating===true){return}hZ=hZ||{};this.dispatchEvent(new bb("onmovestart"));var hY=this;var T=hY.temp;T.pl=hY.offsetX;T.pt=hY.offsetY;if(T.tlPan){T.tlPan.cancel()}if(T.dragAni){T.dragAni.stop(false,{readyToMove:true});T.dragAni=null}T.tlPan=new o({fps:hZ.fps||hY.config.fps,duration:hZ.duration||hY.config.actionDuration,transition:hZ.transition||cn.easeInOutQuad,render:function(h0){this.terminative=hY.temp.operating;if(hY.temp.operating){return}hY._setPlatformPosition(i*h0,e*h0,{initMapOffsetX:T.pl,initMapOffsetY:T.pt})},finish:function(h0){hY.dispatchEvent(new bb("onmoveend"));hY.temp.tlPan=false;if(hY.temp.stopArrow===true){hY.temp.stopArrow=false;if(hY.temp.arrow!==0){hY._arrow()}}}})},_startAnimation:function(i){var hZ=this._animationInfo;var T=this;i=i||{};if(T._ani){T._ani.stop(!!i.goToEnd,{stopCurrentAnimation:i.stopCurrentAnimation})}if(T._infiniteAni){T._infiniteAni.stop();T._infiniteAni=null}var h0=i.duration||500;var h1=i.transition||cn.ease;var e=new bb("onanimation_start");this.fire(e);if(i.unstopable){hZ=this._animationInfoUnstopable}var hY=new o({duration:h0,transition:h1,render:function(h4,h3){for(var h2 in hZ){if(!hZ.hasOwnProperty(h2)){continue}var h6=hZ[h2].current;var h5=hZ[h2].diff;T._setValueTick(h2,h6,h5,h4)}if(i.renderCallback){i.renderCallback(h4,h3)}},finish:function(h2){T.fire(new bb("onanimation_end"));if(i.unstopable){T._animationInfoUnstopable={};T._unstopableAni=null}else{T._ani=null;T._animationInfo={}}if(i.mapNeedCbk){i.mapNeedCbk()}if(i.callback){i.callback(h2)}},onStop:function(h2){h2=h2||{};T.fire(new bb("onanimation_end"));if(h2.stopCurrentAnimation){T._animationInfo={}}T._ani=null;if(i.mapNeedCbk){i.mapNeedCbk()}if(i.callback){i.callback(null,{stop:true})}}});if(i.unstopable){T._unstopableAni=hY}else{T._ani=hY}},_startInfiniteZoomAnimation:function(e){var i=this;if(i._ani){i._ani.stop(!!e.goToEnd,{stopCurrentAnimation:e.stopCurrentAnimation})}if(i._infiniteAni){return}this.fire(new bb("onanimation_start"));i._infiniteAni=new o({duration:10000,transition:cn.linear,render:function(){var T=i._animationInfo.zoom;if(Math.abs(T.current-T.target)<0.001){i._setValue("zoom",T.target);i._infiniteAni.stop();return}T.current+=(T.target-T.current)*0.35;i._setValue("zoom",T.current);if(e.renderCallback){e.renderCallback()}},finish:function(){i._infiniteAni=null;i._animationInfo={};i.fire(new bb("onanimation_end"));if(e.callback){e.callback()}},onStop:function(){i._infiniteAni=null;i._animationInfo={};i.fire(new bb("onanimation_end"));if(e.callback){e.callback()}}})},_setValue:function(e,T){if(e==="zoom"){this._preZoomLevel=this.zoomLevel;var i=this._getProperZoom(T);T=i.zoom;if(T!==this.zoomLevel){this.zoomLevel=T;if(T<5){this.restrictCenter(this.centerPoint)}this.fire(new bb("on"+e+"_changed"))}return}else{if(e==="center"){this.centerPoint=T}}this["_"+e]=T;this.fire(new bb("on"+e+"_changed"))},_setValueTick:function(e,hZ,hY,i){if(e==="center"){var T=new hz(hZ.lng+hY.lng*i,hZ.lat+hY.lat*i);this._setValue(e,T);return}if(e==="zoom"){this._setValue(e,Math.pow(hZ,1-i)*Math.pow(hZ+hY,i));return}this._setValue(e,hZ+hY*i)},setHeading:function(hY,i){i=i||{};if(hY===this._heading){i.callback&&i.callback();return}var T=f5(this._heading,360);var e=f5(hY,360);if(e===T){this._heading=hY;i.callback&&i.callback();return}if(i.noAnimation){this._setValue("heading",hY);i.callback&&i.callback();return}if(i.unstopable){this._animationInfoUnstopable.heading={current:this._heading,diff:hY-this._heading}}else{this._animationInfo.heading={current:this._heading,diff:hY-this._heading}}this._startAnimation(i)},resetHeading:function(e){var i=this._heading;while(i<0){i+=360}i=i%360;if(i>180){i-=360}this._heading=i;e=e||{};e.unstopable=true;this.setHeading(0,e)},getHeading:function(){return this._heading},setTilt:function(e,i){i=i||{};if(e===this._tilt){i.callback&&i.callback();return}if(e>c8.MAX_TILT){e=c8.MAX_TILT}if(e<c8.MIN_TILT){e=c8.MIN_TILT}if(i&&i.noAnimation){this._setValue("tilt",e);i.callback&&i.callback();return}this._animationInfo.tilt={current:this._tilt,diff:e-this._tilt};this._startAnimation(i)},getTilt:function(){return this._tilt},getCenterIn:function(){return this.centerPoint},getZoom:function(){return this.zoomLevel},getCameraPosition:function(T){T=T||{};var e=T.center||this.centerPoint;var hY=T.zoom||this.zoomLevel;var h1=typeof T.heading==="number"?T.heading:this._heading;var i=typeof T.tilt==="number"?T.tilt:this._tilt;var h0=this._webglMapCamera.generateMVMatrix(e,hY,h1,i);var hZ=mat4.create(Float32Array);mat4.invert(hZ,h0);return this._webglMapCamera.getPosition(hZ)}});function fU(i){this._jobQueue=[];this._idleOnlyJobQueue=[];var e=this;this.isIdle=true;i.on("updateframe",function(hY){var T=12-hY.frameTime;T=T<1?1:T;e.isIdle=false;if(e.idleWorkTimer){clearInterval(e.idleWorkTimer);e.idleWorkTimer=null}e.runJobs(T)});this._idleWorkerTicker=(function(T){return function(){if(T.isIdle){T.runJobs();T.runIdleOnlyJobs()}}})(this);i.on("mapglidle",function(){e.isIdle=true;e.runJobs();e.runIdleOnlyJobs();e.idleWorkTimer=setInterval(e._idleWorkerTicker,fU.MAX_IDLE_TIME)})}fU.MAX_IDLE_TIME=50;fU.MAX_FRAME_TIME=6;fU.prototype.runJobs=function(i){if(this._jobQueue.length===0){return}var hY=fH();var e=0;i=i||fU.MAX_FRAME_TIME;while(this._jobQueue.length&&e<i){var T=this._jobQueue.shift();if(T.state!=="invalid"){T.call()}e=fH()-hY}};fU.prototype.runIdleOnlyJobs=function(){if(this._idleOnlyJobQueue.length===0){return}var T=fH();var e=0;while(this._idleOnlyJobQueue.length&&e<fU.MAX_IDLE_TIME){var i=this._idleOnlyJobQueue.shift();if(i.state!=="invalid"){i.call()}e=fH()-T}};fU.prototype.checkIdleRunning=function(){if(this.isIdle&&!this.idleWorkTimer){this.runJobs();this.runIdleOnlyJobs();this.idleWorkTimer=setInterval(this._idleWorkerTicker,50)}};fU.prototype.addJob=function(e){this._jobQueue.push(e);this.checkIdleRunning()};fU.prototype.clearJobs=function(){this._jobQueue.length=0;this._idleOnlyJobQueue.length=0};fU.prototype.addIdleOnlyJob=function(e){this._idleOnlyJobQueue.push(e);this.checkIdleRunning()};var cb={};(function(h1){if(!h5){var h5=0.000001}if(!i){var i=(typeof Float32Array!=="undefined")?Float32Array:Array}if(!hZ){var hZ=Math.random}var T={};var h0=Math.PI/180;T.toRadian=function(h6){return h6*h0};var h4={};h4.create=function(h7){h7=h7||i;var h6=new h7(2);h6[0]=0;h6[1]=0;return h6};h4.clone=function(h6,h8){h8=h8||i;var h7=new h8(2);h7[0]=h6[0];h7[1]=h6[1];return h7};h4.fromValues=function(h6,h9,h8){h8=h8||i;var h7=new h8(2);h7[0]=h6;h7[1]=h9;return h7};h4.copy=function(h7,h6){h7[0]=h6[0];h7[1]=h6[1];return h7};h4.set=function(h7,h6,h8){h7[0]=h6;h7[1]=h8;return h7};h4.add=function(h8,h7,h6){h8[0]=h7[0]+h6[0];h8[1]=h7[1]+h6[1];return h8};h4.subtract=function(h8,h7,h6){h8[0]=h7[0]-h6[0];h8[1]=h7[1]-h6[1];return h8};h4.sub=h4.subtract;h4.multiply=function(h8,h7,h6){h8[0]=h7[0]*h6[0];h8[1]=h7[1]*h6[1];return h8};h4.mul=h4.multiply;h4.divide=function(h8,h7,h6){h8[0]=h7[0]/h6[0];h8[1]=h7[1]/h6[1];return h8};h4.div=h4.divide;h4.min=function(h8,h7,h6){h8[0]=Math.min(h7[0],h6[0]);h8[1]=Math.min(h7[1],h6[1]);return h8};h4.max=function(h8,h7,h6){h8[0]=Math.max(h7[0],h6[0]);h8[1]=Math.max(h7[1],h6[1]);return h8};h4.scale=function(h8,h7,h6){h8[0]=h7[0]*h6;h8[1]=h7[1]*h6;return h8};h4.scaleAndAdd=function(h8,h7,h6,h9){h8[0]=h7[0]+(h6[0]*h9);h8[1]=h7[1]+(h6[1]*h9);return h8};h4.distance=function(h8,h7){var h6=h7[0]-h8[0],h9=h7[1]-h8[1];return Math.sqrt(h6*h6+h9*h9)};h4.dist=h4.distance;h4.squaredDistance=function(h8,h7){var h6=h7[0]-h8[0],h9=h7[1]-h8[1];return h6*h6+h9*h9};h4.sqrDist=h4.squaredDistance;h4.length=function(h7){var h6=h7[0],h8=h7[1];return Math.sqrt(h6*h6+h8*h8)};h4.len=h4.length;h4.squaredLength=function(h7){var h6=h7[0],h8=h7[1];return h6*h6+h8*h8};h4.sqrLen=h4.squaredLength;h4.negate=function(h7,h6){h7[0]=-h6[0];h7[1]=-h6[1];return h7};h4.normalize=function(h9,h8){var h7=h8[0],ia=h8[1];var h6=h7*h7+ia*ia;if(h6>0){h6=1/Math.sqrt(h6);h9[0]=h8[0]*h6;h9[1]=h8[1]*h6}return h9};h4.dot=function(h7,h6){return h7[0]*h6[0]+h7[1]*h6[1]};h4.cross=function(h8,h7,h6){var h9=h7[0]*h6[1]-h7[1]*h6[0];h8[0]=h8[1]=0;h8[2]=h9;return h8};h4.lerp=function(h8,h7,h6,h9){var ib=h7[0],ia=h7[1];h8[0]=ib+h9*(h6[0]-ib);h8[1]=ia+h9*(h6[1]-ia);return h8};h4.random=function(h6,h8){h8=h8||1;var h7=hZ()*2*Math.PI;h6[0]=Math.cos(h7)*h8;h6[1]=Math.sin(h7)*h8;return h6};h4.transformMat2=function(h9,h8,h7){var h6=h8[0],ia=h8[1];h9[0]=h7[0]*h6+h7[2]*ia;h9[1]=h7[1]*h6+h7[3]*ia;return h9};h4.transformMat2d=function(h9,h8,h7){var h6=h8[0],ia=h8[1];h9[0]=h7[0]*h6+h7[2]*ia+h7[4];h9[1]=h7[1]*h6+h7[3]*ia+h7[5];return h9};h4.transformMat3=function(h9,h8,h7){var h6=h8[0],ia=h8[1];h9[0]=h7[0]*h6+h7[3]*ia+h7[6];h9[1]=h7[1]*h6+h7[4]*ia+h7[7];return h9};h4.transformMat4=function(h9,h8,h7){var h6=h8[0],ia=h8[1];h9[0]=h7[0]*h6+h7[4]*ia+h7[12];h9[1]=h7[1]*h6+h7[5]*ia+h7[13];return h9};h4.rotate=function(h9,h7,h6,id){var ic=h7[0]-h6[0];var ib=h7[1]-h6[1];var h8=Math.sin(id);var ia=Math.cos(id);h9[0]=ic*ia-ib*h8+h6[0];h9[1]=ic*h8+ib*ia+h6[1];return h9};h4.forEach=(function(){var h6=h4.create();return function(h9,id,ie,ic,ib,h7){var ia,h8;if(!id){id=2}if(!ie){ie=0}if(ic){h8=Math.min((ic*id)+ie,h9.length)}else{h8=h9.length}for(ia=ie;ia<h8;ia+=id){h6[0]=h9[ia];h6[1]=h9[ia+1];ib(h6,h6,h7);h9[ia]=h6[0];h9[ia+1]=h6[1]}return h9}})();h4.str=function(h6){return"vec2("+h6[0]+", "+h6[1]+")"};h1.vec2=h4;var h3={};h3.create=function(h7){h7=h7||i;var h6=new h7(3);h6[0]=0;h6[1]=0;h6[2]=0;return h6};h3.clone=function(h6,h8){h8=h8||i;var h7=new h8(3);h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];return h7};h3.fromValues=function(h6,ia,h8,h9){h9=h9||i;var h7=new h9(3);h7[0]=h6;h7[1]=ia;h7[2]=h8;return h7};h3.copy=function(h7,h6){h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];return h7};h3.set=function(h7,h6,h9,h8){h7[0]=h6;h7[1]=h9;h7[2]=h8;return h7};h3.add=function(h8,h7,h6){h8[0]=h7[0]+h6[0];h8[1]=h7[1]+h6[1];h8[2]=h7[2]+h6[2];return h8};h3.subtract=function(h8,h7,h6){h8[0]=h7[0]-h6[0];h8[1]=h7[1]-h6[1];h8[2]=h7[2]-h6[2];return h8};h3.sub=h3.subtract;h3.multiply=function(h8,h7,h6){h8[0]=h7[0]*h6[0];h8[1]=h7[1]*h6[1];h8[2]=h7[2]*h6[2];return h8};h3.mul=h3.multiply;h3.divide=function(h8,h7,h6){h8[0]=h7[0]/h6[0];h8[1]=h7[1]/h6[1];h8[2]=h7[2]/h6[2];return h8};h3.div=h3.divide;h3.min=function(h8,h7,h6){h8[0]=Math.min(h7[0],h6[0]);h8[1]=Math.min(h7[1],h6[1]);h8[2]=Math.min(h7[2],h6[2]);return h8};h3.max=function(h8,h7,h6){h8[0]=Math.max(h7[0],h6[0]);h8[1]=Math.max(h7[1],h6[1]);h8[2]=Math.max(h7[2],h6[2]);return h8};h3.scale=function(h8,h7,h6){h8[0]=h7[0]*h6;h8[1]=h7[1]*h6;h8[2]=h7[2]*h6;return h8};h3.scaleAndAdd=function(h8,h7,h6,h9){h8[0]=h7[0]+(h6[0]*h9);h8[1]=h7[1]+(h6[1]*h9);h8[2]=h7[2]+(h6[2]*h9);return h8};h3.distance=function(h8,h7){var h6=h7[0]-h8[0],ia=h7[1]-h8[1],h9=h7[2]-h8[2];return Math.sqrt(h6*h6+ia*ia+h9*h9)};h3.dist=h3.distance;h3.squaredDistance=function(h8,h7){var h6=h7[0]-h8[0],ia=h7[1]-h8[1],h9=h7[2]-h8[2];return h6*h6+ia*ia+h9*h9};h3.sqrDist=h3.squaredDistance;h3.length=function(h7){var h6=h7[0],h9=h7[1],h8=h7[2];return Math.sqrt(h6*h6+h9*h9+h8*h8)};h3.len=h3.length;h3.squaredLength=function(h7){var h6=h7[0],h9=h7[1],h8=h7[2];return h6*h6+h9*h9+h8*h8};h3.sqrLen=h3.squaredLength;h3.negate=function(h7,h6){h7[0]=-h6[0];h7[1]=-h6[1];h7[2]=-h6[2];return h7};h3.normalize=function(h9,h8){var h7=h8[0],ib=h8[1],ia=h8[2];var h6=h7*h7+ib*ib+ia*ia;if(h6>0){h6=1/Math.sqrt(h6);h9[0]=h8[0]*h6;h9[1]=h8[1]*h6;h9[2]=h8[2]*h6}return h9};h3.dot=function(h7,h6){return h7[0]*h6[0]+h7[1]*h6[1]+h7[2]*h6[2]};h3.cross=function(h7,ic,ib){var h6=ic[0],ie=ic[1],id=ic[2],ia=ib[0],h9=ib[1],h8=ib[2];h7[0]=ie*h8-id*h9;h7[1]=id*ia-h6*h8;h7[2]=h6*h9-ie*ia;return h7};h3.lerp=function(h8,h7,h6,h9){var ic=h7[0],ib=h7[1],ia=h7[2];h8[0]=ic+h9*(h6[0]-ic);h8[1]=ib+h9*(h6[1]-ib);h8[2]=ia+h9*(h6[2]-ia);return h8};h3.random=function(h6,ia){ia=ia||1;var h8=hZ()*2*Math.PI;var h9=(hZ()*2)-1;var h7=Math.sqrt(1-h9*h9)*ia;h6[0]=Math.cos(h8)*h7;h6[1]=Math.sin(h8)*h7;h6[2]=h9*ia;return h6};h3.transformMat4=function(h9,h8,h7){var h6=h8[0],ib=h8[1],ia=h8[2];h9[0]=h7[0]*h6+h7[4]*ib+h7[8]*ia+h7[12];h9[1]=h7[1]*h6+h7[5]*ib+h7[9]*ia+h7[13];h9[2]=h7[2]*h6+h7[6]*ib+h7[10]*ia+h7[14];return h9};h3.transformMat3=function(h9,h8,h7){var h6=h8[0],ib=h8[1],ia=h8[2];h9[0]=h6*h7[0]+ib*h7[3]+ia*h7[6];h9[1]=h6*h7[1]+ib*h7[4]+ia*h7[7];h9[2]=h6*h7[2]+ib*h7[5]+ia*h7[8];return h9};h3.transformQuat=function(ic,ij,h6){var ik=ij[0],ii=ij[1],ih=ij[2],ie=h6[0],id=h6[1],ib=h6[2],ig=h6[3],h9=ig*ik+id*ih-ib*ii,h8=ig*ii+ib*ik-ie*ih,h7=ig*ih+ie*ii-id*ik,ia=-ie*ik-id*ii-ib*ih;ic[0]=h9*ig+ia*-ie+h8*-ib-h7*-id;ic[1]=h8*ig+ia*-id+h7*-ie-h9*-ib;ic[2]=h7*ig+ia*-ib+h9*-id-h8*-ie;return ic};h3.rotateX=function(h8,h7,h6,ib){var ia=[],h9=[];ia[0]=h7[0]-h6[0];ia[1]=h7[1]-h6[1];ia[2]=h7[2]-h6[2];h9[0]=ia[0];h9[1]=ia[1]*Math.cos(ib)-ia[2]*Math.sin(ib);h9[2]=ia[1]*Math.sin(ib)+ia[2]*Math.cos(ib);h8[0]=h9[0]+h6[0];h8[1]=h9[1]+h6[1];h8[2]=h9[2]+h6[2];return h8};h3.rotateY=function(h8,h7,h6,ib){var ia=[],h9=[];ia[0]=h7[0]-h6[0];ia[1]=h7[1]-h6[1];ia[2]=h7[2]-h6[2];h9[0]=ia[2]*Math.sin(ib)+ia[0]*Math.cos(ib);h9[1]=ia[1];h9[2]=ia[2]*Math.cos(ib)-ia[0]*Math.sin(ib);h8[0]=h9[0]+h6[0];h8[1]=h9[1]+h6[1];h8[2]=h9[2]+h6[2];return h8};h3.rotateZ=function(h8,h7,h6,ib){var ia=[],h9=[];ia[0]=h7[0]-h6[0];ia[1]=h7[1]-h6[1];ia[2]=h7[2]-h6[2];h9[0]=ia[0]*Math.cos(ib)-ia[1]*Math.sin(ib);h9[1]=ia[0]*Math.sin(ib)+ia[1]*Math.cos(ib);h9[2]=ia[2];h8[0]=h9[0]+h6[0];h8[1]=h9[1]+h6[1];h8[2]=h9[2]+h6[2];return h8};h3.forEach=(function(){var h6=h3.create();return function(h9,id,ie,ic,ib,h7){var ia,h8;if(!id){id=3}if(!ie){ie=0}if(ic){h8=Math.min((ic*id)+ie,h9.length)}else{h8=h9.length}for(ia=ie;ia<h8;ia+=id){h6[0]=h9[ia];h6[1]=h9[ia+1];h6[2]=h9[ia+2];ib(h6,h6,h7);h9[ia]=h6[0];h9[ia+1]=h6[1];h9[ia+2]=h6[2]}return h9}})();h3.str=function(h6){return"vec3("+h6[0]+", "+h6[1]+", "+h6[2]+")"};h1.vec3=h3;var h2={};h2.create=function(h7){h7=h7||i;var h6=new h7(4);h6[0]=0;h6[1]=0;h6[2]=0;h6[3]=0;return h6};h2.clone=function(h6,h8){h8=h8||i;var h7=new h8(4);h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];h7[3]=h6[3];return h7};h2.fromValues=function(h6,ib,h9,h7,ia){ia=ia||i;var h8=new ia(4);h8[0]=h6;h8[1]=ib;h8[2]=h9;h8[3]=h7;return h8};h2.copy=function(h7,h6){h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];h7[3]=h6[3];return h7};h2.set=function(h8,h6,ia,h9,h7){h8[0]=h6;h8[1]=ia;h8[2]=h9;h8[3]=h7;return h8};h2.add=function(h8,h7,h6){h8[0]=h7[0]+h6[0];h8[1]=h7[1]+h6[1];h8[2]=h7[2]+h6[2];h8[3]=h7[3]+h6[3];return h8};h2.subtract=function(h8,h7,h6){h8[0]=h7[0]-h6[0];h8[1]=h7[1]-h6[1];h8[2]=h7[2]-h6[2];h8[3]=h7[3]-h6[3];return h8};h2.sub=h2.subtract;h2.multiply=function(h8,h7,h6){h8[0]=h7[0]*h6[0];h8[1]=h7[1]*h6[1];h8[2]=h7[2]*h6[2];h8[3]=h7[3]*h6[3];return h8};h2.mul=h2.multiply;h2.divide=function(h8,h7,h6){h8[0]=h7[0]/h6[0];h8[1]=h7[1]/h6[1];h8[2]=h7[2]/h6[2];h8[3]=h7[3]/h6[3];return h8};h2.div=h2.divide;h2.min=function(h8,h7,h6){h8[0]=Math.min(h7[0],h6[0]);h8[1]=Math.min(h7[1],h6[1]);h8[2]=Math.min(h7[2],h6[2]);h8[3]=Math.min(h7[3],h6[3]);return h8};h2.max=function(h8,h7,h6){h8[0]=Math.max(h7[0],h6[0]);h8[1]=Math.max(h7[1],h6[1]);h8[2]=Math.max(h7[2],h6[2]);h8[3]=Math.max(h7[3],h6[3]);return h8};h2.scale=function(h8,h7,h6){h8[0]=h7[0]*h6;h8[1]=h7[1]*h6;h8[2]=h7[2]*h6;h8[3]=h7[3]*h6;return h8};h2.scaleAndAdd=function(h8,h7,h6,h9){h8[0]=h7[0]+(h6[0]*h9);h8[1]=h7[1]+(h6[1]*h9);h8[2]=h7[2]+(h6[2]*h9);h8[3]=h7[3]+(h6[3]*h9);return h8};h2.distance=function(h9,h7){var h6=h7[0]-h9[0],ib=h7[1]-h9[1],ia=h7[2]-h9[2],h8=h7[3]-h9[3];return Math.sqrt(h6*h6+ib*ib+ia*ia+h8*h8)};h2.dist=h2.distance;h2.squaredDistance=function(h9,h7){var h6=h7[0]-h9[0],ib=h7[1]-h9[1],ia=h7[2]-h9[2],h8=h7[3]-h9[3];return h6*h6+ib*ib+ia*ia+h8*h8};h2.sqrDist=h2.squaredDistance;h2.length=function(h8){var h6=h8[0],ia=h8[1],h9=h8[2],h7=h8[3];return Math.sqrt(h6*h6+ia*ia+h9*h9+h7*h7)};h2.len=h2.length;h2.squaredLength=function(h8){var h6=h8[0],ia=h8[1],h9=h8[2],h7=h8[3];return h6*h6+ia*ia+h9*h9+h7*h7};h2.sqrLen=h2.squaredLength;h2.negate=function(h7,h6){h7[0]=-h6[0];h7[1]=-h6[1];h7[2]=-h6[2];h7[3]=-h6[3];return h7};h2.normalize=function(ia,h9){var h7=h9[0],ic=h9[1],ib=h9[2],h8=h9[3];var h6=h7*h7+ic*ic+ib*ib+h8*h8;if(h6>0){h6=1/Math.sqrt(h6);ia[0]=h9[0]*h6;ia[1]=h9[1]*h6;ia[2]=h9[2]*h6;ia[3]=h9[3]*h6}return ia};h2.dot=function(h7,h6){return h7[0]*h6[0]+h7[1]*h6[1]+h7[2]*h6[2]+h7[3]*h6[3]};h2.lerp=function(h8,h7,h6,h9){var ic=h7[0],ib=h7[1],ia=h7[2],id=h7[3];h8[0]=ic+h9*(h6[0]-ic);h8[1]=ib+h9*(h6[1]-ib);h8[2]=ia+h9*(h6[2]-ia);h8[3]=id+h9*(h6[3]-id);return h8};h2.random=function(h6,h7){h7=h7||1;h6[0]=hZ();h6[1]=hZ();h6[2]=hZ();h6[3]=hZ();h2.normalize(h6,h6);h2.scale(h6,h6,h7);return h6};h2.transformMat4=function(ia,h9,h7){var h6=h9[0],ic=h9[1],ib=h9[2],h8=h9[3];ia[0]=h7[0]*h6+h7[4]*ic+h7[8]*ib+h7[12]*h8;ia[1]=h7[1]*h6+h7[5]*ic+h7[9]*ib+h7[13]*h8;ia[2]=h7[2]*h6+h7[6]*ic+h7[10]*ib+h7[14]*h8;ia[3]=h7[3]*h6+h7[7]*ic+h7[11]*ib+h7[15]*h8;return ia};h2.transformQuat=function(ic,ij,h6){var ik=ij[0],ii=ij[1],ih=ij[2],ie=h6[0],id=h6[1],ib=h6[2],ig=h6[3],h9=ig*ik+id*ih-ib*ii,h8=ig*ii+ib*ik-ie*ih,h7=ig*ih+ie*ii-id*ik,ia=-ie*ik-id*ii-ib*ih;ic[0]=h9*ig+ia*-ie+h8*-ib-h7*-id;ic[1]=h8*ig+ia*-id+h7*-ie-h9*-ib;ic[2]=h7*ig+ia*-ib+h9*-id-h8*-ie;return ic};h2.forEach=(function(){var h6=h2.create();return function(h9,id,ie,ic,ib,h7){var ia,h8;if(!id){id=4}if(!ie){ie=0}if(ic){h8=Math.min((ic*id)+ie,h9.length)}else{h8=h9.length}for(ia=ie;ia<h8;ia+=id){h6[0]=h9[ia];h6[1]=h9[ia+1];h6[2]=h9[ia+2];h6[3]=h9[ia+3];ib(h6,h6,h7);h9[ia]=h6[0];h9[ia+1]=h6[1];h9[ia+2]=h6[2];h9[ia+3]=h6[3]}return h9}})();h2.str=function(h6){return"vec4("+h6[0]+", "+h6[1]+", "+h6[2]+", "+h6[3]+")"};h1.vec4=h2;var hY={};hY.create=function(h7){h7=h7||i;var h6=new h7(4);h6[0]=1;h6[1]=0;h6[2]=0;h6[3]=1;return h6};hY.clone=function(h6,h8){h8=h8||i;var h7=new h8(4);h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];h7[3]=h6[3];return h7};hY.copy=function(h7,h6){h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];h7[3]=h6[3];return h7};hY.identity=function(h6){h6[0]=1;h6[1]=0;h6[2]=0;h6[3]=1;return h6};hY.transpose=function(h8,h7){if(h8===h7){var h6=h7[1];h8[1]=h7[2];h8[2]=h6}else{h8[0]=h7[0];h8[1]=h7[2];h8[2]=h7[1];h8[3]=h7[3]}return h8};hY.invert=function(ia,h8){var h9=h8[0],h7=h8[1],h6=h8[2],ic=h8[3],ib=h9*ic-h6*h7;if(!ib){return null}ib=1/ib;ia[0]=ic*ib;ia[1]=-h7*ib;ia[2]=-h6*ib;ia[3]=h9*ib;return ia};hY.adjoint=function(h8,h6){var h7=h6[0];h8[0]=h6[3];h8[1]=-h6[1];h8[2]=-h6[2];h8[3]=h7;return h8};hY.determinant=function(h6){return h6[0]*h6[3]-h6[2]*h6[1]};hY.multiply=function(ia,ig,id){var h9=ig[0],h8=ig[1],h7=ig[2],h6=ig[3];var ih=id[0],ie=id[1],ic=id[2],ib=id[3];ia[0]=h9*ih+h7*ie;ia[1]=h8*ih+h6*ie;ia[2]=h9*ic+h7*ib;ia[3]=h8*ic+h6*ib;return ia};hY.mul=hY.multiply;hY.rotate=function(ia,id,ic){var h9=id[0],h8=id[1],h7=id[2],h6=id[3],ie=Math.sin(ic),ib=Math.cos(ic);ia[0]=h9*ib+h7*ie;ia[1]=h8*ib+h6*ie;ia[2]=h9*-ie+h7*ib;ia[3]=h8*-ie+h6*ib;return ia};hY.scale=function(ia,ib,id){var h9=ib[0],h8=ib[1],h7=ib[2],h6=ib[3],ie=id[0],ic=id[1];ia[0]=h9*ie;ia[1]=h8*ie;ia[2]=h7*ic;ia[3]=h6*ic;return ia};hY.str=function(h6){return"mat2("+h6[0]+", "+h6[1]+", "+h6[2]+", "+h6[3]+")"};hY.frob=function(h6){return(Math.sqrt(Math.pow(h6[0],2)+Math.pow(h6[1],2)+Math.pow(h6[2],2)+Math.pow(h6[3],2)))};hY.LDU=function(h6,h9,h8,h7){h6[2]=h7[2]/h7[0];h8[0]=h7[0];h8[1]=h7[1];h8[3]=h7[3]-h6[2]*h8[1];return[h6,h9,h8]};h1.mat2=hY;var e={};e.create=function(h7){h7=h7||i;var h6=new h7(16);h6[0]=1;h6[1]=0;h6[2]=0;h6[3]=0;h6[4]=0;h6[5]=1;h6[6]=0;h6[7]=0;h6[8]=0;h6[9]=0;h6[10]=1;h6[11]=0;h6[12]=0;h6[13]=0;h6[14]=0;h6[15]=1;return h6};e.clone=function(h6){var h7=new i(16);h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];h7[3]=h6[3];h7[4]=h6[4];h7[5]=h6[5];h7[6]=h6[6];h7[7]=h6[7];h7[8]=h6[8];h7[9]=h6[9];h7[10]=h6[10];h7[11]=h6[11];h7[12]=h6[12];h7[13]=h6[13];h7[14]=h6[14];h7[15]=h6[15];return h7};e.copy=function(h7,h6){h7[0]=h6[0];h7[1]=h6[1];h7[2]=h6[2];h7[3]=h6[3];h7[4]=h6[4];h7[5]=h6[5];h7[6]=h6[6];h7[7]=h6[7];h7[8]=h6[8];h7[9]=h6[9];h7[10]=h6[10];h7[11]=h6[11];h7[12]=h6[12];h7[13]=h6[13];h7[14]=h6[14];h7[15]=h6[15];return h7};e.identity=function(h6){h6[0]=1;h6[1]=0;h6[2]=0;h6[3]=0;h6[4]=0;h6[5]=1;h6[6]=0;h6[7]=0;h6[8]=0;h6[9]=0;h6[10]=1;h6[11]=0;h6[12]=0;h6[13]=0;h6[14]=0;h6[15]=1;return h6};e.transpose=function(h9,h8){if(h9===h8){var id=h8[1],ib=h8[2],ia=h8[3],h6=h8[6],ic=h8[7],h7=h8[11];h9[1]=h8[4];h9[2]=h8[8];h9[3]=h8[12];h9[4]=id;h9[6]=h8[9];h9[7]=h8[13];h9[8]=ib;h9[9]=h6;h9[11]=h8[14];h9[12]=ia;h9[13]=ic;h9[14]=h7}else{h9[0]=h8[0];h9[1]=h8[4];h9[2]=h8[8];h9[3]=h8[12];h9[4]=h8[1];h9[5]=h8[5];h9[6]=h8[9];h9[7]=h8[13];h9[8]=h8[2];h9[9]=h8[6];h9[10]=h8[10];h9[11]=h8[14];h9[12]=h8[3];h9[13]=h8[7];h9[14]=h8[11];h9[15]=h8[15]}return h9};e.invert=function(ir,ix){var iB=ix[0],iz=ix[1],iy=ix[2],iv=ix[3],ia=ix[4],h9=ix[5],h8=ix[6],h7=ix[7],iq=ix[8],ip=ix[9],io=ix[10],im=ix[11],iD=ix[12],iC=ix[13],iA=ix[14],iw=ix[15],il=iB*h9-iz*ia,ik=iB*h8-iy*ia,ij=iB*h7-iv*ia,ii=iz*h8-iy*h9,ih=iz*h7-iv*h9,ig=iy*h7-iv*h8,ie=iq*iC-ip*iD,id=iq*iA-io*iD,ic=iq*iw-im*iD,ib=ip*iA-io*iC,iu=ip*iw-im*iC,it=io*iw-im*iA,h6=il*it-ik*iu+ij*ib+ii*ic-ih*id+ig*ie;if(!h6){return null}h6=1/h6;ir[0]=(h9*it-h8*iu+h7*ib)*h6;ir[1]=(iy*iu-iz*it-iv*ib)*h6;ir[2]=(iC*ig-iA*ih+iw*ii)*h6;ir[3]=(io*ih-ip*ig-im*ii)*h6;ir[4]=(h8*ic-ia*it-h7*id)*h6;ir[5]=(iB*it-iy*ic+iv*id)*h6;ir[6]=(iA*ij-iD*ig-iw*ik)*h6;ir[7]=(iq*ig-io*ij+im*ik)*h6;ir[8]=(ia*iu-h9*ic+h7*ie)*h6;ir[9]=(iz*ic-iB*iu-iv*ie)*h6;ir[10]=(iD*ih-iC*ij+iw*il)*h6;ir[11]=(ip*ij-iq*ih-im*il)*h6;ir[12]=(h9*id-ia*ib-h8*ie)*h6;ir[13]=(iB*ib-iz*id+iy*ie)*h6;ir[14]=(iC*ik-iD*ii-iA*il)*h6;ir[15]=(iq*ii-ip*ik+io*il)*h6;return ir};e.adjoint=function(ie,ii){var im=ii[0],ik=ii[1],ij=ii[2],ig=ii[3],h9=ii[4],h8=ii[5],h7=ii[6],h6=ii[7],id=ii[8],ic=ii[9],ib=ii[10],ia=ii[11],ip=ii[12],io=ii[13],il=ii[14],ih=ii[15];ie[0]=(h8*(ib*ih-ia*il)-ic*(h7*ih-h6*il)+io*(h7*ia-h6*ib));ie[1]=-(ik*(ib*ih-ia*il)-ic*(ij*ih-ig*il)+io*(ij*ia-ig*ib));ie[2]=(ik*(h7*ih-h6*il)-h8*(ij*ih-ig*il)+io*(ij*h6-ig*h7));ie[3]=-(ik*(h7*ia-h6*ib)-h8*(ij*ia-ig*ib)+ic*(ij*h6-ig*h7));ie[4]=-(h9*(ib*ih-ia*il)-id*(h7*ih-h6*il)+ip*(h7*ia-h6*ib));ie[5]=(im*(ib*ih-ia*il)-id*(ij*ih-ig*il)+ip*(ij*ia-ig*ib));ie[6]=-(im*(h7*ih-h6*il)-h9*(ij*ih-ig*il)+ip*(ij*h6-ig*h7));ie[7]=(im*(h7*ia-h6*ib)-h9*(ij*ia-ig*ib)+id*(ij*h6-ig*h7));ie[8]=(h9*(ic*ih-ia*io)-id*(h8*ih-h6*io)+ip*(h8*ia-h6*ic));ie[9]=-(im*(ic*ih-ia*io)-id*(ik*ih-ig*io)+ip*(ik*ia-ig*ic));ie[10]=(im*(h8*ih-h6*io)-h9*(ik*ih-ig*io)+ip*(ik*h6-ig*h8));ie[11]=-(im*(h8*ia-h6*ic)-h9*(ik*ia-ig*ic)+id*(ik*h6-ig*h8));ie[12]=-(h9*(ic*il-ib*io)-id*(h8*il-h7*io)+ip*(h8*ib-h7*ic));ie[13]=(im*(ic*il-ib*io)-id*(ik*il-ij*io)+ip*(ik*ib-ij*ic));ie[14]=-(im*(h8*il-h7*io)-h9*(ik*il-ij*io)+ip*(ik*h7-ij*h8));ie[15]=(im*(h8*ib-h7*ic)-h9*(ik*ib-ij*ic)+id*(ik*h7-ij*h8));return ie};e.determinant=function(iu){var iz=iu[0],ix=iu[1],iv=iu[2],it=iu[3],h9=iu[4],h8=iu[5],h7=iu[6],h6=iu[7],ip=iu[8],io=iu[9],im=iu[10],il=iu[11],iB=iu[12],iA=iu[13],iy=iu[14],iw=iu[15],ik=iz*h8-ix*h9,ij=iz*h7-iv*h9,ii=iz*h6-it*h9,ih=ix*h7-iv*h8,ig=ix*h6-it*h8,ie=iv*h6-it*h7,id=ip*iA-io*iB,ic=ip*iy-im*iB,ib=ip*iw-il*iB,ia=io*iy-im*iA,ir=io*iw-il*iA,iq=im*iw-il*iy;return ik*iq-ij*ir+ii*ia+ih*ib-ig*ic+ie*id};e.multiply=function(ij,io,ik){var it=io[0],ir=io[1],ip=io[2],il=io[3],ic=io[4],ia=io[5],h8=io[6],h6=io[7],ii=io[8],ih=io[9],ig=io[10],ie=io[11],iv=io[12],iu=io[13],iq=io[14],im=io[15];var id=ik[0],ib=ik[1],h9=ik[2],h7=ik[3];ij[0]=id*it+ib*ic+h9*ii+h7*iv;ij[1]=id*ir+ib*ia+h9*ih+h7*iu;ij[2]=id*ip+ib*h8+h9*ig+h7*iq;ij[3]=id*il+ib*h6+h9*ie+h7*im;id=ik[4];ib=ik[5];h9=ik[6];h7=ik[7];ij[4]=id*it+ib*ic+h9*ii+h7*iv;ij[5]=id*ir+ib*ia+h9*ih+h7*iu;ij[6]=id*ip+ib*h8+h9*ig+h7*iq;ij[7]=id*il+ib*h6+h9*ie+h7*im;id=ik[8];ib=ik[9];h9=ik[10];h7=ik[11];ij[8]=id*it+ib*ic+h9*ii+h7*iv;ij[9]=id*ir+ib*ia+h9*ih+h7*iu;ij[10]=id*ip+ib*h8+h9*ig+h7*iq;ij[11]=id*il+ib*h6+h9*ie+h7*im;id=ik[12];ib=ik[13];h9=ik[14];h7=ik[15];ij[12]=id*it+ib*ic+h9*ii+h7*iv;ij[13]=id*ir+ib*ia+h9*ih+h7*iu;ij[14]=id*ip+ib*h8+h9*ig+h7*iq;ij[15]=id*il+ib*h6+h9*ie+h7*im;return ij};e.mul=e.multiply;e.translate=function(ij,il,id){var ic=id[0],ib=id[1],ia=id[2],ip,io,im,ik,h9,h8,h7,h6,ii,ih,ig,ie;if(il===ij){ij[12]=il[0]*ic+il[4]*ib+il[8]*ia+il[12];ij[13]=il[1]*ic+il[5]*ib+il[9]*ia+il[13];ij[14]=il[2]*ic+il[6]*ib+il[10]*ia+il[14];ij[15]=il[3]*ic+il[7]*ib+il[11]*ia+il[15]}else{ip=il[0];io=il[1];im=il[2];ik=il[3];h9=il[4];h8=il[5];h7=il[6];h6=il[7];ii=il[8];ih=il[9];ig=il[10];ie=il[11];ij[0]=ip;ij[1]=io;ij[2]=im;ij[3]=ik;ij[4]=h9;ij[5]=h8;ij[6]=h7;ij[7]=h6;ij[8]=ii;ij[9]=ih;ij[10]=ig;ij[11]=ie;ij[12]=ip*ic+h9*ib+ii*ia+il[12];ij[13]=io*ic+h8*ib+ih*ia+il[13];ij[14]=im*ic+h7*ib+ig*ia+il[14];ij[15]=ik*ic+h6*ib+ie*ia+il[15]}return ij};e.scale=function(h9,h7,h8){var h6=h8[0],ib=h8[1],ia=h8[2];h9[0]=h7[0]*h6;h9[1]=h7[1]*h6;h9[2]=h7[2]*h6;h9[3]=h7[3]*h6;h9[4]=h7[4]*ib;h9[5]=h7[5]*ib;h9[6]=h7[6]*ib;h9[7]=h7[7]*ib;h9[8]=h7[8]*ia;h9[9]=h7[9]*ia;h9[10]=h7[10]*ia;h9[11]=h7[11]*ia;h9[12]=h7[12];h9[13]=h7[13];h9[14]=h7[14];h9[15]=h7[15];return h9};e.rotate=function(it,iA,iC,h6){var ih=h6[0],ig=h6[1],ie=h6[2],iu=Math.sqrt(ih*ih+ig*ig+ie*ie),im,iy,il,iE,iD,iB,iz,id,ic,ib,ia,ir,iq,ip,io,ik,ij,ii,ix,iw,iv,h9,h8,h7;if(Math.abs(iu)<h5){return null}iu=1/iu;ih*=iu;ig*=iu;ie*=iu;im=Math.sin(iC);iy=Math.cos(iC);il=1-iy;iE=iA[0];iD=iA[1];iB=iA[2];iz=iA[3];id=iA[4];ic=iA[5];ib=iA[6];ia=iA[7];ir=iA[8];iq=iA[9];ip=iA[10];io=iA[11];ik=ih*ih*il+iy;ij=ig*ih*il+ie*im;ii=ie*ih*il-ig*im;ix=ih*ig*il-ie*im;iw=ig*ig*il+iy;iv=ie*ig*il+ih*im;h9=ih*ie*il+ig*im;h8=ig*ie*il-ih*im;h7=ie*ie*il+iy;it[0]=iE*ik+id*ij+ir*ii;it[1]=iD*ik+ic*ij+iq*ii;it[2]=iB*ik+ib*ij+ip*ii;it[3]=iz*ik+ia*ij+io*ii;it[4]=iE*ix+id*iw+ir*iv;it[5]=iD*ix+ic*iw+iq*iv;it[6]=iB*ix+ib*iw+ip*iv;it[7]=iz*ix+ia*iw+io*iv;it[8]=iE*h9+id*h8+ir*h7;it[9]=iD*h9+ic*h8+iq*h7;it[10]=iB*h9+ib*h8+ip*h7;it[11]=iz*h9+ia*h8+io*h7;if(iA!==it){it[12]=iA[12];it[13]=iA[13];it[14]=iA[14];it[15]=iA[15]}return it};e.rotateX=function(h6,id,ic){var ij=Math.sin(ic),ib=Math.cos(ic),ii=id[4],ih=id[5],ig=id[6],ie=id[7],ia=id[8],h9=id[9],h8=id[10],h7=id[11];if(id!==h6){h6[0]=id[0];h6[1]=id[1];h6[2]=id[2];h6[3]=id[3];h6[12]=id[12];h6[13]=id[13];h6[14]=id[14];h6[15]=id[15]}h6[4]=ii*ib+ia*ij;h6[5]=ih*ib+h9*ij;h6[6]=ig*ib+h8*ij;h6[7]=ie*ib+h7*ij;h6[8]=ia*ib-ii*ij;h6[9]=h9*ib-ih*ij;h6[10]=h8*ib-ig*ij;h6[11]=h7*ib-ie*ij;return h6};e.rotateY=function(ia,ii,ih){var ij=Math.sin(ih),ig=Math.cos(ih),h9=ii[0],h8=ii[1],h7=ii[2],h6=ii[3],ie=ii[8],id=ii[9],ic=ii[10],ib=ii[11];if(ii!==ia){ia[4]=ii[4];ia[5]=ii[5];ia[6]=ii[6];ia[7]=ii[7];ia[12]=ii[12];ia[13]=ii[13];ia[14]=ii[14];ia[15]=ii[15]}ia[0]=h9*ig-ie*ij;ia[1]=h8*ig-id*ij;ia[2]=h7*ig-ic*ij;ia[3]=h6*ig-ib*ij;ia[8]=h9*ij+ie*ig;ia[9]=h8*ij+id*ig;ia[10]=h7*ij+ic*ig;ia[11]=h6*ij+ib*ig;return ia};e.rotateZ=function(ia,id,ic){var ij=Math.sin(ic),ib=Math.cos(ic),h9=id[0],h8=id[1],h7=id[2],h6=id[3],ii=id[4],ih=id[5],ig=id[6],ie=id[7];if(id!==ia){ia[8]=id[8];ia[9]=id[9];ia[10]=id[10];ia[11]=id[11];ia[12]=id[12];ia[13]=id[13];ia[14]=id[14];ia[15]=id[15]}ia[0]=h9*ib+ii*ij;ia[1]=h8*ib+ih*ij;ia[2]=h7*ib+ig*ij;ia[3]=h6*ib+ie*ij;ia[4]=ii*ib-h9*ij;ia[5]=ih*ib-h8*ij;ia[6]=ig*ib-h7*ij;ia[7]=ie*ib-h6*ij;return ia};e.fromRotationTranslation=function(ik,ii,ig){var ic=ii[0],ib=ii[1],ia=ii[2],id=ii[3],il=ic+ic,h6=ib+ib,ie=ia+ia,h9=ic*il,h8=ic*h6,h7=ic*ie,ij=ib*h6,ih=ib*ie,ip=ia*ie,iq=id*il,io=id*h6,im=id*ie;ik[0]=1-(ij+ip);ik[1]=h8+im;ik[2]=h7-io;ik[3]=0;ik[4]=h8-im;ik[5]=1-(h9+ip);ik[6]=ih+iq;ik[7]=0;ik[8]=h7+io;ik[9]=ih-iq;ik[10]=1-(h9+ij);ik[11]=0;ik[12]=ig[0];ik[13]=ig[1];ik[14]=ig[2];ik[15]=1;return ik};e.fromQuat=function(ih,id){var ia=id[0],h9=id[1],h8=id[2],ib=id[3],ii=ia+ia,h6=h9+h9,ic=h8+h8,h7=ia*ii,ig=h9*ii,ie=h9*h6,ip=h8*ii,io=h8*h6,il=h8*ic,im=ib*ii,ik=ib*h6,ij=ib*ic;ih[0]=1-ie-il;ih[1]=ig+ij;ih[2]=ip-ik;ih[3]=0;ih[4]=ig-ij;ih[5]=1-h7-il;ih[6]=io+im;ih[7]=0;ih[8]=ip+ik;ih[9]=io-im;ih[10]=1-h7-ie;ih[11]=0;ih[12]=0;ih[13]=0;ih[14]=0;ih[15]=1;return ih};e.frustum=function(ia,h7,ig,h6,ie,ic,ib){var id=1/(ig-h7),h9=1/(ie-h6),h8=1/(ic-ib);ia[0]=(ic*2)*id;ia[1]=0;ia[2]=0;ia[3]=0;ia[4]=0;ia[5]=(ic*2)*h9;ia[6]=0;ia[7]=0;ia[8]=(ig+h7)*id;ia[9]=(ie+h6)*h9;ia[10]=(ib+ic)*h8;ia[11]=-1;ia[12]=0;ia[13]=0;ia[14]=(ib*ic*2)*h8;ia[15]=0;return ia};e.perspective=function(h9,h8,h7,ia,h6){var ic=1/Math.tan(h8/2),ib=1/(ia-h6);h9[0]=ic/h7;h9[1]=0;h9[2]=0;h9[3]=0;h9[4]=0;h9[5]=ic;h9[6]=0;h9[7]=0;h9[8]=0;h9[9]=0;h9[10]=(h6+ia)*ib;h9[11]=-1;h9[12]=0;h9[13]=0;h9[14]=(2*h6*ia)*ib;h9[15]=0;return h9};e.ortho=function(h9,h7,ig,h6,id,ic,ib){var ia=1/(h7-ig),ie=1/(h6-id),h8=1/(ic-ib);h9[0]=-2*ia;h9[1]=0;h9[2]=0;h9[3]=0;h9[4]=0;h9[5]=-2*ie;h9[6]=0;h9[7]=0;h9[8]=0;h9[9]=0;h9[10]=2*h8;h9[11]=0;h9[12]=(h7+ig)*ia;h9[13]=(id+h6)*ie;h9[14]=(ib+ic)*h8;h9[15]=1;return h9};e.lookAt=function(il,iu,iv,ic){var it,ir,ip,h8,h7,h6,ig,ie,id,im,iq=iu[0],io=iu[1],ik=iu[2],ib=ic[0],ia=ic[1],h9=ic[2],ij=iv[0],ii=iv[1],ih=iv[2];if(Math.abs(iq-ij)<h5&&Math.abs(io-ii)<h5&&Math.abs(ik-ih)<h5){return e.identity(il)}ig=iq-ij;ie=io-ii;id=ik-ih;im=1/Math.sqrt(ig*ig+ie*ie+id*id);ig*=im;ie*=im;id*=im;it=ia*id-h9*ie;ir=h9*ig-ib*id;ip=ib*ie-ia*ig;im=Math.sqrt(it*it+ir*ir+ip*ip);if(!im){it=0;ir=0;ip=0}else{im=1/im;it*=im;ir*=im;ip*=im}h8=ie*ip-id*ir;h7=id*it-ig*ip;h6=ig*ir-ie*it;im=Math.sqrt(h8*h8+h7*h7+h6*h6);if(!im){h8=0;h7=0;h6=0}else{im=1/im;h8*=im;h7*=im;h6*=im}il[0]=it;il[1]=h8;il[2]=ig;il[3]=0;il[4]=ir;il[5]=h7;il[6]=ie;il[7]=0;il[8]=ip;il[9]=h6;il[10]=id;il[11]=0;il[12]=-(it*iq+ir*io+ip*ik);il[13]=-(h8*iq+h7*io+h6*ik);il[14]=-(ig*iq+ie*io+id*ik);il[15]=1;return il};e.str=function(h6){return"mat4("+h6[0]+", "+h6[1]+", "+h6[2]+", "+h6[3]+", "+h6[4]+", "+h6[5]+", "+h6[6]+", "+h6[7]+", "+h6[8]+", "+h6[9]+", "+h6[10]+", "+h6[11]+", "+h6[12]+", "+h6[13]+", "+h6[14]+", "+h6[15]+")"};e.frob=function(h6){return(Math.sqrt(Math.pow(h6[0],2)+Math.pow(h6[1],2)+Math.pow(h6[2],2)+Math.pow(h6[3],2)+Math.pow(h6[4],2)+Math.pow(h6[5],2)+Math.pow(h6[6],2)+Math.pow(h6[6],2)+Math.pow(h6[7],2)+Math.pow(h6[8],2)+Math.pow(h6[9],2)+Math.pow(h6[10],2)+Math.pow(h6[11],2)+Math.pow(h6[12],2)+Math.pow(h6[13],2)+Math.pow(h6[14],2)+Math.pow(h6[15],2)))};h1.mat4=e})(window);function dc(){this.result={bkData:[],eleData:[[],[],[],[],[],[],[],[],[]],tileLabels:[]}}C.extend(dc.prototype,{createLayer:function(T,i){var e=this.result.bkData;i=i||{};if(!e[T]){e[T]=[[],[],[]]}e[T].tileTypeName=i.tileTypeName||"na";e[T].dataType=i.dataType||2;e[T].png8=i.png8||false;e[T].clipTile=i.clipTile||false;e[T].boundary=i.boundary||false},removeLayer:function(i){var e=this.result.bkData;e[i]=null},hasLayerBoundary:function(){var e=this.result.bkData;var T=false;for(var hY=0;hY<e.length;hY++){if(e[hY]&&e[hY].boundary){T=true;break}}return T},getResult:function(){return this.result},setData:function(h0,hZ,h1){var e=this.result.bkData;var T=e[hZ]?e[hZ][h1]:null;if(!T){return}for(var hY=0;hY<T.length;hY++){if(T[hY].key&&T[hY].key===h0.key){T[hY]=h0;return}}T.push(h0)},setLabelData:function(e){this.result.tileLabels=e},getLabelData:function(){return this.result.tileLabels},setOverlayData:function(i,e){if(!this.result.eleData[e]){return}this.result.eleData[e]=i},clearLabelOverlayData:function(){this.result.eleData[2]=[];this.result.eleData[3]=[];this.result.eleData[4]=[]},clearData:function(hY){var e=this.result.bkData;if(typeof hY==="number"){if(e[hY]){e[hY][0]=[];e[hY][1]=[];e[hY][2]=[]}return}for(var T=0;T<e.length;T++){if(!e[T]){continue}e[T][0]=[];e[T][1]=[];e[T][2]=[]}},sortThumbData:function(i){var e=this.result.bkData;var T=e[i];if(!T){return}if(T[0]&&T[0].length>0){T[0].sort(function(hZ,hY){return hZ.tileInfo.useZoom-hY.tileInfo.useZoom})}}});var fn=(function(){var h8=new Int8Array(4);var T=new Int32Array(h8.buffer,0,1);var h3=new Float32Array(h8.buffer,0,1);function ia(ii){T[0]=ii;return h3[0]}function i(ii){h3[0]=ii;return T[0]}function h4(ii){var ik=(ii[3]<<24|ii[2]<<16|ii[1]<<8|ii[0]);var ij=ia(ik&4278190079);return ij}var hZ=0;var h2=1;var h6=2;var ie=0;var ib=1;var h9=2;var h0=9;function h7(ii,ij){var ik;if(ij%2===0){ik=[-ii[1],ii[0]]}else{ik=[ii[1],-ii[0]]}return ik}function e(ii,ij,ik){var il=h7(ii,ij);var im;if(ik===h2){return il}else{if(ij===4||ij===5){im=[il[0]-ii[0],il[1]-ii[1]]}else{im=[il[0]+ii[0],il[1]+ii[1]]}if(ik===hZ){vec2.normalize(im,im)}return im}}function id(ij,ii){return Math.sqrt(Math.pow(ij[0]-ii[0],2)+Math.pow(ij[1]-ii[1],2))}function hY(im,il,ik,ii){var ij=vec2.dot(im,il);if(ik===h9||ik===ib){if((ii===0||ii===1)&&ij>0){return true}else{if((ii===2||ii===3)&&ij<0){return true}}}if((ii===0||ii===1)&&ij<0){return true}else{if((ii===2||ii===3)&&ij>0){return true}}return false}function h5(ij,ip,ir){var iq=h7(ij,ip);var il;var io=ij;var im=ir;var iu=[];vec2.normalize(iu,[io[0]+im[0],io[1]+im[1]]);var it=vec2.dot(iq,[-iu[1],iu[0]]);if(Math.abs(it)<0.1){it=1}var ik=1/it;il=[-iu[1]*ik,iu[0]*ik];var ii=vec2.dot(ij,il);if(ii<0){vec2.negate(il,il)}return{cos2:ii,offset:il}}function ih(ij,ip,ir,ii){var iq=h7(ij,ip);var io;var im;var il;if(ip===0||ip===1){io=ir;im=ij}else{io=ij;im=ir}if(!io||!im){return iq}var iu=[io[0]+im[0],io[1]+im[1]];if(iu[0]===0&&iu[1]===0){vec2.normalize(iu,im)}else{vec2.normalize(iu,iu)}var iv=hY(iu,iq,ii,ip);if(iv){return iq}var it=vec2.dot(iq,[-iu[1],iu[0]]);if(Math.abs(it)<0.1){it=1}var ik=1/it;il=[-iu[1]*ik,iu[0]*ik];return il}function ig(iv,iw,io,im,ix,iu,il,ip,ik,it){var ir;var ij=0;var ii=false;ir=iu.length/h0-1;h1(iw[0],iv[0],io[0],ix,im,4,ip,ik,undefined,iu,it);ir++;ij++;h1(iw[0],iv[0],io[0],ix,im,5,ip,ik,undefined,iu,it);ir++;ij++;for(var iq=0;iq<iv.length;iq++){h1(iw[iq],iv[iq],io[iq],ix,im,0,ip,ik,iv[iq-1],iu,it);ic(il,++ir,++ij,ii);h1(iw[iq],iv[iq],io[iq],ix,im,1,ip,ik,iv[iq-1],iu,it);ic(il,++ir,++ij,ii);h1(iw[iq+1],iv[iq],io[iq+1],ix,im,2,ip,ik,iv[iq+1],iu,it);ic(il,++ir,++ij,ii);h1(iw[iq+1],iv[iq],io[iq+1],ix,im,3,ip,ik,iv[iq+1],iu,it);ic(il,++ir,++ij,ii);if(im===ib&&iq!==iv.length-1){h1(iw[iq+1],iv[iq],io[iq+1],ix,im,8,ip,ik,iv[iq+1],iu,it);ic(il,++ir,++ij,ii);ii=ii?false:true}}h1(iw[iw.length-1],iv[iv.length-1],io[iw.length-1],ix,im,6,ip,ik,undefined,iu,it);ic(il,++ir,++ij,ii);h1(iw[iw.length-1],iv[iv.length-1],io[iw.length-1],ix,im,7,ip,ik,undefined,iu,it);ic(il,++ir,++ij,ii)}function h1(ix,il,iq,iy,ik,ir,io,ij,iv,iu,it){var iw=ir%2===0?1:-1;var ip;if(ir===4||ir===5||ir===6||ir===7){ip=e(il,ir,iy)}else{if(ir===0||ir===1||ir===2||ir===3){ip=ih(il,ir,iv,ik)}else{if(ir===8){var im=h5(il,ir,iv);ip=im.offset;vec2.normalize(ip,ip);var ii=im.cos2;if(ii<0){iw=-iw}}}}iu[iu.length]=ix[0]*10;iu[iu.length]=ix[1]*10;iu[iu.length]=ip[0]*ij*10;iu[iu.length]=ip[1]*ij*10;iu[iu.length]=io;iu[iu.length]=iw;iu[iu.length]=0;iu[iu.length]=it||0;iu[iu.length]=iq}function ic(im,ik,ii,il){var ij;if(ii%2===0){if(il){im[im.length]=ik-2;im[im.length]=ik-1;im[im.length]=ik}else{im[im.length]=ik-1;im[im.length]=ik-2;im[im.length]=ik}}else{if(il){im[im.length]=ik-1;im[im.length]=ik-2;im[im.length]=ik}else{im[im.length]=ik-2;im[im.length]=ik-1;im[im.length]=ik}}}return{getVertexCount:function(ij,ii){if(ii===ib){return ij*5-2}else{return ij*4}},buildData:function(iv,ik,iw,ir,ii,io,ij,it){var iu=[];var iq=0;var im=[0];for(var ip=0;ip<iv.length;ip++){if(ip>0){iq+=id(iv[ip],iv[ip-1]);im.push(iq*10)}if(ip!==iv.length-1){var il=[iv[ip+1][0]-iv[ip][0],iv[ip+1][1]-iv[ip][1]];var ix=[];if(il[0]===0&&il[1]===0){ix=[0,0]}else{vec2.normalize(ix,il)}iu[iu.length]=[ix[0],ix[1]]}}return ig(iu,iv,im,ik,iw,ir,ii,h4(io),ij,it)},toTileSolidLineVertices:function(im,ij){var ik=new Float32Array(im.length/h0*5);var ii=new Int16Array(ik.buffer);var ip=0;var il=0;for(var io=0;io<im.length;io+=h0){ii[ip]=~~im[io];ii[ip+1]=~~im[io+1];ii[ip+2]=~~im[io+2];ii[ip+3]=~~im[io+3];ik[il+2]=im[io+4];ii[ip+6]=im[io+5];ii[ip+7]=ij?ij:0;ii[ip+8]=im[io+7];ii[ip+9]=0;ip+=10;il+=5}return ik}}})();var eM=1;var gz=2;var fY={drawIndex:0,devicePixelRatio:a6(),zoomState:1,curViewTilesInfo:null,iconSetImg:null,LAST_CALC_ZOOM:-1,LAST_LOAD_VECTOR_ZOOM_CHANGE:false,lastCollisionTestTime:0,remove:function(){this.tileCache.clear()},initDrawData:function(){this.drawIndex=this.zIndex;this.map._featureMgr.createLayer(this.drawIndex,{tileTypeName:this.tileType.getName(),dataType:this.dataType,png8:this.png8,clipTile:this.clipTile,boundary:this.boundary});this.dispatchEvent(new bb("oninitDrawData"))},destroyDrawData:function(){this.map._featureMgr.removeLayer(this.drawIndex);var i=new bb("onremoveLayerMask");i.hasLayerBoundary=this.map._featureMgr.hasLayerBoundary();this.map.dispatchEvent(i)},setZIndex:function(h2){h2=Math.abs(Math.floor(h2))||1;if(!h2||h2===this.zIndex){return}var i=this.map._featureMgr.result.bkData;var hY=this.map.tileMgr.tileLayers;function T(h5){var h4=null;for(var h3=0;h3<hY.length;h3++){if(hY[h3].zIndex===h5){h4=hY[h3];break}}return h4}var e=[];var h1=[];var h0=this.zIndex;if(i[h2]){e.push(T(h2));h1.push(i[h2]);this.setTargetZIndex(h2);i[h2]=i[h0];i[h0]=null}else{this.setTargetZIndex(h2);i[h2]=i[h0];i[h0]=null;this.map.dispatchEvent(new bb("onrefresh"));return}var hZ=h2+1;while(hZ){if(i[hZ]){e.push(T(hZ));h1.push(i[hZ]);e.shift().setTargetZIndex(hZ);i[hZ]=h1.shift();hZ+=1}else{e.shift().setTargetZIndex(hZ);i[hZ]=h1.shift();hZ=0}}this.map.dispatchEvent(new bb("onrefresh"))},setZIndexTop:function(){var e=this.map._featureMgr.result.bkData;e[e.length]=e[this.zIndex];e[this.zIndex]=null;this.setTargetZIndex(e.length-1);this.map.dispatchEvent(new bb("onrefresh"))},getTileKey:function(e,hY){hY=hY||{};var i=typeof hY.useZoom==="number"?hY.useZoom:e.useZoom;var T=e.style||this.mapStyleId||"default";return this.mapType+"_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},getTileRenderDataKey:function(i){var T=i.col;var hY=i.zoom;var e=i.baseTileSize;T=d7.calcLoopParam(T,hY,e).col;return this.mapType+"_"+T+"_"+i.row+"_"+hY+"_"+i.useZoom},getTileUnits:function(e){var hY=this.map;var T=b6[hY.getMapType()];var i=T.baseUnits*Math.pow(2,T.zoomLevelBase-e);return i},getTilesUrl:function(hZ,h8,h9){var i=hZ.x;var ia=hZ.y;var h5=aD("ditu","normal");var h1=h5.ver;var h2=h5.udt;i=d7.calcLoopParam(i,h8,h9).col;var h7=b6.B_NORMAL_MAP.vectorTileUrls;var h0=Math.abs(i+ia)%h7.length;var h6=h7[h0];if(window.offLineIPAddress){h7=[window.offLineIPAddress+"pvd/"];h6=h7[0]}var T="x="+i+"&y="+ia+"&z="+Math.floor(h8);var h4=this.devicePixelRatio>1?"&scaler=2":"";var h3="&textimg=1";if(this.map.config.textRenderType==="canvas"){h3="&textimg=0"}var hY=this.map.config.style;if(typeof hY==="string"&&hY!=="default"){T+="&styleId="+e8.mapStyleNameIdPair[hY]}T+="&styles=pl"+h3+h4+"&v="+h1+"&udt="+h2+"&json=0";var e=h6+"?qt=vtile&param="+window.encodeURIComponent(gr(T));return e},getRasterTilesUrl:function(T,h0,hY){var hZ=b6[this.map.mapType];var i=this.map.config.style;var e=hZ.tileUrls[Math.abs(h0+T)%hZ.tileUrls.length]+"?qt=tile&x="+T+"&y="+h0+"&z="+hY+((i==="default"||typeof i!=="string")?"":("&styleId="+e8.mapStyleNameIdPair[i]))+"&styles=pl&udt="+this.normalUdt+"&scaler="+this.scaler+"&p=1";e=e.replace(/-(\d+)/gi,"M$1");return e},getZoomState:function(){var T=this.map;var i=T.getZoom();var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState},releaseOutViewTileData:function(e){var hZ=this.map._workerMgr.releasePendingData(e);for(var hY=0,T=hZ.length;hY<T;hY++){var h0=this.getTileKey(hZ[hY]);this.tileCache.removeData(h0)}},loadLayerData:function(e,hY,i){this.hasZoomChange=i;this.curViewTilesInfo=e;this.mapStyleId=this.map.getMapStyleId();this.releaseOutViewTileData(e);var T=this.getZoomState();if(this.dataType===gz){if(hY){this.getVectorLayerDataFromCache(e,T)}else{this.loadVectorLayerData(e)}}else{this.loadRasterLayerData(e,hY)}},getVectorLayerDataFromCache:function(h3,id){this.map.temp.isPermitSpotOver=false;this.tileLabels=[];if(this.baseLayer===true){var h7=this.map._customLabelMgr.virtualTile;if(h7&&h7.label){this.tileLabels.push(h7.label)}}this.thumbCache={};var ie=-1;for(var ia=0,h8=h3.length;ia<h8;ia++){var ib=h3[ia];var hZ=ib.col;var h0=ib.row;var T=ib.zoom;var h9=this._getTileTexImgKey(ib);var hY=ib.useZoom;ie=T;var h1=this.getTileKey(ib);var ih=this.tileCache.getData(h1);if(ih&&ih.status==="ready"){var ii=ih;this.map._featureMgr.setData(ih,this.drawIndex,2);if(ih.label){if(ih.label.status==="ready"){ih.label.tileInfo=ih.tileInfo;this.tileLabels.push(ih.label);if(ih.label.textureSources&&ih.label.textureSources[hY]&&this.map._webglMapScene){var ig=this.map._webglMapScene._painter;if(!ig._labelTextureAtlasOffset[h9]){ig._addToAsyncJob(ih.label.textureSources[hY])}}}else{if(ih.label.status!=="processing"){this.processLabelData(ih)}}}}else{var ic={tileInfo:ib,dataType:gz,key:h1};this.map._featureMgr.setData(ic,this.drawIndex,2);if(this.useThumbData){this.setThumbData(hZ,h0,T,hY,id)}}}this.tileLabels.labelZoom=ie;this.updateLabels(id);var h4=this.map.getZoom();var h2=Math.floor(h4);var h6=h4-h2;var h5=Math.floor(this.LAST_CALC_ZOOM);var e=this.LAST_CALC_ZOOM-h5;var ij=false;if(this.hasZoomChange){if(Math.abs(h4-this.LAST_CALC_ZOOM)>=0.5){ij=true}else{if(h6<0.5&&e>=0.5){ij=true}else{if(h6>=0.5&&e<0.5){ij=true}}}if(ij){this.cacheDataCollideLabels(0)}this.LAST_CALC_ZOOM=h4}else{if(this.tileLabels.length>0){this.cacheDataCollideLabels(C.Browser.ie?50:30)}}},loadVectorLayerData:function(h4){this.map.temp.isPermitSpotOver=false;var h3=this;function h2(i,h5){var h7=h3.tileCache.getData(h5);if(!h7){return}if(!i||i.error){var h6=new bb("ontileloaderror");i=i||{};h6.error=i.error||"";h6.message=i.message||"";h3.map.fire(h6);h7.status="init";h7.reloadTimer=setTimeout(function(){if(h7.retry<3){h7.retry++;h7.status="loading";h3.loadVectorTileData(i.tileInfo,h2)}else{h3.tileCache.removeData(h5)}},4000);h3.map._featureMgr.clearData(h3.drawIndex);h3._checkTilesLoaded();h3.getVectorLayerDataFromCache(h3.curViewTilesInfo,h3.getZoomState());return}if(h7.reloadTimer){clearTimeout(h7.reloadTimer);h7.reloadTimer=null}h3.callbackDataQueue.push([i,h5]);if(h3.processDataTimer){return}h3.processDataTimer=setTimeout(function(){while(h3.callbackDataQueue.length>0){var h8=h3.callbackDataQueue.shift();h3.vectorTileDataCbk(h8[0],h8[1]);h3._checkTilesLoaded()}h3.map._featureMgr.clearData(h3.drawIndex);h3.getVectorLayerDataFromCache(h3.curViewTilesInfo,h3.getZoomState());h3.processDataTimer=null},200)}for(var h1=0,hZ=h4.length;h1<hZ;h1++){var T=h4[h1];var h0=this.getTileKey(T);var e=this.tileCache.getData(h0);if(!e){e={status:"init",tileInfo:T,dataType:gz,key:h0,retry:0}}if(e.status!=="ready"&&e.status!=="loading"){this.numLoading++;e.status="loading";this.tileCache.setData(h0,e);var hY=this.getProcessedLabelZoom(T);if(hY){T.processedLabelZooms=hY}this.loadVectorTileData(T,h2)}}},setThumbData:function(i,hZ,hY,e,T){if(T===1){if(this._findParentZoomTile(i,hZ,hY,e,8)===false){this._findChildZoomTile(i,hZ,hY,e,3)}}else{if(T===-1){if(this._findChildZoomTile(i,hZ,hY,e,3)===false){this._findParentZoomTile(i,hZ,hY,e,8)}}}this.map._featureMgr.sortThumbData(this.drawIndex)},_findParentZoomTile:function(h1,ia,h9,hZ,h4){var h0=b6[this.getMapType()];var T=h0.minDataZoom;var e=h1;var h7=ia;var h5=h9;var h6=hZ;for(var h3=1;h3<=h4;h3++){var hY=this.tileType.getParentTile(e,h7,h5,h6,T);if(hY===null){continue}var h8=this.getTileKey(hY);var h2=this.tileCache.getData(h8);if(h2&&h2.status==="ready"){if(this.thumbCache[h8]){continue}this.map._featureMgr.setData(h2,this.drawIndex,0);this.thumbCache[h8]=true;return true}e=hY.col;h7=hY.row;h5=hY.zoom;h6=hY.useZoom}return false},_findChildZoomTile:function(h2,h4,e,hZ,id){var ib=b6[this.getMapType()];var h7=ib.maxDataZoom;var h1=h2;var h3=h4;var h5=e;var hY=hZ;var h0=true;for(var ia=1;ia<=id;ia++){var h8=false;var T=this.tileType.getChildTiles(h1,h3,h5,hY,h7,ia);if(!T){continue}for(var h9=0;h9<T.length;h9++){var h6=this.getTileKey(T[h9]);var ic=this.tileCache.getData(h6);if(ic&&ic.status==="ready"){if(!this.thumbCache[h6]){this.map._featureMgr.setData(ic,this.drawIndex,1);this.thumbCache[h6]=true}h8=true}else{h0=false}}if(h8){break}}return h0},loadVectorTileData:function(i,hZ){var T=i.col;var h3=i.row;var h1=i.zoom;var h2=i.baseTileSize;var e=this.getTilesUrl(new em(T,h3),h1,h2);if(!e){return}var h0=this.getTileKey(i);by(this.map);if(!this.processData){this.map._workerMgr.loadTileData(e,i,h0,hZ);return}var hZ="cbk"+h0.replace(/-/g,"_");var hY=this;bo[hZ]=function(h4){var h5=(function(h6){return function(){h6.tileInfo=i;var ic=hY.processData(h6);if(!ic.road){return}var h9={tileInfo:i,renderData:{base:[]},status:"ready",key:h0,mapType:hY.mapType};var ig=[];var ij=[];for(var ib=0;ib<ic.road.length;ib++){var ie=ic.road[ib];var id=-1;for(var ia=0;ia<ie.length;ia++){var ih=ie[ia];var ii=[];if(ig.length/7+ih[0].length/2>65536){h9.renderData.base.push({type:"line",data:[fn.toTileSolidLineVertices(ig,4000),new Uint16Array(ij)]});ig=[];ij=[]}for(var h8=0;h8<ih[0].length;h8+=2){ii[ii.length]=[ih[0][h8],ih[0][h8+1]]}var h7=ih[3];fn.buildData(ii,ih[1],ih[2],ig,ij,h7,ih[4],ib+20,false)}h9.renderData.base.push({type:"line",data:[fn.toTileSolidLineVertices(ig,4000),new Uint16Array(ij)]})}hY.tileCache.setData(h0,h9);hY.map._featureMgr.clearData(hY.drawIndex);hY.getVectorLayerDataFromCache(hY.curViewTilesInfo,hY.getZoomState());hY.map.dispatchEvent(new bb("onrefresh"))}})(h4);hY.map.jobScheduler.addJob(h5);delete bo[hZ]};e+="&fn="+encodeURIComponent(eF+"."+hZ);ht.load(e)},vectorTileDataCbk:function(hY,hZ){var h3=new bb("ontileloaded");h3.perfStat=hY.perfStat||[];var e=this.map;e.fire(h3);var i=hY.tileInfo;var T=i.col;var h8=i.row;var h7=i.zoom;var h6=i.baseTileSize;var h1=this.tileCache.getData(hZ);if(!h1){return}if(!this.showLabel){hY.label=null}h1.renderData=hY;h1.tileInfo=i;var h0=d7.calcLoopParam(T,h7,h6);var h4=h0.geoOffsetX;h1.tileInfo.loopOffsetX=h4;h1.status="ready";h1.mapType=this.mapType;this.tileCache.setData(hZ,h1);h1.label=hY.label;hY.label=null;if(hY.indoorData&&e._indoorMgr){e._indoorMgr.setData(hY.indoorData)}var h2="id_"+T+"_"+h8+"_"+h7;if(!this.curViewTilesInfo[h2]){e.fire(new bb("ontilenotinview"));return}this.processLabelData(h1);if(hY.indoorData&&e._indoorMgr&&e._indoorMgr.currentUid){this._refreshIndoorData(e._indoorMgr.currentUid,e._indoorMgr.currentFloor)}var h5=new bb("onrefresh");h5.source="webgllayer";this.map.dispatchEvent(h5)},_refreshIndoorData:function(h6,h5){var h8=this.map._indoorMgr.getIndoorData(h6);var ib=h8.tileKeys;var h9=Math.floor(this.map.getZoom());for(var h3=0;h3<ib.length;h3++){var h0=ib[h3];var h2=this.tileCache.getData(h0);if(!h2){continue}var ia=h2.renderData;ia.indoorBase=[];ia.indoorBaseContour=[];ia.indoorBorder3D=[];ia.indoorArea3D=[];h2.label.indoorLabel=[];this.labelProcessor.clearCollisionCache(h2.label);for(var h4 in ia.indoorData){if(h4==="tileInfo"){continue}var e=ia.indoorData[h4];var hZ=e.defaultFloor;if(h4===h6){hZ=h5;e.currentFloor=h5}if(e.floors[hZ]){if(e.floors[hZ].base){for(var h1=0;h1<e.floors[hZ].base.length;h1++){ia.indoorBase.push(e.floors[hZ].base[h1])}}if(e.floors[hZ].contour){for(var h1=0;h1<e.floors[hZ].contour.length;h1++){ia.indoorBaseContour.push(e.floors[hZ].contour[h1])}}if(e.floors[hZ].indoorBorder3D){ia.indoorBorder3D.push(e.floors[hZ].indoorBorder3D)}if(e.floors[hZ].area3D){ia.indoorArea3D.push(e.floors[hZ].area3D)}if(e.floors[hZ].pois){h2.label.indoorLabel=h2.label.indoorLabel.concat(e.floors[hZ].pois)}}}this.updateAllIconsTextureCoords(h2);var h7=this;this.labelProcessor.loadIconImages(h2,function(i){h7.updateAllIconsTextureCoords(i)});var hY=h0.split("_");var T=parseInt(hY[hY.length-1],10);if(T!==h9){continue}h7.map._featureMgr.setData(h2,this.drawIndex,2)}this.dataBackCollideLabels();this.map.dispatchEvent(new bb("onrefresh"))},_removeIndoorData:function(i){if(!i.indoorData){return}for(var e in i.indoorData){if(e==="tileInfo"){continue}this.map._indoorMgr.removeData(e,i.key)}},getProcessedLabelZoom:function(hY){var hZ=di.baseZoomInfo[hY.zoom];if(!hZ){return false}var T=[];for(var h0=0;h0<hZ.length;h0++){var h1=this.getTileKey(hY,{useZoom:hZ[h0]});var e=this.tileCache.getData(h1);if(e&&e.status==="ready"&&e.label&&e.label.status==="ready"){T.push(hZ[h0])}}if(T.length){return T}else{return false}},getSameZoomDataFromCache:function(T){var hY=di.baseZoomInfo[T.zoom];for(var hZ=0;hZ<hY.length;hZ++){var h0=this.getTileKey(T,{useZoom:hY[hZ]});if(T.useZoom===hY[hZ]){continue}var e=this.tileCache.getData(h0);if(e&&e.status==="ready"&&e.label&&e.label.status==="ready"){return e}}return false},hasSameLabelData:function(hY,T){for(var e=0;e<T.length;e++){if(T[e].key===hY){return true}}return false},getDataByFloorName:function(T,hY){for(var e=0;e<T.length;e++){if(T[e].floorName===hY){return T[e]}}return null},mergeIndoorLabelData:function(h3,e){for(var h1 in h3){if(h1==="tileInfo"){continue}if(e[h1]){var T=h3[h1].floors;var h4=e[h1].floors;for(var hZ=0;hZ<T.length;hZ++){var hY=T[hZ];var h2=hY.floorName;var h0=this.getDataByFloorName(h4,h2);if(h0){if(h0.pois){h0.pois=h0.pois.concat(hY.pois);hY.pois=h0.pois}else{h0.pois=hY.pois}}}}}},mergeSameZoomLabelData:function(h1){var hZ=h1.label;if(!hZ){return}var e=h1.tileInfo;var h0=this.getSameZoomDataFromCache(e);if(!h0){return}var hY=h0.label;if(!hY){return}for(var T=0;T<hZ.fixedLabel.length;T++){if(!this.hasSameLabelData(hZ.fixedLabel[T].key,hY.fixedLabel)){hY.hasNewData=true;hY.fixedLabel.push(hZ.fixedLabel[T])}}for(var T=0;T<hZ.lineLabel.length;T++){if(!this.hasSameLabelData(hZ.lineLabel[T].key,hY.lineLabel)){hY.hasNewData=true;hY.lineLabel.push(hZ.lineLabel[T])}}for(var T=0;T<hZ.indoorLabel.length;T++){if(!this.hasSameLabelData(hZ.indoorLabel[T].key,hY.indoorLabel)){hY.hasNewData=true;hY.indoorLabel.push(hZ.indoorLabel[T])}}h1.label=hY;if(h0.renderData.indoorData&&h1.renderData.indoorData){this.mergeIndoorLabelData(h1.renderData.indoorData,h0.renderData.indoorData)}},processLabelData:function(h0){if(!h0.label){return}if(h0.label.status==="processing"){return}h0.label.status="processing";var hY=this;hY.updateAllIconsTextureCoords(h0);this.labelProcessor.loadIconImages(h0,function(h1){hY.updateAllIconsTextureCoords(h1)});if(this.map.config.textRenderType==="canvas"){var e=this.labelProcessor.drawLabelsOnCanvas(h0,function(h3,h4){var h2=h0.tileInfo;if(!bo.customStyleInfo){hY.mergeSameZoomLabelData(h0)}if(h3){if(!h0.label.textureHeights){h0.label.textureHeights=[]}h0.label.textureHeights[h2.useZoom]=h3.height}if(h4){if(!h0.label.indoorTextureHeights){h0.label.indoorTextureHeights=[]}h0.label.indoorTextureHeights[h2.useZoom]=h4.height}var h1=hY._getTileTexImgKey(h2);hY._doWorkAfterLabelImageLoad(h0,h3,h4,h1)});return}var T=h0.label.textImageBitmap||h0.label.textImgStr;var hZ=h0.label.indoorTextImageBitmap||h0.label.indoorTextImgStr;this.labelProcessor.loadImgByStr(T,hZ,function i(h6,h4){var h3=h0.label.textureHeight;var h7=h0.label.indoorTextureHeight;h0.label.textureHeight=undefined;h0.label.indoorTextureHeight=undefined;var h2=h0.tileInfo;hY.mergeSameZoomLabelData(h0);var h5=h0.label;h5.textImgStr="";h5.indoorTextImgStr&&(h5.indoorTextImgStr="");if(!h5.textureHeights){h5.textureHeights=[]}h5.textureHeights[h2.useZoom]=h3;if(!h5.indoorTextureHeights){h5.indoorTextureHeights=[]}h5.indoorTextureHeights[h2.useZoom]=h7;var h1=hY._getTileTexImgKey(h2);hY._doWorkAfterLabelImageLoad(h0,h6,h4,h1)})},_getTileTexImgKey:function(i){var T=i.style||this.mapStyleId||"default";var e=T+"_"+i.col+"_"+i.row+"_"+i.zoom;if(this.map.config.textRenderType==="canvas"){e+="_"+i.useZoom}return e},_doWorkAfterLabelImageLoad:function(h2,h0,hY,i){var h1=this;var hZ=h2.label;hZ.tileInfo=h2.tileInfo;hZ.status="ready";if(h0||hY){var e=hZ.tileInfo;if(h0){h0.id=i;if(!hZ.textureSources){hZ.textureSources=[]}hZ.textureSources[e.useZoom]=h0}if(hY){hY.id=i+"_indoor";if(!hZ.indoorTextureSources){hZ.indoorTextureSources=[]}hZ.indoorTextureSources[e.useZoom]=hY}if(h1.map._webglMapScene){var T=h1.map._webglMapScene._painter;if(h0){T._addToAsyncJob(hZ.textureSources[e.useZoom])}}}if(h2.custom!==true){h1.tileLabels.push(hZ)}if(h1.collisionTimer){return}h1.collisionTimer=setTimeout(function(){h1.dataBackCollideLabels();h1.collisionTimer=null},300)},_updateIconTextureCoords:function(h2,T){if(!h2){return}var h1=this.map;for(var hY=0;hY<h2.length;hY++){var h0=h2[hY];if(!h0.iconPos){continue}if(h1._webglMapScene){var e=h1._webglMapScene._painter;var hZ=T+"_"+h0.iconPos.iconType;h0.iconPos.texcoord=e._iconTextureAtlasCoords[hZ]||null}}},updateAllIconsTextureCoords:function(hZ){if(this.map.viewAnimationTime){return}if(hZ){if(hZ.label){var i=hZ.tileInfo.style;this._updateIconTextureCoords(hZ.label.fixedLabel,i);this._updateIconTextureCoords(hZ.label.indoorLabel,i)}}else{var hY=this.tileCache.getAllData();for(var T in hY){var e=hY[T].data;if(e.status==="ready"&&e.label){var i=e.tileInfo.style;this._updateIconTextureCoords(e.label.fixedLabel,i);this._updateIconTextureCoords(e.label.indoorLabel,i)}}}this.updateLabels();this.map.dispatchEvent(new bb("onrefresh"))},cacheDataCollideLabels:function(T){var hZ=this;var i=this.map._featureMgr;function hY(){hZ.cacheLabelTimer=null;var h0;var h1=hZ.map.getTilt();var h2=hZ.map.getHeading()%360;if(hZ.tileLabels.length===0||(hZ.tileLabels.length===1&&hZ.tileLabels[0].tileInfo.zoom===0)){h0=i.getLabelData();if(h0.length>0){h0=hZ.labelProcessor.collisionTest(h0,-1)}}else{if(h1||h2){if(this._collisionTimer){if(!h1){clearTimeout(this._collisionTimer)}else{if(Date.now()-hZ.lastCollisionTestTime>500){hZ.lastCollisionTestTime=Date.now()}else{clearTimeout(this._collisionTimer)}}}this._collisionTimer=setTimeout(function(){h0=hZ.labelProcessor.collisionTest(hZ.tileLabels);if(h0){i.setLabelData(h0)}hZ.updateLabels();hZ.map.dispatchEvent(new bb("onrefresh"));hZ._collisionTimer=null},60);return}else{h0=hZ.labelProcessor.getCachedLabels(hZ.tileLabels)}}if(h0){i.setLabelData(h0)}hZ.updateLabels();hZ.map.dispatchEvent(new bb("onrefresh"))}if(!T){clearTimeout(hZ.cacheLabelTimer);hY()}else{if(hZ.cacheLabelTimer){return}hZ.cacheLabelTimer=setTimeout(function e(){hY()},T)}},dataBackCollideLabels:function(){var i=this;if((i.tileLabels&&i.tileLabels.length===0)){return}var e;i.labelProcessor.calcLabelsCollision(i.tileLabels);e=i.labelProcessor.getCachedLabels(i.tileLabels);if(e){i.map._featureMgr.setLabelData(e)}i.updateLabels();i.map.dispatchEvent(new bb("onrefresh"));if(gb()){this.labelProcessor._refreshSpotData()}},updateLabels:function(hZ){var h0=this.map;var i=h0._featureMgr;var T=i.getLabelData();if(T.length>0){var hY=h0.getZoom();if(T.labelZoom-hY<3){this.labelProcessor.updateLabels(T);var e=this.labelProcessor.fixDataFormat(T);i.setOverlayData(e[0],2);i.setOverlayData(e[1],3);i.setOverlayData(e[2],4)}else{i.clearLabelOverlayData()}h0.temp.isPermitSpotOver=false;this.labelProcessor.curSpotAdded=false}},loadRasterLayerData:function(h3,hY){this.thumbCache={};var h4=this.getZoomState();if(hY){for(var h1=0,hZ=h3.length;h1<hZ;h1++){var T=h3[h1];var h0=this.getTileKey(T);var e=this.tileCache.getData(h0);if(e&&e.status==="ready"){if(T.tileTypeName==="xyz"){e.tileInfo=T}this.map._featureMgr.setData(e,this.drawIndex,2)}else{if(this.useThumbData){this.setThumbData(T.col,T.row,T.zoom,T.useZoom,h4)}}}return}for(var h1=0,hZ=h3.length;h1<hZ;h1++){var T=h3[h1];var h0=this.getTileKey(T);var e=this.tileCache.getData(h0);if(!e){this.tileCache.setData(h0,{});var h2=this;this.loadRasterTileData(T,function(i,h5){h2.rasterTileDataCbk(i,h5)})}}},loadRasterTileData:function(i,e){var T=new Image();var hZ=i.col;var h2=i.row;var h0=i.zoom;var hY=this.getTilesUrl(new em(hZ,h2),h0,i);if(!hY){return}var h1=this.getTileKey(i);if(i.combine){T=hY;T.tileInfo=i;if(T){e&&e(T,h1)}else{e&&e(null,h1)}}else{T=this.loadTileImage(hY,h1,e)}T.tileInfo=i},loadTileImage:function(hY,T,e){var i=new Image();i.crossOrigin="anonymous";i.onload=function(){e&&e(this,T)};i.onerror=function(){e&&e(null,T)};i.src=hY;return i},rasterTileDataCbk:function(h0,hY){if(!h0||typeof h0==="string"){this.tileCache.removeData(hY);return}var i=h0.tileInfo;var T=i.col;var h6=i.row;var h5=i.zoom;var e=this.tileCache.getData(hY);if(!e){return}var h1="id_"+T+"_"+h6+"_"+h5;var h4=this;e.dataType=eM;e.tileInfo=i;if(i.tileTypeName==="xyz"){var h3=i.tileSize;e.textureSource=h0;e.renderData={vertexAll:[0,0,0,0,0,h3,0,0,1,0,h3,h3,0,1,1,0,0,0,0,0,h3,h3,0,1,1,0,h3,0,0,1]};h4.setRasterTileData(hY,e,h1)}else{e.textureSource=h0;var hZ=d7.calcLoopParam(T,h5);var h2=hZ.geoOffsetX;h0.tileInfo.loopOffsetX=h2;e.renderData={vertexAll:[0,0,0,0,0,256,0,0,1,0,256,256,0,1,1,0,0,0,0,0,256,256,0,1,1,0,256,0,0,1]};this.setRasterTileData(hY,e,h1)}},setRasterTileData:function(hZ,e,hY){e.status="ready";this.tileCache.setData(hZ,e);var T=false;if(this.curViewTilesInfo[hY]){e.dataType=eM;e.png8=this.png8||false;this.map._featureMgr.setData(e,this.drawIndex,2);T=true}if(T){var i=new bb("onrefresh");i.source="webgllayer";this.map.dispatchEvent(i)}},_checkTilesLoaded:function(){this.numLoading--;if(this.map.firstTileLoad===false){this.map.dispatchEvent(new bb("onfirsttilesloaded"));this.map.firstTileLoad=true}var e=this;if(this.numLoading===0){if(this._checkLoadedTimer){clearTimeout(this._checkLoadedTimer);this._checkLoadedTimer=null}this._checkLoadedTimer=setTimeout(function(){if(e.numLoading===0){e.map.dispatchEvent(new bb("ontilesloaded"))}e._checkLoadedTimer=null},60)}},isClickableLabel:function(e){if(e.isDel){return false}if(e.zoom>9&&!e.guid){return false}if(e.zoom<=9&&!e.name&&!e.guid){return false}return true}};var b9=5;var dY=4;var hx=3;var fl=2;var hR=1;var d1=0;function v(e){this._ratio=a6();this._iconCache={};this._map=e;this._drawingCanvasPool=[];this._drawingCanvasHeight=4096}C.extend(v.prototype,{_loadIcons:function(i,h2){var h0=0;var hZ=this;var T=this._map.config.style;for(var h1 in i){h0++;var e=new Image();e.id=h1;e.crossOrigin="anonymous";e.onload=function(){hZ._iconCache[this.id].loaded=true;h0--;if(h0===0){h2()}this.onload=null};e.onerror=function(){hZ._iconCache[this.id]=null;h0--;if(h0===0){h2()}this.onerror=null};var hY=e8.getIconSetPath(T)+h1+".png";e.src=hY;this._iconCache[h1]={loaded:false,image:e}}},_getEmptyDrawingCanvas:function(){for(var T=0;T<this._drawingCanvasPool.length;T++){if(this._drawingCanvasPool[T]._free===true){this._drawingCanvasPool[T]._free=false;return this._drawingCanvasPool[T]}}var e=this._createNewDrawingCanvas();this._drawingCanvasPool.push(e);e._free=false;return e},_createNewDrawingCanvas:function(){var e=S("canvas");e.width=512;e.height=this._drawingCanvasHeight;e._free=true;e._id=bo.getGUID();var i=e.getContext("2d");i.textBaseline="bottom";i.lineJoin="round";return e},drawLabelsOnCanvas:function(ih,hY){var h6=ih.label.fixedLabel.slice(0);var ic=ih.label.lineLabel.slice(0);var T=ih.label.indoorLabel.slice(0);if(h6.length===0&&ic.length===0&&T.length===0){hY();return}var h1=function(im,i){return im.styleId-i.styleId};h6.sort(h1);ic.sort(h1);T.sort(h1);var ig={};var e=this._getEmptyDrawingCanvas();var ib=e.getContext("2d");ib.clearRect(0,0,e.width,e.height);var ik=0;var h7=null;var h0=0;if(h6.length>0){while(h0<h6.length&&!h6[h0].styleText[0]){h0++}if(h6[h0]&&h6[h0].styleText[0]){h7=h6[h0].styleText[0].fontSize+h6[h0].styleText[0].haloSize*2}}if(h7===null&&T.length>0){h0=0;while(h0<T.length&&!T[h0].styleText[0]){h0++}if(T[h0]&&T[h0].styleText[0]){h7=T[h0].styleText[0].fontSize+T[h0].styleText[0].haloSize*2}}if(h7===null&&ic.length>0){h0=0;while(h0<ic.length&&!ic[h0].styleText[0]){h0++}if(ic[h0]&&ic[h0].styleText[0]){h7=ic[h0].styleText[0].fontSize+ic[h0].styleText[0].haloSize*2}}if(h7===null||isNaN(h7)){hY();return}var h3=0;var h2=h7;var h9={};var il=0;var ia=[];for(var ie=0;ie<h6.length;ie++){var h5=h6[ie];var h8=h5.name;var id=h5.styleText;if(!h8||id.length===0){continue}var hZ=h5.icon;if(h5.textOnIcon&&(!this._iconCache[hZ]||this._iconCache[hZ].loaded===false)){ia.push(h5);il++;if(!h9[hZ]){h9[hZ]=true}continue}var ii=this._drawEachText(ib,h5,ik,h3,h2,h7,ig);if(!ii){continue}h3=ii.curX;h2=ii.curY;h7=ii.curLineHeight;ik=ii.styleId}var ii=this._drawEachTypeOfLabels(ib,T,ik,h3,h2,h7,ig);ik=ii.curStyleId;h3=ii.curX;h2=ii.curY;h7=ii.curLineHeight;var ii=this._drawEachTypeOfLabels(ib,ic,ik,h3,h2,h7,ig);ik=ii.curStyleId;h3=ii.curX;h2=ii.curY;h7=ii.curLineHeight;if(il>0){var ij=this;this._loadIcons(h9,function(){ii=ij._drawEachTypeOfLabels(ib,ia,ik,h3,h2,h7,ig);ik=ii.curStyleId;h3=ii.curX;h2=ii.curY;h7=ii.curLineHeight;var i=ij._generateEachLabelCanvas(e,h2,h6,ic,T,ih);hY(i[0],i[1])});return}var h4=this._generateEachLabelCanvas(e,h2,h6,ic,T,ih);hY(h4[0],h4[1])},drawCustomLabelsOnCanvas:function(h1,h7){if(h1.length===0){h7();return}var T=0;var e=(h1[0].style.fontSize+(h1[0].style.haloSize||0)*2)||0;var hY=e;var h3=this._getEmptyDrawingCanvas();var h8=h3.getContext("2d");h8.clearRect(0,0,h3.width,h3.height);var h4={};var h6=-1;for(var hZ=0;hZ<h1.length;hZ++){if(!h1[hZ].name){continue}var h5=this._drawEachText(h8,h1[hZ],h6,T,e,hY,h4);if(!h5){continue}T=h5.curX;e=h5.curY;hY=h5.curLineHeight;h6=h5.styleId}var h0=e;var h2=this._copyToNewCanvas(h3,h0);for(var hZ=0;hZ<h1.length;hZ++){if(!h1[hZ].name&&h1[hZ].style.iconSize){this._addFixedLabelBounds(h1[hZ]);continue}if(!h1[hZ].textSize){continue}this._updateFixedLabelCoords(h1[hZ],h0);this._addFixedLabelBounds(h1[hZ])}h7(h2)},_drawEachTypeOfLabels:function(h7,h1,h5,hY,T,hZ,h3){for(var h0=0;h0<h1.length;h0++){var h2=h1[h0];var h6=h2.name;var e=h2.styleText;if(!h6||e.length===0){continue}var h4=this._drawEachText(h7,h2,h5,hY,T,hZ,h3);if(!h4){continue}hY=h4.curX;T=h4.curY;hZ=h4.curLineHeight;h5=h4.styleId;if(h4.curY>this._drawingCanvasHeight){return{curX:hY,curY:T,curLineHeight:hZ,curStyleId:h5}}}return{curX:hY,curY:T,curLineHeight:hZ,curStyleId:h5}},_drawIndoorTextLabelOnCanvas:function(hZ){var e=this._getEmptyDrawingCanvas();var h6=e.getContext("2d");h6.clearRect(0,0,e.width,e.height);var ie=0;var h5=null;var h4=0;var h2;var ib={};var ia=[];for(var h0 in hZ){if(h0==="tileInfo"){continue}var hY=hZ[h0];var h9=hY.defaultFloor;var h3=hY.floors;for(var h8=0;h8<h3.length;h8++){if(h8===h9){continue}var ic=h3[h8];if(!ic.pois){continue}var h1=ic.pois;for(var h7=0;h7<h1.length;h7++){if(h5===null&&h1[h7].styleText[0]){h5=h1[h7].styleText[0].fontSize+h1[h7].styleText[0].haloSize*2;h2=h5}ia.push(h1[h7])}}}if(h5===null){return null}ia.sort(function(ig,i){return i.rank-ig.rank||ig.styleId-i.styleId});var id=this._drawEachTypeOfLabels(h6,ia,ie,h4,h2,h5,ib);ie=id.curStyleId;h4=id.curX;h2=id.curY;h5=id.curLineHeight;var T=this._copyToNewCanvas(e,h2);return T},_updateIndoorLabelsCoords:function(h5,h6){for(var h4 in h5){if(h4==="tileInfo"){continue}var e=h5[h4];var h0=e.defaultFloor;var h1=e.floors;for(var h2=0;h2<h1.length;h2++){if(h2===h0){continue}var T=h1[h2];if(!T.pois){continue}var hZ=T.pois;for(var hY=0;hY<hZ.length;hY++){var h3=hZ[hY];if(h3.name&&(!h3.textSize||h3.textSize.length===0)){hZ.splice(hY,1);hY--;continue}this._updateFixedLabelCoords(h3,h6);this._addFixedLabelBounds(h3)}}}},_generateEachLabelCanvas:function(h1,h0,h2,e,h4,T){h0=Math.min(h0,this._drawingCanvasHeight);var h3=this._copyToNewCanvas(h1,h0);var hY=null;if(T.renderData.indoorData){hY=this._drawIndoorTextLabelOnCanvas(T.renderData.indoorData);if(hY){this._updateIndoorLabelsCoords(T.renderData.indoorData,hY.height)}}for(var hZ=0;hZ<h2.length;hZ++){if(!h2[hZ].textSize){continue}this._updateFixedLabelCoords(h2[hZ],h0);this._addFixedLabelBounds(h2[hZ])}for(var hZ=0;hZ<h4.length;hZ++){if(!h4[hZ].textSize){continue}this._updateFixedLabelCoords(h4[hZ],h0);this._addFixedLabelBounds(h4[hZ])}for(var hZ=0;hZ<e.length;hZ++){this._updateLineLabelCoords(e[hZ],h0)}return[h3,hY]},_copyToNewCanvas:function(T,i){if(i===0){return null}var hY=S("canvas");hY.width=T.width;hY.height=i;var e=hY.getContext("2d");e.drawImage(T,0,0,512,i,0,0,512,i);hY._id=T._id;T._free=true;return hY},_drawEachText:function(ih,h2,T,ij,ii,ir,hZ){var iq=h2.name;var h7=h2.styleText?h2.styleText[0]:h2.style;if(!h7){return null}var ia=h7.fontSize;var iw=h7.fontWeight;var iJ=h7.haloSize||0;if(!ib){}if(h7.fontRgba){var iP=h7.fontRgba[3]/255;var h6=[];h6[3]=iP;for(var iO=0;iO<3;iO++){h6[iO]=h7.fontRgba[iO]}}if(h7.haloRgba){var iP=h7.haloRgba[3]/255;var id=[];id[3]=iP;for(var iO=0;iO<3;iO++){id[iO]=h7.haloRgba[iO]}}var iD=h6?"rgba("+h6.join(",")+")":h7.color;var h1=id?"rgba("+id.join(",")+")":h7.strokeColor;var iL=h2.styleId||0;if(iJ>4){iJ=4}var it=[];var ig=[];var io=0;if(hZ&&!hZ[iL]){hZ[iL]={}}var h9=ia+iJ*2;var iu=h9;if(h2.containDescendings){iu+=4}if(iJ===0){iu+=2}if(h2.textOnIcon){iu=Math.max(iu,h2.iconSize[1])}if(iL!==T||iu>ir){T=iL;if(iw>=10&&iw%10===0){ih.font=iw*10+" "+ia+"px sans-serif"}else{ih.font=ia+"px sans-serif"}if(iu>ir){var ip=iu-ir;ir+=ip;ii+=ip}if(iJ>0){ih.lineWidth=iJ*2;ih.strokeStyle=h1}ih.fillStyle=iD}if(h2.type==="line"){var h4=iq.split("");for(var iM=0;iM<h4.length;iM++){var iF=h4[iM];var ik;var ix;if(hZ[iL][iF]){var ib=hZ[iL][iF];ik=ib.displaySize;ix=ib.curWordPosition}else{var hY=Math.ceil(ih.measureText(iF).width);if(ij+hY>512){ij=0;ii+=iu;ir=iu}if(ii>this._drawingCanvasHeight){return{curX:ij,curY:ii,curLineHeight:ir,styleId:iL}}var iG=ij;if(iJ>0){hY+=iJ;iG-=Math.round(iJ/2);ih.strokeText(iF,ij,ii)}ih.fillText(iF,ij,ii);var iC=[hY,iu];ik=[Math.round(iC[0]/2),Math.round(iC[1]/2)];ix=[iG,ii-iu];hZ[iL][iF]={displaySize:ik,curWordPosition:ix,totalHeight:io};ij+=hY+2}it.push(ik);ig.push(ix)}io=Math.round(it[0][1])}else{if(hZ[iL][iq]){var ib=hZ[iL][iq];it=ib.textSize;ig=ib.labelImagePosition;io=ib.totalHeight}else{var ic=iq.split("\\");if(ic.length>1&&h2.textOnIcon){var iN=0;var iK=0;var iQ=[];var il=8;for(var iM=0;iM<ic.length;iM++){var iq=ic[iM];var h8=Math.ceil(ih.measureText(iq).width);if(h8>iN){iN=h8}iQ.push(Math.round(h8/2));iK+=iu}var h5=iN+2*il;var iI=iK+2*il;if(ij+h5>512){ij=0;ii+=ir}ii+=iK-iu+2*il;var iB=ij;var im=ii-iI;var e=Math.round(h5/2);var ie=this._iconCache[h2.icon].image;this.drawStretchedIcon(ih,ie,[iB,im],il,iN,iK);for(var iM=0;iM<ic.length;iM++){var iq=ic[iM];var iH=iB+(e-iQ[iM]);var iE=im+4+(iM+1)*iu;ih.fillText(iq,iH,iE)}it.push([Math.round(h5/2),Math.round(iI/2)]);ig.push([iB,im]);ij+=h5;ir=iI;io=Math.round(iI/2)}else{for(var iM=0;iM<ic.length;iM++){var iq=ic[iM];var h8=Math.ceil(ih.measureText(iq).width);var h5=h8;var h0=0;if(h2.textOnIcon){h0=10;h5+=h0*2;if(h2.styleId===519){h5=h2.iconSize[0];h0=Math.round((h5-h8)/2)}}if(ij+h5>512){ij=0;ii+=iu;ir=iu}if(ii>this._drawingCanvasHeight){return{curX:ij,curY:ii,curLineHeight:ir,styleId:iL}}var iB=ij;var im=ii-iu;var iA=ij;var iz=ii;if(h2.containDescendings){iz-=4}if(h2.textOnIcon){var iv=false;var ie=this._iconCache[h2.icon].image;var iy=h2.iconSize.concat([]);if(h9>iy[1]){iy[1]=h9;iv=true}if(h8>iy[0]){iy[0]=h8;iv=true}if(h2.styleId===519){ih.drawImage(ie,0,0,iy[0],iy[1],iB,im,iy[0],iy[1])}else{if(iv){this.drawStretchedIcon(ih,ie,[iB,im],h0,h8,iy[1])}else{this.draw3StretchedIcon(ih,ie,[iB,im],h0,h8,iy[1])}}iA+=h0;if(h2.iconSize[1]>h9){iz-=(h2.iconSize[1]-h9)/2-1}h5+=1}if(iJ>0){h5+=iJ;iB-=Math.round(iJ/2);im+=Math.round(iJ/2);if(iL===71028){iu-=2}if(iL===32){iu-=2}ih.strokeText(iq,iA,iz)}ih.fillText(iq,iA,iz);var h3=[h5,iu];var ik=[Math.round(h3[0]/2),Math.round(h3[1]/2)];it.push(ik);ig.push([iB,im]);io+=Math.round(ik[1]);ij+=h5}}hZ[iL][iq]={textSize:it,labelImagePosition:ig,totalHeight:io}}}h2.textSize=it;h2.labelImagePosition=ig;h2.totalHeight=io;return{curX:ij,curY:ii,curLineHeight:ir,styleId:iL}},drawStretchedIcon:function(e,T,hY,h1,h2,i){var h0=hY[0];var hZ=hY[1];e.drawImage(T,0,0,h1,h1,h0,hZ,h1,h1);e.drawImage(T,h1,0,1,h1,h0+h1,hZ,h2,h1);e.drawImage(T,T.width-h1,0,h1,h1,h0+h2+h1,hZ,h1,h1);e.drawImage(T,0,h1,h1,1,h0,hZ+h1,h1,i);e.drawImage(T,h1,h1,1,1,h0+h1,hZ+h1,h2,i);e.drawImage(T,T.width-h1,h1,h1,1,h0+h2+h1,hZ+h1,h1,i);e.drawImage(T,0,T.height-h1,h1,h1,h0,hZ+i+h1,h1,h1);e.drawImage(T,h1,T.height-h1,1,h1,h0+h1,hZ+i+h1,h2,h1);e.drawImage(T,T.width-h1,T.height-h1,h1,h1,h0+h2+h1,hZ+i+h1,h1,h1)},draw3StretchedIcon:function(e,i,T,h0,h2,h1){var hZ=T[0];var hY=T[1];e.drawImage(i,0,0,h0,i.height,hZ,hY,h0,i.height);e.drawImage(i,h0,0,1,i.height,hZ+h0,hY,h2,i.height);e.drawImage(i,i.width-h0,0,h0,i.height,hZ+h0+h2,hY,h0,i.height)},_updateFixedLabelCoords:function(hZ,ie){if(ie===0){return}var h9=[];var im=[];var io=0;var ic=hZ.totalHeight;var ix=hZ.textSize.length;var h0=hZ.direction;if(typeof h0!=="number"){h0=0}for(var ip=0;ip<ix;ip++){var ig=hZ.labelImagePosition[ip];var id=hZ.textSize[ip];var ib=ig[0];var hY=ig[1];var h1=id[0];var h6=id[1];var h8=0;var il=0;if(typeof hZ.textMargin==="number"){il=hZ.textMargin}var h7;var e;var h3=0;var ia=0;if(!hZ.iconPos){if(!hZ.custom){h0=dY}}else{h3=hZ.iconPos.width;ia=hZ.iconPos.height}switch(h0){case hx:var T=ic/2-h6+h8*(ix-1)/2;h7=Math.round(-h3/2-h1-il);e=Math.round(T-io-h8*ip);break;case hR:var T=ic/2-h6+h8*(ix-1)/2;h7=Math.round(h3/2+il);e=Math.round(T-io-h8*ip);break;case fl:var T=ia/2+ic-h6+h8*ix;h7=Math.round(-h1/2);e=Math.round(T-io-h8*ip);break;case d1:var T=-ia/2-h8-h6;h7=Math.round(-h1/2);e=Math.round(T-io-h8*ip);break;case dY:var T=-ic/2-h8*(ix-1)/2;h7=Math.round(-h1/2);e=Math.round(T-io-h8*ip);break}io+=h6;var h5=h7+h1;var iy=e;var h4=h5;var iw=iy+h6;var h2=h7;var iv=iw;h9.push(h7,e,h5,iy,h4,iw,h7,e,h4,iw,h2,iv);var iu=ib/512;var ik=(ie-hY-h6*2)/ie;var it=(ib+h1*2)/512;var ij=ik;var ir=it;var ii=(ie-hY)/ie;var iq=iu;var ih=ii;im.push(iu,ik,it,ij,ir,ii,iu,ik,ir,ii,iq,ih)}if(!hZ.textPos){hZ.textPos={}}hZ.textPos.vertex=h9;hZ.textPos.texcoord=im},_addFixedLabelBounds:function(h4){var h0=1000;var hY=1000;var T=-1000;var e=-1000;if(h4.iconPos){var h2=h4.iconPos["vertex"];for(var h3=0,hZ=h2.length;h3<hZ;h3+=2){var h8=h2[h3];var h6=h2[h3+1];if(h8<h0){h0=h8}if(h8>T){T=h8}if(h6<hY){hY=h6}if(h6>e){e=h6}}}if(h4.custom&&h4.style.iconSize&&!h4.name){var h5=h4.style.iconSize;var h7=h4.direction;switch(h7){case dY:h0=-Math.round(h5[0]/2);hY=-Math.round(h5[1]/2);T=Math.round(h5[0]/2);e=Math.round(h5[1]/2);break;case fl:h0=-Math.round(h5[0]/2);hY=0;T=Math.round(h5[0]/2);e=h5[1];break}}if(h4.textPos){var h1=h4.textPos["vertex"];for(var h3=0,hZ=h1.length;h3<hZ;h3+=2){var h8=h1[h3];var h6=h1[h3+1];if(h8<h0){h0=h8}if(h8>T){T=h8}if(h6<hY){hY=h6}if(h6>e){e=h6}}}h4.bds=[h0,hY,T,e]},_updateLineLabelCoords:function(ig,h5){if(h5===0){return}var hY=ig.wordsInfo;var ic=ig.wordCount;if(!ig.labelImagePosition){return}var h7=ig.labelImagePosition.slice(0);if(ig.reverse){h7.reverse()}var iq=1000;var im=1000;var io=-1000;var il=-1000;for(var ih=0;ih<ic;ih++){var ir=h7[ih];var ip=ir[0];var id=ir[1];var ib=ig.textSize[ih];var h4=ib[0];var e=ib[1];var h3=ip/512;var ia=(h5-id-e*2)/h5;var h1=(ip+h4*2)/512;var h9=ia;var hZ=h1;var h8=(h5-id)/h5;var T=h3;var h6=h8;hY[ih].size=[h4,e];hY[ih].texcoord=[h3,ia,h1,h9,hZ,h8,h3,ia,hZ,h8,T,h6];var ik=hY[ih].offset[0];var ij=hY[ih].offset[1];var ii=ik-h4/2;var h2=ij+e/2;var h0=ij-e/2;var ie=ik+h4/2;if(ii<iq){iq=ii}if(ie>io){io=ie}if(h0<im){im=h0}if(h2>il){il=h2}}ig.bds=[iq,im,io,il]}});var cT={0:"00000000",16:"00010000",32:"00100000",48:"00110000",64:"01000000",96:"01100000"};function cq(T,hY,hZ){var e=T.bds;if(!e){return false}var i=T.tracer;var h2;if(i){if(!cT[i]){h2=i.toString(2);if(h2.length<8){h2=new Array(8-h2.length+1).join("0")+h2}cT[i]=h2}h2=cT[i];var h1=di.mapZoomStartZoomMapping[hY];return h2[hY-h1]==="1"}var h0=T.displayRange;if(hZ>=h0[0]&&hZ<=h0[1]){return true}return false}function dj(i,e){this.map=i.map;this.layer=i;e=e||[];this.allLabels=[];this._spotData=[];this._strategyInfo=null;this.RANK1=1000000;this.RANK2=2000000;this.RANK3=3000000;this.RANK4=4000000;this.RANK5=5000000;this._ratio=a6();this._useRound=true;this._sharpenRender=false;if(this._ratio>c8.HIGH_RES_MIN_RATIO){this._useRound=false;this._sharpenRender=true}this._mapIsMoving=false;this._onMapIdleCallback=e.onMapIdleCallback;this.map.temp.isPermitSpotOver=true;this.currentSelectedLabel=null;this.map._labelProcessor=this;this.iconCache={};this.fixedLabelData=[];this.lineLabelData=[];this.highlightLabelData=[];this._iconLoadTimer=null;this._labelTextCanvas=null;if(this.map.config.textRenderType==="canvas"){this._labelTextCanvas=this.map.tileMgr.getLabelTextCanvas()}this.bind()}C.extend(dj.prototype,{bind:function(){var T=this.map;var i=this;T.addEventListener("mapstatusbusy_inner",function(hY){i._mapIsMoving=true;if(i._ratio>c8.HIGH_RES_MIN_RATIO){i._sharpenRender=false}else{i._useRound=false}});T.addEventListener("mapstatusidle_inner",function(hY){if(i._ratio>c8.HIGH_RES_MIN_RATIO){i._sharpenRender=true}else{i._useRound=true}i._mapIsMoving=false});T.addEventListener("onspotmouseover",function(h0){if(!this.temp.isPermitSpotOver){return}if(h0.spots.length>0){var hZ=h0.spots[0].userdata.uid;var h1=h0.spots[0].userdata.tilePosStr;var hY=i.getLabelByUid(hZ,h1);hY&&hY.formatedData&&i._toHighlightColor(hY.formatedData)}});T.addEventListener("onspotmouseout",function(h0){if(!this.temp.isPermitSpotOver){return}if(h0.spots.length>0){var hZ=h0.spots[0].userdata.uid;var h1=h0.spots[0].userdata.tilePosStr;var hY=i.getLabelByUid(hZ,h1);hY&&hY.formatedData&&i._toDefaultColor(hY.formatedData)}});T.addEventListener("spotclick",function(h0){if(h0.spots&&h0.spots.length>0){if(h0.spots[0].userdata.zoom<10){return}var hZ=h0.spots[0].userdata.uid;var h1=h0.spots[0].userdata.tilePosStr;if(i.currentSelectedLabel&&(i.currentSelectedLabel.uid!==hZ||i.currentSelectedLabel.tilePosStr!==h1)){i._recoverNormalState()}var hY=i.getLabelByUid(hZ,h1);hY&&i._changeBaseMapState(hY)}else{i._recoverNormalState()}});T.on("spot_status_reset",function(){i._recoverNormalState()});T.on("spot_highlight",function(hZ){var hY=i.getLabelByUid(hZ.uid,hZ.tilePosStr);hY&&hY.formatedData&&i._toHighlightColor(hY.formatedData)});T.addEventListener("mousemove",function(hY){if(i.curSpotAdded){return}if(this.currentOperation!==dV.idle||i._mapIsMoving===true){return}i._refreshSpotData();this.temp.isPermitSpotOver=true;i.curSpotAdded=true});if(gb()){function e(){i._refreshSpotData()}T.addEventListener("mapstatusidle_inner",e)}T.on("style_loaded",function(){if(i.map.config.textRenderType==="canvas"&&!i._labelTextCanvas){i._labelTextCanvas=i.map.tileMgr.getLabelTextCanvas()}})},getLabelByUid:function(h1,h2){var e=this.map._featureMgr.getResult().tileLabels;for(var h0=0;h0<e.length;h0++){var T=e[h0].fixedLabel;for(var hZ=0;hZ<T.length;hZ++){if(e[h0].fixedLabel[hZ].guid===h1&&e[h0].fixedLabel[hZ].tilePosStr===h2){return e[h0].fixedLabel[hZ]}}var hY=e[h0].indoorLabel;for(var hZ=0;hZ<hY.length;hZ++){if(e[h0].indoorLabel[hZ].guid===h1&&e[h0].indoorLabel[hZ].tilePosStr===h2){return e[h0].indoorLabel[hZ]}}}return null},getTileByLabelUid:function(h1){var e=this.map._featureMgr.getResult().tileLabels;for(var h0=0;h0<e.length;h0++){var T=e[h0].fixedLabel;for(var hZ=0;hZ<T.length;hZ++){if(e[h0].fixedLabel[hZ].guid===h1){return e[h0]}}var hY=e[h0].indoorLabel;for(var hZ=0;hZ<hY.length;hZ++){if(e[h0].indoorLabel[hZ].guid===h1){return e[h0]}}}return null},_toHighlightColor:function(T){if(T.tempRank&&T.tempRank===this.RANK5){return}var e=this.map._featureMgr.getResult().eleData[4]||[];var hZ=false;for(var hY=0;hY<e.length;hY++){if(e[hY]===T||(e[hY].guid===T.guid&&e[hY].tilePosStr===T.tilePosStr&&e[hY].zoom===T.zoom)){hZ=true;break}}if(hZ){return}e.push(T);this.map._featureMgr.setOverlayData(e,4);this.map.dispatchEvent(new bb("onrefresh"))},_toDefaultColor:function(T){if(T.tempRank&&T.tempRank===this.RANK5){return}var e=this.map._featureMgr.getResult().eleData[4]||[];for(var hY=0;hY<e.length;hY++){if(T===e[hY]||(T.guid===e[hY].guid&&T.tilePosStr===e[hY].tilePosStr&&T.zoom===e[hY].zoom)){e.splice(hY,1);break}}this.map._featureMgr.setOverlayData(e,4);this.map.dispatchEvent(new bb("onrefresh"))},_changeBaseMapState:function(i){var hZ=i.guid;var h3=i.formatedData.guidExt;var h5={guid:hZ,tilePosStr:i.tilePosStr,guidExt:h3};this._strategyInfo=h5;this.currentSelectedLabel=i;var hY=this.map._featureMgr;var e=hY.getLabelData();e=this.collisionTest(e);this.updateLabels(e);var h6=this.fixDataFormat(e);hY.setOverlayData(h6[0],2);hY.setOverlayData(h6[1],3);hY.setOverlayData(h6[2],4);var T=this.getTileByLabelUid(hZ);this.currentSelectedLabel.tileInfo=T.tileInfo;var h4=T.tileInfo.zoom;var h2=this.layer.tileCache.getAllData();for(var h1 in h2){var h0=h2[h1].data;if(!h0.label){continue}this.clearCollisionCache(h0.label)}this.map.dispatchEvent(new bb("onrefresh"))},_recoverNormalState:function(){this._strategyInfo=null;var h2=false;var h0=this.map._featureMgr.getLabelData();if(this.currentSelectedLabel){var T=this.currentSelectedLabel.guid;this.clearCollisionCache(this.getTileByLabelUid(T));var hZ=this.layer.tileCache.getAllData();for(var hY in hZ){var h1=hZ[hY].data;if(!h1.label){continue}this.clearCollisionCache(h1.label)}this.currentSelectedLabel.tempRank=null;this.currentSelectedLabel=null;h2=true}h0=this.collisionTest(h0);this.updateLabels(h0);var e=this.fixDataFormat(h0);var i=this.map._featureMgr;i.setOverlayData(e[0],2);i.setOverlayData(e[1],3);i.setOverlayData([],4);this.map.dispatchEvent(new bb("onrefresh"));if(h2){this.curSpotAdded=false;this._refreshSpotData()}},loadIconImages:function(hZ,ia){var h2=hZ.label;var h0=hZ.tileInfo.style;var T=h2.fixedLabel;var h7=h2.indoorLabel;var ib=T.length+h7.length;var h4=this;var hY=0;var h9=200;for(var h1=0;h1<ib;h1++){var h3;if(h1<T.length){h3=T[h1]}else{h3=h7[h1-T.length]}if(!h3.iconPos){continue}var h6=h3.iconPos.iconType;var h8=h0+"_"+h6;hY++;if(this.iconCache[h8]){if(this.iconCache[h8].loaded){ia(hZ)}continue}var h5=new Image();h5.id=h8;h5.crossOrigin="anonymous";h5.onload=function(){h4.iconCache[this.id].loaded=true;h4._addToIconTexture(this);if(h4._iconLoadTimer===null){h4._iconLoadTimer=setTimeout(function(){ia();h4._iconLoadTimer=null},h9)}this.onload=null};h5.onerror=function(){if(!h4._iconLoadTimer){h4._iconLoadTimer=setTimeout(function(){ia();h4._iconLoadTimer=null},h9)}h4.iconCache[this.id]=null;this.onerror=null};var e=e8.getIconSetPath(this.map.config.style)+h6+".png";h5.src=e;this.iconCache[h8]={loaded:false,image:h5}}return hY},_addToIconTexture:function(h0){if(!this.map._webglMapScene){return}var h2=this.map._webglMapScene._painter;var e=h2._iconTextureAtlas.addTexture(h0);h2._iconTextureAtlasOffset[h0.id]=e;var h5=0*h0.width/1024+e.width;var hZ=0*h0.height/1024+e.height;var h4=h0.width/1024+e.width;var hY=hZ;var h3=h4;var T=h0.height/1024+e.height;var h1=h5;var i=T;h2._iconTextureAtlasCoords[h0.id]=[h5,hZ,h4,hY,h3,T,h5,hZ,h3,T,h1,i]},loadImgByStr:function(hY,hZ,h0){if(!hY&&!hZ){h0&&h0(null,null);return}if(typeof hY==="object"&&typeof hZ==="object"){h0(hY,hZ);return}var i=0;var T=null;var e=null;if(hY){i++;T=new Image();T.onload=function(){i--;if(i===0){h0&&h0(this,e)}this.onload=null};T.src=hY}if(hZ){i++;e=new Image();e.onload=function(){i--;if(i===0){h0&&h0(T,this)}this.onload=null};e.src=hZ}},collisionTest:function(h5,iL,ip){if(this.map.viewAnimationTime){return[]}if(!h5){return[]}var ig=this.map;var ix=ig.getHeading();ix=this.calcLoopHeading(ix);var iG=ig.height;var iC=this.allLabels;iC.length=0;h5.sort(function(iN,i){var iP=iN.tileInfo;var iO=i.tileInfo;if(iP.col*iP.row<iO.col*iO.row){return -1}else{return 1}});var h6=h5.labelZoom;var ih=ig.getTilt();var h8=ig.getZoom();var iB;if(ip){iB=ip}else{iB=this.getZoomStep()}for(var iJ=0,iH=h5.length;iJ<iH;iJ++){var ik=h5[iJ];var h3=ik.tileInfo;var h0=h3.zoom;var iA=h3.loopOffsetX/Math.pow(2,18-h0);if(!ix&&!ih){if(ik.unnecessaryCollisionTest&&ik.unnecessaryCollisionTest[ip]){continue}}var it=ik.fixedLabel||[];for(var iI=0,im=it.length;iI<im;iI++){var h1=it[iI];h1.zoom=h0;if(iL===-1&&h1.isDel){continue}if(!cq(h1,h3.useZoom,h8)){h1.isDel=true;continue}this.calcCollisionBounds(h1,iB,iA,iG);iC.push(h1)}var ir=ik.indoorLabel||[];for(var iI=0,im=ir.length;iI<im;iI++){var h1=ir[iI];h1.zoom=h0;if(iL===-1&&h1.isDel){continue}if(!cq(h1,h3.useZoom)){h1.isDel=true;continue}this.calcCollisionBounds(h1,iB,iA,iG);iC.push(h1)}var h2=ik.lineLabel||[];for(var iI=0,im=h2.length;iI<im;iI++){var h1=h2[iI];if(iL===-1&&h1.isDel){continue}if(!cq(h1,h3.useZoom)){h1.isDel=true;continue}var iM=h1.pt;var io=ig.pointToPixelIn(iM,{zoom:iB,useRound:this._useRound});var il=io.x+iA;var ij=iG-io.y;var iq=h1.bds;var iF=iq[0];var iD=iq[1];var id=iq[2];var ic=iq[3];var iy=iF;var iw=iD;var ib=id;var ia=ic;if((ix>=0&&ix<45)||(ix>=315&&ix<360)){iy=iF;iw=iD;ib=id;ia=ic}else{if(ix>=45&&ix<135){iy=iD;iw=-id;ib=ic;ia=-iF}else{if(ix>=135&&ix<225){iy=-id;iw=-ic;ib=-iF;ia=-iD}else{if(ix>=225&&ix<315){iy=-ic;iw=iF;ib=-iD;ia=id}}}}h1._tempBds=[il+iy,ij+iw,il+ib,ij+ia];var h4=ig.pixelToPointIn(new em(h1._tempBds[0],io.y+iw),{zoom:iB});var hY=ig.pixelToPointIn(new em(h1._tempBds[2],io.y+ia),{zoom:iB});h1._mcBds=[h4,hY];iC.push(h1)}}var iz=this._strategyInfo;if(iz){var h9=iz.guid;var ii=iz.guidExt;var T=false;for(var iJ=0,iH=iC.length;iJ<iH;iJ++){var iE=iC[iJ];delete iE.tempRank;if(!this.layer.isClickableLabel(iE)||(ii===1&&!iE.guidExt)){continue}if(h9===iE.guid&&iz.tilePosStr===iE.tilePosStr){iE.tempRank=this.RANK5;T=true}}if(!T&&this.currentSelectedLabel){this.currentSelectedLabel.tempRank=this.RANK5;var h3=this.currentSelectedLabel.tileInfo;var h0=h3.zoom;var iA=h3.loopOffsetX/Math.pow(2,18-h0);this.calcCollisionBounds(this.currentSelectedLabel,iB,iA,iG);iC.push(this.currentSelectedLabel)}}else{for(var iJ=0,iH=iC.length;iJ<iH;iJ++){var iE=iC[iJ];if(iE.type==="line"||!iE.iconPos){continue}delete iE.tempRank}}iC.sort(function(iO,iN){var iP=iO.tempRank?iO.tempRank:iO.rank;var i=iN.tempRank?iN.tempRank:iN.rank;return i-iP||iO.startZoom-iN.startZoom||iN.pt.lng-iO.pt.lng||iN.pt.lat-iO.pt.lat});var hZ=0;if(ih>0){hZ=6}var h8=ig.getZoom();if(h8>=8&&h8<9){h8<8.5?(hZ=6):(hZ=3)}if(ig._displayOptions.labelMargin>0){hZ=ig._displayOptions.labelMargin}var e=2;if(h8<6&&h8>=5){e=-1}for(var iJ=0,iH=iC.length;iJ<iH;iJ++){var iv=iC[iJ];var h7=iv._tempBds;iv.isDel=false;iv._intersectIdx=[];for(iI=iJ+1;iI<iH;iI++){var ie=iC[iI];var iK=ie._tempBds;if(!(h7[2]+hZ+e<iK[0]-hZ||h7[0]-hZ>iK[2]+hZ+e||h7[3]+hZ+e<iK[1]-hZ||h7[1]-hZ>iK[3]+hZ+e)){iv._intersectIdx.push(iI)}}}for(var iJ=0,iH=iC.length;iJ<iH;iJ++){var iE=iC[iJ];if(iE.isDel===false){var iu=iE._intersectIdx;for(var iI=0,im=iu.length;iI<im;iI++){iC[iu[iI]].isDel=true}}}return h5},calcCollisionBounds:function(h4,h2,i,h3){var h0=h4.ptFix||h4.pt;var hY=this.map;var hZ=hY.pointToPixelIn(h0,{zoom:h2,useRound:this._useRound});var T=hZ.x+i;var h6=h3-hZ.y;var e=h4.bds;h4._tempBds=[T+e[0],h6+e[1],T+e[2],h6+e[3]];var h1=hY.pixelToPointIn(new em(h4._tempBds[0],hZ.y+e[1]),{zoom:h2});var h5=hY.pixelToPointIn(new em(h4._tempBds[2],hZ.y+e[3]),{zoom:h2});h4._mcBds=[h1,h5]},getZoomStep:function(){var T=this.map.getZoom();var e=Math.floor(T);var i=T-e>=0.5?e+0.5:e;return i},clearCollisionCache:function(e){if(!e){return}e.cacheState=null;e.unnecessaryCollisionTest=null},getCachedLabels:function(e){e=e||[];var T=this.getZoomStep();var hZ=[];var h1=false;for(var hY=0;hY<e.length;hY++){var h0=e[hY];if(!h0.cacheState||!h0.cacheState[T]){h1=true;break}if(h0.hasNewData){h1=true;break}}if(h1){this.calcLabelsCollision(e)}return e},calcLabelsCollision:function(T){var hZ=this.getZoomStep();var h0={};var h3;var hY;T=this.collisionTest(T,undefined,hZ);bJ.addLabelIntoAreaSpots(T);for(var h2=0;h2<T.length;h2++){h3=T[h2];hY=h3.tileInfo;var h7=hY.col+","+hY.row;h0[h7]=1}var e={};for(var h2=0;h2<T.length;h2++){h3=T[h2];if(!h3.cacheState){h3.cacheState={}}hY=h3.tileInfo;var h6=hY.col;var h4=hY.row;h7=h6+","+h4;if(h3.cacheState[hZ]==="stable"){e[h7]=1;if(!h3.hasNewData){continue}}for(var h1=0;h1<h3.fixedLabel.length;h1++){var h5=h3.fixedLabel[h1];if(!h5.cachedIsDel){h5.cachedIsDel={}}h5.cachedIsDel[hZ]=h5.isDel}for(var h1=0;h1<h3.indoorLabel.length;h1++){var h5=h3.indoorLabel[h1];if(!h5.cachedIsDel){h5.cachedIsDel={}}h5.cachedIsDel[hZ]=h5.isDel}for(var h1=0;h1<h3.lineLabel.length;h1++){var h5=h3.lineLabel[h1];if(!h5.cachedIsDel){h5.cachedIsDel={}}h5.cachedIsDel[hZ]=h5.isDel}if(h0[(h6-1)+","+(h4-1)]&&h0[(h6-1)+","+h4]&&h0[(h6-1)+","+(h4+1)]&&h0[h6+","+(h4-1)]&&h0[h6+","+(h4+1)]&&h0[(h6+1)+","+(h4-1)]&&h0[(h6+1)+","+h4]&&h0[(h6+1)+","+(h4+1)]){h3.cacheState[hZ]="stable";e[h7]=1}else{if(!h3.cacheState[hZ]){h3.cacheState[hZ]="unstable"}}}for(var h2=0;h2<T.length;h2++){var h3=T[h2];hY=h3.tileInfo;var h7=hY.col+","+hY.row;var h6=+hY.col;var h4=+hY.row;if(e[(h6-1)+","+(h4-1)]&&e[(h6-1)+","+h4]&&e[(h6-1)+","+(h4+1)]&&e[h6+","+(h4-1)]&&e[h6+","+(h4+1)]&&e[(h6+1)+","+(h4-1)]&&e[(h6+1)+","+h4]&&e[(h6+1)+","+(h4+1)]){if(!h3.unnecessaryCollisionTest){h3.unnecessaryCollisionTest={}}h3.unnecessaryCollisionTest[hZ]=1}}T.hasNewData=false},updateLabels:function(hY){var e=this.map;var h4=e.getZoom();var h6=e.getHeading();h6=this.calcLoopHeading(h6);var h5=e.getTilt();var hZ=this.getZoomStep();for(var h3=0,h0=hY.length;h3<h0;h3++){var h2=hY[h3];var T=h2.tileInfo;var h1=T.loopOffsetX||0;this.updateFixedLabel(h2.fixedLabel,h5,h6,h2,hZ,h4,h1);this.updateFixedLabel(h2.indoorLabel,h5,h6,h2,hZ,h4,0);this.updateLineLabel(h2.lineLabel,h5,h6,h2,hZ)}},updateFixedLabel:function(h3,h5,i,h7,hZ,e,hY){if(h3.length===1){}for(var h8=0,h0=h3.length;h8<h0;h8++){var h4=h3[h8];if(!h4.cachedIsDel){continue}if(!h5&&!i&&h7.cacheState&&h7.cacheState[hZ]){h4.isDel=h4.cachedIsDel[hZ];if(typeof h4.isDel==="undefined"){h4.isDel=h4.cachedIsDel[hZ]=true}}if(h4.startScale>e){h4.isDel=true}if(h4.isDel){continue}var ia=h4.pt;var T=h4.iconPos;if(T&&T.texcoord){if(!T.rtVertex){T.rtVertex=[];var ic=T.vertex;var h1=aF(ia.lng);var h9=aF(ia.lat);T.rtVertex=[h1[0],h9[0],h1[1],h9[1],0,ic[0],ic[1],0,0,T.texcoord[0],T.texcoord[1],h1[0],h9[0],h1[1],h9[1],0,ic[2],ic[3],0,0,T.texcoord[2],T.texcoord[3],h1[0],h9[0],h1[1],h9[1],0,ic[4],ic[5],0,0,T.texcoord[4],T.texcoord[5],h1[0],h9[0],h1[1],h9[1],0,ic[6],ic[7],0,0,T.texcoord[6],T.texcoord[7],h1[0],h9[0],h1[1],h9[1],0,ic[8],ic[9],0,0,T.texcoord[8],T.texcoord[9],h1[0],h9[0],h1[1],h9[1],0,ic[10],ic[11],0,0,T.texcoord[10],T.texcoord[11]]}}var ib=h4.textPos;if(ib){if(!ib.rtVertex){ib.rtVertex=[];var ic=ib.vertex;var h2=ib.rtVertex;var h1=aF(ia.lng);var h9=aF(ia.lat);var ie=aF(hY);for(var h6=0,id=ic.length;h6<id;h6+=12){h2.push(h1[0],h9[0],h1[1],h9[1],0,ic[h6],ic[h6+1],ie[0],ie[1],ib.texcoord[0],ib.texcoord[1]);h2.push(h1[0],h9[0],h1[1],h9[1],0,ic[h6+2],ic[h6+3],ie[0],ie[1],ib.texcoord[2],ib.texcoord[3]);h2.push(h1[0],h9[0],h1[1],h9[1],0,ic[h6+4],ic[h6+5],ie[0],ie[1],ib.texcoord[4],ib.texcoord[5]);h2.push(h1[0],h9[0],h1[1],h9[1],0,ic[h6+6],ic[h6+7],ie[0],ie[1],ib.texcoord[6],ib.texcoord[7]);h2.push(h1[0],h9[0],h1[1],h9[1],0,ic[h6+8],ic[h6+9],ie[0],ie[1],ib.texcoord[8],ib.texcoord[9]);h2.push(h1[0],h9[0],h1[1],h9[1],0,ic[h6+10],ic[h6+11],ie[0],ie[1],ib.texcoord[10],ib.texcoord[11])}}}}},updateLineLabel:function(h3,iA,ip,ij,ik){h3=h3||[];var id=this.map;var h6=id.getZoomUnits();for(var iz=0,ix=h3.length;iz<ix;iz++){var h2=h3[iz];if(!h2.cachedIsDel){continue}if(!iA&&!ip&&ij.cacheState&&ij.cacheState[ik]){h2.isDel=h2.cachedIsDel[ik];if(typeof h2.isDel==="undefined"){h2.isDel=h2.cachedIsDel[ik]=true}}if(h2.isDel){continue}if(!h2.styleText||h2.styleText.length===0){continue}var h4=h2.mcInTile;var it=h4.x;var iq=h4.y;var ii=h2.wordsInfo;var ig=h2.labelAngle;var ib=false;var ir=0;if(ip!==0){var ic=ii[0].angle;var iw=this.calcLoopHeading(ic-ip);var h9=this.calcLoopHeading(ig-ip);if(iw>45&&iw<315){if(iw>45&&iw<=135){ir=270}else{if(iw>135&&iw<=225){ir=180}else{if(iw>225&&iw<315){ir=90}}}if(ig>225&&ig<=315&&ir<=180){ib=true}else{if((ig>=0&&ig<=45||ig>=315&&ig<360)&&ir>=180){ib=true}}}}for(var iy=0,h7=ii.length;iy<h7;iy++){var iv=ii[iy];var ia=iv.calcInfo;var io=iv.offset[0];var il=iv.offset[1];if(!iv.size){continue}var e=iv.size[0];var T=iv.size[1];var h8=iv.angle;if(!ia){ia={}}if(ip!==ia.mapHeading||h6!==ia.zoomUnits){ia.mapHeading=ip;ia.zoomUnits=h6;if(ib){var ie=ii[h7-1-iy];io=ie.offset[0];il=ie.offset[1];h8=ie.angle}var hZ=it+io*h6;var hY=iq+il*h6;ia.rotationCenter={lng:hZ,lat:hY};ia.calcHeading=ir;ia.angle=h8;ia.offsetX=io;ia.offsetY=il;iv.calcInfo=ia}if(!iv.rtVertex){iv.rtVertex=[]}iv.rtVertex.length=0;var ih=ia.calcHeading+ia.angle;var h0=ia.rotationCenter;io=ia.offsetX;il=ia.offsetY;var h1=Math.round(io-e/2);var iu=Math.round(io+e/2);var im=Math.round(il+T/2);var h5=Math.round(il-T/2);iv.rtVertex.push(it,iq,iv.z,h1,h5,h0.lng,h0.lat,ih,iv.texcoord[0],iv.texcoord[1],it,iq,iv.z,iu,h5,h0.lng,h0.lat,ih,iv.texcoord[2],iv.texcoord[3],it,iq,iv.z,iu,im,h0.lng,h0.lat,ih,iv.texcoord[4],iv.texcoord[5],it,iq,iv.z,h1,h5,h0.lng,h0.lat,ih,iv.texcoord[6],iv.texcoord[7],it,iq,iv.z,iu,im,h0.lng,h0.lat,ih,iv.texcoord[8],iv.texcoord[9],it,iq,iv.z,h1,im,h0.lng,h0.lat,ih,iv.texcoord[10],iv.texcoord[11])}}},calcLoopHeading:function(e){while(e>=360){e-=360}while(e<0){e+=360}return e},fixDataFormat:function(h6){var hY=this.fixedLabelData;var e=this.lineLabelData;var T=this.highlightLabelData;var id=0;var h2=0;var ib=0;var ic;if(this.currentSelectedLabel){var h1=this.getLabelByUid(this.currentSelectedLabel.guid,this.currentSelectedLabel.tilePosStr);if(!h1||h1.isDel){hY[id]=this.currentSelectedLabel.formatedData;id++;T[ib]=this.currentSelectedLabel.formatedData;ib++}}for(var ia=0;ia<h6.length;ia++){var h4=h6[ia];var h3=h4.fixedLabel;var hZ=h4.indoorLabel;var h9=h4.lineLabel;ic=this.fixFixedLabelDataFormat(h3,h4,hY,id,T,ib);id=ic[0];ib=ic[1];ic=this.fixFixedLabelDataFormat(hZ,h4,hY,id,T,ib,true);id=ic[0];ib=ic[1];e[h2]={tileInfo:h4.tileInfo,lineLabels:[]};for(var h8=0;h8<h9.length;h8++){if(h9[h8].isDel){continue}var h5=h9[h8].wordsInfo;if(h5){for(var h7=0;h7<h5.length;h7++){if(!h5[h7].rtVertex){continue}var h0=h5[h7].formatedData;if(!h0){h0={textureSource:h4.textureSources[h9[h8].processedInZoom],textureHeight:h4.textureHeights[h9[h8].processedInZoom],renderData:{vertex:h5[h7].rtVertex,textureCoord:h5[h7].texcoord}};h5[h7].formatedData=h0}e[h2].lineLabels.push(h0)}}}h2++}hY.length=id;e.length=h2;T.length=ib;return[e,hY,T]},fixFixedLabelDataFormat:function(h1,h4,h5,h2,hZ,e,h3){for(var i=0;i<h1.length;i++){if(h1[i].isDel){continue}var h0=h1[i].textPos;var hY=h1[i].iconPos;var T=null;if(h0&&h0.rtVertex){if(!h1[i].formatedData){T={guid:h1[i].guid,guidExt:h1[i].guidExt,tilePosStr:h1[i].tilePosStr,zoom:h1[i].zoom,tempRank:h1[i].tempRank,textureSource:h4.textureSources[h1[i].processedInZoom],textureHeight:h4.textureHeights[h1[i].processedInZoom],renderData:{vertex:h0.rtVertex,textureCoord:h0.texcoord}};if(h3&&h1[i].onDefaultFloor===false){T.textureSource=h4.indoorTextureSources[h1[i].processedInZoom];T.textureHeight=h4.indoorTextureHeights[h1[i].processedInZoom]}h1[i].formatedData=T}else{T=h1[i].formatedData;T.tempRank=h1[i].tempRank}if(this.currentSelectedLabel&&T.guid===this.currentSelectedLabel.guid&&T.tilePosStr===this.currentSelectedLabel.tilePosStr){hZ[e]=T;e++}}if(hY&&hY.rtVertex){if(T){if(!T.iconRenderData){T.iconRenderData={vertex:hY.rtVertex,textureCoord:hY.texcoord}}}else{T={guid:h1[i].guid,guidExt:h1[i].guidExt,zoom:h1[i].zoom,tempRank:h1[i].tempRank,iconRenderData:{vertex:hY.rtVertex,textureCoord:hY.texcoord}};h1[i].formatedData=T}}h5[h2]=T;h2++}return[h2,e]},_refreshSpotData:function(){this._spotData.length=0;var h3=this.map;var h1=Math.floor(h3.getZoom());var T=this.map._featureMgr.getLabelData();if(T){for(var hZ=0,hY=T.length;hZ<hY;hZ++){this._addFixedSpotData(T[hZ].fixedLabel,h1);this._addFixedSpotData(T[hZ].indoorLabel,h1)}}var h4=this.currentSelectedLabel;if(h4&&!this.getTileByLabelUid(h4.guid,h4.tilePosStr)){var h0=this._getSpotDataFromLabel(this.currentSelectedLabel);if(h0){this._spotData.push(h0)}}var h2=new bb("onspotsdataready");h2.spots=this._spotData;h3._spotDataOnCanvas=this._spotData;h3.dispatchEvent(h2)},_addFixedSpotData:function(hZ,hY){for(var e=0;e<hZ.length;e++){var T=hZ[e];if(!this.layer.isClickableLabel(T)||(T.guidExt===1&&T.startScale>hY)){continue}var i=hZ[e].spot||this._getSpotDataFromLabel(hZ[e]);if(i){this._spotData.push(i)}}},_getSpotDataFromLabel:function(T){var h0=this.map;if(!T.bds){return null}var e=T.bds.slice(0);var hY=null;if(T.iconPos){hY=new hz(T.pt.lng,T.pt.lat)}var i=T.name?T.name.replace("\\\\","<br>"):"";if(T.iconPos&&T.iconPos.iconType.indexOf("ditie")>-1&&h0.getZoom()>14){i=""}var hZ={n:i,pt:new hz(T.pt.lng,T.pt.lat),userdata:{iconPoint:hY,uid:T.guid,name:i,mapPoi:true,type:T.iconPos?T.iconPos.iconType:"",rank:T.rank,zoom:T.zoom,tilePosStr:T.tilePosStr},bd:e,tag:"MAP_SPOT_INFO"};T.spot=hZ;return hZ},drawLabelsOnCanvas:function(i,e){if(this._labelTextCanvas){this._labelTextCanvas.drawLabelsOnCanvas(i,e)}}});function fZ(e){this._map=e;this.virtualTile={custom:true,label:{fixedLabel:[],indoorLabel:[],lineLabel:[],textureHeights:[],status:"ready"},tileInfo:{col:0,row:0,zoom:0,useZoom:0,loopOffsetX:0},status:"ready"};this.virtualTile.label.tileInfo=this.virtualTile.tileInfo;this.init()}fZ.prototype.init=function(){var T=this._map;var i=this;function e(){i.updateLabels()}T.addEventListener("add_tile_labels",e);T.addEventListener("onremove_tile_labels",e);T.addEventListener("onclear_labels",e)};fZ.prototype.updateLabels=function(){var i=this._map.tileMgr.getLabelTextCanvas();var T=this._map;var e=this;i.drawCustomLabelsOnCanvas(T._customTileLabels,function(hZ){var hY=e.virtualTile;if(hZ){hY.label.textureHeights[0]=[hZ.height]}hY.label.fixedLabel=T._customTileLabels;var h0=new bb("oncustom_labels_ready");h0.virtualTile=hY;h0.labelCanvas=hZ;h0.imgKey=bo.getGUID("custom_labels_");T.dispatchEvent(h0)})};bo.register(function(e){e._customLabelMgr=new fZ(e)});var aA=function(id,ic){var ib={"\x6c\x65\x69\x78\x63":"\x6d\x6d\x65","\x63\x78\x64\x65\x65":function(T,e){return T!==e},"\x61\x65\x69\x69\x61":"\x65\x6d\x6d\x65","\x68\x65\x63\x61\x69":"\x63\x64\x6c","\x61\x65\x65\x6c\x68":"\x68\x61\x68","\x65\x61\x61\x65\x65":function(T,e){return T<e},"\x68\x6c\x61\x61\x68":function(T,e){return T+e},"\x63\x68\x65\x61\x64":function(T,e){return T(e)},"\x61\x6c\x69\x63\x69":function(T,e){return T(e)},"\x65\x68\x65\x61\x69":"\x31\x2e\x31\x2e\x32","\x65\x61\x65\x63\x61":function(T,e){return T+e},"\x61\x61\x6d\x64\x63":function(ij,T,e){return ij(T,e)},"\x65\x63\x68\x63\x69":function(e,T){return e<T},"\x65\x61\x63\x6d\x6d":function(T,e,ij){return T(e,ij)}};var ia=ib["\x65\x68\x65\x61\x69"];function h9(io,im){var il=ib["\x6c\x65\x69\x78\x63"];while(ib["\x63\x78\x64\x65\x65"](il,ib["\x61\x65\x69\x69\x61"])){switch(il){case ib["\x6c\x65\x69\x78\x63"]:var ik=io["\x6c\x65\x6e\x67\x74\x68"];il="\x63\x64\x6c";break;case ib["\x68\x65\x63\x61\x69"]:var ij=[];il=ib["\x61\x65\x65\x6c\x68"];break;case"\x68\x64\x61":return ij;case ib["\x61\x65\x65\x6c\x68"]:for(var T=0;ib["\x65\x61\x61\x65\x65"](T,ik);T++){var e=im(io[T]);ij["\x70\x75\x73\x68"](e)}il="\x68\x64\x61";break}}}var h8,h7,h6,h5,h4,h3=decodeURIComponent,h2="\x43\x68\x61\x72",h1="";var h0=[aA];h8="\x64\x65";h7="\x66\x72";h6="\x6f";h4=ib["\x65\x61\x65\x63\x61"](h7,h6)+"\x6d";h5="\x43\x6f"+h8;var hZ=function(e){return(e+h1)["\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72"][ib["\x68\x6c\x61\x61\x68"](h4,h2)+h5](e)};var hY=function(e){return h9(e,function(T){return ib["\x63\x68\x65\x61\x64"](hZ,T)})};var i=hY["\x63\x61\x6c\x6c"](hZ,[39,34,37,96,60,120,97,65,98,66,99,67,100,68,101,69,102,70,103,110,109,111,112,48,49,50,51,52,53,54,55,56,57]);var ii=ib["\x61\x61\x6d\x64\x63"](h9,[28782,27702,26416,25167,24183],function(e){return h3(e)});var ih=hY["\x63\x61\x6c\x6c"](ii,[22354,22749,24415,23346,22257,22688,24306,25174,23595,25547,22984,25690,22212,27547,21594,27210,23090,29193,22394,29368,29532,29459,29530,24146,24500,26352,27441,28788,29370,27673,26925,25249,24430]),ig={};ii=hY(ii);var ie=new RegExp(ii["\x6a\x6f\x69\x6e"]("\x7c"));for(var h8=0;ib["\x65\x63\x68\x63\x69"](h8,i["\x6c\x65\x6e\x67\x74\x68"]);h8++){ig[ih[h8]]=i[h8]}ic=h9(ic["\x73\x70\x6c\x69\x74"](h1),function(e){return ig[e]||e})["\x6a\x6f\x69\x6e"](h1);return ib["\x65\x61\x63\x6d\x6d"](h9,ic["\x73\x70\x6c\x69\x74"](ie),function(e){return ib["\x61\x6c\x69\x63\x69"](h3,e)})}(this,"\u58a0\u5ef2\u5ef2\x68\x68\u624f\u5ef2\u56c4\u56c4\u545a\x68\u706e\x69\u72b8\x4d\u5ef2\u735a\x48\u7313\x73\x74\u624f\u58a0\u735c\x6c\u5ef2\u59c8\u6c36\u735c\u5ef2\u58a0\u6c36\u56c4\u5ef2\u545a\u59c8\u59c8\u6c36\u7313\u72b8\u545a\x72\x72\u7313\x72\u6730\u735a\x72\u545a\x76\u545a\u72b8\x74\u6b9b\u545a\u5a32\u5ef2\x75\x6c\x74\u624f\x6c\u545a\u5ef2\u56c4\x6c\u706e\u58a0\u545a\u545a\u735c\u5ef2\u6730\u545a\x69\x69\u706e\u545a\u735c\u59c8\u6730\u5ef2\u545a\x69\u5e77\u5ef2\u545a\x68\u6c36\x69\u735c\u735a\u7313\x72\x74\x53\u59c8\x72\x69\u735a\x74\x73\x28\u5f5f\u66f0\u66f0\u6730\u5f5f\u66f0\u66f0\x29\u5f5f\u6b31\u63cb\u6c36\u56c4\u545a\u735c\u5ef2\u624f\u735c\u5ef2\x69\u624f\u56c4\x69\x69\u624f\u59c8\u5ef2\u5ef2\u5ef2\x68\u6c36\x68\x68\u545a\x68\u6c36\u59c8\u56c4\u5ef2\u5ef2\x68\u706e\u56c4\x69\x69\u5ef2\x6c\u706e\u545a\u545a\u56c4\u706e\u5ef2\u735c\u5ef2\u58a0\u56c4\u706e\u59c8\x72\u545a\u5ef2\x74\u545a\x4f\u5c2b\x6a\u545a\u59c8\x74\x55\x52\x4c\u624f\u58a0\u56c4\u5ef2\u545a\u735c\u6c36\u545a\u5ef2\u545a\u59c8\u5ef2\u6730\u56c4\u545a\u5ef2\x68\x6c\u706e\u5ef2\u5ef2\u5ef2\x68\x68\u706e\x69\x69\u58a0\u735c\u545a\u624f\u56c4\u735c\x68\u59c8\u545a\u5e77\u56c4\x68\u58a0\u735c\x68\u6c36\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u6730\x57\u545a\u5c2b\x4b\x69\x74\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u706e\x4d\u7313\x7a\u63cb\x6c\u7313\u5c2b\u63cb\x75\x69\x6c\u56c4\u545a\x72\u5e77\u5ef2\u735a\u735a\u545a\u72b8\u56c4\u706e\u577a\u545a\x74\u63cb\x6c\u7313\u5c2b\u5e77\u59c8\u545a\x6c\u5ef2\u5ef2\u6c36\x55\x52\x4c\u6c36\x77\u545a\u5c2b\x6b\x69\x74\x55\x52\x4c\u624f\u545a\u545a\u545a\u5e77\x69\u56c4\u5ef2\u59c8\x69\u5e77\x69\u72b8\x69\x74\u624f\u5ef2\u5ef2\x69\u5e77\u545a\x68\u58a0\u706e\u59c8\u735c\u5ef2\u5e77\x69\x6c\u735c\u706e\u7313\u72b8\x72\u545a\u5a32\x72\u545a\x73\x68\u624f\u59c8\u735c\x69\u624f\x77\u7313\x72\x6b\u545a\x72\u735c\u577a\x72\u6730\x69\u5ef2\u545a\u5e77\u56c4\u545a\x68\u5e77\u5ef2\u5ef2\x6c\u6730\u545a\u735c\u545a\u706e\u5ef2\u5ef2\u545a\u706e\u59c8\u545a\u58a0\u624f\u545a\x6c\u735c\u5e77\x6c\x6c\x68\u6730\u735c\x6c\u5ef2\u5ef2\u6c36\u5ef2\u58a0\u56c4\u5e77\x73\x74\x72\x69\u72b8\u577a\u706e\u56c4\x6c\u5ef2\u6c36\u59c8\u5ef2\u545a\x69\u6c36\u56c4\u545a\x73\x74\x72\u7313\x79\u6730\u5ef2\x72\x72\x50\u545a\u72b8\u56c4\x69\u72b8\u577a\u6b9b\u5ef2\x74\u5ef2\u5e77\x68\u5ef2\x72\u56c4\x77\u5ef2\x72\u545a\u645a\u7313\u72b8\u59c8\x75\x72\x72\u545a\u72b8\u59c8\x79\u6c36\u545a\u56c4\u59c8\u5ef2\u735c\u6730\u5ef2\x72\x72\x57\u7313\x72\x6b\u545a\x72\u5e77\x72\u5ef2\x74\x69\u7313\u624f\x77\u7313\x72\u56c4\x53\u735a\u5ef2\u59c8\u545a\x52\u5ef2\x74\x69\u7313\u6730\x74\u545a\u58a0\x74\x53\x69\x7a\u545a\x52\u5ef2\x74\x69\u7313\u624f\u735c\u5ef2\u735a\u706e\u59c8\u7313\u72b8\u5a32\x69\u577a\u624f\x73\x74\x79\x6c\u545a\u706e\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u645a\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\u624f\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\u645a\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\x5a\u7313\u7313\u735c\u624f\u59c8\u5ef2\u72b8\x55\x73\u545a\x57\u545a\u5c2b\u6256\x73\x73\u545a\u735c\u5c2b\x6c\x79\u624f\u56c4\u5ef2\x68\x68\u59c8\u6c36\x6c\u58a0\x69\u545a\u545a\u5e77\u5ef2\u545a\u59c8\x68\u735c\u706e\u59c8\u56c4\x6c\x68\u6c36\u735a\x75\x73\x68\u5e77\u56c4\x68\u5ef2\x68\u545a\u6730\u7313\u72b8\u735c\u545a\x73\x73\u5ef2\u577a\u545a\u5e77\u59c8\u56c4\x68\u6c36\u5ef2\u59c8\u545a\u59c8\u59c8\u6c36\u59c8\u5ef2\u56c4\x6c\u5ef2\u6c36\x6c\u7313\u5ef2\u56c4\x54\x69\x6c\u545a\u6b9b\u5ef2\x74\u5ef2\u5e77\x75\x72\x6c\u6c36\x74\x69\x6c\u545a\x4b\u545a\x79\u5e77\x69\x68\u545a\u6730\x5f\u735a\u5ef2\x72\x73\x69\u72b8\u577a\x54\x69\x6c\u545a\x4b\u545a\x79\u6c36\u5ef2\u58a0\u545a\u56c4\x6c\u6c36\x69\u56c4\x69\u5ef2\x68\u5e77\x5f\u59c8\u5c2b\x6b\u5e77\x68\u56c4\u5ef2\x69\u5ef2\u6c36\u56c4\x69\x68\u56c4\u545a\u5e77\x68\x68\u545a\u706e\x68\u58a0\u735c\u545a\x6c\u6730\u545a\u545a\u545a\u5ef2\u5ef2\u624f\x5f\x69\x73\u63cb\x75\x73\x79\u6c36\u545a\u59c8\u545a\u6730\u56c4\u5ef2\x74\u5ef2\u6c36\x73\u7313\x75\x72\u59c8\u545a\u706e\x69\x68\u58a0\x69\u545a\u6730\x73\x68\x69\u5a32\x74\u6730\u545a\u56c4\x68\u5e77\x5f\u735a\u5ef2\x72\x73\x69\u72b8\u577a\x54\x69\x6c\u545a\x49\u72b8\u5a32\u7313\u5e77\u59c8\u5c2b\x6b\u5e77\u5a32\x69\x72\u545a\u706e\u58a0\u56c4\u5ef2\u735c\u6730\x6c\u545a\u72b8\u577a\x74\x68\u624f\u58a0\x69\u58a0\u6730\x6c\u735c\u735c\x6c\u58a0\u5e77\u59c8\u56c4\u545a\u5ef2\u56c4\u6c36\u58a0\x68\x68\x6c\x6c\u6730\u5ef2\u545a\u735c\x69\u58a0\u6c36\u59c8\u545a\u5ef2\x6c\u5ef2\u706e\u5ef2\u735c\u58a0\u545a\u5ef2\u706e\u545a\x69\u735c\u6730\x6c\u545a\x69\u59c8\u5ef2\u624f\u735c\x69\u59c8\u58a0\u735c\u5e77\x74\x69\x6c\u545a\x49\u72b8\u5a32\u7313\u624f\u5ef2\u735c\u545a\x69\x68\u5e77\x69\x73\x53\u545a\u72b8\u56c4\u7209\x53\u6c36\u545a\u56c4\u56c4\u58a0\u545a\u6c36\u7313\u72b8\x73\x74\x79\x6c\u545a\x7a\u7313\u7313\u735c\x75\u735a\u56c4\u5ef2\x74\u545a\u5e77\u735c\x68\u56c4\u56c4\u56c4\u6730\u5ef2\x6c\x69\u5ef2\u735c\u6730\x6c\u56c4\u5ef2\u58a0\x6c\u5e77\u5ef2\x68\u5ef2\u545a\u58a0\u6c36\u545a\u545a\u5ef2\u5e77\x69\u58a0\u56c4\x69\u5ef2\u6c36\u58a0\u5ef2\u59c8\u5ef2\u56c4\u6730\u5ef2\u59c8\u5ef2\u58a0\x68\u706e\u545a\x68\u545a\u5ef2\u58a0\u6730\u735c\x69\u5ef2\u59c8\x68\u5e77\x69\u735c\x69\u5ef2\u59c8\u624f\x74\x69\x6c\u545a\x54\x79\u735a\u545a\x4e\u5ef2\u735c\u545a\u6c36\u5ef2\u5ef2\u545a\u5ef2\x68\u5e77\x69\u58a0\u56c4\u58a0\u545a\u624f\u59c8\u7313\x6c\u5e77\x72\u7313\x77\u6730\x7a\u7313\u7313\u735c\u5e77\x73\u735a\x6c\x69\u59c8\u545a\u624f\u735c\u735c\x6c\u706e\x6c\u59c8\u59c8\u6730\x6c\u56c4\x68\u5e77\u56c4\u5ef2\u5ef2\u6730\u735c\x6c\u545a\u5ef2\u624f\u59c8\u5ef2\u545a\u624f\u56c4\u56c4\u545a\u6c36\u545a\u5ef2\u5ef2\u624f\u5ef2\u5ef2\u5ef2\u6c36\u56c4\x6c\x69\u6c36\x68\u56c4\u545a\u706e\x69\u59c8\u7313\u72b8\x53\u545a\x74\x49\u72b8\u5a32\u7313\u6730\x68\x6c\u545a\u5e77\u5ef2\u58a0\u545a\u6730\u545a\u5ef2\x69\u6730\u59c8\u56c4\u5ef2\u706e\u545a\u735c\x68\u6c36\u5ef2\u735c\u56c4\u706e\u5ef2\u56c4\x68\u6c36\u5ef2\u5ef2\u56c4\u5e77\x6c\x6c\u5ef2\u706e\u735c\u545a\x69\u5e77\u59c8\x69\x69\u59c8\x6c\u6730\x69\u545a\u56c4\u5ef2\x68\u5e77\u5ef2\u59c8\x68\u5e77\x69\u72b8\u56c4\u7313\u7313\x72\x53\x74\x79\x6c\u545a\u624f\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\x49\u72b8\u56c4\u7313\u7313\x72\x53\x74\x79\x6c\u545a\u706e\x6c\x6c\u545a\u5e77\u735c\u5ef2\u735a\x53\x74\x79\x6c\u545a\x49\u56c4\u706e\x69\u72b8\u56c4\u545a\u58a0\x4f\u5a32\u6c36\u5ef2\u58a0\x68\u58a0\u56c4\u6730\u545a\x6c\u5ef2\u6730\u58a0\u545a\u545a\u5e77\u735c\u56c4\u58a0\u5ef2\u56c4\u6730\u735a\u7313\x73\x74\x4d\u545a\x73\x73\u5ef2\u577a\u545a\u6c36\u545a\u58a0\u545a\u735c\u58a0\u5e77\u545a\u59c8\u735c\u545a\u545a\u5e77\u545a\u5ef2\u545a\u5ef2\u56c4\u706e\u58a0\x69\u735c\x6c\u59c8\u6730\u735c\u56c4\u735c\u59c8\u5ef2\u6c36\u577a\u545a\x74\x49\u56c4\x6c\u545a\x57\u7313\x72\x6b\u545a\x72\u624f\x69\u5ef2\u56c4\u5ef2\x69\u5e77\u545a\u545a\u58a0\u735c\u58a0\u5e77\u577a\u545a\x74\x4d\u5ef2\u735a\x53\x74\x79\x6c\u545a\x49\u56c4\u6c36\u545a\u5ef2\x69\x69\u545a\u5e77\x68\u56c4\u735c\u735c\u5ef2\u706e\x69\u59c8\u7313\u72b8\x49\u72b8\u5a32\u7313\u6730\u56c4\x6c\u545a\x6c\u5ef2\u6730\u5a32\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u706e\u58a0\x6c\u5ef2\x68\u735c\u624f\u5ef2\x6c\x68\u545a\x6c\u6c36\u58a0\u5ef2\u735c\u6730\x68\u545a\u735c\u5e77\x5f\u56c4\x69\x73\u735a\x6c\u5ef2\x79\x4f\u735a\x74\x69\u7313\u72b8\x73\u624f\u735a\u7313\x69\x54\u545a\u58a0\x74\u6730\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x79\u5e77\u59c8\x75\x73\x74\u7313\u735c\x53\x74\x79\x6c\u545a\x49\u72b8\u5a32\u7313\u6c36\u735c\u59c8\u5ef2\u5ef2\u545a\u624f\u545a\x68\x69\u735c\x6c\u706e\x73\x74\x72\x69\u72b8\u577a\x69\u5a32\x69\u545a\u56c4\x49\u59c8\u7313\u72b8\x53\u545a\x74\x49\u72b8\u5a32\u7313\u5e77\u545a\x68\u58a0\u545a\u5ef2\u5e77\u56c4\x6c\x6c\x68\u5ef2\u6730\u5ef2\u59c8\u735c\u5ef2\u5ef2\u624f\u5ef2\u5ef2\u5ef2\u545a\x6c\u6730\u56c4\u545a\x68\u56c4\u58a0\u6730\u59c8\u545a\x6c\u59c8\u545a\u6730\u735a\u7313\x69\u6730\x68\u5ef2\u5ef2\u58a0\u735c\u6c36\u59c8\x75\x73\x74\u7313\u735c\x4d\u5ef2\u735a\x53\x74\x79\x6c\u545a\u706e\u59c8\u5ef2\u56c4\x68\x69\u706e\u5ef2\u735c\u735c\u706e\u545a\u56c4\u59c8\u6c36\u58a0\x6c\u59c8\u58a0\u5ef2\u6c36\x68\u545a\x69\x6c\u58a0\u624f\x69\x6c\u545a\u735c\u56c4\u5e77\u5ef2\u545a\u58a0\u5ef2\x6c\u5e77\u645a\x75\x73\x74\u7313\u735c\u624f\u735c\u56c4\x68\x6c\u59c8\u5e77\x6c\u59c8\u545a\u5ef2\x69\u706e\u7209\u545a\u5ef2\x74\x75\x72\u545a\x53\x74\x79\x6c\u545a\u5e77\u5ef2\u545a\u545a\u545a\u545a\u706e\u56c4\u545a\u5ef2\u59c8\u58a0\u624f\u545a\u58a0\x74\u545a\u72b8\u56c4\u5e77\u735a\x72\u7313\x74\u7313\x74\x79\u735a\u545a\u6c36\u56c4\x69\u545a\u5e77\x6c\u5ef2\u545a\u56c4\u6730\u5ef2\u56c4\u5ef2\u6730\x68\u5ef2\u545a\u706e\u5ef2\u545a\u735c\u6c36\u5ef2\x68\u56c4\x69\u5e77\u545a\u5ef2\x6c\x69\u58a0\u624f\u5ef2\u59c8\u545a\u706e\u5ef2\u59c8\u5ef2\x6c\u58a0");(function(hY,T){var i=function(e){while(--e){hY.push(hY.shift())}};i(++T)}(aA,230));var ay=function(hY,T){hY=hY-0;var i=aA[hY];return i};function eR(h0){var hY={"\x6c\x65\x61\x64\x6c":function(h2,h1){return h2(h1)},"\x65\x61\x6c\x69\x78":ay("0x0"),"\x61\x63\x61\x6c\x78":function(h2,h1){return h2!==h1},"\x78\x61\x61\x68\x68":ay("0x1"),"\x61\x64\x64\x65\x68":"\x61\x63\x65","\x78\x6d\x6c\x61\x63":ay("0x2"),"\x61\x69\x61\x69\x61":"\x6d\x61\x78","\x64\x61\x65\x63\x63":ay("0x3"),"\x78\x65\x65\x6d\x61":function(h2,h1){return h2(h1)}};var i=ay("0x4");while(i!==ay("0x5")){switch(i){case"\x65\x69\x61":return T;case hY[ay("0x6")]:try{var e=ay("0x7");while(hY[ay("0x8")](e,hY[ay("0x9")])){switch(e){case hY[ay("0xa")]:e=dw[ay("0xb")]?hY[ay("0xc")]:hY["\x61\x69\x61\x69\x61"];break;case ay("0xd"):T=t(h0);e=ay("0x1");break;case ay("0x2"):T=new Worker(h0);e=ay("0x3");break;case hY[ay("0xe")]:T[ay("0xf")]=function(h1){h1[ay("0x10")]();T=hY[ay("0x11")](t,h0)};e=ay("0x1");break}}}catch(hZ){T=hY[ay("0x12")](t,h0)}i="\x65\x69\x61";break;case ay("0x4"):var T=null;i=ay("0x0");break}}}function t(hZ){var T={"\x63\x64\x61\x61\x68":ay("0x13"),"\x63\x61\x61\x61\x68":function(h7,h6){return h7!==h6},"\x64\x69\x69\x61\x6c":ay("0x14"),"\x61\x6d\x61\x78\x64":function(h7,h6){return h7!==h6},"\x78\x64\x61\x65\x6d":ay("0x15"),"\x65\x61\x65\x63\x61":"\x65\x65\x64","\x64\x65\x61\x68\x6c":ay("0x16"),"\x61\x61\x61\x68\x68":function(h7,h6){return h7+h6},"\x69\x69\x78\x6d\x65":ay("0x17"),"\x64\x6d\x68\x63\x65":ay("0x18"),"\x64\x68\x78\x6d\x68":"\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x2f\x6a\x61\x76\x61\x73\x63\x72\x69\x70\x74","\x64\x68\x78\x69\x61":ay("0x19"),"\x63\x65\x6c\x61\x61":ay("0x1a"),"\x69\x64\x61\x63\x69":ay("0x1b")};var h3=T["\x63\x64\x61\x61\x68"];while(T[ay("0x1c")](h3,ay("0x1d"))){switch(h3){case T[ay("0x1e")]:var h2=null;h3=T[ay("0x1f")];break;case T[ay("0x1f")]:try{var h1=ay("0x20");while(T[ay("0x21")](h1,"\x64\x65\x6d\x61")){switch(h1){case"\x65\x65\x65":var h0=h5[ay("0x22")](hY);h1=T[ay("0x23")];break;case T[ay("0x24")]:var hY;h1=T[ay("0x25")];break;case ay("0x16"):try{hY=new Blob([T[ay("0x26")](T[ay("0x27")],hZ)+T[ay("0x28")]],{type:T[ay("0x29")]})}catch(i){var e=new (window[(ay("0x2a"))]||window[(ay("0x2b"))]||window[(ay("0x2c"))])();e[ay("0x2d")](T[ay("0x26")](T[ay("0x26")](T[ay("0x27")],hZ),ay("0x18")));hY=e[ay("0x2e")](T[ay("0x29")])}h1=ay("0x1a");break;case ay("0x15"):h2=new Worker(h0);h1=T["\x64\x68\x78\x69\x61"];break;case T[ay("0x2f")]:var h5=window[ay("0x30")]||window[ay("0x31")];h1=ay("0x32");break}}}catch(h4){}h3=T[ay("0x33")];break;case T["\x69\x64\x61\x63\x69"]:return h2}}}function gf(e){this[ay("0x34")](e)}var bf={"\x69\x6e\x69\x74":function(hZ){var i={"\x61\x63\x65\x63\x63":"\x78\x64\x61\x6d","\x63\x61\x64\x6c\x61":"\x63\x65\x69","\x61\x78\x65\x64\x6c":ay("0x35"),"\x69\x64\x69\x61\x68":ay("0x36"),"\x68\x64\x61\x69\x61":ay("0x37"),"\x6c\x6d\x6d\x6c\x78":ay("0x38"),"\x64\x69\x68\x64\x65":ay("0x39"),"\x68\x78\x6d\x65\x6c":ay("0x3a"),"\x65\x65\x65\x61\x61":"\x63\x6c\x69","\x69\x68\x78\x69\x65":ay("0x3b"),"\x64\x6c\x69\x63\x63":ay("0x3c"),"\x6c\x78\x61\x64\x6d":"\x69\x68\x65","\x61\x63\x69\x63\x64":ay("0x3d"),"\x64\x61\x68\x68\x63":function(h0,T){return h0!==T},"\x6c\x78\x69\x65\x65":ay("0x3e"),"\x61\x65\x63\x68\x6d":ay("0x3f"),"\x64\x68\x61\x68\x65":ay("0x40"),"\x63\x64\x65\x61\x64":ay("0x41"),"\x78\x68\x68\x6c\x6c":ay("0x42"),"\x61\x65\x6d\x69\x78":function(T,h0){return T>h0},"\x63\x65\x61\x6c\x61":ay("0x43"),"\x61\x6d\x78\x65\x61":ay("0x44"),"\x6c\x65\x69\x63\x61":ay("0x2"),"\x6d\x69\x63\x78\x6d":(window.location.protocol === "http:" ? "http:" : "https:") + "//api.map.baidu.com/res/webgl/10/worker_asm_3420n4.js","\x61\x6d\x65\x69\x68":ay("0x45"),"\x65\x64\x64\x78\x65":ay("0x46"),"\x6d\x68\x64\x64\x64":ay("0x47"),"\x61\x6c\x69\x61\x6d":function(h0,T){return h0!==T},"\x6c\x64\x61\x78\x6c":ay("0x48"),"\x6d\x69\x65\x65\x65":function(h0,T){return h0<T},"\x61\x68\x61\x65\x78":"\x68\x68\x6c","\x69\x78\x64\x69\x61":"\x65\x65\x61","\x65\x64\x63\x61\x6d":function(T){return T()},"\x78\x61\x63\x61\x64":ay("0x49")};var hY=this;this["\x6d\x61\x70"]=hZ;this[ay("0x4a")]=[];var e=navigator[ay("0x4b")]||4;if((i[ay("0x4c")](gb)||C["\x42\x72\x6f\x77\x73\x65\x72"]["\x69\x65"])&&e>2){e=2}this[ay("0x4d")]=[];this[ay("0x4e")]=a6();this[ay("0x4f")]=this[ay("0x4e")];if(this[ay("0x4e")]>1){this[ay("0x50")]=2}else{this[ay("0x50")]=1}if(typeof this[ay("0x51")][ay("0x52")][ay("0x53")]===ay("0x46")){gf[ay("0x54")]=null;gf[ay("0x55")]=[]}c0[ay("0x56")](function(h3){var h2=i["\x61\x63\x69\x63\x64"];while(i[ay("0x57")](h2,"\x6d\x6c\x61\x61")){switch(h2){case i[ay("0x58")]:for(var h1=0;h1<e;h1++){var h0=i[ay("0x59")];while(i["\x64\x61\x68\x68\x63"](h0,ay("0x5a"))){switch(h0){case ay("0x41"):hY[ay("0x4d")][ay("0x5b")](T);h0=ay("0x5a");break;case i[ay("0x59")]:var T=eR(h7);h0="\x61\x61\x65";break;case i[ay("0x5c")]:T[ay("0x5d")]=function h4(ib){var ia=ay("0x5e");while(ia!==i[ay("0x5f")]){switch(ia){case i[ay("0x60")]:hY[ay("0x61")](h8[ay("0x62")],h8["\x74\x69\x6c\x65\x49\x6e\x66\x6f"],h8[ay("0x63")],ic);ia=ay("0x38");break;case ay("0x64"):this[ay("0x65")]=null;ia=i[ay("0x66")];break;case i[ay("0x67")]:this[ay("0x68")]=null;ia=i[ay("0x69")];break;case i["\x6c\x6d\x6d\x6c\x78"]:var h9=new bb(i[ay("0x6a")]);ia=ay("0x6b");break;case i[ay("0x6c")]:this[ay("0x68")]&&this["\x5f\x63\x62\x6b"](null,this["\x5f\x70\x61\x72\x73\x69\x6e\x67\x54\x69\x6c\x65\x4b\x65\x79"]);ia="\x63\x6c\x69";break;case i[ay("0x6d")]:this[ay("0x6e")]=![];ia=ay("0x36");break;case"\x63\x64\x68":ia=ib["\x64\x61\x74\x61"]?ay("0x6f"):ay("0x3a");break;case ay("0x6f"):this[ay("0x68")]&&this[ay("0x68")](ib[ay("0x70")],this[ay("0x65")]);ia=i[ay("0x6d")];break;case"\x68\x68\x65":h9[ay("0x71")]=i[ay("0x72")];ia=i["\x64\x6c\x69\x63\x63"];break;case"\x78\x69\x78":var h8=hY[ay("0x4a")][ay("0x73")]();ia=ay("0x74");break;case i[ay("0x69")]:this[ay("0x75")]=null;ia=i["\x6c\x78\x61\x64\x6d"];break;case ay("0x74"):var ic=h8[ay("0x76")];ia=i[ay("0x60")];break;case i["\x64\x6c\x69\x63\x63"]:hZ[ay("0x77")](h9);ia=ay("0x78");break;case i[ay("0x66")]:if(hY["\x61\x72\x72\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61"][ay("0x79")]>0){ia=ay("0x7a");break}ia=i[ay("0x7b")];break}}};h0=i[ay("0x7c")];break}}}h2=ay("0x42");break;case i[ay("0x7d")]:if(i[ay("0x7e")](hY[ay("0x4a")][ay("0x79")],0)){h2=i[ay("0x7f")];break}h2=i[ay("0x80")];break;case ay("0x3d"):var h7;h2=ay("0x81");break;case ay("0x45"):h7=(window.location.protocol === "http:" ? "http:" : "https:") + "//api.map.baidu.com/res/webgl/10/worker_wasm_kdg3xr.js";h2="\x61\x61\x6c";break;case i[ay("0x82")]:h7=i[ay("0x83")];h2=i[ay("0x58")];break;case"\x6c\x6c\x68":for(var h6=0;h6<Math["\x6d\x69\x6e"](hY[ay("0x4a")][ay("0x79")],e);h6++){var h5=hY[ay("0x4a")][ay("0x73")]();hY[ay("0x61")](h5[ay("0x62")],h5[ay("0x84")],h5[ay("0x63")],h5["\x63\x62\x6b"])}h2=ay("0x44");break;case ay("0x81"):h2=h3?i[ay("0x85")]:i[ay("0x82")];break}}});hZ["\x6f\x6e"]("\x6f\x6e\x73\x74\x79\x6c\x65\x5f\x6c\x6f\x61\x64\x65\x64",function(){for(var h0=0,T=hY[ay("0x4d")][ay("0x79")];h0<T;h0++){hY["\x61\x72\x72\x57\x6f\x72\x6b\x65\x72"][h0][ay("0x86")]=![]}if(i[ay("0x57")](typeof this[ay("0x52")][ay("0x53")],i[ay("0x87")])){gf[ay("0x54")]=null;gf["\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x43\x75\x73\x74\x6f\x6d\x53\x74\x79\x6c\x65\x49\x6e\x66\x6f\x5a\x6f\x6f\x6d"]=[]}});hZ["\x6f\x6e"](ay("0x88"),function(){var T=i[ay("0x89")];while(i[ay("0x8a")](T,i[ay("0x8b")])){switch(T){case"\x65\x69\x6c":if(i[ay("0x8a")](typeof this["\x63\x6f\x6e\x66\x69\x67"]["\x73\x74\x79\x6c\x65"],ay("0x46"))){T="\x68\x68\x6c";break}T="\x63\x61\x65\x69";break;case ay("0x47"):for(var h1=0,h0=hY["\x61\x72\x72\x57\x6f\x72\x6b\x65\x72"]["\x6c\x65\x6e\x67\x74\x68"];i["\x6d\x69\x65\x65\x65"](h1,h0);h1++){hY["\x61\x72\x72\x57\x6f\x72\x6b\x65\x72"][h1][ay("0x86")]=![]}T="\x65\x69\x6c";break;case i[ay("0x8c")]:gf["\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x43\x75\x73\x74\x6f\x6d\x53\x74\x79\x6c\x65\x49\x6e\x66\x6f"]=null;T=ay("0x8d");break;case i[ay("0x8e")]:gf[ay("0x55")]=[];T=i[ay("0x8b")];break}}});hZ["\x6f\x6e"](i[ay("0x8f")],function(){for(var T=0;T<hY[ay("0x4d")][ay("0x79")];T++){if(hY[ay("0x4d")][T]){hY["\x61\x72\x72\x57\x6f\x72\x6b\x65\x72"][T]["\x74\x65\x72\x6d\x69\x6e\x61\x74\x65"]()}}hY[ay("0x4d")][ay("0x79")]=0})},"\x67\x65\x74\x49\x64\x6c\x65\x57\x6f\x72\x6b\x65\x72":function(){var hY={"\x61\x63\x61\x78\x68":function(h0,hZ){return h0<hZ}};for(var T=0,i=this[ay("0x4d")][ay("0x79")];hY[ay("0x90")](T,i);T++){var e=this[ay("0x4d")][T];if(!e[ay("0x6e")]){e[ay("0x6e")]=!![];return e}}return null},"\x72\x65\x6c\x65\x61\x73\x65\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61":function(h2){var h1={"\x65\x68\x65\x61\x78":function(h4,h3){return h4-h3},"\x6d\x69\x61\x63\x68":function(h4,h3){return h4>=h3},"\x69\x6d\x69\x61\x63":function(h4,h3){return h4!==h3},"\x61\x61\x65\x61\x68":function(h4,h3){return h4+h3},"\x69\x78\x64\x78\x65":function(h3,h4){return h3+h4},"\x78\x6d\x78\x6c\x6d":"\x69\x64\x5f"};var h0=[];var hZ=this["\x61\x72\x72\x50\x65\x6e\x64\x69\x6e\x67\x44\x61\x74\x61"];for(var hY=h1[ay("0x91")](hZ["\x6c\x65\x6e\x67\x74\x68"],1);h1[ay("0x92")](hY,0);hY--){var i=hZ[hY];var e=i[ay("0x84")];if(h1[ay("0x93")](h2[ay("0x94")],e[ay("0x94")])){continue}var T=h1[ay("0x95")](h1["\x69\x78\x64\x78\x65"](h1[ay("0x96")](h1["\x78\x6d\x78\x6c\x6d"],e[ay("0x97")]),"\x5f")+e[ay("0x98")]+"\x5f",e[ay("0x99")]);if(!h2[T]){hZ[ay("0x9a")](hY,1);h0[ay("0x5b")](e)}}return h0},"\x6c\x6f\x61\x64\x54\x69\x6c\x65\x44\x61\x74\x61":function(h0,hY,T,i){var e={"\x63\x69\x69\x63\x6c":"\x65\x64\x63","\x69\x65\x64\x61\x68":ay("0x9b"),"\x6d\x6c\x6c\x65\x64":"\x65\x6c\x6d","\x65\x61\x69\x69\x65":ay("0x9c"),"\x61\x78\x68\x78\x64":"\x63\x75\x73\x74\x6f\x6d","\x61\x61\x61\x65\x6c":ay("0x9d"),"\x6d\x64\x78\x61\x64":ay("0x9e"),"\x65\x78\x65\x6d\x78":ay("0x9f"),"\x65\x63\x6d\x65\x65":ay("0xa0"),"\x65\x61\x65\x61\x64":"\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x46\x65\x61\x74\x75\x72\x65\x53\x74\x79\x6c\x65","\x78\x69\x6d\x6c\x63":function(ia,h9){return ia+h9},"\x6d\x64\x6d\x63\x61":ay("0xa1"),"\x69\x61\x64\x61\x69":"\x61\x6c\x69","\x65\x65\x78\x6d\x78":ay("0xa2"),"\x68\x64\x6d\x6d\x61":ay("0xa3"),"\x64\x6c\x65\x6c\x61":ay("0xa4"),"\x68\x65\x69\x6c\x78":"\x61\x6d\x61","\x78\x6c\x61\x68\x6d":function(ia,h9){return ia+h9},"\x61\x6c\x68\x65\x6c":"\x6c\x68\x65","\x6d\x65\x65\x65\x78":ay("0xa5"),"\x6d\x63\x61\x61\x65":"\x61\x6d\x6d","\x65\x68\x69\x6d\x6c":"\x61\x68\x63","\x65\x68\x78\x65\x61":ay("0xa6"),"\x64\x6c\x6c\x68\x61":"\x65\x6c\x61","\x61\x63\x6d\x61\x61":"\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x49\x63\x6f\x6e\x53\x65\x74\x49\x6e\x66\x6f","\x64\x65\x68\x64\x78":ay("0xa7"),"\x64\x61\x65\x78\x78":ay("0x74"),"\x63\x65\x6c\x63\x65":ay("0x61"),"\x68\x61\x61\x78\x6d":ay("0xa8"),"\x78\x6d\x78\x61\x78":ay("0xa9"),"\x63\x61\x64\x68\x69":ay("0xaa"),"\x78\x61\x65\x68\x61":ay("0xab"),"\x61\x65\x78\x61\x6c":ay("0xac"),"\x78\x6c\x63\x78\x61":function(ia,h9){return ia+h9},"\x69\x6c\x65\x6d\x64":ay("0xad"),"\x6d\x64\x68\x6c\x63":ay("0xae"),"\x6c\x63\x65\x61\x69":function(ia,h9){return ia+h9},"\x64\x65\x6d\x69\x65":function(ia,h9){return ia+h9},"\x61\x65\x65\x65\x65":ay("0xaf"),"\x64\x65\x61\x63\x78":"\x78\x65\x65"};var h8=ay("0xb0");while(h8!=="\x6d\x6c\x65\x61"){switch(h8){case e[ay("0xb1")]:if(!h6[ay("0x86")]){h8=ay("0xa0");break}h8=e[ay("0xb2")];break;case ay("0xb3"):h1[ay("0xb4")]=gf[ay("0xb5")];h8=ay("0xb6");break;case ay("0xa4"):h1[ay("0xb7")]=h5;h8=e["\x6d\x6c\x6c\x65\x64"];break;case ay("0xaf"):h6[ay("0x68")]=i;h8="\x65\x63\x61";break;case e["\x65\x61\x69\x69\x65"]:var h7=!!(h5[ay("0xb8")](e[ay("0xb9")])===0);h8=e["\x61\x61\x61\x65\x6c"];break;case ay("0xba"):if(!gf[ay("0xb5")]){h8=ay("0xbb");break}h8=e[ay("0xbc")];break;case e[ay("0xb2")]:h6[ay("0xbd")](h1);h8=e[ay("0xbe")];break;case e[ay("0xbf")]:if(!gf[e[ay("0xc0")]+h5]&&bo[e[ay("0xc1")]("\x46\x65\x61\x74\x75\x72\x65\x53\x74\x79\x6c\x65",h5)]){h8=e[ay("0xc2")];break}h8=ay("0xae");break;case ay("0xb0"):var h6=this[ay("0xc3")]();h8=e[ay("0xc4")];break;case e[ay("0xc5")]:var h5=this[ay("0x51")][ay("0xc6")]();h8=e[ay("0xc7")];break;case e["\x6d\x6c\x6c\x65\x64"]:h6[ay("0x86")]=!![];h8=ay("0x9b");break;case e[ay("0xc8")]:h1[ay("0xc9")]={"\x77\x6f\x72\x64\x53\x70\x61\x63\x65\x52\x61\x74\x69\x6f":this[ay("0x4f")],"\x74\x65\x78\x74\x53\x69\x7a\x65\x52\x61\x74\x69\x6f":this[ay("0x50")]};h8=e[ay("0xca")];break;case ay("0xad"):h6[ay("0x65")]=T;h8=ay("0x74");break;case e["\x68\x65\x69\x6c\x78"]:h1[ay("0xcb")]=gf[e[ay("0xcc")](e[ay("0xc0")],h5)];h8=e[ay("0xcd")];break;case ay("0xce"):var h4={"\x75\x72\x6c":h0,"\x74\x69\x6c\x65\x49\x6e\x66\x6f":hY,"\x74\x69\x6c\x65\x4b\x65\x79":T,"\x63\x62\x6b":i};h8=ay("0xcf");break;case"\x61\x78\x65":var h3=hZ?this["\x6d\x61\x70"][ay("0xd0")][ay("0xd1")]:![];h8=e["\x6d\x65\x65\x65\x78"];break;case ay("0xab"):gf[ay("0x54")]=JSON[ay("0xd2")](bo[ay("0xd3")]);h8=e[ay("0xd4")];break;case e[ay("0xd5")]:gf[e[ay("0xcc")](ay("0xd6"),h2)]=JSON[ay("0xd2")](bo[e[ay("0xd7")]+h2]);h8=e[ay("0xd8")];break;case e["\x61\x6c\x68\x65\x6c"]:h1[ay("0xa6")]=gf[e[ay("0xd9")]+h2];h8=ay("0xb3");break;case ay("0xcf"):this[ay("0x4a")][ay("0x5b")](h4);h8=e["\x65\x78\x65\x6d\x78"];break;case e[ay("0xda")]:var h2=h5;h8=e[ay("0xdb")];break;case e["\x64\x61\x65\x78\x78"]:var h1={"\x61\x63\x74\x69\x6f\x6e":e[ay("0xdc")],"\x75\x72\x6c":h0,"\x74\x69\x6c\x65\x49\x6e\x66\x6f":hY,"\x74\x69\x6c\x65\x4b\x65\x79":T,"\x69\x73\x54\x65\x78\x74":h3,"\x69\x73\x50\x6f\x69":hZ};h8=e[ay("0xc5")];break;case e[ay("0xc4")]:var hZ=this["\x6d\x61\x70"][ay("0xd0")][ay("0xdd")];h8=e[ay("0xde")];break;case ay("0xb6"):if(h7&&gf[ay("0x54")]){h8=ay("0xa9");break}h8="\x61\x61\x61";break;case e["\x78\x6d\x78\x61\x78"]:h1[ay("0xdf")]=gf[ay("0x54")];h8=e[ay("0xc8")];break;case e[ay("0xe0")]:if(!gf["\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x43\x75\x73\x74\x6f\x6d\x53\x74\x79\x6c\x65\x49\x6e\x66\x6f"]){h8=e["\x78\x61\x65\x68\x61"];break}h8=ay("0xe1");break;case ay("0xa7"):if(h7){h8=e["\x61\x65\x78\x61\x6c"];break}h8=ay("0xe2");break;case e[ay("0xbc")]:if(h7&&bo["\x63\x75\x73\x74\x6f\x6d\x53\x74\x79\x6c\x65\x49\x6e\x66\x6f"]){h8=ay("0xaa");break}h8=e[ay("0xd4")];break;case e[ay("0xd4")]:if(gf[e[ay("0xe3")]("\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x46\x65\x61\x74\x75\x72\x65\x53\x74\x79\x6c\x65",h5)]){h8=e[ay("0xe4")];break}h8=e["\x61\x6c\x68\x65\x6c"];break;case"\x65\x63\x61":h6[ay("0x75")]=hY;h8=e[ay("0xe5")];break;case e[ay("0xe6")]:h2=ay("0xe7");h8=ay("0xe2");break;case e[ay("0xe8")]:if(!gf[e["\x78\x6c\x63\x78\x61"]("\x73\x74\x72\x69\x6e\x67\x69\x66\x69\x65\x64\x49\x63\x6f\x6e\x53\x65\x74\x49\x6e\x66\x6f",h2)]){h8=e["\x65\x68\x69\x6d\x6c"];break}h8=e[ay("0xd8")];break;case ay("0xa1"):gf[e[ay("0xe9")](e[ay("0xc0")],h5)]=JSON[ay("0xd2")](bo[e["\x64\x65\x6d\x69\x65"](ay("0xea"),h5)]);h8=e[ay("0xe8")];break;case ay("0xa5"):h8=h6?e[ay("0xeb")]:ay("0xce");break;case e[ay("0xec")]:gf[ay("0xb5")]=JSON[ay("0xd2")](bo[ay("0xb4")]);h8=e[ay("0xbc")];break}}}};C[ay("0xed")](gf[ay("0xee")],bf);function dU(i){this.tileLayers=[];this.map=i;var e=this.config=b6[this.map.mapType];this.errorUrl=e.errorUrl;this.tileSize=e.tileSize;this.baseUnits=e.baseUnits;this.baseZoomLevel=e.zoomLevelBase;this.tileURLs=e.tileUrls;this.tilesInfoCache={};this.loadDelay=10;this._labelTextCanvas=null}bo.register(function(i){if(i._renderType!=="webgl"){return}var e=i.tileMgr=new dU(i);i.addEventListener("addtilelayer",function(hY){e.addWebGLLayer(hY.target)});i.addEventListener("removetilelayer",function(hY){e.removeWebGLLayer(hY.target)});i.on("update",function T(hY){if(i.getFeatureStyleTags().length===0&&!bo.customStyleLoaded){return}e.loadLayersData({zoomChanged:hY.changedStatus.onzoom_changed?true:false})});i.on("style_changed",function(){e.loadLayersData()})});C.extend(dU.prototype,{addWebGLLayer:function(T){this.tileLayers.push(T);T.initDrawData();if(this.tileLayers.length>1){for(var e=1;e<this.tileLayers.length;e++){if(this.tileLayers[e].isFlat){this.map.setDisplayOptions({isFlat:true});break}}}if(this.map.getFeatureStyleTags().length>0){this.loadLayersData()}else{var hY=this;this.map.loadMapStyleFiles(function(){hY.loadLayersData()})}},removeWebGLLayer:function(h0){var h1=false;for(var hZ=0,hY=this.tileLayers.length;hZ<hY;hZ++){if(h0===this.tileLayers[hZ]){h1=true;this.tileLayers.splice(hZ,1);break}}if(h1===false){return}h0.destroyDrawData();if(this.map.getFeatureStyleTags().length>0){this.loadLayersData()}if(this.tileLayers.length===1){this.map.setDisplayOptions({isFlat:false})}else{var e=false;for(var hZ=1;hZ<this.tileLayers.length;hZ++){if(this.tileLayers[hZ].isFlat){e=true;break}}this.map.setDisplayOptions({isFlat:e})}var T=new bb("onrefresh");T.source="removewebgllayer";this.map.fire(T)},getLabelTextCanvas:function(){if(!this._labelTextCanvas){this._labelTextCanvas=new v(this.map)}return this._labelTextCanvas},loadLayersData:function(i){if(this.map.suspendLoad){return}var hY=this;i=i||{};var T=!!i.zoomChanged;var e=(T===true||this.map.getTilt()>50);if(!e){if(!this.syncLoadTimer){this.syncLoadTimer=setTimeout(function(){hY._loadLayersFromCache(T);hY.syncLoadTimer=null},40)}}else{this._loadLayersFromCache(T)}if(!hY.map.viewAnimationTime){this.timer&&window.clearTimeout(this.timer)}this.timer=window.setTimeout(function(){if(hY.map.viewAnimationTime){if(new Date().getTime()-hY.map.viewAnimationTime<1000){return}hY.map.viewAnimationTime=new Date().getTime()}var h0=hY.tileLayers.length;hY.tilesInfoCache={};for(var h1=0;h1<h0;h1++){var h3=hY.tileLayers[h1];var h2=h3.tileType;var hZ=null;if(hY.tilesInfoCache[h2.getName()]){hZ=hY.tilesInfoCache[h2.getName()]}else{hZ=hY.calcTilesInfo(h2,h3);hY.tilesInfoCache[h2.getName()]=hZ}h3.loadLayerData(hZ,false,T)}hY.timer=null},this.loadDelay);if((gb()||C.Browser.ie)&&T){this.loadDelay=200}else{this.loadDelay=80}},_loadLayersFromCache:function(hZ){this.map._featureMgr.clearData();var h2=this.tileLayers;h2.sort(function(h3,i){return h3.zIndex-i.zIndex>0});var T=h2.length;this.tilesInfoCache={};for(var hY=0;hY<T;hY++){var h1=h2[hY];var h0=h1.tileType;var e=null;if(this.tilesInfoCache[h0.getName()]){e=this.tilesInfoCache[h0.getName()]}else{e=this.calcTilesInfo(h0,h1);this.tilesInfoCache[h0.getName()]=e}h1.loadLayerData(e,true,hZ)}},calcTilesInfo:function(ib,iG){var ir=this.map;var iy=ir.getMapType();var it=b6[iy];var ik=ir.getZoom();var e=Math.floor(ik);var h1=ib.getDataZoom(ik);var iL=ib.getName();h1=fL(h1,it.minDataZoom,it.maxDataZoom);var iB=e;if(ib._name==="web"||ib._name==="xyz"){iB=h1}else{if(iB<3){iB=3}}var ip=ib.getTileSize(ik);var h0=ib.getBaseTileSize(ik);var im=ir.getBoundsIn();var ih=ib.getMercatorSize(ik,h1);var ig;var iz;var io;var iD;var iu=ir.getCenterIn();if(iy!==BMAP_SATELLITE_MAP){iu=d7.calcLoopCenterPoint(iu)}if(iL==="xyz"){return this.calcXYZTilesInfo(iu,im,h1,iL,iG,ir)}var il=Math.floor(iu.lng/ih);var h3=Math.floor(iu.lat/ih);var iw=0;var hY=0;if(iL!=="web"){im=d7.calcLoopMapBounds(im,ir.getCenter())}if(im.ne.lng>d7._mc180X){var h9=d7.getSpaceDistanceInPixel(h1);iw=Math.ceil(h9/h0)}if(im.sw.lng<d7._mcM180X){var h9=d7.getSpaceDistanceInPixel(h1);hY=Math.ceil(h9/h0)}if(im.ne.lat>19505879.362428114||im.sw.lat<-15949096.637571886){im.ne.lat=19505879.362428114;im.sw.lat=-15949096.637571886}var h5=[Math.floor(im.sw.lng/ih)-hY,Math.floor(im.sw.lat/ih)];var iJ=[Math.floor(im.ne.lng/ih)+iw,Math.floor(im.ne.lat/ih)];ig=h5[0];iz=iJ[0]+1;io=h5[1];iD=iJ[1]+1;var ia=[];for(var h7=ig;h7<iz;h7++){if(d7.isTileBlank(h7,h1,h0)===true){continue}for(var ic=io;ic<iD;ic++){var iF=false;var h6=256;if(iL==="web"){var iA=d7.calcLoopParam(h7,h1);var iI={col:iA.col,row:ic,baseTileSize:256,zoom:h1};var iq=eq.prototype.tileToBound(iI,ir.getCenter());if(iq.LL.sw.lng*iq.LL.ne.lng<0&&Math.floor(iq.LL.ne.lng)<0){iF=true;h6=d7.pixelWidth(iq.MC.sw.lng,ir.getZoom())}}var h8={col:h7,row:ic,zoom:h1,useZoom:iB,tileTypeName:iL,loopOffsetX:0,tileSize:ip,baseTileSize:h0,mercatorSize:ih,combine:iF,dataIndex:h6};ia.push(h8);var ix="id_"+h7+"_"+ic+"_"+h1;ia[ix]=true}}if(iy!==BMAP_SATELLITE_MAP){ia=d7.calcLoopTiles(ia,h1,h0,ih)}if(h1===3){for(var iH=0,iE=ia.length;iH<iE;iH++){var h7=ia[iH].col;var ic=ia[iH].row;var iA=d7.calcLoopParam(h7,h1);var h2=iA.T;var ii=h7>=0?h7-h2:h7+h2;var ij="id_"+ii+"_"+ic+"_"+h1;if(!ia[ij]){var h8={col:ii,row:ic,zoom:h1,useZoom:iB,loopOffsetX:0,tileSize:ip,baseTileSize:h0,mercatorSize:ih,combine:false};ia.push(h8);ia[ij]=true}}}if(this.map._tilt>0){for(var iH=0;iH<ia.length;iH++){var h4=ia[iH];var iC=h4.col;var iK=h4.row;var iv=[];iv.minX=iC*ih;iv.maxX=(iC+1)*ih;iv.minY=iK*ih;iv.maxY=(iK+1)*ih;var hZ=new hz(0,0);hZ.lng=(iv.minX+iv.maxX)/2;hZ.lat=(iv.minY+iv.maxY)/2;var ie=ir.pointToPixelIn(hZ);if(ie.x>0&&ie.x<this.map.width&&ie.y>0&&ie.y<this.map.height){continue}if(iv.minX<iu.lng&&iv.maxX>iu.lng&&iv.minY<iu.lat&&iv.maxY>iu.lat){continue}if(!this.ifTileInMapBounds(iv,im,iC,iK)){ia.splice(iH,1);iH--}}}ia.sort((function(i){return function(T,id){return((0.4*Math.abs(T.col-i[0])+0.6*Math.abs(T.row-i[1]))-(0.4*Math.abs(id.col-i[0])+0.6*Math.abs(id.row-i[1])))}})([il,h3]));ia.zoom=h1;ia.tileTypeName=iL;return ia},calcXYZTilesInfo:function(h9,h2,h8,ie,h1,ii){var h4=ii.width;var ig=ii.height;var h3=Math.floor(h8);var hY=ey.transformBDmcPoint(h9);if(!hY){return[]}var h5=null;if(h1.transform.source==="BD09MC"){var hZ=ey.getRangeExtent(hY,h4,ig,h3,h1.transform);h5=[hZ.minX,hZ.minY,hZ.maxX,hZ.maxY]}else{var h0=ey.transformBDmcPoint(h2.ne);var h7=ey.transformBDmcPoint(h2.sw);h5=ey.getLoopBox(hY,[h7[0],h7[1],h0[0],h0[1]])}if(!h5){return[]}if(h1.transform.source==="BD09MC"){h3+=1}var T=ey.getTileRangeForExtentFactory(h5,h3,h1.transform);var e=[];var ij=ey.getResolutionScale(h3,h1.transform);for(var ic=T.minX;ic<=T.maxX;ic++){for(var ia=T.minY;ia<=T.maxY;ia++){var ib={col:ic,row:ia,zoom:h3,useZoom:h3,tileTypeName:ie,loopOffsetX:0,tileSize:256*ij,transform:h1.transform,combine:false,dataIndex:0};e.push(ib);var h6="id_"+ic+"_"+ia+"_"+h3;e[h6]=true}}var ih=ey.getTileCoordForCoordAndZ(hY,h3);e.sort((function(i){return function(id,ik){return((0.4*Math.abs(id.col-i[0])+0.6*Math.abs(id.row-i[1]))-(0.4*Math.abs(ik.col-i[0])+0.6*Math.abs(ik.row-i[1])))}})([ih[1],ih[2]]));e.zoom=h3;e.tileTypeName=ie;return e},getCurrentViewTilesInfo:function(i){var e=this.tilesInfoCache[i.getName()];if(!e){return this.calcTilesInfo(i)}return e},ifTileInMapBounds:function(e,h0,T,hZ){var i=h0.normalizedBottomLeft;var ib=h0.normalizedTopRight;var h3=h0.normalizedTopLeft;var h1=h0.normalizedBottomRight;var hY=false;var ia=new hz(e.minX,e.minY);var h7=new hz(e.maxX,e.maxY);var h2=new hz(h7.lng,ia.lat);var h8=new hz(ia.lng,h7.lat);var h5=[h8,h7,h2,ia];for(var h9=0,h4=h5.length;h9<h4;h9++){var h6=h9+1;if(h6===h4){h6=0}var ic=h9;var id=gD(h5[h6],h5[ic],h3,i);if(id){hY=true;break}id=gD(h5[h6],h5[ic],h1,ib);if(id){hY=true;break}id=gD(h5[h6],h5[ic],ib,h3);if(id){hY=true;break}id=gD(h5[h6],h5[ic],i,h1);if(id){hY=true;break}}return hY},getTileLayer:function(hZ){for(var hY=0,e=this.tileLayers.length;hY<e;hY++){var T=this.tileLayers[hY];if(T.mapType===hZ){return T}}return null},getZoomState:function(i){var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState}});function aR(e){this._map=e;this._spotsId=null;this._init()}aR.prototype._init=function(){var e=this._map;e.addEventListener("onspotsdataready",function(T){var i=T.spots;if(this._spotsId){e.removeSpots(this._spotsId)}this._spotsId=e.addSpots(i)})};bo.register(function(e){if(!e.config.enableIconClick){return}e._mapIcon=new aR(e)});function aU(e){this._indoorData={};this._map=e;this.currentUid=null;this.currentFloor=null;this._indoorControl=null;this.enterMethod=null;this.showMask=false;this._isMobile=gb();this._autoEnterZoom=19;if(this._isMobile){this._autoEnterZoom=17}this._init(e);window._indoorMgr=this}aU.prototype._init=function(i){var e=this;i.on("indoor_status_changed",function(h1){var T=h1.uid;var hZ=h1.floor;if(T===null){T=e.currentUid;if(e._indoorData[T]){hZ=e._indoorData[T].defaultFloor}if(e._indoorControl){e._indoorControl.hide()}e.currentUid=null;e.currentFloor=null;e.enterMethod=null}else{if(e._indoorData[T]){var h0=e._indoorData[T];hZ=(typeof hZ==="number")?hZ:h0.defaultFloor;if(!e._indoorControl){if(i.config.showControls&&i._displayOptions.indoor){e._indoorControl=new gH(i,h0)}}else{e._indoorControl.setInfo(h0);e._indoorControl.show()}e.currentUid=T;e.currentFloor=hZ}}if(!e._indoorData||!e._indoorData[T]||e._indoorData[T].currentFloor===hZ){this.fire(new bb("onrefresh"));return}var hY=new bb("onindoor_data_refresh");hY.uid=T;hY.floor=hZ;hY.tileKey=e._indoorData[T].tileKey;e._indoorData[T].currentFloor=hZ;e.currentFloor=hZ;this.fire(hY)});i.on("spotclick",function(hY){var T=null;if(hY.curAreaSpot&&this.areaSpots[hY.curAreaSpot]){T=this.areaSpots[hY.curAreaSpot].userData.uid}if(T===e.currentUid){if(hY.curAreaSpot){e.enterMethod="byClick"}return}if(T===null){if(e.currentUid&&e.enterMethod==="byClick"){i.showIndoor(null);e.enterMethod=null}}else{e.enterMethod="byClick";if(e.currentUid){i.showIndoor(e.currentUid,e._indoorData[e.currentUid].defaultFloor)}i.showIndoor(T,e._indoorData[T].defaultFloor)}});i.on("moveend",function(){if(this.getZoom()>=e._autoEnterZoom){e._checkIndoorByMove()}});i.on("zoomend",function(){if(this.getZoom()>=e._autoEnterZoom){e._checkIndoorByMove()}else{if(e.enterMethod!=="byClick"&&e.currentUid!==null){this.showIndoor(null)}}})};aU.prototype._checkIndoorByMove=function(){var T=this._map;var h4=T.getSize();var h9={x:h4.width/2,y:h4.height/2};var h8=Math.max(h4.width,h4.height);var ia=[];for(var h5 in this._indoorData){var e=this._indoorData[h5].center;var hY=T.pointToPixelIn(new bo.Point(e[0],e[1]));var h1=g2(h9,hY);ia.push({uid:h5,distance:h1})}if(ia.length===0){return}ia.sort(function(ib,i){return ib.distance-i.distance});var h0=ia[0];var h6=T.getCenterIn();var hZ=false;for(var h3=0;h3<this._indoorData[h0.uid].contour.length;h3++){if(dg([h6.lng,h6.lat],this._indoorData[h0.uid].contour[h3])){hZ=true;break}}if(hZ===false&&h0.uid==="e96b44200baa3b4082288acc"){var h2=this._indoorData[h0.uid].boundsMin;var h7=this._indoorData[h0.uid].boundsMax;if(h6.lng>h2[0]&&h6.lat>h2[1]&&h6.lng<h7[0]&&h6.lat<h7[1]){hZ=true}}if(hZ){if(this.enterMethod!=="byClick"){if(this.currentUid!==null&&this.currentUid!==h0.uid){this._map.showIndoor(this.currentUid,this._indoorData[this.currentUid].defaultFloor)}if(this.currentUid!==h0.uid){this._map.showIndoor(h0.uid,this._indoorData[h0.uid].defaultFloor)}this.enterMethod="byMove"}}else{if(this.enterMethod!=="byClick"){this._map.showIndoor(null)}}};aU.prototype.setData=function(hY){if(hY===null){return}for(var T in hY){if(T==="tileInfo"){continue}var hZ=hY[T].tileKey;if(this._indoorData[T]){if(!this._indoorData[T][hZ]){this._indoorData[T].tileKeys.push(hZ);this._indoorData[T][hZ]=true}}else{this._indoorData[T]=hY[T];this._indoorData[T].tileKeys=[hY[T].tileKey];this._indoorData[T][hZ]=true;for(var e=0;e<this._indoorData[T].contour.length;e++){this._map.addAreaSpot(this._indoorData[T].contour[e],{id:T+e,userData:{uid:T}})}}}if(this._map.getZoom()>=this._autoEnterZoom){this._checkIndoorByMove()}};aU.prototype.removeData=function(T,hZ){if(!this._indoorData[T]){return}var hY=this._indoorData[T];for(var e=0;e<hY.tileKeys.length;e++){if(hY.tileKeys[e]===hZ){hY.tileKeys.splice(e,1);break}}delete hY[hZ];if(hY.tileKeys.length===0){delete this._indoorData[T]}};aU.prototype.getIndoorData=function(e){return this._indoorData[e]||null};aU.prototype.getData=function(){return this._indoorData};bo.register(function(e){e._indoorMgr=new aU(e)});var eo=(function(){var hY={};var h7={};var h3={};function h5(h9){if(Object.prototype.toString.call(h9)==="[object Object]"){for(var h8 in h9){return false}return true}else{return false}}function h4(ig,ih,ik,ic,ij){var h8=h8||null;ic=ic||h8;var ia;if(ic){ia=h6(ig,ih,ik,ic)}else{ia=T(ig,ih,ik,ij)}var ie=ia.drawId;var h9=ia.style;var ii=ia.styleUpdate;var il=[];if(!ie){return il}for(var ib=0;ib<ie.length;ib++){var id=ii[ie[ib]]||h9[ie[ib]];if(id){switch(ih){case"polygon":id=hZ(id,ig);break;case"line":id=h2(id,ig);break;case"pointText":id=h0(id,ig);break;case"point":id=e(id,ig);break;case"polygon3d":id=h1(id,ig);break}if(id){id.did=ie[ib];il[il.length]=id}}}return il}function h6(h9,ib,ic,h8){var ia=h8[2];switch(ib){case"point":ia=ia[0];break;case"pointText":ia=ia[1];break;case"line":ia=ia[3];break;case"polygon":ia=ia[4];break;case"polygon3d":ia=ia[5];break}var ie=ic-1;if(ib==="line"&&ic===12){ie=ic}var ig=h8[1][ie][0];var id=ig[h9];if(!id){if(ib==="point"||ib==="pointText"){ig=h8[1][ic][0];id=ig[h9]}}return{drawId:id,style:ia,styleUpdate:[]}}function T(ic,id,ih,ig){if(!ig){return{drawId:null,style:[],styleUpdate:[]}}var ie;var ia=ig.baseFs;if(h5(ig.zoomRegion)){ie=ig.StyleBody||[]}else{ie=ig.zoomStyleBody[ih]||[]}var h9=ia[2];switch(id){case"point":h9=h9[0];ie=ie[0]||{};break;case"pointText":h9=h9[1];ie=ie[1]||{};break;case"line":h9=h9[3];ie=ie[3]||{};break;case"polygon":h9=h9[4];ie=ie[4]||{};break;case"polygon3d":h9=h9[5];ie=ie[5]||{};break}var h8=ia[1][ih-1][0];var ib=h8[ic];return{drawId:ib,style:h9,styleUpdate:ie}}function h0(h9,h8){if(!h9||h9.length===0){return null}return{sid:h8,fontRgba:i(h9[0]),haloRgba:i(h9[1]),backRgba:i(h9[2]),fontSize:h9[3],haloSize:h9[4],fontWeight:h9[5],fontStyle:h9[6],density:h9[7]}}function e(h9,h8){return{sid:h8,rank:h9[0],ucflag:h9[1],icon:h9[2],iconType:h9[3],nineGG:h9[4],density:h9[5],zoom:h9[6]}}function h2(h9,h8){return{sid:h8,borderRgba:i(h9[0]),fillRgba:i(h9[1]),borderWidth:h9[2],fillWidth:h9[3],borderCap:h9[4],fillCap:h9[5],haveBorderLine:h9[6],haveBorderTexture:h9[7],haveFillTexture:h9[8],isUseBorderRgba:h9[9],isUseFillRgba:h9[10],borderTexture:h9[11],fillTexture:h9[12],borderTextureType:h9[13],fillTextureType:h9[14],isRealWidth:h9[15],haveArrow:h9[16],needRound:h9[17],realBorderWidth:h9[18]}}function hZ(h9,h8){return{sid:h8,fillRgba:i(h9[0]),borderRgba:i(h9[1]),borderWidth:h9[2],borderTexture:h9[3],borderTextureType:h9[4],waterStyle:h9[5],haloStyle:h9[6],textureStyle:h9[7],thickRgba:i(h9[8])}}function h1(h9,h8){return{sid:h8,filter:h9[0],ratio:h9[1],haveBorder:h9[2],borderWidth:h9[3],borderRgba:i(h9[4]),fillTop:i(h9[5]),fillSide:i(h9[6]),polyTexture:h9[7]}}function i(id){var ic=id;if(h3[ic]){return h3[ic]}id=id>>>0;var ib=(id)&255;var ia=(id>>8)&255;var h8=(id>>16)&255;var h9=(id>>24)&255;h3[ic]=[ib,ia,h8,h9];return h3[ic]}return{getStyleFromCache:function(ig,ia,id,ie,h9,ic,h8){ig=ig||"default";var ib=ig+"-"+ia+"-"+id+"-"+ie;if(ic){ib+="-indoor"}if(h9){if(!h7[ib]){h7[ib]=h4(ia,id,ie,h9)}return h7[ib]}if(!hY[ib]){hY[ib]=h4(ia,id,ie,h9,h8)}return hY[ib]}}})();bo.register(function(i){var e=new dG(i)});function dG(e){e.container.appendChild(this.render());this.bind(e)}dG.prototype.render=function(){var i=document.createElement("div");i.className="click-ripple-container";var e=document.createElement("div");e.className="click-ripple";i.appendChild(e);this._div=i;this._ripple=e;return i};dG.prototype.bind=function(i){var e=this;i.addEventListener("spotclick",function(T){if(!T.spots||T.spots.length===0){return}e._div.style.left=T.pixel.x+"px";e._div.style.top=T.pixel.y+"px";C.ac(e._ripple,"ripple-playing")});C.on(e._ripple,"transitionend",function(){C.rc(e._ripple,"ripple-playing")})};function f7(e){eg.call(this);if(!e){return}this._opts={};this._map=e;this._maxLat=84.6;this._minLat=-80.6;this._maxLatMC=eq.convertLL2MC(new c4(this._maxLat,0)).lat;this._minLatMC=eq.convertLL2MC(new c4(this._minLat,0)).lat}f7.inherits(eg,"ToolbarItem");C.extend(f7.prototype,{open:function(){if(this._isOpen==true){return true}if(this._map._toolInUse){return false}this._map._toolInUse=true;this._isOpen=true;return true},close:function(){if(!this._isOpen){return}this._map._toolInUse=false;this._isOpen=false},_checkStr:function(e){if(!e){return""}return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}});function gR(T,i){f7.call(this,T);i=i||{};this._opts=C.extend(C.extend(this._opts||{},{autoClear:false,tips:"测距",followText:"单击确定起点，双击结束绘制",unit:"metric",showResult:true,lineColor:"blue",lineStroke:2,opacity:1,lineStyle:"solid",cursor:e8.distCursor,styleCodes:{lnCode:0,spCode:0,slCode:0,tlCode:0},enableMassClear:true}),i);if(this._opts.showResult===false){if(typeof i.tips==="undefined"){this._opts.tips="绘制折线"}if(!i.cursor){this._opts.cursor="crosshair"}}if(this._opts.lineStroke<=0){this._opts.lineStroke=2}if(this._opts.opacity>1){this._opts.opacity=1}else{if(this._opts.opacity<0){this._opts.opacity=0}}if(this._opts.lineStyle!=="solid"&&this._opts.lineStyle!=="dashed"){this._opts.lineStyle="solid"}this._checked=false;this._drawing=null;this.followTitle=null;this._totalDis={};this._points=[];this._paths=[];this._dots=[];this._segDistance=[];this._overlays=[];this._units={metric:{name:"metric",conv:1,incon:1000,u1:"米",u2:"公里"},us:{name:"us",conv:3.2808,incon:5279.856,u1:"英尺",u2:"英里"}};if(!this._units[this._opts.unit]){this._opts.unit="metric"}this._dLineColor="#ff6319";this._dLineStroke=3;this._dOpacity=0.8;this._dLineStyle="solid";this._dCursor=e8.distCursor;if(this._opts.showResult){this._opts.followText="单击确定起点"}this._followTextM="单击确定地点，双击结束";this._sectionMarkerTip="单击可删除此点，拖拽可调整位置";this._movingTimerId=null;if(this._opts.showResult){this.text="测距"}else{this.text="绘线"}this._isOpen=false;var e=this;ed.load("tools",function(){e._draw()})}gR.inherits(f7,"PolylineTItem");C.extend(gR.prototype,{setLineColor:function(e){this._opts.lineColor=e},setLineStroke:function(e){if(Math.round(e)>0){this._opts.lineStroke=Math.round(e)}},setOpacity:function(e){if(e>=0&&e<=1){this._opts.opacity=e}},setLineStyle:function(e){if(e==="solid"||e==="dashed"){this._opts.lineStyle=e}},clear:function(){for(var T=0,e=this._overlays.length;T<e;T++){if(this._overlays[T]){this._map.removeOverlay(this._overlays[T])}}this._overlays.length=0;for(var T=0,e=this._dots.length;T<e;T++){if(this._dots[T]&&this._dots[T].parentNode){this._dots[T].parentNode.removeChild(this._dots[T])}}this._dots.length=0},setCursor:function(e){if(this._opts.showResult===true){return}this._opts.cursor=e},getCursor:function(){if(this._opts.showResult===true){return this._dCursor}var e=this._opts.cursor.match(/^url\((.+)\)(,.*)?/);if(e!==null){return e[1]}else{return this._opts.cursor}},showResult:function(e){this._opts.showResult=!!e}});function cu(){var hZ=3;var h6=256;var hY=Math.pow(2,18-hZ)*h6;var h7=2;var h5=(h7+1)*hY;var T=eq.convertLL2MC(new hz(180,0));var h3=T.lng;var h1=h5-h3;var h4=-3;var e=h4*hY;var h0=eq.convertLL2MC(new hz(-180,0));var h2=h0.lng;var i=h2-e;this._validPixels=h3/Math.pow(2,18-hZ);this._mc180X=h3;this._mcM180X=h2;this._loopOffset=h1+i;this._mcTSpan=h3-h2;this._spaceDistance=h1;this._mSpaceDistance=i}cu.prototype={calcLoopParam:function(hY,i,h5){h5=h5||256;var h2=0;var hZ=3;var h1=6;var h0=h1*Math.pow(2,(i-hZ))*256/h5;var h4=h0/2-1;var h3=-h0/2;while(hY>h4){hY-=h0;h2-=this._loopOffset}while(hY<h3){hY+=h0;h2+=this._loopOffset}var e=h2;h2=Math.round(h2/Math.pow(2,18-i));return{offsetX:h2,geoOffsetX:e,col:hY,T:h0,maxCol:h4,minCol:h3}},calcLoopCenterPoint:function(i){var e=i.lng;while(e>this._mc180X){e-=this._mcTSpan}while(e<this._mcM180X){e+=this._mcTSpan}i.lng=e;return i},calcLoopMapBounds:function(T,hY){var i=hY||T.getCenter();var e=T.sw.lng;var hZ=T.ne.lng;while(i.lng>this._mc180X){i.lng-=this._mcTSpan;e-=this._mcTSpan;hZ-=this._mcTSpan}while(i.lng<this._mcM180X){i.lng+=this._mcTSpan;e+=this._mcTSpan;hZ+=this._mcTSpan}T.sw.lng=e;T.ne.lng=hZ;if(T.pointBottomLeft){T.pointBottomLeft=this.calcLoopCenterPoint(T.pointBottomLeft);T.pointTopLeft=this.calcLoopCenterPoint(T.pointTopLeft);T.pointTopRight=this.calcLoopCenterPoint(T.pointTopRight);T.pointBottomRight=this.calcLoopCenterPoint(T.pointBottomRight)}return T},calcLoopTiles:function(h6,e,ia,h3){ia=ia||256;var hZ=h3||Math.pow(2,18-e)*ia;var h5=Math.floor(this._mc180X/hZ);var h1=Math.floor(this._mcM180X/hZ);var h7=Math.floor(this._loopOffset/hZ);var h8=[];for(var h2=0;h2<h6.length;h2++){var h9=h6[h2];var hY=h9[0];var ib=h9[1];if(hY>=h5){var h4=hY+h7;if(this.isTileBlank(h4,e,ia)===true){continue}var T="id_"+h4+"_"+ib+"_"+e;if(!h6[T]){h6[T]=true;h8.push([h4,ib,e,0])}}else{if(hY<=h1){var h4=hY-h7;if(this.isTileBlank(h4,e,ia)===true){continue}var T="id_"+h4+"_"+ib+"_"+e;if(!h6[T]){h6[T]=true;h8.push([h4,ib,e,0])}}}}for(var h2=0,h0=h8.length;h2<h0;h2++){h6.push(h8[h2])}for(var h2=h6.length-1;h2>=0;h2--){var hY=h6[h2][0];if(this.isTileBlank(hY,e,ia)){h6.splice(h2,1)}}return h6},isTileBlank:function(T,hZ,e){var h0=Math.pow(2,hZ-3);var i=Math.round(this._validPixels*h0);var hY=6*h0*256/e;while(T>hY/2-1){T-=hY}while(T<-(hY/2)){T+=hY}if(T>0&&T*e>i){return true}if(T<0&&Math.abs((T+1)*e)>i){return true}return false},isAddWidth:function(e,i){return e<this._mcM180X||i>this._mc180X},pixelWidth:function(e,i){if(e<0){e=-e}return Math.abs(e-this._mc180X)/(Math.pow(2,18-i))},getSpaceDistanceInPixel:function(i){var e=Math.round((this._spaceDistance+this._mSpaceDistance)/Math.pow(2,18-i));return e}};var d7=new cu();var ce=(function(){var i=true;var hZ=256;var e=true;var h1=aD("ditu","normalTraffic");var hY=h1.udt;var h2="://its.map.baidu.com/traffic/";var h0=[[2,"79,210,125,1",3,2,0,[],0,0],[2,"79,210,125,1",3,2,0,[],0,0],[2,"79,210,125,1",4,2,0,[],0,0],[2,"79,210,125,1",5,2,0,[],0,0],[2,"79,210,125,1",6,2,0,[],0,0],[2,"255,208,69,1",3,2,0,[],0,0],[2,"255,208,69,1",3,2,0,[],0,0],[2,"255,208,69,1",4,2,0,[],0,0],[2,"255,208,69,1",5,2,0,[],0,0],[2,"255,208,69,1",6,2,0,[],0,0],[2,"232,14,14,1",3,2,0,[],0,0],[2,"232,14,14,1",3,2,0,[],0,0],[2,"232,14,14,1",4,2,0,[],0,0],[2,"232,14,14,1",5,2,0,[],0,0],[2,"232,14,14,1",6,2,0,[],0,0],[2,"181,0,0,1",3,2,0,[],0,0],[2,"181,0,0,1",3,2,0,[],0,0],[2,"181,0,0,1",4,2,0,[],0,0],[2,"181,0,0,1",5,2,0,[],0,0],[2,"181,0,0,1",6,2,0,[],0,0],[2,"255,255,255,1",4,0,0,[],0,0],[2,"255,255,255,1",5.5,0,0,[],0,0],[2,"255,255,255,1",7,0,0,[],0,0],[2,"255,255,255,1",8.5,0,0,[],0,0],[2,"255,255,255,1",10,0,0,[],0,0]];var T=new cR({transparentPng:true,dataType:2,cacheSize:256,clipTile:true});T.zIndex=2;T.getTilesUrl=function(h5,h6){if(!h5||h6<7){return null}var h4=h5.x;var h7=h5.y;var h3=h2+"TrafficTileService?level="+h6+"&x="+h4+"&y="+h7+"&time="+(+new Date());if(this.map.getRenderType()==="webgl"){h3=h2+"?qt=vtraffic&z="+h6+"&x="+h4+"&y="+h7+"&udt="+hY}return h3};T.setColors=function(h3){for(var h6=0;h6<h0.length;h6++){var h5=Math.floor(h6/5);var h4=h3[h5];if(h4){if(Object.prototype.toString.call(h4)==="[object String]"){h4=g6.parseCSSColor(h4)}h0[h6][1]=[h4[0],h4[1],h4[2],h4[3]/255].join(",")}}};T.setEdge=function(h3){e=!!h3};T.processData=function(h6){var ia=h6.content;var h8=10;if(typeof h6.precision==="number"){h8=h6.precision*10}var ii={road:[[],[]]};if(!ia){return ii}var ig=ia.tf;if(!ig){return ii}for(var h7=0;h7<ig.length;h7++){var ih=ig[h7][1];var ie=[];var ic=0;var ib=0;var id=h0[ig[h7][3]];for(var h5=0,h3=ih.length;h5<h3/2;h5++){ic+=ih[h5*2]/h8;ib+=ih[h5*2+1]/h8;ie.push(ic,256-ib)}var h4=id[1].split(",");h4[3]=h4[3]*255;var h9=id[2]/2;if(e){ii.road[0].push([ie,1,2,[255,255,255,255],h9+2])}ii.road[1].push([ie,1,2,h4,h9])}return ii};return T})();function g8(e){cV.call(this);e=e||{};this._opts={};this._opts.districts=e.name||"";this._opts.kind=e.kind||0;this._config={};this._config.strokeColor=e.strokeColor||"#00f";this._config.strokeOpacity=typeof e.strokeOpacity==="number"?e.strokeOpacity:1;fL(this._config.strokeOpacity,0,1);this._config.fillColor=e.fillColor||"#ff0";this._config.fillOpacity=typeof e.fillOpacity==="number"?e.fillOpacity:0.6;fL(this._config.fillOpacity,0,1);this._config.hoverColor=e.hoverColor||"#6f6cd8";this.disOverlays=[];this.eventAndCallback={};var i=this;ed.load("layer",function(){i._asyncSearch()})}g8.inherits(eg,"DistrictLayer");C.extend(g8.prototype,{initialize:function(e){this._map=e;this.addDistrict()},removeDistrict:function(i,e){this._map=i;this.deleteDistrict(e)},toString:function(){return"DistrictLayer"}});var ff=function(i){var i=i||{};const hZ=i.transform||{source:"EPSG3857",target:"BD09MC"};const hY=i.tileUrlTemplate||"";const h2=i.xTemplate||function(h9,ib,ia){return h9};const h6=i.yTemplate||(i.tms?function(h9,ib,ia){return Math.pow(2,ia)-ib-1}:function(h9,ib,ia){return ib});const h1=i.zTemplate||function(h9,ib,ia){return ia};const h5=i.bTemplate||function(h9,ic,ib){const ia=ey.getTileRangeExtent([ib,h9,ic]);return ia.minX+","+ia.minY+","+ia.maxX+","+ia.maxY};var h7=i.extent||[];const h0=i.extentCRSIsWGS84||false;var T=i.minZoom||0;var h4=i.maxZoom||23;var h3=true;var h8=new cR({transform:hZ,transparentPng:h3,dataType:1,tileTypeName:"xyz",cacheSize:256,customLayer:true,clipTile:false,boundary:i.boundary||false,useThumbData:i.useThumbData||false});h8.zIndex=2;(h7.length===4)&&h0&&(h7=ey.fromEPSG4326(h7));h8.getTilesUrl=function(ia,ih,ie){if(!ia||ih<0||ih<T||ih>h4){h8.tileCache.clear();return null}if(hZ.source!=="BD09MC"){ia.x=ey.getTilesLoop(ih,ia.x)}var ig=ey.getTileRangeExtent([ih,ia.x,ia.y]);var id=e([ig.minX,ig.minY,ig.maxX,ig.maxY]);if(!id){return null}var ib="";if(hY){ib=hY;var ic=/[^\{}]*\{(.*)\}[^\}]*/;ib.match(ic);var h9=[];if(RegExp.$1){h9=RegExp.$1.split(",")}ib=ib.replace(/\{(.*)\}/,h9[(ia.x+ia.y)%h9.length]);ib=ib.replace(/\[x\]/gi,h2(ia.x,ia.y,ih));ib=ib.replace(/\[y\]/gi,h6(ia.x,ia.y,ih));ib=ib.replace(/\[z\]/gi,h1(ia.x,ia.y,ih));ib=ib.replace(/\[b\]/gi,h5(ia.x,ia.y,ih))}else{return null}return ib};function e(h9){if(h7&&h7 instanceof Array&&h7.length===4){if((h7[0]<=h9[2]&&h7[1]<=h9[3])&&(h7[2]>=h9[0]&&h7[3]>=h9[1])){return true}else{return false}}return true}return h8};var aV=function(e){var e=e||{};this.inputCRS=e.inputCRS||"EPSG3857";this.outCRS=e.outCRS||"EPSG3857";this.minZoom=e.minZoom||3;this.maxZoom=e.maxZoom||19;this.retry=e.retry||false;this.retryTime=e.retryTime||600;this.useThumbData=e.useThumbData||true;this.lastZoom=3;this.cacheSize=e.cacheSize||128;this.tileType=cL.getInstance("web");this._mapCenter={};this._featureMgr=[[],[],[]];this._gridRefs={row:{},col:{}};this.tileCache=new e4(this.cacheSize,{clearCallback:function(i){}})};aV.inherits(eg,"BaiduLayer");C.extend(aV.prototype,{fetch:function(i,hY,hZ){var hY=Math.ceil(hY)||3;var i=i||[];if(i.length!==4||hY>19){hZ(null);return}var e=this.getZoomState(hY);var T=this.calCoord(i,hY,e);this.curViewTilesInfo=this.calTilesOrders(T.sw,T.ne,hY);this.clearData();this.clearRefs();this.loadLayerData(this.curViewTilesInfo,e,true,hZ)},calCoord:function(T,hY,i){if(T.length!==4){return}var e=gcoord.transform([T[0],T[1]],gcoord[this.inputCRS],gcoord.BD09MC);var hZ=gcoord.transform([T[2],T[3]],gcoord[this.inputCRS],gcoord.BD09MC);if(hZ[1]>19505879.362428114||e[1]<-15949096.637571886){hZ[1]=19505879.362428114;e[1]=-15949096.637571886}this._mapCenter[hY]=new hz((e[0]+hZ[0])/2,(e[1]+hZ[1])/2);return{sw:e,ne:hZ}},calTilesOrders:function(h3,h9,h5){var h6=this.tileType.getMercatorSize(h5,h5);var h1=[Math.floor(h3[0]/h6),Math.floor(h3[1]/h6)];var i=[Math.floor(h9[0]/h6),Math.floor(h9[1]/h6)];var h2=h1[0]-1;var h0=i[0]+2;var hZ=h1[1]-1;var h8=i[1]+2;var h4=[];for(var hY=h2;hY<h0;hY++){for(var h7=hZ;h7<h8;h7++){var T={col:hY,row:h7,zoom:h5,useZoom:h5,tileTypeName:"web",loopOffsetX:0,tileSize:256,baseTileSize:256,mercatorSize:h6,combine:false,dataIndex:256};h4.push(T);var e="id_"+hY+"_"+h7+"_"+h5;h4[e]=true}}h4.sort((function(ia){return function(ib,ic){return((0.4*Math.abs(ib.col-ia[0])+0.6*Math.abs(ib.row-ia[1]))-(0.4*Math.abs(ic.col-ia[0])+0.6*Math.abs(ic.row-ia[1])))}})([(h2+h0)/2,(hZ+h8)/2]));h4.zoom=h5;h4.tileTypeName="web";return h4},getZoomState:function(i){var e=i-this.lastZoom;if(e>0){this.zoomState=1}else{if(e<0){this.zoomState=-1}}this.lastZoom=i;return this.zoomState||0},loadLayerData:function(h5,hY,hZ,h4){this.thumbCache={};if(hZ){for(var h2=0,h0=h5.length;h2<h0;h2++){var T=h5[h2];var h1=this.getTileKey(T);var e=this.tileCache.getData(h1);if(e&&e.status==="ready"){e.key=h1;this.setData(e,2)}else{if(this.useThumbData){hY===1&&this.setThumbData(T.col,T.row,T.zoom,T.useZoom,hY)}}}this.calOutData(h4)}for(var h2=0,h0=h5.length;h2<h0;h2++){var T=h5[h2];var h1=this.getTileKey(T);var e=this.tileCache.getData(h1);if(!e){this.tileCache.setData(h1,{});var h3=this;this.loadRasterTileData(T,function(i,h6){h3.rasterTileDataCbk(i,h6,h4)})}}},loadRasterTileData:function(i,e){var T=new Image();var hZ=i.col;var h2=i.row;var h0=i.zoom;var hY=this.getTilesUrl(new em(hZ,h2),h0);if(!hY){return}var h1=this.getTileKey(i);T=this.loadTileImage(hY,i,h1,e);T.tileInfo=i},loadTileImage:function(h2,e,T,h0){var hY=new Image();hY.crossOrigin="anonymous";var h1=this;var hZ;function h3(){if(h1.retry){hZ&&clearInterval(hZ);hZ=null}}if(this.retry){var i=1;hZ=setInterval(function(){if(i>3){h3();return}var h4=h1.getTilesUrl(new em(e.col,e.row),e.zoom,i);hY.src=h4;i++},this.retryTime)}hY.onload=function(){h3();h0&&h0(this,T)};hY.onerror=function(){h3();h0&&h0(null,T)};hY.src=h2;return hY},rasterTileDataCbk:function(hZ,hY,h2){if(!hZ||typeof hZ==="string"){this.tileCache.removeData(hY);return}var i=hZ.tileInfo;var T=i.col;var h4=i.row;var h3=i.zoom;var e=this.tileCache.getData(hY);if(!e){return}e.textureSource=hZ;e.dataType=eM;e.tileInfo=i;e.status="ready";this.tileCache.setData(hY,e);var h0="id_"+T+"_"+h4+"_"+h3;var h1=false;if(this.curViewTilesInfo[h0]){e.png8=this.png8||false;e.key=hY;this.setData(e,2);h1=true}if(h1){this.calOutData(h2,e)}},getTilesUrl:function(hZ,h6,i){var h1=i||0;var T=hZ.x;var h7=hZ.y;var h3=aD("ditu","normal");var h2=h3.udt;var h5=b6.B_NORMAL_MAP.tileUrls;var h0=Math.abs(T+h7+h1)%h5.length;var h4=h5[h0];if(T<0){T="M"+(-T)}if(h7<0){h7="M"+(-h7)}var hY="x="+T+"&y="+h7+"&z="+Math.floor(h6);hY+="&styles=pl&scaler=2&udt="+h2+"&from=jsapi3_0";var e=h4+"?qt=vtile&"+hY;return e},calOutData:function(h4,T){if(!T){for(var h1=0;h1<this._featureMgr.length;h1++){var e=this._featureMgr[h1];for(var hZ=0;hZ<e.length;hZ++){var hY=e[hZ].tileInfo;if(h1===2){var h2=e[hZ].extent;if(h2){this.addRefs(h2,hY.col,hY.row)}else{var h3=this.calBoxCoord(hY);if(!h3){continue}e[hZ].extent=this.findRefs(h3,hY.col,hY.row)}}}}h4({size:this.curViewTilesInfo.length,zoom:this.lastZoom,data:this._featureMgr})}else{var h0=this.calBoxCoord(T.tileInfo);if(!h0){return}T.extent=this.findRefs(h0,T.tileInfo.col,T.tileInfo.row);h4({zoom:this.lastZoom,size:this.curViewTilesInfo.length,data:[[],[],[T]]})}},calOutData_back:function(h6,hY){if(!hY){var h0;var h7;var h4;for(var h2=0;h2<this._featureMgr.length;h2++){var T=this._featureMgr[h2];for(var h1=0;h1<T.length;h1++){var hZ=T[h1].tileInfo;if(h2===2){if(h1===0){var h3=this.calBoxCoord(hZ);T[0].extent=h3;h0=T[0];h7=h3[2]-h3[0];h4=h3[3]-h3[1]}else{if(h0&&h7&&h4){var e=(hZ.row-h0.tileInfo.row)*h4;var h5=(hZ.col-h0.tileInfo.col)*h7;var h3=h0.extent;T[h1].extent=[h3[0]+h5,h3[1]+e,h3[2]+h5,h3[3]+e]}}}else{var h3=this.calBoxCoord(hZ);T[h1].extent=h3}}}h6({size:this.curViewTilesInfo.length,zoom:this.lastZoom,data:this._featureMgr})}else{if(this._featureMgr[2].length===1){var h3=this.calBoxCoord(hY.tileInfo);hY.extent=h3;this.featureCell=hY;this.cellW=h3[2]-h3[0];this.cellH=h3[3]-h3[1]}else{var e=(hY.tileInfo.row-this.featureCell.tileInfo.row)*this.cellH;var h5=(hY.tileInfo.col-this.featureCell.tileInfo.col)*this.cellW;var h3=this.featureCell.extent;hY.extent=[h3[0]+h5,h3[1]+e,h3[2]+h5,h3[3]+e]}h6({zoom:this.lastZoom,size:this.curViewTilesInfo.length,data:[[],[],[hY]]})}},calBoxCoord:function(e){var i=eq.prototype.tileToBound(e,this._mapCenter[e.zoom]).LL;var T=gcoord.transform([i.sw.lng,i.sw.lat],gcoord.BD09LL,gcoord[this.outCRS]);var hY=gcoord.transform([i.ne.lng,i.ne.lat],gcoord.BD09LL,gcoord[this.outCRS]);return[T[0],T[1],hY[0],hY[1]]},clearData:function(){this._featureMgr=[[],[],[]]},addRefs:function(i,e,T){this._gridRefs.row[T]=i[1];this._gridRefs.row[T+1]=i[3];this._gridRefs.col[e]=i[0];this._gridRefs.col[e+1]=i[2]},findRefs:function(i,e,hY){var T=[];this._gridRefs.row[hY]&&(T[1]=this._gridRefs.row[hY]);this._gridRefs.row[hY+1]&&(T[3]=this._gridRefs.row[hY+1]);this._gridRefs.col[e]&&(T[0]=this._gridRefs.col[e]);this._gridRefs.col[e+1]&&(T[2]=this._gridRefs.col[e+1]);!this._gridRefs.row[hY]&&(this._gridRefs.row[hY]=i[1])&&(T[1]=i[1]);!this._gridRefs.row[hY+1]&&(this._gridRefs.row[hY+1]=i[3])&&(T[3]=i[3]);!this._gridRefs.col[e]&&(this._gridRefs.col[e]=i[0])&&(T[0]=i[0]);!this._gridRefs.col[e+1]&&(this._gridRefs.col[e+1]=i[2])&&(T[2]=i[2]);return T},clearRefs:function(){this._gridRefs={row:{},col:{}}},destroy:function(){this.tileCache.clear();this.clearData();this.clearRefs();this._mapCenter={}},setData:function(hZ,T){var e=this._featureMgr[T];for(var hY=0;hY<e.length;hY++){if(e[hY].key&&e[hY].key===hZ.key){e[hY]=hZ;return}}e.push(hZ)},getTileKey:function(e,hY){hY=hY||{};var i=typeof hY.useZoom==="number"?hY.useZoom:e.useZoom;var T="default";return"web_"+T+"_"+e.col+"_"+e.row+"_"+e.zoom+"_"+i},setThumbData:function(i,hZ,hY,e,T){if(T===1){if(this._findParentZoomTile(i,hZ,hY,e,8)===false){this._findChildZoomTile(i,hZ,hY,e,3)}}else{if(T===-1){if(this._findChildZoomTile(i,hZ,hY,e,3)===false){this._findParentZoomTile(i,hZ,hY,e,8)}}}this.sortThumbData()},_findParentZoomTile:function(h1,ia,h9,hZ,h4){var h0="web";var T=3;var e=h1;var h7=ia;var h5=h9;var h6=hZ;for(var h3=1;h3<=h4;h3++){var hY=this.tileType.getParentTile(e,h7,h5,h6,T);if(hY===null){continue}var h8=this.getTileKey(hY);var h2=this.tileCache.getData(h8);if(h2&&h2.status==="ready"){if(this.thumbCache[h8]){continue}h2.key=h8;this.setData(h2,0);this.thumbCache[h8]=true;return true}e=hY.col;h7=hY.row;h5=hY.zoom;h6=hY.useZoom}return false},_findChildZoomTile:function(h2,h4,e,hZ,id){var ib="web";var h7=21;var h1=h2;var h3=h4;var h5=e;var hY=hZ;var h0=true;for(var ia=1;ia<=id;ia++){var h8=false;var T=this.tileType.getChildTiles(h1,h3,h5,hY,h7,ia);if(!T){continue}for(var h9=0;h9<T.length;h9++){var h6=this.getTileKey(T[h9]);var ic=this.tileCache.getData(h6);if(ic&&ic.status==="ready"){if(!this.thumbCache[h6]){ic.key=h6;this.setData(ic,1);this.thumbCache[h6]=true}h8=true}else{h0=false}}if(h8){break}}return h0},sortThumbData:function(){var e=this._featureMgr;if(!e){return}if(e[0]&&e[0].length>0){e[0].sort(function(T,i){return T.tileInfo.useZoom-i.tileInfo.useZoom})}}});bo.register(function(i){if(i.config&&i.config.isOverviewMap){return}if(i.isLoaded()){fI(i)}else{i.addEventListener("load",function(){fI(this)})}i.cityName="中国";i.cCode="1";var e={};e.enableRequest=true;e.request=function(){if(e.enableRequest){e.enableRequest=false;setTimeout(function(){e._request()},500)}};e._request=function(){var hY=i.getBoundsIn();var h0=i.getZoom();var T=hY.getSouthWest();var hZ=hY.getNorthEast();cB.request(function(h4){if(h4.current_city["code"]>=9000&&h4.current_city["code"]<=9378){h4.current_city["name"]="台湾省"}if(h4.current_city["code"]>=20000&&h4.current_city["code"]<=20499){h4.current_city["name"]="新加坡"}if(h4.current_city["code"]>=20500&&h4.current_city["code"]<=25999){h4.current_city["name"]="泰国"}if(h4.current_city["code"]>=26000&&h4.current_city["code"]<=29999){h4.current_city["name"]="日本"}if(h4.current_city["code"]>=30000&&h4.current_city["code"]<=30999){h4.current_city["name"]="韩国"}if(h4.current_city["code"]>=31000&&h4.current_city["code"]<=37000){h4.current_city["name"]="亚太"}if(h4.current_city["code"]>=46609&&h4.current_city["code"]<=52505){h4.current_city["name"]="欧洲"}if(h4.current_city["code"]>=39509&&h4.current_city["code"]<=53500){h4.current_city["name"]="南美洲"}if(h4.current_city["code"]>=54000&&h4.current_city["code"]<=70000){h4.current_city["name"]="北美洲"}if(h4.current_city["code"]===54003&&h4.current_city["code"]>=60731&&h4.current_city["code"]<=61123){h4.current_city["name"]="美国"}if(h4.current_city["code"]===54015||h4.current_city["code"]>=57970&&h4.current_city["code"]<=60223){h4.current_city["name"]="加拿大"}if(h4.current_city["code"]===54025||h4.current_city["code"]>=54338&&h4.current_city["code"]<=57374){h4.current_city["name"]="墨西哥"}e.enableRequest=true;if(h4&&h4.current_city){var h3=h4.current_city["name"];var h2=h4.current_city["code"];if(h2!==i.cCode){var h1=new bb("oncitychange");h1.name=h3;h1.code=h2;i.dispatchEvent(h1)}i.cityName=h3;i.cCode=h2;if(!gb()){eA(i)}}},{qt:"cen",b:T.lng+","+T.lat+";"+hZ.lng+","+hZ.lat,l:h0},"","",true)};i.addEventListener("load",function(T){e.request()});i.addEventListener("moveend",function(T){e.request()});i.addEventListener("zoomend",function(T){e.request()});e.request()});function fI(i){if(i.temp.copyadded){return}i.temp.copyadded=true;if(!i.cpyCtrl){var hY=new ec(2,2);i.config.cpyCtrlOffset=hY;if(gb()){hY.width=72;hY.height=0}var T=new dH({offset:hY,printable:true});i.cpyCtrl=T}if(!gb()){eA(i);i.addEventListener("maptypechange",function(){eA(i)})}i.addControl(T);var e=new af();e._opts={printable:true};i.logoCtrl=e;i.addControl(e);i.addEventListener("resize",function(){if(this.getSize().width>=300&&i.getSize().height>=100){e.show();T.setOffset(i.config.cpyCtrlOffset)}else{e.hide();T.setOffset(new ec(4,2))}});if(i.getSize().width>=300&&i.getSize().height>=100){e.show()}else{e.hide();T.setOffset(new ec(4,2))}i.addEventListener("oncopyrightoffsetchange",function(hZ){i.logoCtrl.setOffset(hZ.target.logo);i.cpyCtrl.setOffset(hZ.target.cpy)});i.dispatchEvent(new bb("oncopyrightaddend"))}function eA(id){if(!id.cpyCtrl){var im=new ec(2,2);if(gb()){im.width=72;im.height=0}var ih=new dH({offset:im,printable:true});id.cpyCtrl=ih}var ix=id.cityName||"中国";var ie=id.getMapType();var ig=["常州市","南昌市","乌鲁木齐市","无锡市","福州市","泉州市","珠海市","贵阳市"];var h7=["北京市","上海市","广州市","深圳市","宁波市","石家庄市","沈阳市","长春市","青岛市","温州市","台州市","金华市","佛山市","中山市","昆明市","南宁市","苏州市","西安市","济南市","郑州市","合肥市","呼和浩特市","杭州市","成都市","武汉市","长沙市","天津市","南京市","重庆市","大连市","东莞市","厦门市"];var h9=["香港特别行政区"];var h3=["台湾省"];var io=["日本"];var iv=["韩国"];var ii=["泰国"];var il=["亚太"];var h4=["新加坡"];var iw=["欧洲"];var hY=["南美洲"];var ir=["北美洲"];var T=["美国"];var ik=["墨西哥"];var h1=["加拿大"];for(var it in ig){if(ig[it]===ix){var ia=true;break}}for(var it in h7){if(h7[it]===ix){var hZ=true;break}}for(var it in h9){if(h9[it]===ix){var iz=true;break}}if(h3[0]===ix){var iq=true}if(h4[0]===ix){var i=true}if(io[0]===ix){var h6=true}if(iv[0]===ix){var ic=true}if(ii[0]===ix){var ib=true}if(il[0]===ix){var h2=true}if(iw[0]===ix){var h8=true}if(hY[0]===ix){var h5=true}if(ir[0]===ix){var e=true}if(T[0]===ix){var iu=true}if(h1[0]===ix){var ip=true}if(ik[0]===ix){var h0=true}var iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "];var ij="rgba(255, 255, 255, 0.701961)";if(id.getZoom()<=9){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(iq){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(h6||ic){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(i||ib){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(h2){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(h8){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(h5){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}else{if(e){iy=["&copy;&nbsp;2022 Baidu - GS(2021)6026号 - 甲测资字1100930 - 京ICP证030173号 - Data &copy; "]}}}}}}}}if(id.getZoom()<=9){iy.push("长地万方");iy.push(' &amp; <a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iy.push(' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');if(ie===BMAP_SATELLITE_MAP||ie===BMAP_HYBRID_MAP){iy.push(' &amp; <a target="_blank" href="http://www.eso.org/public/">ESO</a>');ij="rgba(0,0,0,.7)"}}else{if(h6||ic){iy.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>')}else{if(i||ib){iy.push('<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>')}else{if(h2){iy.push('<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');iy.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(h8){iy.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iy.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(h5){iy.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iy.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(iu||h0||ip){iy.push('<a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');iy.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{if(e){iy.push('<a target="_blank" href="http://www.openstreetmap.org/">OpenStreetMap</a>');iy.push(' &amp; <a target="_blank" href="https://www.mapbox.com/">Mapbox</a>')}else{iy.push("长地万方");if(ia){iy.push(' &amp; <a target="_blank" href="http://www.palmcity.cn/palmcity/">PalmCity</a>')}if(iz){iy.push(' &amp; <a target="_blank" href="http://www.mapking.com/HongKong/eng/home/MapKing_Webmap.html">MapKing</a>')}if(iq){iy.push(' &amp; <a target="_blank" href="http://corporate.navteq.com/supplier_terms.html">HERE</a>');iy.push(' &amp; <a target="_blank" href="http://www.localking.com.tw/about/localking.aspx">樂客LocalKing</a>')}if(ie===BMAP_SATELLITE_MAP||ie===BMAP_HYBRID_MAP){ij="rgba(0,0,0,.7)"}}}}}}}}}iy.unshift('<span style="background: '+ij+';padding: 0px 1px;line-height: 16px;display: inline;height: 16px;">');iy.push("</span>");iy=iy.join("");id.cpyCtrl.addCopyright({id:1,content:iy})}window.BMAP_STATUS_SUCCESS=0;window.BMAP_STATUS_CITY_LIST=1;window.BMAP_STATUS_UNKNOWN_LOCATION=2;window.BMAP_STATUS_UNKNOWN_ROUTE=3;window.BMAP_STATUS_INVALID_KEY=4;window.BMAP_STATUS_INVALID_REQUEST=5;window.BMAP_STATUS_PERMISSION_DENIED=6;window.BMAP_STATUS_SERVICE_UNAVAILABLE=7;window.BMAP_STATUS_TIMEOUT=8;window.BMAP_ROUTE_TYPE_WALKING=2;window.BMAP_ROUTE_TYPE_DRIVING=3;window.BMAP_ROUTE_TYPE_RIDING=6;window.BMAP_ROUTE_STATUS_NORMAL=0;window.BMAP_ROUTE_STATUS_EMPTY=1;window.BMAP_ROUTE_STATUS_ADDRESS=2;var eK="cur";var b2="cen";var ep="s";var P="con";var dM="bd";var gj="nb";var hP="bt";var cP="nav";var en="walk";var hL="gc";var fR="rgc";var eC="dec";var fh="bse";var fs="nse";var g="bl";var bc="bsl";var bp="bda";var X="sa";var az="nba";var bZ="drag";var H="ext";var d2="exts";var aO="hip";var R="ride";var fW="drct";var gv=2;var fT=4;var he=7;var hc=11;var fD=12;var hJ=14;var bQ=15;var dJ=18;var fk=20;var cI=21;var co=19;var fd=23;var ci=26;var ao=28;var el=31;var cF=35;var gn=44;var hW=45;var eN=46;var cD=47;var gE=-1;var g3=0;var hj=1;var cm=2;var b8=3;window.BMAP_POI_TYPE_NORMAL=0;var Q=1;var cc=2;BMapGL.I=C.I;var O={};O.removeHtml=function(e){e=e.replace(/<\/?[^>]*>/g,"");e=e.replace(/[ | ]* /g," ");return e};O.parseGeoExtReg1=function(e){return e.replace(/([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*),([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0|[1-9]\d*)(,)/g,"$1,$2;")};O.parseGeoExtReg2=function(i,e){var T=new RegExp("(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);)(((-?\\d+)(\\.\\d+)?),((-?\\d+)(\\.\\d+)?);){"+e+"}","ig");return i.replace(T,"$1")};var fB=0;var cH=1;var hf=2;O.unique=function(T){var h0=false;var hZ=[];var h1={};for(var hY=0,e=T.length;hY<e;hY++){if(!h1[T[hY]]){h1[T[hY]]=true;hZ.push(T[hY])}}return hZ};O.getBestLevel=function(T,i){if(i){var e=Math.min(i.width/1100,i.height/660);T=Math.round(T+(Math.log(e)/Math.log(2)))}if(T<1){T=1}if(T>21){T=21}return T};O.parseGeo=function(h1,h4){if(typeof h1!="string"||!h1){return}var h6=h1.split("|");var e;var hZ;var T;if(h6.length==1){e=gg(h1)}else{e=gg(h6[2]);hZ=gg(h6[0]);T=gg(h6[1]);if(!h4){return e}}var h2={type:e.geoType};if(h4){switch(h2.type){case hf:var h3=new hz(e.geo[0][0],e.geo[0][1]);var h5=eq.convertMC2LL(h3);h2.point=h5;h2.points=[h5];break;case cH:h2.points=[];var h7=e.geo[0];for(var h0=0,hY=h7.length-1;h0<hY;h0+=2){var h8=new hz(h7[h0],h7[h0+1]);h8=eq.convertMC2LL(h8);h2.points.push(h8)}hZ=new hz(hZ.geo[0][0],hZ.geo[0][1]);T=new hz(T.geo[0][0],T.geo[0][1]);hZ=eq.convertMC2LL(hZ);T=eq.convertMC2LL(T);h2.bounds=new dT(hZ,T);break;default:break}}return h2};O.parseGeoExt=function(ii,h8){if(!h8){h8=0}else{if(h8<0.25){h8=0}else{if(h8>0.25&&h8<1){h8=1}else{if(h8>32){h8=32}}}}var h3=ii.split("|");if(h3.length==1){var hY=gg(h3[0]);return{type:hY.type,bound:"",points:hY.geo.join(",")}}else{if(h3.length>1){var h9=ii.split(";.=");var h5=[];var hZ=[];var ia=0;var ie=h9.length;for(var ib=0;ib<ie;ib++){var ih=h9[ib];if(ie>1){if(ib==0){ih=ih+";"}if(ib>0&&ib<ie-1){ih=".="+ih+";"}if(ib==ie-1){ih=".="+ih}}var h0=ih.split("|");var id=gg(h0[0]);var ic=gg(h0[1]);h5.push(id.geo.join(","));h5.push(ic.geo.join(","));var hY=gg(h0[2]);ia=hY.type;var ig=hY.geo.join(",");ig=O.parseGeoExtReg1(ig);if(h8>0){ig=O.parseGeoExtReg2(ig,h8)}hZ.push(ig)}if(ie<=1){hZ=hZ.join(";")}if(ie==2){var T=hZ[0]+";"+hZ[1];var h1=T.split(";");var e=[];for(var ib=0;ib<h1.length;ib++){var h4=h1[ib].split(",")[0];var h2=h1[ib].split(",")[1];var h6=new hz(h4,h2);var h7=eq.convertMC2LL(h6);e.push(h7)}hZ=e}return{type:ia,bound:h5.join(";"),points:hZ}}}};O.getPoiPoint=function(e){var T=[];var i=null;if(e.toString()=="Point"){i=e}else{if(typeof e=="string"){T=C.trim(e).split(",");if(T.length<2){return}T[0]=parseFloat(C.trim(T[0]));T[1]=parseFloat(C.trim(T[1]))}else{T=e.slice(0);if(T.length<2){return}}i=new BMap.Point(T[0],T[1])}return i};O.parseGeoStr=function(T){var i=T.split(",");var e=new hz(i[0],i[1]);return eq.convertMC2LL(e)};O.level={country:4,province:11,city:12,area:13};var hQ=["=",".","-","*"];var ga=1<<23;function gg(h4){var h3=a9(h4.charAt(0));var T=h4.substr(1);var h6=0;var e=T.length;var h7=[];var h1=[];var h2=[];while(h6<e){if(T.charAt(h6)==hQ[0]){if((e-h6)<13){return 0}h2=aL(T.substr(h6,13),h7);if(h2<0){return 0}h6+=13}else{if(T.charAt(h6)==";"){h1.push(h7.slice(0));h7.length=0;++h6}else{if((e-h6)<8){return 0}h2=c6(T.substr(h6,8),h7);if(h2<0){return 0}h6+=8}}}for(var h0=0,hY=h1.length;h0<hY;h0++){for(var hZ=0,h5=h1[h0].length;hZ<h5;hZ++){h1[h0][hZ]/=100}}return{geoType:h3,geo:h1}}function a9(i){var e=-1;if(i==hQ[1]){e=hf}else{if(i==hQ[2]){e=cH}else{if(i==hQ[3]){e=fB}}}return e}function aL(hZ,T){var e=0;var h1=0;var h0=0;for(var hY=0;hY<6;hY++){h0=cO(hZ.substr(1+hY,1));if(h0<0){return -1-hY}e+=h0<<(6*hY);h0=cO(hZ.substr(7+hY,1));if(h0<0){return -7-hY}h1+=h0<<(6*hY)}T.push(e);T.push(h1);return 0}function c6(h0,hY){var T=hY.length;if(T<2){return -1}var e=0;var h2=0;var h1=0;for(var hZ=0;hZ<4;hZ++){h1=cO(h0.substr(hZ,1));if(h1<0){return -1-hZ}e+=h1<<(6*hZ);h1=cO(h0.substr(4+hZ,1));if(h1<0){return -5-hZ}h2+=h1<<(6*hZ)}if(e>ga){e=ga-e}if(h2>ga){h2=ga-h2}hY.push(hY[T-2]+e);hY.push(hY[T-1]+h2);return 0}function cO(i){var e=i.charCodeAt(0);if(i>="A"&&i<="Z"){return e-"A".charCodeAt(0)}else{if(i>="a"&&i<="z"){return(26+e-"a".charCodeAt(0))}else{if(i>="0"&&i<="9"){return(52+e-"0".charCodeAt(0))}else{if(i=="+"){return 62}else{if(i=="/"){return 63}}}}}return -1}O.pathToPoints=function(h0){var hY=[];if(typeof h0!=="string"){return hY}else{var hZ=h0.split(";");for(var T=0;T<hZ.length;T++){var e=hZ[T].split(",");hY.push(new hz(e[0],e[1]))}}return hY};window.BMAP_POI_TYPE_NORMAL=0;window.BMAP_POI_TYPE_BUSSTOP=1;window.BMAP_POI_TYPE_BUSLINE=2;window.BMAP_POI_TYPE_SUBSTOP=3;window.BMAP_POI_TYPE_SUBLINE=4;var hC=0;var f2=1;var c3={};window.APIPack=c3;function fG(i,e){eg.call(this);this._loc={};this.setLocation(i);e=e||{};e.renderOptions=e.renderOptions||{};this._opts={renderOptions:{panel:e.renderOptions.panel||null,map:e.renderOptions.map||null,autoViewport:e.renderOptions.autoViewport||true,selectFirstResult:e.renderOptions.selectFirstResult,highlightMode:e.renderOptions.highlightMode,enableDragging:e.renderOptions.enableDragging||false},onSearchComplete:e.onSearchComplete||function(){},onMarkersSet:e.onMarkersSet||function(){},onInfoHtmlSet:e.onInfoHtmlSet||function(){},onResultsHtmlSet:e.onResultsHtmlSet||function(){},onGetBusListComplete:e.onGetBusListComplete||function(){},onGetBusLineComplete:e.onGetBusLineComplete||function(){},onBusListHtmlSet:e.onBusListHtmlSet||function(){},onBusLineHtmlSet:e.onBusLineHtmlSet||function(){},onPolylinesSet:e.onPolylinesSet||function(){},reqFrom:e.reqFrom||""};if(typeof e!="undefined"&&typeof e.renderOptions!="undefined"&&typeof e.renderOptions["autoViewport"]!="undefined"){this._opts.renderOptions.autoViewport=e.renderOptions["autoViewport"]}else{this._opts.renderOptions.autoViewport=true}this._opts.renderOptions.panel=C.G(this._opts.renderOptions.panel)}fG.inherits(eg,"BaseSearch");C.extend(fG.prototype,{getResults:function(){if(!this._isMultiKey){return this._results}else{return this._arrResults}},enableAutoViewport:function(){this._opts.renderOptions.autoViewport=true},disableAutoViewport:function(){this._opts.renderOptions.autoViewport=false},setLocation:function(e){if(!e){return}this._loc.src=e},setSearchCompleteCallback:function(e){this._opts.onSearchComplete=e||function(){}},setMarkersSetCallback:function(e){this._opts.onMarkersSet=e||function(){}},setPolylinesSetCallback:function(e){this._opts.onPolylinesSet=e||function(){}},setInfoHtmlSetCallback:function(e){this._opts.onInfoHtmlSet=e||function(){}},setResultsHtmlSetCallback:function(e){this._opts.onResultsHtmlSet=e||function(){}},getStatus:function(){return this._status}});var dN=function(T,i){fG.call(this,T,i);i=i||{};i.renderOptions=i.renderOptions||{};this.setPageCapacity(i.pageCapacity);if(typeof i.renderOptions["selectFirstResult"]!="undefined"&&!i.renderOptions["selectFirstResult"]){this.disableFirstResultSelection()}else{this.enableFirstResultSelection()}this._overlays=[];this._arrPois=[];this._curIndex=-1;this._queryList=[];var e=this;ed.load("localSearch",function(){e._check()},true)};dN.inherits(fG,"LocalSearch");dN.DEFAULT_PAGE_CAPACITY=10;dN.MIN_PAGE_CAPACITY=1;dN.MAX_PAGE_CAPACITY=100;dN.DEFAULT_RADIUS=2000;dN.MAX_RADIUS=100000;C.extend(dN.prototype,{search:function(e,i){this._queryList.push({method:"search",arguments:[e,i]})},searchInBounds:function(e,T,i){this._queryList.push({method:"searchInBounds",arguments:[e,T,i]})},searchNearby:function(T,i,e,hY){this._queryList.push({method:"searchNearby",arguments:[T,i,e,hY]})},clearResults:function(){delete this._json;delete this._status;delete this._results;delete this._ud;this._curIndex=-1;this._setStatus();if(this._opts.renderOptions.panel){this._opts.renderOptions.panel.innerHTML=""}},gotoPage:function(){},enableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=true},disableFirstResultSelection:function(){this._opts.renderOptions.selectFirstResult=false},setPageCapacity:function(e){if(typeof e=="number"&&!isNaN(e)){this._opts.pageCapacity=e<1?dN.DEFAULT_PAGE_CAPACITY:(e>dN.MAX_PAGE_CAPACITY?dN.DEFAULT_PAGE_CAPACITY:e)}else{this._opts.pageCapacity=dN.DEFAULT_PAGE_CAPACITY}},getPageCapacity:function(){return this._opts.pageCapacity},toString:function(){return"LocalSearch"}});function V(i){this._opts={};C.extend(this._opts,i);this._queryList=[];var e=this;ed.load("otherSearch",function(){e._asyncSearch()})}V.inherits(eg,"Geocoder");C.extend(V.prototype,{getPoint:function(e,T,i){this._queryList.push({method:"getPoint",arguments:[e,T,i]})},getLocation:function(e,T,i){this._queryList.push({method:"getLocation",arguments:[e,T,i]})},toString:function(){return"Geocoder"}});function cS(e){e=e||{};this.config={timeout:e.timeout||1000*10,maximumAge:e.maximumAge||0,enableHighAccuracy:e.enableHighAccuracy||true,SDKLocation:e.SDKLocation||false};this._pendingCalls=[];var i=this;ed.load("otherSearch",function(){var T=i._pendingCalls.length;for(var hY=0;hY<T;hY++){var hZ=i._pendingCalls[hY];i[hZ.method].apply(i,hZ.arguments)}})}C.extend(cS.prototype,{getCurrentPosition:function(e,i){this._pendingCalls.push({method:"getCurrentPosition",arguments:arguments})},getStatus:function(){return BMAP_STATUS_UNKNOWN_LOCATION},enableSDKLocation:function(){if(gb()){this.config.SDKLocation=true}},disableSDKLocation:function(){this.config.SDKLocation=false}});function gF(){this._queryList=[];var e=this;ed.load("otherSearch",function(){e._asyncSearch()})}gF.inherits(eg,"Boundary");C.extend(gF.prototype,{get:function(i,e){this._queryList.push({method:"get",arguments:[i,e]})},toString:function(){return"Boundary"},parsebdStr:function(i,e){}});function W(i){i=i||{};i.renderOptions=i.renderOptions||{};this._opts={renderOptions:{map:i.renderOptions.map||null}};this._queryList=[];var e=this;ed.load("otherSearch",function(){e._asyncSearch()})}W.inherits(eg,"LocalCity");C.extend(W.prototype,{get:function(e){this._queryList.push({method:"get",arguments:[e]})},toString:function(){return"LocalCity"}});function cN(e,T){eg.call(this);this.markersList=[];this.destList=[];this.pointsList=[];this._opts=T;this.json=e;this.map=this._opts.renderOptions.map||null;this.sType=this._opts.sType;this.infoWindow=null;this.curPointIndex=0;this.startName="";this.endIndex=1;this.endName="";this.resCity=[0,0,0,0,0,0,0];this.locPois=[];this.curPageIndex=[1,1,1,1,1,1,1];this.totalPage=[1,1,1,1,1,1,1];this.resCount=[0,0,0,0,0,0,0];this.resType=[0,0,0,0,0,0,0];this.qInfo=[{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1},{n:"",c:0,u:0,x:0,y:0,t:-1}];this.curSelectedIndex=-1;this.tpList=[];this.tpListInMap=[];var i=this;ed.load("route",function(){})}cN.inherits(eg,"RouteAddr");function d5(T,i){fG.call(this,T,i);this.QUERY_TYPE_BUSLIST=g;this.RETURN_TYPE_BUSLIST=bQ;this.QUERY_TYPE_BUSLINE=bc;this.RETURN_TYPE_BUSLINE=dJ;this._queryList=[];var e=this;ed.load("buslineSearch",function(){e._asyncSearch()})}var bn=e8.staticHost+"/wolfman/static/common/images/";d5._iconOpen=e8.apiIMG+"/iw_plus.gif";d5._iconClose=e8.apiIMG+"/iw_minus.gif";d5._stopUrl=bn+"new/bus-stop-1x_ddd4723.png";d5.inherits(fG,"BusLineSearch");C.extend(d5.prototype,{getBusList:function(e){this._queryList.push({method:"getBusList",arguments:[e]})},getBusLine:function(e){this._queryList.push({method:"getBusLine",arguments:[e]})},setGetBusListCompleteCallback:function(e){this._opts.onGetBusListComplete=e||function(){}},setGetBusLineCompleteCallback:function(e){this._opts.onGetBusLineComplete=e||function(){}},setBusListHtmlSetCallback:function(e){this._opts.onBusListHtmlSet=e||function(){}},setBusLineHtmlSetCallback:function(e){this._opts.onBusLineHtmlSet=e||function(){}},setPolylinesSetCallback:function(e){this._opts.onPolylinesSet=e||function(){}}});function g9(i){fG.call(this,i);i=i||{};this._options={input:i.input||null,baseDom:i.baseDom||null,types:i.types||[],onSearchComplete:i.onSearchComplete||function(){}};this._loc.src=i.location||"全国";this._word="";this._show=false;this._suggestion=null;this._inputValue="";this._initialize();var e=this;ed.load("autocomplete",function(){e._asyncSearch()},true)}g9.inherits(fG,"Autocomplete");C.extend(g9.prototype,{_initialize:function(){},show:function(){this._show=true},hide:function(){this._show=false},setTypes:function(e){this._options.types=e},setLocation:function(e){this._loc.src=e},search:function(e){this._word=e},setInputValue:function(e){this._inputValue=e},setSearchCompleteCallback:function(e){this._options.onSearchComplete=e}});var hm=function(i,e){fG.call(this,i,e)};C.inherit(hm,fG,"BaseRoute");C.extend(hm.prototype,{clearResults:function(){}});window.BMAP_TRANSIT_POLICY_RECOMMEND=0;window.BMAP_TRANSIT_POLICY_LEAST_TIME=4;window.BMAP_TRANSIT_POLICY_LEAST_TRANSFER=1;window.BMAP_TRANSIT_POLICY_LEAST_WALKING=2;window.BMAP_TRANSIT_POLICY_AVOID_SUBWAYS=3;window.BMAP_TRANSIT_POLICY_FIRST_SUBWAYS=5;window.BMAP_LINE_TYPE_BUS=0;window.BMAP_LINE_TYPE_SUBWAY=1;window.BMAP_LINE_TYPE_FERRY=2;window.BMAP_LINE_TYPE_TRAIN=3;window.BMAP_LINE_TYPE_AIRPLANE=4;window.BMAP_LINE_TYPE_COACH=5;var dk=3;var fp=4;var hF=1;var d0=2;var gV=5;var hd=6;window.BMAP_TRANSIT_TYPE_IN_CITY=0;window.BMAP_TRANSIT_TYPE_CROSS_CITY=1;window.BMAP_TRANSIT_PLAN_TYPE_ROUTE=0;window.BMAP_TRANSIT_PLAN_TYPE_LINE=1;window.BMAP_TRANSIT_TYPE_POLICY_TRAIN=0;window.BMAP_TRANSIT_TYPE_POLICY_AIRPLANE=1;window.BMAP_TRANSIT_TYPE_POLICY_COACH=2;window.BMAP_INTERCITY_POLICY_LEAST_TIME=0;window.BMAP_INTERCITY_POLICY_EARLY_START=1;window.BMAP_INTERCITY_POLICY_CHEAP_PRICE=2;function bI(T,i){hm.call(this,T,i);i=i||{};this.setPolicy(i.policy);this.setIntercityPolicy(i.intercityPolicy);this.setTransitTypePolicy(i.transitTypePolicy);this.setPageCapacity(i.pageCapacity);this.QUERY_TYPE=hP;this.RETURN_TYPE=hJ;this.ROUTE_TYPE=f2;this._overlays=[];this._curIndex=-1;this._opts._enableTraffic=i.enableTraffic||false;this._queryList=[];var e=this;ed.load("route",function(){e._asyncSearch()},true)}bI.MAX_PAGE_CAPACITY=100;bI.LINE_TYPE_MAPPING=[0,1,0,0,0,0,0,0,2,0,0,0,1,1,1];bI.LINE_TYPE_MAPPING_CROSS_CITY=[0,3,4,0,0,0,5];C.inherit(bI,hm,"TransitRoute");C.extend(bI.prototype,{setPolicy:function(e){if(e>=BMAP_TRANSIT_POLICY_RECOMMEND&&e<=BMAP_TRANSIT_POLICY_FIRST_SUBWAYS){this._opts.policy=e}else{this._opts.policy=BMAP_TRANSIT_POLICY_RECOMMEND}},setIntercityPolicy:function(e){if(e>=BMAP_INTERCITY_POLICY_LEAST_TIME&&e<=BMAP_INTERCITY_POLICY_CHEAP_PRICE){this._opts.intercityPolicy=e}else{this._opts.intercityPolicy=BMAP_INTERCITY_POLICY_LEAST_TIME}},setTransitTypePolicy:function(e){if(e>=BMAP_TRANSIT_TYPE_POLICY_TRAIN&&e<=BMAP_TRANSIT_TYPE_POLICY_COACH){this._opts.transitTypePolicy=e}else{this._opts.transitTypePolicy=BMAP_TRANSIT_TYPE_POLICY_TRAIN}},_internalSearch:function(i,e){this._queryList.push({method:"_internalSearch",arguments:[i,e]})},search:function(i,e){this._queryList.push({method:"search",arguments:[i,e]})},setPageCapacity:function(e){if(typeof e==="string"){e=parseInt(e,10);if(isNaN(e)){this._opts.pageCapacity=bI.MAX_PAGE_CAPACITY;return}}if(typeof e!=="number"){this._opts.pageCapacity=bI.MAX_PAGE_CAPACITY;return}if(e>=1&&e<=bI.MAX_PAGE_CAPACITY){this._opts.pageCapacity=Math.round(e)}else{this._opts.pageCapacity=bI.MAX_PAGE_CAPACITY}},toString:function(){return"TransitRoute"},_shortTitle:function(e){return e.replace(/\(.*\)/,"")}});window.BMAP_HIGHLIGHT_STEP=1;window.BMAP_HIGHLIGHT_ROUTE=2;var cK=function(e,hY){hm.call(this,e,hY);this._overlays=[];this._curIndex=-1;this._queryList=[];var T=this;var i=this._opts.renderOptions;if(i.highlightMode!==BMAP_HIGHLIGHT_STEP&&i.highlightMode!==BMAP_HIGHLIGHT_ROUTE){i.highlightMode=BMAP_HIGHLIGHT_STEP}this._enableDragging=this._opts.renderOptions.enableDragging?true:false;ed.load("route",function(){T._asyncSearch()},true);if(this.init_d){this.init_d()}};cK.ROAD_TYPE=["","环岛","无属性道路","主路","高速连接路","交叉点内路段","连接道路","停车场内部道路","服务区内部道路","桥","步行街","辅路","匝道","全封闭道路","未定义交通区域","POI连接路","隧道","步行道","公交专用道","提前右转道"];C.inherit(cK,hm,"DWRoute");C.extend(cK.prototype,{search:function(T,e,i){this._queryList.push({method:"search",arguments:[T,e,i]})}});window.BMAP_DRIVING_POLICY_DEFAULT=0;window.BMAP_DRIVING_POLICY_AVOID_HIGHWAYS=3;window.BMAP_DRIVING_POLICY_FIRST_HIGHWAYS=4;window.BMAP_DRIVING_POLICY_AVOID_CONGESTION=5;window.BMAP_TRAFFICE_STATUS_NONE=0;window.BMAP_TRAFFICE_STATUS_NORMAL=1;window.BMAP_TRAFFICE_STATUS_SLOW=2;window.BMAP_TRAFFICE_STATUS_JAM=3;function fK(e,i){cK.call(this,e,i);i=i||{};this._opts._enableTraffic=i.enableTraffic||false;this.setPolicy(i.policy);this.QUERY_TYPE=cP;this.RETURN_TYPE=fk;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_DRIVING}C.inherit(fK,cK,"DrivingRoute");fK.prototype.setPolicy=function(e){if(e>=BMAP_DRIVING_POLICY_DEFAULT&&e<=BMAP_DRIVING_POLICY_AVOID_CONGESTION){this._opts.policy=e}else{this._opts.policy=BMAP_DRIVING_POLICY_DEFAULT}};function ba(e,i){cK.call(this,e,i);this.QUERY_TYPE=en;this.RETURN_TYPE=el;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_WALKING;this._enableDragging=false}C.inherit(ba,cK,"WalkingRoute");function bm(e,i){cK.call(this,e,i);this.QUERY_TYPE=R;this.ROUTE_TYPE=BMAP_ROUTE_TYPE_RIDING;this._enableDragging=false}C.inherit(bm,cK,"RidingRoute");window.BMAP_MODE_DRIVING="driving";window.BMAP_MODE_TRANSIT="transit";window.BMAP_MODE_WALKING="walking";window.BMAP_MODE_NAVIGATION="navigation";var be={web:"//api.map.baidu.com/direction?",android:"bdapp://map/direction?",ios:"baidumap://map/direction?"};function hA(e){this.opts=e||{}}C.extend(hA.prototype,{routeCall:function(hY,e,T){var i=this;ed.load("route",function(){i._asyncSearch(hY,e,T)})}});bo.Map=c8;bo.MapType=b6;bo.Point=hz;bo.Pixel=em;bo.Size=ec;bo.Bounds=dT;bo.TileLayer=cR;bo.Copyright=c5;bo.Projection=bo.Project=eq;bo.XYZProjection=bo.XYZProject=ey;bo.Convertor=ax;bo.RenderTypeUtils=a8;bo.Overlay=bl;bo.Label=fV;bo.Marker=aC;bo.Icon=hi;bo.Polyline=ak;bo.BezierCurve=ft;bo.PolylineMultipart=fr;bo.Polygon=hb;bo.Prism=cg;bo.Marker3D=cv;bo.GroundOverlay=cp;bo.InfoWindow=an;bo.SimpleInfoWindow=hO;bo.Circle=dF;bo.Control=a7;bo.NavigationControl=dt;bo.NavigationControl3D=eZ;bo.CopyrightControl=dH;bo.ScaleControl=ho;bo.CityListControl=ee;bo.MapTypeControl=bC;bo.ZoomControl=cy;bo.LocationControl=bA;bo.LogoControl=af;bo.DistanceTool=gR;bo.ContextMenu=cf;bo.MenuItem=fE;bo.OperationMask=ek;bo.Animation=o;bo.ViewAnimation=cM;bo.Transitions=cn;bo.Event=bb;bo.trafficLayer=ce;bo.XYZLayer=ff;bo.BaiduLayer=aV;bo.Geolocation=cS;bo.Geocoder=V;bo.Boundary=gF;bo.DistrictLayer=g8;bo.LocalCity=W;bo.LocalSearch=dN;bo.Autocomplete=g9;bo.BusLineSearch=d5;bo.WalkingRoute=ba;bo.RidingRoute=bm;bo.DrivingRoute=fK;bo.TransitRoute=bI;bo.RouteSearch=hA;function d4(e,i){for(var T in i){e[T]=i[T]}}bo.verify();bo.apiLoad();bo.frequency();bo.getSeckeyCid();window._layer=1;C.extend(g8.prototype,{_asyncSearch:function(){for(var T=0,e=this._queryList.length;T<e;T++){var hY=this._queryList[T];this[hY.method].apply(this,hY.arguments)}delete this._queryList},addDistrict:function(){if(this._opts.districts){var e=this._opts.districts;if(typeof e==="string"){this.getDistrictData(e)}else{if(Object.prototype.toString.call(e)==="[object Array]"){var i=this.parseArrayParams(e);this.getDistrictData(i)}}}},parseArrayParams:function(e){var hZ="";for(var hY=0;hY<e.length;hY++){if(e[hY] instanceof Array){hZ+="(";for(var T=0;T<e.length;T++){hZ+=e[T]}hZ+=")"}else{hZ+="("+e[hY]+")"}}return hZ},getDistrictData:function(e){var i=this;cB.request(function(hY){var T=i._parseGeoData(hY);i._drawToMap(i,T)},{qt:d2,adnames:e,level:i._opts.level})},_drawToMap:function(h4,h1){var h3=h1.boundaries.length;if(h3===0){alert("未能获取当前输入行政区域");return}var h5=this._config.fillColor;var hZ=this._config.fillOpacity;var T=this._config.strokeColor;var e=this._config.strokeOpacity;if(typeof h5==="string"){var hY=h5;var h6=[];for(var h0=0;h0<h3;h0++){var h2=new BMapGL.Polygon(h1.boundaries[h0],{strokeWeight:2,strokeColor:T,strokeOpacity:e,fillColor:hY,fillOpacity:hZ});h2.style={strokecolor:T,strokeOpacity:e,fillColor:hY,fillOpacity:hZ};this.disOverlays.push(h2);this.addEventListenerIn();h4._map.addOverlay(h2);h6=h6.concat(h2.getPath())}h4._map.setViewport(h6)}else{if(Object.prototype.toString.call(h5)==="[object Array]"){var hZ=this._config.fillOpacity;var T=this._config.strokeColor;var e=this._config.strokeOpacity;var h6=[];for(var h0=0;h0<h3;h0++){var hY=h5[h0];var h2=new BMapGL.Polygon(h1.boundaries[h0],{strokeWeight:2,strokeColor:T,strokeOpacity:e,fillColor:hY,fillOpacity:hZ});h2.style={strokecolor:T,strokeOpacity:e,fillColor:hY,fillOpacity:hZ};this.disOverlays.push(h2);this.addEventListenerIn();h4._map.addOverlay(h2);h6=h6.concat(h2.getPath())}}}},_parseGeoData:function(h7){var ia={};ia.boundaries=[];if(h7&&h7.content&&h7.content["geo"]){for(var ig=0;ig<h7.content["geo"].length;ig++){var hY=O.parseGeo(h7.content["geo"][ig],false);if(hY.geo&&hY.geo.length&&hY.geo.length>0){var id=hY.geo.length;for(gy=0;gy<id;gy++){var T=hY.geo[gy];if(T&&T.length&&T.length>0){var h5=T.length-1;var ic=[];var h4=false;var ib=0;var h9=0;for(var ie=0;ie<h5;ie+=2){var h2=T[ie];var h0=T[ie+1];var h8=new hz(h2,h0);h8=eq.convertMC2LL(h8);if(ie<h5-3){var i=T[ie+2];var e=T[ie+3];var h6=new hz(i,e);h6=eq.convertMC2LL(h6)}ic.push(h8.lng+", "+h8.lat)}if(h4===true){if(ib>h9){var ih=ib;ib=h9;h9=ih}var h3=ic;var h1=ic.splice(ib+1);var hZ=h1.splice(h9-ib);h3=h3.concat(hZ);ia.boundaries.push(h3.join(";"));ia.boundaries.push(h1.join(";"));h4=false;continue}if(ic.length!==0){ia.boundaries.push(ic.join(";"))}}}}}}return ia},deleteDistrict:function(hY){var T=hY.disOverlays;for(var e=0;e<T.length;e++){this._map.removeOverlay(T[e])}},addEventListener:function(e,i){this.eventAndCallback[e]=i},addEventListenerIn:function(){var hY=this;var h0=Object.keys(hY.eventAndCallback);if(h0.length>0){for(var T=0;T<h0.length;T++){var hZ=hY.eventAndCallback[h0[T]];for(var e=0;e<hY.disOverlays.length;e++){hY.disOverlays[e].addEventListener(h0[T],hZ)}}}}});window._layer=2;})(BMapGL,"BMapGL");